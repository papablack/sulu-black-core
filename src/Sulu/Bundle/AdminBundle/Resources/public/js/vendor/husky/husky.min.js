var requirejs,require,define;(function(global){var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version='2.1.9',commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!!(typeof window!=='undefined'&&typeof navigator!=='undefined'&&window.document),isWebWorker=!isBrowser&&typeof importScripts!=='undefined',readyRegExp=isBrowser&&navigator.platform==='PLAYSTATION 3'?/^complete$/:/^(complete|loaded)$/,defContextName='_',isOpera=typeof opera!=='undefined'&&opera.toString()==='[object Opera]',contexts={},cfg={},globalDefQueue=[],useInteractive=false;function isFunction(it){return ostring.call(it)==='[object Function]';}
function isArray(it){return ostring.call(it)==='[object Array]';}
function each(ary,func){if(ary){var i;for(i=0;i<ary.length;i+=1){if(ary[i]&&func(ary[i],i,ary)){break;}}}}
function eachReverse(ary,func){if(ary){var i;for(i=ary.length-1;i>-1;i-=1){if(ary[i]&&func(ary[i],i,ary)){break;}}}}
function hasProp(obj,prop){return hasOwn.call(obj,prop);}
function getOwn(obj,prop){return hasProp(obj,prop)&&obj[prop];}
function eachProp(obj,func){var prop;for(prop in obj){if(hasProp(obj,prop)){if(func(obj[prop],prop)){break;}}}}
function mixin(target,source,force,deepStringMixin){if(source){eachProp(source,function(value,prop){if(force||!hasProp(target,prop)){if(deepStringMixin&&typeof value!=='string'){if(!target[prop]){target[prop]={};}
mixin(target[prop],value,force,deepStringMixin);}else{target[prop]=value;}}});}
return target;}
function bind(obj,fn){return function(){return fn.apply(obj,arguments);};}
function scripts(){return document.getElementsByTagName('script');}
function defaultOnError(err){throw err;}
function getGlobal(value){if(!value){return value;}
var g=global;each(value.split('.'),function(part){g=g[part];});return g;}
function makeError(id,msg,err,requireModules){var e=new Error(msg+'\nhttp://requirejs.org/docs/errors.html#'+id);e.requireType=id;e.requireModules=requireModules;if(err){e.originalError=err;}
return e;}
if(typeof define!=='undefined'){return;}
if(typeof requirejs!=='undefined'){if(isFunction(requirejs)){return;}
cfg=requirejs;requirejs=undefined;}
if(typeof require!=='undefined'&&!isFunction(require)){cfg=require;require=undefined;}
function newContext(contextName){var inCheckLoaded,Module,context,handlers,checkLoadedTimeoutId,config={waitSeconds:7,baseUrl:'./',paths:{},pkgs:{},shim:{},config:{}},registry={},enabledRegistry={},undefEvents={},defQueue=[],defined={},urlFetched={},requireCounter=1,unnormalizedCounter=1;function trimDots(ary){var i,part;for(i=0;ary[i];i+=1){part=ary[i];if(part==='.'){ary.splice(i,1);i-=1;}else if(part==='..'){if(i===1&&(ary[2]==='..'||ary[0]==='..')){break;}else if(i>0){ary.splice(i-1,2);i-=2;}}}}
function normalize(name,baseName,applyMap){var pkgName,pkgConfig,mapValue,nameParts,i,j,nameSegment,foundMap,foundI,foundStarMap,starI,baseParts=baseName&&baseName.split('/'),normalizedBaseParts=baseParts,map=config.map,starMap=map&&map['*'];if(name&&name.charAt(0)==='.'){if(baseName){if(getOwn(config.pkgs,baseName)){normalizedBaseParts=baseParts=[baseName];}else{normalizedBaseParts=baseParts.slice(0,baseParts.length-1);}
name=normalizedBaseParts.concat(name.split('/'));trimDots(name);pkgConfig=getOwn(config.pkgs,(pkgName=name[0]));name=name.join('/');if(pkgConfig&&name===pkgName+'/'+pkgConfig.main){name=pkgName;}}else if(name.indexOf('./')===0){name=name.substring(2);}}
if(applyMap&&map&&(baseParts||starMap)){nameParts=name.split('/');for(i=nameParts.length;i>0;i-=1){nameSegment=nameParts.slice(0,i).join('/');if(baseParts){for(j=baseParts.length;j>0;j-=1){mapValue=getOwn(map,baseParts.slice(0,j).join('/'));if(mapValue){mapValue=getOwn(mapValue,nameSegment);if(mapValue){foundMap=mapValue;foundI=i;break;}}}}
if(foundMap){break;}
if(!foundStarMap&&starMap&&getOwn(starMap,nameSegment)){foundStarMap=getOwn(starMap,nameSegment);starI=i;}}
if(!foundMap&&foundStarMap){foundMap=foundStarMap;foundI=starI;}
if(foundMap){nameParts.splice(0,foundI,foundMap);name=nameParts.join('/');}}
return name;}
function removeScript(name){if(isBrowser){each(scripts(),function(scriptNode){if(scriptNode.getAttribute('data-requiremodule')===name&&scriptNode.getAttribute('data-requirecontext')===context.contextName){scriptNode.parentNode.removeChild(scriptNode);return true;}});}}
function hasPathFallback(id){var pathConfig=getOwn(config.paths,id);if(pathConfig&&isArray(pathConfig)&&pathConfig.length>1){pathConfig.shift();context.require.undef(id);context.require([id]);return true;}}
function splitPrefix(name){var prefix,index=name?name.indexOf('!'):-1;if(index>-1){prefix=name.substring(0,index);name=name.substring(index+1,name.length);}
return[prefix,name];}
function makeModuleMap(name,parentModuleMap,isNormalized,applyMap){var url,pluginModule,suffix,nameParts,prefix=null,parentName=parentModuleMap?parentModuleMap.name:null,originalName=name,isDefine=true,normalizedName='';if(!name){isDefine=false;name='_@r'+(requireCounter+=1);}
nameParts=splitPrefix(name);prefix=nameParts[0];name=nameParts[1];if(prefix){prefix=normalize(prefix,parentName,applyMap);pluginModule=getOwn(defined,prefix);}
if(name){if(prefix){if(pluginModule&&pluginModule.normalize){normalizedName=pluginModule.normalize(name,function(name){return normalize(name,parentName,applyMap);});}else{normalizedName=normalize(name,parentName,applyMap);}}else{normalizedName=normalize(name,parentName,applyMap);nameParts=splitPrefix(normalizedName);prefix=nameParts[0];normalizedName=nameParts[1];isNormalized=true;url=context.nameToUrl(normalizedName);}}
suffix=prefix&&!pluginModule&&!isNormalized?'_unnormalized'+(unnormalizedCounter+=1):'';return{prefix:prefix,name:normalizedName,parentMap:parentModuleMap,unnormalized:!!suffix,url:url,originalName:originalName,isDefine:isDefine,id:(prefix?prefix+'!'+normalizedName:normalizedName)+suffix};}
function getModule(depMap){var id=depMap.id,mod=getOwn(registry,id);if(!mod){mod=registry[id]=new context.Module(depMap);}
return mod;}
function on(depMap,name,fn){var id=depMap.id,mod=getOwn(registry,id);if(hasProp(defined,id)&&(!mod||mod.defineEmitComplete)){if(name==='defined'){fn(defined[id]);}}else{mod=getModule(depMap);if(mod.error&&name==='error'){fn(mod.error);}else{mod.on(name,fn);}}}
function onError(err,errback){var ids=err.requireModules,notified=false;if(errback){errback(err);}else{each(ids,function(id){var mod=getOwn(registry,id);if(mod){mod.error=err;if(mod.events.error){notified=true;mod.emit('error',err);}}});if(!notified){req.onError(err);}}}
function takeGlobalQueue(){if(globalDefQueue.length){apsp.apply(defQueue,[defQueue.length-1,0].concat(globalDefQueue));globalDefQueue=[];}}
handlers={'require':function(mod){if(mod.require){return mod.require;}else{return(mod.require=context.makeRequire(mod.map));}},'exports':function(mod){mod.usingExports=true;if(mod.map.isDefine){if(mod.exports){return mod.exports;}else{return(mod.exports=defined[mod.map.id]={});}}},'module':function(mod){if(mod.module){return mod.module;}else{return(mod.module={id:mod.map.id,uri:mod.map.url,config:function(){var c,pkg=getOwn(config.pkgs,mod.map.id);c=pkg?getOwn(config.config,mod.map.id+'/'+pkg.main):getOwn(config.config,mod.map.id);return c||{};},exports:defined[mod.map.id]});}}};function cleanRegistry(id){delete registry[id];delete enabledRegistry[id];}
function breakCycle(mod,traced,processed){var id=mod.map.id;if(mod.error){mod.emit('error',mod.error);}else{traced[id]=true;each(mod.depMaps,function(depMap,i){var depId=depMap.id,dep=getOwn(registry,depId);if(dep&&!mod.depMatched[i]&&!processed[depId]){if(getOwn(traced,depId)){mod.defineDep(i,defined[depId]);mod.check();}else{breakCycle(dep,traced,processed);}}});processed[id]=true;}}
function checkLoaded(){var map,modId,err,usingPathFallback,waitInterval=config.waitSeconds*1000,expired=waitInterval&&(context.startTime+waitInterval)<new Date().getTime(),noLoads=[],reqCalls=[],stillLoading=false,needCycleCheck=true;if(inCheckLoaded){return;}
inCheckLoaded=true;eachProp(enabledRegistry,function(mod){map=mod.map;modId=map.id;if(!mod.enabled){return;}
if(!map.isDefine){reqCalls.push(mod);}
if(!mod.error){if(!mod.inited&&expired){if(hasPathFallback(modId)){usingPathFallback=true;stillLoading=true;}else{noLoads.push(modId);removeScript(modId);}}else if(!mod.inited&&mod.fetched&&map.isDefine){stillLoading=true;if(!map.prefix){return(needCycleCheck=false);}}}});if(expired&&noLoads.length){err=makeError('timeout','Load timeout for modules: '+noLoads,null,noLoads);err.contextName=context.contextName;return onError(err);}
if(needCycleCheck){each(reqCalls,function(mod){breakCycle(mod,{},{});});}
if((!expired||usingPathFallback)&&stillLoading){if((isBrowser||isWebWorker)&&!checkLoadedTimeoutId){checkLoadedTimeoutId=setTimeout(function(){checkLoadedTimeoutId=0;checkLoaded();},50);}}
inCheckLoaded=false;}
Module=function(map){this.events=getOwn(undefEvents,map.id)||{};this.map=map;this.shim=getOwn(config.shim,map.id);this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0;};Module.prototype={init:function(depMaps,factory,errback,options){options=options||{};if(this.inited){return;}
this.factory=factory;if(errback){this.on('error',errback);}else if(this.events.error){errback=bind(this,function(err){this.emit('error',err);});}
this.depMaps=depMaps&&depMaps.slice(0);this.errback=errback;this.inited=true;this.ignore=options.ignore;if(options.enabled||this.enabled){this.enable();}else{this.check();}},defineDep:function(i,depExports){if(!this.depMatched[i]){this.depMatched[i]=true;this.depCount-=1;this.depExports[i]=depExports;}},fetch:function(){if(this.fetched){return;}
this.fetched=true;context.startTime=(new Date()).getTime();var map=this.map;if(this.shim){context.makeRequire(this.map,{enableBuildCallback:true})(this.shim.deps||[],bind(this,function(){return map.prefix?this.callPlugin():this.load();}));}else{return map.prefix?this.callPlugin():this.load();}},load:function(){var url=this.map.url;if(!urlFetched[url]){urlFetched[url]=true;context.load(this.map.id,url);}},check:function(){if(!this.enabled||this.enabling){return;}
var err,cjsModule,id=this.map.id,depExports=this.depExports,exports=this.exports,factory=this.factory;if(!this.inited){this.fetch();}else if(this.error){this.emit('error',this.error);}else if(!this.defining){this.defining=true;if(this.depCount<1&&!this.defined){if(isFunction(factory)){if((this.events.error&&this.map.isDefine)||req.onError!==defaultOnError){try{exports=context.execCb(id,factory,depExports,exports);}catch(e){err=e;}}else{exports=context.execCb(id,factory,depExports,exports);}
if(this.map.isDefine){cjsModule=this.module;if(cjsModule&&cjsModule.exports!==undefined&&cjsModule.exports!==this.exports){exports=cjsModule.exports;}else if(exports===undefined&&this.usingExports){exports=this.exports;}}
if(err){err.requireMap=this.map;err.requireModules=this.map.isDefine?[this.map.id]:null;err.requireType=this.map.isDefine?'define':'require';return onError((this.error=err));}}else{exports=factory;}
this.exports=exports;if(this.map.isDefine&&!this.ignore){defined[id]=exports;if(req.onResourceLoad){req.onResourceLoad(context,this.map,this.depMaps);}}
cleanRegistry(id);this.defined=true;}
this.defining=false;if(this.defined&&!this.defineEmitted){this.defineEmitted=true;this.emit('defined',this.exports);this.defineEmitComplete=true;}}},callPlugin:function(){var map=this.map,id=map.id,pluginMap=makeModuleMap(map.prefix);this.depMaps.push(pluginMap);on(pluginMap,'defined',bind(this,function(plugin){var load,normalizedMap,normalizedMod,name=this.map.name,parentName=this.map.parentMap?this.map.parentMap.name:null,localRequire=context.makeRequire(map.parentMap,{enableBuildCallback:true});if(this.map.unnormalized){if(plugin.normalize){name=plugin.normalize(name,function(name){return normalize(name,parentName,true);})||'';}
normalizedMap=makeModuleMap(map.prefix+'!'+name,this.map.parentMap);on(normalizedMap,'defined',bind(this,function(value){this.init([],function(){return value;},null,{enabled:true,ignore:true});}));normalizedMod=getOwn(registry,normalizedMap.id);if(normalizedMod){this.depMaps.push(normalizedMap);if(this.events.error){normalizedMod.on('error',bind(this,function(err){this.emit('error',err);}));}
normalizedMod.enable();}
return;}
load=bind(this,function(value){this.init([],function(){return value;},null,{enabled:true});});load.error=bind(this,function(err){this.inited=true;this.error=err;err.requireModules=[id];eachProp(registry,function(mod){if(mod.map.id.indexOf(id+'_unnormalized')===0){cleanRegistry(mod.map.id);}});onError(err);});load.fromText=bind(this,function(text,textAlt){var moduleName=map.name,moduleMap=makeModuleMap(moduleName),hasInteractive=useInteractive;if(textAlt){text=textAlt;}
if(hasInteractive){useInteractive=false;}
getModule(moduleMap);if(hasProp(config.config,id)){config.config[moduleName]=config.config[id];}
try{req.exec(text);}catch(e){return onError(makeError('fromtexteval','fromText eval for '+id+' failed: '+e,e,[id]));}
if(hasInteractive){useInteractive=true;}
this.depMaps.push(moduleMap);context.completeLoad(moduleName);localRequire([moduleName],load);});plugin.load(map.name,localRequire,load,config);}));context.enable(pluginMap,this);this.pluginMaps[pluginMap.id]=pluginMap;},enable:function(){enabledRegistry[this.map.id]=this;this.enabled=true;this.enabling=true;each(this.depMaps,bind(this,function(depMap,i){var id,mod,handler;if(typeof depMap==='string'){depMap=makeModuleMap(depMap,(this.map.isDefine?this.map:this.map.parentMap),false,!this.skipMap);this.depMaps[i]=depMap;handler=getOwn(handlers,depMap.id);if(handler){this.depExports[i]=handler(this);return;}
this.depCount+=1;on(depMap,'defined',bind(this,function(depExports){this.defineDep(i,depExports);this.check();}));if(this.errback){on(depMap,'error',bind(this,this.errback));}}
id=depMap.id;mod=registry[id];if(!hasProp(handlers,id)&&mod&&!mod.enabled){context.enable(depMap,this);}}));eachProp(this.pluginMaps,bind(this,function(pluginMap){var mod=getOwn(registry,pluginMap.id);if(mod&&!mod.enabled){context.enable(pluginMap,this);}}));this.enabling=false;this.check();},on:function(name,cb){var cbs=this.events[name];if(!cbs){cbs=this.events[name]=[];}
cbs.push(cb);},emit:function(name,evt){each(this.events[name],function(cb){cb(evt);});if(name==='error'){delete this.events[name];}}};function callGetModule(args){if(!hasProp(defined,args[0])){getModule(makeModuleMap(args[0],null,true)).init(args[1],args[2]);}}
function removeListener(node,func,name,ieName){if(node.detachEvent&&!isOpera){if(ieName){node.detachEvent(ieName,func);}}else{node.removeEventListener(name,func,false);}}
function getScriptData(evt){var node=evt.currentTarget||evt.srcElement;removeListener(node,context.onScriptLoad,'load','onreadystatechange');removeListener(node,context.onScriptError,'error');return{node:node,id:node&&node.getAttribute('data-requiremodule')};}
function intakeDefines(){var args;takeGlobalQueue();while(defQueue.length){args=defQueue.shift();if(args[0]===null){return onError(makeError('mismatch','Mismatched anonymous define() module: '+args[args.length-1]));}else{callGetModule(args);}}}
context={config:config,contextName:contextName,registry:registry,defined:defined,urlFetched:urlFetched,defQueue:defQueue,Module:Module,makeModuleMap:makeModuleMap,nextTick:req.nextTick,onError:onError,configure:function(cfg){if(cfg.baseUrl){if(cfg.baseUrl.charAt(cfg.baseUrl.length-1)!=='/'){cfg.baseUrl+='/';}}
var pkgs=config.pkgs,shim=config.shim,objs={paths:true,config:true,map:true};eachProp(cfg,function(value,prop){if(objs[prop]){if(prop==='map'){if(!config.map){config.map={};}
mixin(config[prop],value,true,true);}else{mixin(config[prop],value,true);}}else{config[prop]=value;}});if(cfg.shim){eachProp(cfg.shim,function(value,id){if(isArray(value)){value={deps:value};}
if((value.exports||value.init)&&!value.exportsFn){value.exportsFn=context.makeShimExports(value);}
shim[id]=value;});config.shim=shim;}
if(cfg.packages){each(cfg.packages,function(pkgObj){var location;pkgObj=typeof pkgObj==='string'?{name:pkgObj}:pkgObj;location=pkgObj.location;pkgs[pkgObj.name]={name:pkgObj.name,location:location||pkgObj.name,main:(pkgObj.main||'main').replace(currDirRegExp,'').replace(jsSuffixRegExp,'')};});config.pkgs=pkgs;}
eachProp(registry,function(mod,id){if(!mod.inited&&!mod.map.unnormalized){mod.map=makeModuleMap(id);}});if(cfg.deps||cfg.callback){context.require(cfg.deps||[],cfg.callback);}},makeShimExports:function(value){function fn(){var ret;if(value.init){ret=value.init.apply(global,arguments);}
return ret||(value.exports&&getGlobal(value.exports));}
return fn;},makeRequire:function(relMap,options){options=options||{};function localRequire(deps,callback,errback){var id,map,requireMod;if(options.enableBuildCallback&&callback&&isFunction(callback)){callback.__requireJsBuild=true;}
if(typeof deps==='string'){if(isFunction(callback)){return onError(makeError('requireargs','Invalid require call'),errback);}
if(relMap&&hasProp(handlers,deps)){return handlers[deps](registry[relMap.id]);}
if(req.get){return req.get(context,deps,relMap,localRequire);}
map=makeModuleMap(deps,relMap,false,true);id=map.id;if(!hasProp(defined,id)){return onError(makeError('notloaded','Module name "'+
id+'" has not been loaded yet for context: '+
contextName+
(relMap?'':'. Use require([])')));}
return defined[id];}
intakeDefines();context.nextTick(function(){intakeDefines();requireMod=getModule(makeModuleMap(null,relMap));requireMod.skipMap=options.skipMap;requireMod.init(deps,callback,errback,{enabled:true});checkLoaded();});return localRequire;}
mixin(localRequire,{isBrowser:isBrowser,toUrl:function(moduleNamePlusExt){var ext,index=moduleNamePlusExt.lastIndexOf('.'),segment=moduleNamePlusExt.split('/')[0],isRelative=segment==='.'||segment==='..';if(index!==-1&&(!isRelative||index>1)){ext=moduleNamePlusExt.substring(index,moduleNamePlusExt.length);moduleNamePlusExt=moduleNamePlusExt.substring(0,index);}
return context.nameToUrl(normalize(moduleNamePlusExt,relMap&&relMap.id,true),ext,true);},defined:function(id){return hasProp(defined,makeModuleMap(id,relMap,false,true).id);},specified:function(id){id=makeModuleMap(id,relMap,false,true).id;return hasProp(defined,id)||hasProp(registry,id);}});if(!relMap){localRequire.undef=function(id){takeGlobalQueue();var map=makeModuleMap(id,relMap,true),mod=getOwn(registry,id);removeScript(id);delete defined[id];delete urlFetched[map.url];delete undefEvents[id];if(mod){if(mod.events.defined){undefEvents[id]=mod.events;}
cleanRegistry(id);}};}
return localRequire;},enable:function(depMap){var mod=getOwn(registry,depMap.id);if(mod){getModule(depMap).enable();}},completeLoad:function(moduleName){var found,args,mod,shim=getOwn(config.shim,moduleName)||{},shExports=shim.exports;takeGlobalQueue();while(defQueue.length){args=defQueue.shift();if(args[0]===null){args[0]=moduleName;if(found){break;}
found=true;}else if(args[0]===moduleName){found=true;}
callGetModule(args);}
mod=getOwn(registry,moduleName);if(!found&&!hasProp(defined,moduleName)&&mod&&!mod.inited){if(config.enforceDefine&&(!shExports||!getGlobal(shExports))){if(hasPathFallback(moduleName)){return;}else{return onError(makeError('nodefine','No define call for '+moduleName,null,[moduleName]));}}else{callGetModule([moduleName,(shim.deps||[]),shim.exportsFn]);}}
checkLoaded();},nameToUrl:function(moduleName,ext,skipExt){var paths,pkgs,pkg,pkgPath,syms,i,parentModule,url,parentPath;if(req.jsExtRegExp.test(moduleName)){url=moduleName+(ext||'');}else{paths=config.paths;pkgs=config.pkgs;syms=moduleName.split('/');for(i=syms.length;i>0;i-=1){parentModule=syms.slice(0,i).join('/');pkg=getOwn(pkgs,parentModule);parentPath=getOwn(paths,parentModule);if(parentPath){if(isArray(parentPath)){parentPath=parentPath[0];}
syms.splice(0,i,parentPath);break;}else if(pkg){if(moduleName===pkg.name){pkgPath=pkg.location+'/'+pkg.main;}else{pkgPath=pkg.location;}
syms.splice(0,i,pkgPath);break;}}
url=syms.join('/');url+=(ext||(/^data\:|\?/.test(url)||skipExt?'':'.js'));url=(url.charAt(0)==='/'||url.match(/^[\w\+\.\-]+:/)?'':config.baseUrl)+url;}
return config.urlArgs?url+
((url.indexOf('?')===-1?'?':'&')+
config.urlArgs):url;},load:function(id,url){req.load(context,id,url);},execCb:function(name,callback,args,exports){return callback.apply(exports,args);},onScriptLoad:function(evt){if(evt.type==='load'||(readyRegExp.test((evt.currentTarget||evt.srcElement).readyState))){interactiveScript=null;var data=getScriptData(evt);context.completeLoad(data.id);}},onScriptError:function(evt){var data=getScriptData(evt);if(!hasPathFallback(data.id)){return onError(makeError('scripterror','Script error for: '+data.id,evt,[data.id]));}}};context.require=context.makeRequire();return context;}
req=requirejs=function(deps,callback,errback,optional){var context,config,contextName=defContextName;if(!isArray(deps)&&typeof deps!=='string'){config=deps;if(isArray(callback)){deps=callback;callback=errback;errback=optional;}else{deps=[];}}
if(config&&config.context){contextName=config.context;}
context=getOwn(contexts,contextName);if(!context){context=contexts[contextName]=req.s.newContext(contextName);}
if(config){context.configure(config);}
return context.require(deps,callback,errback);};req.config=function(config){return req(config);};req.nextTick=typeof setTimeout!=='undefined'?function(fn){setTimeout(fn,4);}:function(fn){fn();};if(!require){require=req;}
req.version=version;req.jsExtRegExp=/^\/|:|\?|\.js$/;req.isBrowser=isBrowser;s=req.s={contexts:contexts,newContext:newContext};req({});each(['toUrl','undef','defined','specified'],function(prop){req[prop]=function(){var ctx=contexts[defContextName];return ctx.require[prop].apply(ctx,arguments);};});if(isBrowser){head=s.head=document.getElementsByTagName('head')[0];baseElement=document.getElementsByTagName('base')[0];if(baseElement){head=s.head=baseElement.parentNode;}}
req.onError=defaultOnError;req.createNode=function(config,moduleName,url){var node=config.xhtml?document.createElementNS('http://www.w3.org/1999/xhtml','html:script'):document.createElement('script');node.type=config.scriptType||'text/javascript';node.charset='utf-8';node.async=true;return node;};req.load=function(context,moduleName,url){var config=(context&&context.config)||{},node;if(isBrowser){node=req.createNode(config,moduleName,url);node.setAttribute('data-requirecontext',context.contextName);node.setAttribute('data-requiremodule',moduleName);if(node.attachEvent&&!(node.attachEvent.toString&&node.attachEvent.toString().indexOf('[native code')<0)&&!isOpera){useInteractive=true;node.attachEvent('onreadystatechange',context.onScriptLoad);}else{node.addEventListener('load',context.onScriptLoad,false);node.addEventListener('error',context.onScriptError,false);}
node.src=url;currentlyAddingScript=node;if(baseElement){head.insertBefore(node,baseElement);}else{head.appendChild(node);}
currentlyAddingScript=null;return node;}else if(isWebWorker){try{importScripts(url);context.completeLoad(moduleName);}catch(e){context.onError(makeError('importscripts','importScripts failed for '+
moduleName+' at '+url,e,[moduleName]));}}};function getInteractiveScript(){if(interactiveScript&&interactiveScript.readyState==='interactive'){return interactiveScript;}
eachReverse(scripts(),function(script){if(script.readyState==='interactive'){return(interactiveScript=script);}});return interactiveScript;}
if(isBrowser&&!cfg.skipDataMain){eachReverse(scripts(),function(script){if(!head){head=script.parentNode;}
dataMain=script.getAttribute('data-main');if(dataMain){mainScript=dataMain;if(!cfg.baseUrl){src=mainScript.split('/');mainScript=src.pop();subPath=src.length?src.join('/')+'/':'./';cfg.baseUrl=subPath;}
mainScript=mainScript.replace(jsSuffixRegExp,'');if(req.jsExtRegExp.test(mainScript)){mainScript=dataMain;}
cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript];return true;}});}
define=function(name,deps,callback){var node,context;if(typeof name!=='string'){callback=deps;deps=name;name=null;}
if(!isArray(deps)){callback=deps;deps=null;}
if(!deps&&isFunction(callback)){deps=[];if(callback.length){callback.toString().replace(commentRegExp,'').replace(cjsRequireRegExp,function(match,dep){deps.push(dep);});deps=(callback.length===1?['require']:['require','exports','module']).concat(deps);}}
if(useInteractive){node=currentlyAddingScript||getInteractiveScript();if(node){if(!name){name=node.getAttribute('data-requiremodule');}
context=contexts[node.getAttribute('data-requirecontext')];}}
(context?context.defQueue:globalDefQueue).push([name,deps,callback]);};define.amd={jQuery:true};req.exec=function(text){return eval(text);};req(cfg);}(this));define("requirejs",function(){});(function(window,undefined){var
readyList,rootjQuery,core_strundefined=typeof undefined,location=window.location,document=window.document,docElem=document.documentElement,_jQuery=window.jQuery,_$=window.$,class2type={},core_deletedIds=[],core_version="1.10.2",core_concat=core_deletedIds.concat,core_push=core_deletedIds.push,core_slice=core_deletedIds.slice,core_indexOf=core_deletedIds.indexOf,core_toString=class2type.toString,core_hasOwn=class2type.hasOwnProperty,core_trim=core_version.trim,jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery);},core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,core_rnotwhite=/\S+/g,rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rvalidchars=/^[\],:{}\s]*$/,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rvalidescape=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,rvalidtokens=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase();},completed=function(event){if(document.addEventListener||event.type==="load"||document.readyState==="complete"){detach();jQuery.ready();}},detach=function(){if(document.addEventListener){document.removeEventListener("DOMContentLoaded",completed,false);window.removeEventListener("load",completed,false);}else{document.detachEvent("onreadystatechange",completed);window.detachEvent("onload",completed);}};jQuery.fn=jQuery.prototype={jquery:core_version,constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem;if(!selector){return this;}
if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null];}else{match=rquickExpr.exec(selector);}
if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){this[match](context[match]);}else{this.attr(match,context[match]);}}}
return this;}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector);}
this.length=1;this[0]=elem;}
this.context=document;this.selector=selector;return this;}}else if(!context||context.jquery){return(context||rootjQuery).find(selector);}else{return this.constructor(context).find(selector);}}else if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this;}else if(jQuery.isFunction(selector)){return rootjQuery.ready(selector);}
if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context;}
return jQuery.makeArray(selector,this);},selector:"",length:0,toArray:function(){return core_slice.call(this);},get:function(num){return num==null?this.toArray():(num<0?this[this.length+num]:this[num]);},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret;},each:function(callback,args){return jQuery.each(this,callback,args);},ready:function(fn){jQuery.ready.promise().done(fn);return this;},slice:function(){return this.pushStack(core_slice.apply(this,arguments));},first:function(){return this.eq(0);},last:function(){return this.eq(-1);},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[]);},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem);}));},end:function(){return this.prevObject||this.constructor(null);},push:core_push,sort:[].sort,splice:[].splice};jQuery.fn.init.prototype=jQuery.fn;jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2;}
if(typeof target!=="object"&&!jQuery.isFunction(target)){target={};}
if(length===i){target=this;--i;}
for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue;}
if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[];}else{clone=src&&jQuery.isPlainObject(src)?src:{};}
target[name]=jQuery.extend(deep,clone,copy);}else if(copy!==undefined){target[name]=copy;}}}}
return target;};jQuery.extend({expando:"jQuery"+(core_version+Math.random()).replace(/\D/g,""),noConflict:function(deep){if(window.$===jQuery){window.$=_$;}
if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery;}
return jQuery;},isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++;}else{jQuery.ready(true);}},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return;}
if(!document.body){return setTimeout(jQuery.ready);}
jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return;}
readyList.resolveWith(document,[jQuery]);if(jQuery.fn.trigger){jQuery(document).trigger("ready").off("ready");}},isFunction:function(obj){return jQuery.type(obj)==="function";},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array";},isWindow:function(obj){return obj!=null&&obj==obj.window;},isNumeric:function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj);},type:function(obj){if(obj==null){return String(obj);}
return typeof obj==="object"||typeof obj==="function"?class2type[core_toString.call(obj)]||"object":typeof obj;},isPlainObject:function(obj){var key;if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false;}
try{if(obj.constructor&&!core_hasOwn.call(obj,"constructor")&&!core_hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false;}}catch(e){return false;}
if(jQuery.support.ownLast){for(key in obj){return core_hasOwn.call(obj,key);}}
for(key in obj){}
return key===undefined||core_hasOwn.call(obj,key);},isEmptyObject:function(obj){var name;for(name in obj){return false;}
return true;},error:function(msg){throw new Error(msg);},parseHTML:function(data,context,keepScripts){if(!data||typeof data!=="string"){return null;}
if(typeof context==="boolean"){keepScripts=context;context=false;}
context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])];}
parsed=jQuery.buildFragment([data],context,scripts);if(scripts){jQuery(scripts).remove();}
return jQuery.merge([],parsed.childNodes);},parseJSON:function(data){if(window.JSON&&window.JSON.parse){return window.JSON.parse(data);}
if(data===null){return data;}
if(typeof data==="string"){data=jQuery.trim(data);if(data){if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))){return(new Function("return "+data))();}}}
jQuery.error("Invalid JSON: "+data);},parseXML:function(data){var xml,tmp;if(!data||typeof data!=="string"){return null;}
try{if(window.DOMParser){tmp=new DOMParser();xml=tmp.parseFromString(data,"text/xml");}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data);}}catch(e){xml=undefined;}
if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data);}
return xml;},noop:function(){},globalEval:function(data){if(data&&jQuery.trim(data)){(window.execScript||function(data){window["eval"].call(window,data);})(data);}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase);},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase();},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray){for(;i<length;i++){value=callback.apply(obj[i],args);if(value===false){break;}}}else{for(i in obj){value=callback.apply(obj[i],args);if(value===false){break;}}}}else{if(isArray){for(;i<length;i++){value=callback.call(obj[i],i,obj[i]);if(value===false){break;}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);if(value===false){break;}}}}
return obj;},trim:core_trim&&!core_trim.call("\uFEFF\xA0")?function(text){return text==null?"":core_trim.call(text);}:function(text){return text==null?"":(text+"").replace(rtrim,"");},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr);}else{core_push.call(ret,arr);}}
return ret;},inArray:function(elem,arr,i){var len;if(arr){if(core_indexOf){return core_indexOf.call(arr,elem,i);}
len=arr.length;i=i?i<0?Math.max(0,len+i):i:0;for(;i<len;i++){if(i in arr&&arr[i]===elem){return i;}}}
return-1;},merge:function(first,second){var l=second.length,i=first.length,j=0;if(typeof l==="number"){for(;j<l;j++){first[i++]=second[j];}}else{while(second[j]!==undefined){first[i++]=second[j++];}}
first.length=i;return first;},grep:function(elems,callback,inv){var retVal,ret=[],i=0,length=elems.length;inv=!!inv;for(;i<length;i++){retVal=!!callback(elems[i],i);if(inv!==retVal){ret.push(elems[i]);}}
return ret;},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value;}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value;}}}
return core_concat.apply([],ret);},guid:1,proxy:function(fn,context){var args,proxy,tmp;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp;}
if(!jQuery.isFunction(fn)){return undefined;}
args=core_slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(core_slice.call(arguments)));};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy;},access:function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=true;for(i in key){jQuery.access(elems,fn,i,key[i],true,emptyGet,raw);}}else if(value!==undefined){chainable=true;if(!jQuery.isFunction(value)){raw=true;}
if(bulk){if(raw){fn.call(elems,value);fn=null;}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value);};}}
if(fn){for(;i<length;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));}}}
return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet;},now:function(){return(new Date()).getTime();},swap:function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name];}
ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name];}
return ret;}});jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready);}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",completed,false);window.addEventListener("load",completed,false);}else{document.attachEvent("onreadystatechange",completed);window.attachEvent("onload",completed);var top=false;try{top=window.frameElement==null&&document.documentElement;}catch(e){}
if(top&&top.doScroll){(function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left");}catch(e){return setTimeout(doScrollCheck,50);}
detach();jQuery.ready();}})();}}}
return readyList.promise(obj);};jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase();});function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);if(jQuery.isWindow(obj)){return false;}
if(obj.nodeType===1&&length){return true;}
return type==="array"||type!=="function"&&(length===0||typeof length==="number"&&length>0&&(length-1)in obj);}
rootjQuery=jQuery(document);(function(window,undefined){var i,support,cachedruns,Expr,getText,isXML,compile,outermostContext,sortInput,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+ -(new Date()),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),hasDuplicate=false,sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0;}
return 0;},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn=({}).hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){var i=0,len=this.length;for(;i<len;i++){if(this[i]===elem){return i;}}
return-1;},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rsibling=new RegExp(whitespace+"*[+~]"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={"ID":new RegExp("^#("+characterEncoding+")"),"CLASS":new RegExp("^\\.("+characterEncoding+")"),"TAG":new RegExp("^("+characterEncoding.replace("w","w*")+")"),"ATTR":new RegExp("^"+attributes),"PSEUDO":new RegExp("^"+pseudos),"CHILD":new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),"bool":new RegExp("^(?:"+booleans+")$","i"),"needsContext":new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+
whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-0x10000;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+0x10000):String.fromCharCode(high>>10|0xD800,high&0x3FF|0xDC00);};try{push.apply((arr=slice.call(preferredDoc.childNodes)),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType;}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els));}:function(target,els){var j=target.length,i=0;while((target[j++]=els[i++])){}
target.length=j-1;}};}
function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context);}
context=context||document;results=results||[];if(!selector||typeof selector!=="string"){return results;}
if((nodeType=context.nodeType)!==1&&nodeType!==9){return[];}
if(documentIsHTML&&!seed){if((match=rquickExpr.exec(selector))){if((m=match[1])){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results;}}else{return results;}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results;}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results;}else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results;}}
if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType===9&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if((old=context.getAttribute("id"))){nid=old.replace(rescape,"\\$&");}else{context.setAttribute("id",nid);}
nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i]);}
newContext=rsibling.test(selector)&&context.parentNode||context;newSelector=groups.join(",");}
if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results;}catch(qsaError){}finally{if(!old){context.removeAttribute("id");}}}}}
return select(selector.replace(rtrim,"$1"),context,results,seed);}
function createCache(){var keys=[];function cache(key,value){if(keys.push(key+=" ")>Expr.cacheLength){delete cache[keys.shift()];}
return(cache[key]=value);}
return cache;}
function markFunction(fn){fn[expando]=true;return fn;}
function assert(fn){var div=document.createElement("div");try{return!!fn(div);}catch(e){return false;}finally{if(div.parentNode){div.parentNode.removeChild(div);}
div=null;}}
function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler;}}
function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-
(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff;}
if(cur){while((cur=cur.nextSibling)){if(cur===b){return-1;}}}
return a?1:-1;}
function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type;};}
function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type;};}
function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[(j=matchIndexes[i])]){seed[j]=!(matches[j]=seed[j]);}}});});}
isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false;};support=Sizzle.support={};setDocument=Sizzle.setDocument=function(node){var doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document;}
document=doc;docElem=doc.documentElement;documentIsHTML=!isXML(doc);if(parent&&parent.attachEvent&&parent!==parent.top){parent.attachEvent("onbeforeunload",function(){setDocument();});}
support.attributes=assert(function(div){div.className="i";return!div.getAttribute("className");});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return!div.getElementsByTagName("*").length;});support.getElementsByClassName=assert(function(div){div.innerHTML="<div class='a'></div><div class='a i'></div>";div.firstChild.className="i";return div.getElementsByClassName("i").length===2;});support.getById=assert(function(div){docElem.appendChild(div).id=expando;return!doc.getElementsByName||!doc.getElementsByName(expando).length;});if(support.getById){Expr.find["ID"]=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[];}};Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId;};};}else{delete Expr.find["ID"];Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId;};};}
Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag);}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while((elem=results[i++])){if(elem.nodeType===1){tmp.push(elem);}}
return tmp;}
return results;};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!==strundefined&&documentIsHTML){return context.getElementsByClassName(className);}};rbuggyMatches=[];rbuggyQSA=[];if((support.qsa=rnative.test(doc.querySelectorAll))){assert(function(div){div.innerHTML="<select><option selected=''></option></select>";if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")");}
if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked");}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("t","");if(div.querySelectorAll("[t^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")");}
if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled");}
div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:");});}
if((support.matchesSelector=rnative.test((matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)))){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos);});}
rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));contains=rnative.test(docElem.contains)||docElem.compareDocumentPosition?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16));}:function(a,b){if(b){while((b=b.parentNode)){if(b===a){return true;}}}
return false;};sortOrder=docElem.compareDocumentPosition?function(a,b){if(a===b){hasDuplicate=true;return 0;}
var compare=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b);if(compare){if(compare&1||(!support.sortDetached&&b.compareDocumentPosition(a)===compare)){if(a===doc||contains(preferredDoc,a)){return-1;}
if(b===doc||contains(preferredDoc,b)){return 1;}
return sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0;}
return compare&4?-1:1;}
return a.compareDocumentPosition?-1:1;}:function(a,b){var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(a===b){hasDuplicate=true;return 0;}else if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0;}else if(aup===bup){return siblingCheck(a,b);}
cur=a;while((cur=cur.parentNode)){ap.unshift(cur);}
cur=b;while((cur=cur.parentNode)){bp.unshift(cur);}
while(ap[i]===bp[i]){i++;}
return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0;};return doc;};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements);};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem);}
expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret;}}catch(e){}}
return Sizzle(expr,document,null,[elem]).length>0;};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context);}
return contains(context,elem);};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem);}
var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val===undefined?support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null:val;};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg);};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while((elem=results[i++])){if(elem===results[i]){j=duplicates.push(i);}}
while(j--){results.splice(duplicates[j],1);}}
return results;};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){for(;(node=elem[i]);i++){ret+=getText(node);}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent;}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem);}}}else if(nodeType===3||nodeType===4){return elem.nodeValue;}
return ret;};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{"ATTR":function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" ";}
return match.slice(0,4);},"CHILD":function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0]);}
match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+((match[7]+match[8])||match[3]==="odd");}else if(match[3]){Sizzle.error(match[0]);}
return match;},"PSEUDO":function(match){var excess,unquoted=!match[5]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null;}
if(match[3]&&match[4]!==undefined){match[2]=match[4];}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess);}
return match.slice(0,3);}},filter:{"TAG":function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true;}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName;};},"CLASS":function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"");});},"ATTR":function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!=";}
if(!operator){return true;}
result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false;};},"CHILD":function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode;}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while((node=node[dir])){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false;}}
start=dir=type==="only"&&!start&&"nextSibling";}
return true;}
start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break;}}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1];}else{while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff];}
if(node===elem){break;}}}}
diff-=last;return diff===first||(diff%first===0&&diff / first>=0);}};},"PSEUDO":function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument);}
if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf.call(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i]);}}):function(elem){return fn(elem,0,args);};}
return fn;}},pseudos:{"not":markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if((elem=unmatched[i])){seed[i]=!(matches[i]=elem);}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);return!results.pop();};}),"has":markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0;};}),"contains":markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1;};}),"lang":markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang);}
lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if((elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0;}}while((elem=elem.parentNode)&&elem.nodeType===1);return false;};}),"target":function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id;},"root":function(elem){return elem===docElem;},"focus":function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex);},"enabled":function(elem){return elem.disabled===false;},"disabled":function(elem){return elem.disabled===true;},"checked":function(elem){var nodeName=elem.nodeName.toLowerCase();return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected);},"selected":function(elem){if(elem.parentNode){elem.parentNode.selectedIndex;}
return elem.selected===true;},"empty":function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeName>"@"||elem.nodeType===3||elem.nodeType===4){return false;}}
return true;},"parent":function(elem){return!Expr.pseudos["empty"](elem);},"header":function(elem){return rheader.test(elem.nodeName);},"input":function(elem){return rinputs.test(elem.nodeName);},"button":function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button";},"text":function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()===elem.type);},"first":createPositionalPseudo(function(){return[0];}),"last":createPositionalPseudo(function(matchIndexes,length){return[length-1];}),"eq":createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument];}),"even":createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i);}
return matchIndexes;}),"odd":createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i);}
return matchIndexes;}),"lt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i);}
return matchIndexes;}),"gt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i);}
return matchIndexes;})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i);}
for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i);}
function setFilters(){}
setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0);}
soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar;}
groups.push(tokens=[]);}
matched=false;if((match=rcombinators.exec(soFar))){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length);}
for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length);}}
if(!matched){break;}}
return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0);}
function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value;}
return selector;}
function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml);}}}:function(elem,context,xml){var data,cache,outerCache,dirkey=dirruns+" "+doneName;if(xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true;}}}}else{while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((cache=outerCache[dir])&&cache[0]===dirkey){if((data=cache[1])===true||data===cachedruns){return data===true;}}else{cache=outerCache[dir]=[dirkey];cache[1]=matcher(elem,context,xml)||cachedruns;if(cache[1]===true){return true;}}}}}};}
function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false;}}
return true;}:matchers[0];}
function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if((elem=unmatched[i])){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i);}}}}
return newUnmatched;}
function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter);}
if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector);}
return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml);}
if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if((elem=temp[i])){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem);}}}
if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if((elem=matcherOut[i])){temp.push((matcherIn[i]=elem));}}
postFinder(null,(matcherOut=[]),temp,xml);}
i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem);}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml);}else{push.apply(results,matcherOut);}}});}
function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext;},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1;},implicitRelative,true),matchers=[function(elem,context,xml){return(!leadingRelative&&(xml||context!==outermostContext))||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));}];for(;i<len;i++){if((matcher=Expr.relative[tokens[i].type])){matchers=[addCombinator(elementMatcher(matchers),matcher)];}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break;}}
return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens((tokens=tokens.slice(j))),j<len&&toSelector(tokens));}
matchers.push(matcher);}}
return elementMatcher(matchers);}
function matcherFromGroupMatchers(elementMatchers,setMatchers){var matcherCachedRuns=0,bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,expandContext){var elem,j,matcher,setMatched=[],matchedCount=0,i="0",unmatched=seed&&[],outermost=expandContext!=null,contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",expandContext&&context.parentNode||context),dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1);if(outermost){outermostContext=context!==document&&context;cachedruns=matcherCachedRuns;}
for(;(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while((matcher=elementMatchers[j++])){if(matcher(elem,context,xml)){results.push(elem);break;}}
if(outermost){dirruns=dirrunsUnique;cachedruns=++matcherCachedRuns;}}
if(bySet){if((elem=!matcher&&elem)){matchedCount--;}
if(seed){unmatched.push(elem);}}}
matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while((matcher=setMatchers[j++])){matcher(unmatched,setMatched,context,xml);}
if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results);}}}
setMatched=condense(setMatched);}
push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&(matchedCount+setMatchers.length)>1){Sizzle.uniqueSort(results);}}
if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup;}
return unmatched;};return bySet?markFunction(superMatcher):superMatcher;}
compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!group){group=tokenize(selector);}
i=group.length;while(i--){cached=matcherFromTokens(group[i]);if(cached[expando]){setMatchers.push(cached);}else{elementMatchers.push(cached);}}
cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));}
return cached;};function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results);}
return results;}
function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);if(!seed){if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results;}
selector=selector.slice(tokens.shift().value.length);}
i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[(type=token.type)]){break;}
if((find=Expr.find[type])){if((seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&context.parentNode||context))){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results;}
break;}}}}}
compile(selector,match)(seed,context,!documentIsHTML,results,rsibling.test(selector));return results;}
support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1;});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#";})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2);}});}
if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")==="";})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue;}});}
if(!assert(function(div){return div.getAttribute("disabled")==null;})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return(val=elem.getAttributeNode(name))&&val.specified?val.value:elem[name]===true?name.toLowerCase():null;}});}
jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;})(window);var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.match(core_rnotwhite)||[],function(_,flag){object[flag]=true;});return object;}
jQuery.Callbacks=function(options){options=typeof options==="string"?(optionsCache[options]||createOptions(options)):jQuery.extend({},options);var
firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;fired=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=true;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;break;}}
firing=false;if(list){if(stack){if(stack.length){fire(stack.shift());}}else if(memory){list=[];}else{self.disable();}}},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg);}}else if(arg&&arg.length&&type!=="string"){add(arg);}});})(arguments);if(firing){firingLength=list.length;}else if(memory){firingStart=start;fire(memory);}}
return this;},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--;}
if(index<=firingIndex){firingIndex--;}}}});}
return this;},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length);},empty:function(){list=[];firingLength=0;return this;},disable:function(){list=stack=memory=undefined;return this;},disabled:function(){return!list;},lock:function(){stack=undefined;if(!memory){self.disable();}
return this;},locked:function(){return!stack;},fireWith:function(context,args){if(list&&(!fired||stack)){args=args||[];args=[context,args.slice?args.slice():args];if(firing){stack.push(args);}else{fire(args);}}
return this;},fire:function(){self.fireWith(this,arguments);return this;},fired:function(){return!!fired;}};return self;};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state;},always:function(){deferred.done(arguments).fail(arguments);return this;},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var action=tuple[0],fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify);}else{newDefer[action+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments);}});});fns=null;}).promise();},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise;}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString;},tuples[i^1][2].disable,tuples[2][2].lock);}
deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);return this;};deferred[tuple[0]+"With"]=list.fireWith;});promise.promise(deferred);if(func){func.call(deferred,deferred);}
return deferred;},when:function(subordinate){var i=0,resolveValues=core_slice.call(arguments),length=resolveValues.length,remaining=length!==1||(subordinate&&jQuery.isFunction(subordinate.promise))?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?core_slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values);}else if(!(--remaining)){deferred.resolveWith(contexts,values);}};},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues));}else{--remaining;}}}
if(!remaining){deferred.resolveWith(resolveContexts,resolveValues);}
return deferred.promise();}});jQuery.support=(function(support){var all,a,input,select,fragment,opt,eventName,isSupported,i,div=document.createElement("div");div.setAttribute("className","t");div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";all=div.getElementsByTagName("*")||[];a=div.getElementsByTagName("a")[0];if(!a||!a.style||!all.length){return support;}
select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];a.style.cssText="top:1px;float:left;opacity:.5";support.getSetAttribute=div.className!=="t";support.leadingWhitespace=div.firstChild.nodeType===3;support.tbody=!div.getElementsByTagName("tbody").length;support.htmlSerialize=!!div.getElementsByTagName("link").length;support.style=/top/.test(a.getAttribute("style"));support.hrefNormalized=a.getAttribute("href")==="/a";support.opacity=/^0.5/.test(a.style.opacity);support.cssFloat=!!a.style.cssFloat;support.checkOn=!!input.value;support.optSelected=opt.selected;support.enctype=!!document.createElement("form").enctype;support.html5Clone=document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>";support.inlineBlockNeedsLayout=false;support.shrinkWrapBlocks=false;support.pixelPosition=false;support.deleteExpando=true;support.noCloneEvent=true;support.reliableMarginRight=tru e;support.boxSizingReliable=true;input.checked=true;support.noCloneChecked=input.cloneNode(true).checked;select.disabled=true;support.optDisabled=!opt.disabled;try{delete div.test;}catch(e){support.deleteExpando=false;}
input=document.createElement("input");input.setAttribute("value","");support.input=input.getAttribute("value")==="";input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";input.setAttribute("checked","t");input.setAttribute("name","t");fragment=document.createDocumentFragment();fragment.appendChild(input);support.appendChecked=input.checked;support.checkClone=fragment.cloneNode(true).cloneNode(true).lastChild.checked;if(div.attachEvent){div.attachEvent("onclick",function(){support.noCloneEvent=false;});div.cloneNode(true).click();}
for(i in{submit:true,change:true,focusin:true}){div.setAttribute(eventName="on"+i,"t");support[i+"Bubbles"]=eventName in window||div.attributes[eventName].expando===false;}
div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";for(i in jQuery(support)){break;}
support.ownLast=i!=="0";jQuery(function(){var container,marginDiv,tds,divReset="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",body=document.getElementsByTagName("body")[0];if(!body){return;}
container=document.createElement("div");container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";body.appendChild(container).appendChild(div);div.innerHTML="<table><tr><td></td><td>t</td></tr></table>";tds=div.getElementsByTagName("td");tds[0].style.cssText="padding:0;margin:0;border:0;display:none";isSupported=(tds[0].offsetHeight===0);tds[0].style.display="";tds[1].style.display="none";support.reliableHiddenOffsets=isSupported&&(tds[0].offsetHeight===0);div.innerHTML="";div.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";jQuery.swap(body,body.style.zoom!=null?{zoom:1}:{},function(){support.boxSizing=div.offsetWidth===4;});if(window.getComputedStyle){support.pixelPosition=(window.getComputedStyle(div,null)||{}).top!=="1%";support.boxSizingReliable=(wi ndow.getComputedStyle(div,null)||{width:"4px"}).width==="4px";marginDiv=div.appendChild(document.createElement("div"));marginDiv.style.cssText=div.style.cssText=divReset;marginDiv.style.marginRight=marginDiv.style.width="0";div.style.width="1px";support.reliableMarginRight=!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight);}
if(typeof div.style.zoom!==core_strundefined){div.innerHTML="";div.style.cssText=divReset+"width:1px;padding:1px;display:inline;zoom:1";support.inlineBlockNeedsLayout=(div.offsetWidth===3);div.style.display="block";div.innerHTML="<div></div>";div.firstChild.style.width="5px";support.shrinkWrapBlocks=(div.offsetWidth!==3);if(support.inlineBlockNeedsLayout){body.style.zoom=1;}}
body.removeChild(container);container=div=tds=marginDiv=null;});all=select=fragment=opt=a=input=null;return support;})({});var rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rmultiDash=/([A-Z])/g;function internalData(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return;}
var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if((!id||!cache[id]||(!pvt&&!cache[id].data))&&data===undefined&&typeof name==="string"){return;}
if(!id){if(isNode){id=elem[internalKey]=core_deletedIds.pop()||jQuery.guid++;}else{id=internalKey;}}
if(!cache[id]){cache[id]=isNode?{}:{toJSON:jQuery.noop};}
if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id]=jQuery.extend(cache[id],name);}else{cache[id].data=jQuery.extend(cache[id].data,name);}}
thisCache=cache[id];if(!pvt){if(!thisCache.data){thisCache.data={};}
thisCache=thisCache.data;}
if(data!==undefined){thisCache[jQuery.camelCase(name)]=data;}
if(typeof name==="string"){ret=thisCache[name];if(ret==null){ret=thisCache[jQuery.camelCase(name)];}}else{ret=thisCache;}
return ret;}
function internalRemoveData(elem,name,pvt){if(!jQuery.acceptData(elem)){return;}
var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(!cache[id]){return;}
if(name){thisCache=pvt?cache[id]:cache[id].data;if(thisCache){if(!jQuery.isArray(name)){if(name in thisCache){name=[name];}else{name=jQuery.camelCase(name);if(name in thisCache){name=[name];}else{name=name.split(" ");}}}else{name=name.concat(jQuery.map(name,jQuery.camelCase));}
i=name.length;while(i--){delete thisCache[name[i]];}
if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache)){return;}}}
if(!pvt){delete cache[id].data;if(!isEmptyDataObject(cache[id])){return;}}
if(isNode){jQuery.cleanData([elem],true);}else if(jQuery.support.deleteExpando||cache!=cache.window){delete cache[id];}else{cache[id]=null;}}
jQuery.extend({cache:{},noData:{"applet":true,"embed":true,"object":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return!!elem&&!isEmptyDataObject(elem);},data:function(elem,name,data){return internalData(elem,name,data);},removeData:function(elem,name){return internalRemoveData(elem,name);},_data:function(elem,name,data){return internalData(elem,name,data,true);},_removeData:function(elem,name){return internalRemoveData(elem,name,true);},acceptData:function(elem){if(elem.nodeType&&elem.nodeType!==1&&elem.nodeType!==9){return false;}
var noData=elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()];return!noData||noData!==true&&elem.getAttribute("classid")===noData;}});jQuery.fn.extend({data:function(key,value){var attrs,name,data=null,i=0,elem=this[0];if(key===undefined){if(this.length){data=jQuery.data(elem);if(elem.nodeType===1&&!jQuery._data(elem,"parsedAttrs")){attrs=elem.attributes;for(;i<attrs.length;i++){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name]);}}
jQuery._data(elem,"parsedAttrs",true);}}
return data;}
if(typeof key==="object"){return this.each(function(){jQuery.data(this,key);});}
return arguments.length>1?this.each(function(){jQuery.data(this,key,value);}):elem?dataAttr(elem,key,jQuery.data(elem,key)):null;},removeData:function(key){return this.each(function(){jQuery.removeData(this,key);});}});function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data;}catch(e){}
jQuery.data(elem,key,data);}else{data=undefined;}}
return data;}
function isEmptyDataObject(obj){var name;for(name in obj){if(name==="data"&&jQuery.isEmptyObject(obj[name])){continue;}
if(name!=="toJSON"){return false;}}
return true;}
jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=jQuery._data(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=jQuery._data(elem,type,jQuery.makeArray(data));}else{queue.push(data);}}
return queue||[];}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type);};if(fn==="inprogress"){fn=queue.shift();startLength--;}
if(fn){if(type==="fx"){queue.unshift("inprogress");}
delete hooks.stop;fn.call(elem,next,hooks);}
if(!startLength&&hooks){hooks.empty.fire();}},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue");jQuery._removeData(elem,key);})});}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--;}
if(arguments.length<setter){return jQuery.queue(this[0],type);}
return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type);}});},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type);});},delay:function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout);};});},clearQueue:function(type){return this.queue(type||"fx",[]);},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!(--count)){defer.resolveWith(elements,[elements]);}};if(typeof type!=="string"){obj=type;type=undefined;}
type=type||"fx";while(i--){tmp=jQuery._data(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve);}}
resolve();return defer.promise(obj);}});var nodeHook,boolHook,rclass=/[\t\r\n\f]/g,rreturn=/\r/g,rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=jQuery.support.getSetAttribute,getSetInput=jQuery.support.input;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,jQuery.attr,name,value,arguments.length>1);},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name);});},prop:function(name,value){return jQuery.access(this,jQuery.prop,name,value,arguments.length>1);},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name];}catch(e){}});},addClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed=typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className));});}
if(proceed){classes=(value||"").match(core_rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");if(cur){j=0;while((clazz=classes[j++])){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" ";}}
elem.className=jQuery.trim(cur);}}}
return this;},removeClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed=arguments.length===0||typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className));});}
if(proceed){classes=(value||"").match(core_rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");if(cur){j=0;while((clazz=classes[j++])){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ");}}
elem.className=value?jQuery.trim(cur):"";}}}
return this;},toggleClass:function(value,stateVal){var type=typeof value;if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value);}
if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal);});}
return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(core_rnotwhite)||[];while((className=classNames[i++])){if(self.hasClass(className)){self.removeClass(className);}else{self.addClass(className);}}}else if(type===core_strundefined||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className);}
this.className=this.className||value===false?"":jQuery._data(this,"__className__")||"";}});},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return true;}}
return false;},val:function(value){var ret,hooks,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret;}
ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret;}
return;}
isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return;}
if(isFunction){val=value.call(this,i,jQuery(this).val());}else{val=value;}
if(val==null){val="";}else if(typeof val==="number"){val+="";}else if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+"";});}
hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val;}});}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:elem.text;}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(jQuery.support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value;}
values.push(value);}}
return values;},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if((option.selected=jQuery.inArray(jQuery(option).val(),values)>=0)){optionSet=true;}}
if(!optionSet){elem.selectedIndex=-1;}
return values;}}},attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return;}
if(typeof elem.getAttribute===core_strundefined){return jQuery.prop(elem,name,value);}
if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook);}
if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);}else if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret;}else{elem.setAttribute(name,value+"");return value;}}else if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret;}else{ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret;}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(core_rnotwhite);if(attrNames&&elem.nodeType===1){while((name=attrNames[i++])){propName=jQuery.propFix[name]||name;if(jQuery.expr.match.bool.test(name)){if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem[propName]=false;}else{elem[jQuery.camelCase("default-"+name)]=elem[propName]=false;}}else{jQuery.attr(elem,name,"");}
elem.removeAttribute(getSetAttribute?name:propName);}}},attrHooks:{type:{set:function(elem,value){if(!jQuery.support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val;}
return value;}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return;}
notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name];}
if(value!==undefined){return hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem[name]=value);}else{return hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name];}},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1;}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name);}else if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name);}else{elem[jQuery.camelCase("default-"+name)]=elem[name]=true;}
return name;}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=jQuery.expr.attrHandle[name]||jQuery.find.attr;jQuery.expr.attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var fn=jQuery.expr.attrHandle[name],ret=isXML?undefined:(jQuery.expr.attrHandle[name]=undefined)!=getter(elem,name,isXML)?name.toLowerCase():null;jQuery.expr.attrHandle[name]=fn;return ret;}:function(elem,name,isXML){return isXML?undefined:elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null;};});if(!getSetInput||!getSetAttribute){jQuery.attrHooks.value={set:function(elem,value,name){if(jQuery.nodeName(elem,"input")){elem.defaultValue=value;}else{return nodeHook&&nodeHook.set(elem,value,name);}}};}
if(!getSetAttribute){nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){elem.setAttributeNode((ret=elem.ownerDocument.createAttribute(name)));}
ret.value=value+="";return name==="value"||value===elem.getAttribute(name)?value:undefined;}};jQuery.expr.attrHandle.id=jQuery.expr.attrHandle.name=jQuery.expr.attrHandle.coords=function(elem,name,isXML){var ret;return isXML?undefined:(ret=elem.getAttributeNode(name))&&ret.value!==""?ret.value:null;};jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);return ret&&ret.specified?ret.value:undefined;},set:nodeHook.set};jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,value===""?false:value,name);}};jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value;}}};});}
if(!jQuery.support.hrefNormalized){jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4);}};});}
if(!jQuery.support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined;},set:function(elem,value){return(elem.style.cssText=value+"");}};}
if(!jQuery.support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex;}}
return null;}};}
jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this;});if(!jQuery.support.enctype){jQuery.propFix.enctype="encoding";}
jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0);}}};if(!jQuery.support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value;};}});var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return true;}
function returnFalse(){return false;}
function safeActiveElement(){try{return document.activeElement;}catch(err){}}
jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(!elemData){return;}
if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector;}
if(!handler.guid){handler.guid=jQuery.guid++;}
if(!(events=elemData.events)){events=elemData.events={};}
if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!==core_strundefined&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined;};eventHandle.elem=elem;}
types=(types||"").match(core_rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue;}
special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false);}else if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle);}}}
if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid;}}
if(selector){handlers.splice(handlers.delegateCount++,0,handleObj);}else{handlers.push(handleObj);}
jQuery.event.global[type]=true;}
elem=null;},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(!elemData||!(events=elemData.events)){return;}
types=(types||"").match(core_rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true);}
continue;}
special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--;}
if(special.remove){special.remove.call(elem,handleObj);}}}
if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle);}
delete events[type];}}
if(jQuery.isEmptyObject(events)){delete elemData.handle;jQuery._removeData(elem,"events");}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=core_hasOwn.call(event,"type")?event.type:event,namespaces=core_hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return;}
if(rfocusMorph.test(type+jQuery.event.triggered)){return;}
if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort();}
ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem;}
data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return;}
if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode;}
for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur;}
if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window);}}
i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");if(handle){handle.apply(cur,data);}
handle=ontype&&cur[ontype];if(handle&&jQuery.acceptData(cur)&&handle.apply&&handle.apply(cur,data)===false){event.preventDefault();}}
event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&jQuery.acceptData(elem)){if(ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null;}
jQuery.event.triggered=type;try{elem[type]();}catch(e){}
jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp;}}}}
return event.result;},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=core_slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return;}
handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation();}}}}}
if(special.postDispatch){special.postDispatch.call(this,event);}
return event.result;},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;cur!=this;cur=cur.parentNode||this){if(cur.nodeType===1&&(cur.disabled!==true||event.type!=="click")){matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length;}
if(matches[sel]){matches.push(handleObj);}}
if(matches.length){handlerQueue.push({elem:cur,handlers:matches});}}}}
if(delegateCount<handlers.length){handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)});}
return handlerQueue;},fix:function(event){if(event[jQuery.expando]){return event;}
var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{};}
copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop];}
if(!event.target){event.target=originalEvent.srcElement||document;}
if(event.target.nodeType===3){event.target=event.target.parentNode;}
event.metaKey=!!event.metaKey;return fixHook.filter?fixHook.filter(event,originalEvent):event;},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode;}
return event;}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);}
if(!event.relatedTarget&&fromElement){event.relatedTarget=fromElement===event.target?original.toElement:fromElement;}
if(!event.which&&button!==undefined){event.which=(button&1?1:(button&2?3:(button&4?2:0)));}
return event;}},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){try{this.focus();return false;}catch(e){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return false;}},delegateType:"focusout"},click:{trigger:function(){if(jQuery.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return false;}},_default:function(event){return jQuery.nodeName(event.target,"a");}},beforeunload:{postDispatch:function(event){if(event.result!==undefined){event.originalEvent.returnValue=event.result;}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem);}else{jQuery.event.dispatch.call(elem,e);}
if(e.isDefaultPrevented()){event.preventDefault();}}};jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false);}}:function(elem,type,handle){var name="on"+type;if(elem.detachEvent){if(typeof elem[name]===core_strundefined){elem[name]=null;}
elem.detachEvent(name,handle);}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props);}
if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=(src.defaultPrevented||src.returnValue===false||src.getPreventDefault&&src.getPreventDefault())?returnTrue:returnFalse;}else{this.type=src;}
if(props){jQuery.extend(this,props);}
this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true;};jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(!e){return;}
if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(!e){return;}
if(e.stopPropagation){e.stopPropagation();}
e.cancelBubble=true;},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation();}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||(related!==target&&!jQuery.contains(target,related))){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix;}
return ret;}};});if(!jQuery.support.submitBubbles){jQuery.event.special.submit={setup:function(){if(jQuery.nodeName(this,"form")){return false;}
jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;if(form&&!jQuery._data(form,"submitBubbles")){jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=true;});jQuery._data(form,"submitBubbles",true);}});},postDispatch:function(event){if(event._submit_bubble){delete event._submit_bubble;if(this.parentNode&&!event.isTrigger){jQuery.event.simulate("submit",this.parentNode,event,true);}}},teardown:function(){if(jQuery.nodeName(this,"form")){return false;}
jQuery.event.remove(this,"._submit");}};}
if(!jQuery.support.changeBubbles){jQuery.event.special.change={setup:function(){if(rformElems.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){jQuery.event.add(this,"propertychange._change",function(event){if(event.originalEvent.propertyName==="checked"){this._just_changed=true;}});jQuery.event.add(this,"click._change",function(event){if(this._just_changed&&!event.isTrigger){this._just_changed=false;}
jQuery.event.simulate("change",this,event,true);});}
return false;}
jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;if(rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")){jQuery.event.add(elem,"change._change",function(event){if(this.parentNode&&!event.isSimulated&&!event.isTrigger){jQuery.event.simulate("change",this.parentNode,event,true);}});jQuery._data(elem,"changeBubbles",true);}});},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||(elem.type!=="radio"&&elem.type!=="checkbox")){return event.handleObj.handler.apply(this,arguments);}},teardown:function(){jQuery.event.remove(this,"._change");return!rformElems.test(this.nodeName);}};}
if(!jQuery.support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0,handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true);};jQuery.event.special[fix]={setup:function(){if(attaches++===0){document.addEventListener(orig,handler,true);}},teardown:function(){if(--attaches===0){document.removeEventListener(orig,handler,true);}}};});}
jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined;}
for(type in types){this.on(type,selector,data,types[type],one);}
return this;}
if(data==null&&fn==null){fn=selector;data=selector=undefined;}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined;}else{fn=data;data=selector;selector=undefined;}}
if(fn===false){fn=returnFalse;}else if(!fn){return this;}
if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments);};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++);}
return this.each(function(){jQuery.event.add(this,types,fn,data,selector);});},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1);},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this;}
if(typeof types==="object"){for(type in types){this.off(type,selector,types[type]);}
return this;}
if(selector===false||typeof selector==="function"){fn=selector;selector=undefined;}
if(fn===false){fn=returnFalse;}
return this.each(function(){jQuery.event.remove(this,types,fn,selector);});},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this);});},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true);}}});var isSimple=/^.[^:#\[\.,]*$/,rparentsprev=/^(?:parents|prev(?:Until|All))/,rneedsContext=jQuery.expr.match.needsContext,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true;}}}));}
for(i=0;i<len;i++){jQuery.find(selector,self[i],ret);}
ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret;},has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;i<len;i++){if(jQuery.contains(this,targets[i])){return true;}}});},not:function(selector){return this.pushStack(winnow(this,selector||[],true));},filter:function(selector){return this.pushStack(winnow(this,selector||[],false));},is:function(selector){return!!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length;},closest:function(selectors,context){var cur,i=0,l=this.length,ret=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){cur=ret.push(cur);break;}}}
return this.pushStack(ret.length>1?jQuery.unique(ret):ret);},index:function(elem){if(!elem){return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1;}
if(typeof elem==="string"){return jQuery.inArray(this[0],jQuery(elem));}
return jQuery.inArray(elem.jquery?elem[0]:elem,this);},add:function(selector,context){var set=typeof selector==="string"?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(jQuery.unique(all));},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));}});function sibling(cur,dir){do{cur=cur[dir];}while(cur&&cur.nodeType!==1);return cur;}
jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null;},parents:function(elem){return jQuery.dir(elem,"parentNode");},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until);},next:function(elem){return sibling(elem,"nextSibling");},prev:function(elem){return sibling(elem,"previousSibling");},nextAll:function(elem){return jQuery.dir(elem,"nextSibling");},prevAll:function(elem){return jQuery.dir(elem,"previousSibling");},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until);},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until);},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem);},children:function(elem){return jQuery.sibling(elem.firstChild);},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes);}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until;}
if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret);}
if(this.length>1){if(!guaranteedUnique[name]){ret=jQuery.unique(ret);}
if(rparentsprev.test(name)){ret=ret.reverse();}}
return this.pushStack(ret);};});jQuery.extend({filter:function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")";}
return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1;}));},dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur);}
cur=cur[dir];}
return matched;},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n);}}
return r;}});function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not;});}
if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return(elem===qualifier)!==not;});}
if(typeof qualifier==="string"){if(isSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not);}
qualifier=jQuery.filter(qualifier,elements);}
return jQuery.grep(elements,function(elem){return(jQuery.inArray(elem,qualifier)>=0)!==not;});}
function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop());}}
return safeFrag;}
var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,manipulation_rcheckableType=/^(?:checkbox|radio)$/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;jQuery.fn.extend({text:function(value){return jQuery.access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value));},null,value,arguments.length);},append:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem);}});},prepend:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild);}});},before:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this);}});},after:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling);}});},remove:function(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;for(;(elem=elems[i])!=null;i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem));}
if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"));}
elem.parentNode.removeChild(elem);}}
return this;},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));}
while(elem.firstChild){elem.removeChild(elem.firstChild);}
if(elem.options&&jQuery.nodeName(elem,"select")){elem.options.length=0;}}
return this;},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents);});},html:function(value){return jQuery.access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined){return elem.nodeType===1?elem.innerHTML.replace(rinlinejQuery,""):undefined;}
if(typeof value==="string"&&!rnoInnerhtml.test(value)&&(jQuery.support.htmlSerialize||!rnoshimcache.test(value))&&(jQuery.support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value;}}
elem=0;}catch(e){}}
if(elem){this.empty().append(value);}},null,value,arguments.length);},replaceWith:function(){var
args=jQuery.map(this,function(elem){return[elem.nextSibling,elem.parentNode];}),i=0;this.domManip(arguments,function(elem){var next=args[i++],parent=args[i++];if(parent){if(next&&next.parentNode!==parent){next=this.nextSibling;}
jQuery(this).remove();parent.insertBefore(elem,next);}},true);return i?this:this.remove();},detach:function(selector){return this.remove(selector,true);},domManip:function(args,callback,allowIntersection){args=core_concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||!(l<=1||typeof value!=="string"||jQuery.support.checkClone||!rchecked.test(value))){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0]=value.call(this,index,self.html());}
self.domManip(args,callback,allowIntersection);});}
if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,!allowIntersection&&this);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first;}
if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"));}}
callback.call(this[i],node,i);}
if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){jQuery._evalUrl(node.src);}else{jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,""));}}}}
fragment=first=null;}}
return this;}});function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType===1?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem;}
function disableScript(elem){elem.type=(jQuery.find.attr(elem,"type")!==null)+"/"+elem.type;return elem;}
function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type=match[1];}else{elem.removeAttribute("type");}
return elem;}
function setGlobalEval(elems,refElements){var elem,i=0;for(;(elem=elems[i])!=null;i++){jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"));}}
function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return;}
var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle;curData.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i]);}}}
if(curData.data){curData.data=jQuery.extend({},curData.data);}}
function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(dest.nodeType!==1){return;}
nodeName=dest.nodeName.toLowerCase();if(!jQuery.support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events){jQuery.removeEvent(dest,e,data.handle);}
dest.removeAttribute(jQuery.expando);}
if(nodeName==="script"&&dest.text!==src.text){disableScript(dest).text=src.text;restoreScript(dest);}else if(nodeName==="object"){if(dest.parentNode){dest.outerHTML=src.outerHTML;}
if(jQuery.support.html5Clone&&(src.innerHTML&&!jQuery.trim(dest.innerHTML))){dest.innerHTML=src.innerHTML;}}else if(nodeName==="input"&&manipulation_rcheckableType.test(src.type)){dest.defaultChecked=dest.checked=src.checked;if(dest.value!==src.value){dest.value=src.value;}}else if(nodeName==="option"){dest.defaultSelected=dest.selected=src.defaultSelected;}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue;}}
jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);core_push.apply(ret,elems.get());}
return this.pushStack(ret);};});function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==core_strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==core_strundefined?context.querySelectorAll(tag||"*"):undefined;if(!found){for(found=[],elems=context.childNodes||context;(elem=elems[i])!=null;i++){if(!tag||jQuery.nodeName(elem,tag)){found.push(elem);}else{jQuery.merge(found,getAll(elem,tag));}}}
return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found;}
function fixDefaultChecked(elem){if(manipulation_rcheckableType.test(elem.type)){elem.defaultChecked=elem.checked;}}
jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(jQuery.support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")){clone=elem.cloneNode(true);}else{fragmentDiv.innerHTML=elem.outerHTML;fragmentDiv.removeChild(clone=fragmentDiv.firstChild);}
if((!jQuery.support.noCloneEvent||!jQuery.support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0;(node=srcElements[i])!=null;++i){if(destElements[i]){fixCloneNodeIssues(node,destElements[i]);}}}
if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0;(node=srcElements[i])!=null;i++){cloneCopyEvent(node,destElements[i]);}}else{cloneCopyEvent(elem,clone);}}
destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"));}
destElements=srcElements=node=null;return clone;},buildFragment:function(elems,context,scripts,selection){var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem);}else if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem));}else{tmp=tmp||safe.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild;}
if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)){nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0]));}
if(!jQuery.support.tbody){elem=tag==="table"&&!rtbody.test(elem)?tmp.firstChild:wrap[1]==="<table>"&&!rtbody.test(elem)?tmp:0;j=elem&&elem.childNodes.length;while(j--){if(jQuery.nodeName((tbody=elem.childNodes[j]),"tbody")&&!tbody.childNodes.length){elem.removeChild(tbody);}}}
jQuery.merge(nodes,tmp.childNodes);tmp.textContent="";while(tmp.firstChild){tmp.removeChild(tmp.firstChild);}
tmp=safe.lastChild;}}}
if(tmp){safe.removeChild(tmp);}
if(!jQuery.support.appendChecked){jQuery.grep(getAll(nodes,"input"),fixDefaultChecked);}
i=0;while((elem=nodes[i++])){if(selection&&jQuery.inArray(elem,selection)!==-1){continue;}
contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(safe.appendChild(elem),"script");if(contains){setGlobalEval(tmp);}
if(scripts){j=0;while((elem=tmp[j++])){if(rscriptType.test(elem.type||"")){scripts.push(elem);}}}}
tmp=null;return safe;},cleanData:function(elems,acceptData){var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=jQuery.support.deleteExpando,special=jQuery.event.special;for(;(elem=elems[i])!=null;i++){if(acceptData||jQuery.acceptData(elem)){id=elem[internalKey];data=id&&cache[id];if(data){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type);}else{jQuery.removeEvent(elem,type,data.handle);}}}
if(cache[id]){delete cache[id];if(deleteExpando){delete elem[internalKey];}else if(typeof elem.removeAttribute!==core_strundefined){elem.removeAttribute(internalKey);}else{elem[internalKey]=null;}
core_deletedIds.push(id);}}}}},_evalUrl:function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,global:false,"throws":true});}});jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i));});}
if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0]);}
wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild;}
return elem;}).append(this);}
return this;},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i));});}
return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html);}else{self.append(html);}});},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html);});},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes);}}).end();}});var iframe,getStyles,curCSS,ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rposition=/^(top|right|bottom|left)$/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rmargin=/^margin/,rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rrelNum=new RegExp("^([+-])=("+core_pnum+")","i"),elemdisplay={BODY:"block"},cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssExpand=["Top","Right","Bottom","Left"],cssPrefixes=["Webkit","O","Moz","ms"];function vendorPropName(style,name){if(name in style){return name;}
var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name;}}
return origName;}
function isHidden(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem);}
function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue;}
values[index]=jQuery._data(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&display==="none"){elem.style.display="";}
if(elem.style.display===""&&isHidden(elem)){values[index]=jQuery._data(elem,"olddisplay",css_defaultDisplay(elem.nodeName));}}else{if(!values[index]){hidden=isHidden(elem);if(display&&display!=="none"||!hidden){jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"));}}}}
for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue;}
if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none";}}
return elements;}
jQuery.fn.extend({css:function(name,value){return jQuery.access(this,function(elem,name,value){var len,styles,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles);}
return map;}
return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name);},name,value,arguments.length>1);},show:function(){return showHide(this,true);},hide:function(){return showHide(this);},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide();}
return this.each(function(){if(isHidden(this)){jQuery(this).show();}else{jQuery(this).hide();}});}});jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret;}}}},cssNumber:{"columnCount":true,"fillOpacity":true,"fontWeight":true,"lineHeight":true,"opacity":true,"order":true,"orphans":true,"widows":true,"zIndex":true,"zoom":true},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return;}
var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number";}
if(value==null||type==="number"&&isNaN(value)){return;}
if(type==="number"&&!jQuery.cssNumber[origName]){value+="px";}
if(!jQuery.support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit";}
if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){try{style[name]=value;}catch(e){}}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret;}
return style[name];}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get"in hooks){val=hooks.get(elem,true,extra);}
if(val===undefined){val=curCSS(elem,name,styles);}
if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name];}
if(extra===""||extra){num=parseFloat(val);return extra===true||jQuery.isNumeric(num)?num||0:val;}
return val;}});if(window.getComputedStyle){getStyles=function(elem){return window.getComputedStyle(elem,null);};curCSS=function(elem,name,_computed){var width,minWidth,maxWidth,computed=_computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:undefined,style=elem.style;if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name);}
if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth;}}
return ret;};}else if(document.documentElement.currentStyle){getStyles=function(elem){return elem.currentStyle;};curCSS=function(elem,name,_computed){var left,rs,rsLeft,computed=_computed||getStyles(elem),ret=computed?computed[name]:undefined,style=elem.style;if(ret==null&&style&&style[name]){ret=style[name];}
if(rnumnonpx.test(ret)&&!rposition.test(name)){left=style.left;rs=elem.runtimeStyle;rsLeft=rs&&rs.left;if(rsLeft){rs.left=elem.currentStyle.left;}
style.left=name==="fontSize"?"1em":ret;ret=style.pixelLeft+"px";style.left=left;if(rsLeft){rs.left=rsLeft;}}
return ret===""?"auto":ret;};}
function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value;}
function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true,styles);}
if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles);}
if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}}}
return val;}
function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box";if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null){val=elem.style[name];}
if(rnumnonpx.test(val)){return val;}
valueIsBorderBox=isBorderBox&&(jQuery.support.boxSizingReliable||val===elem.style[name]);val=parseFloat(val)||0;}
return(val+
augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles))+"px";}
function css_defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(doc.documentElement);doc=(iframe[0].contentWindow||iframe[0].contentDocument).document;doc.write("<!doctype html><html><body>");doc.close();display=actualDisplay(nodeName,doc);iframe.detach();}
elemdisplay[nodeName]=display;}
return display;}
function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=jQuery.css(elem[0],"display");elem.remove();return display;}
jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){return elem.offsetWidth===0&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra);}):getWidthOrHeight(elem,name,extra);}},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles):0);}};});if(!jQuery.support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":computed?"1":"";},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1;if((value>=1||value==="")&&jQuery.trim(filter.replace(ralpha,""))===""&&style.removeAttribute){style.removeAttribute("filter");if(value===""||currentStyle&&!currentStyle.filter){return;}}
style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity;}};}
jQuery(function(){if(!jQuery.support.reliableMarginRight){jQuery.cssHooks.marginRight={get:function(elem,computed){if(computed){return jQuery.swap(elem,{"display":"inline-block"},curCSS,[elem,"marginRight"]);}}};}
if(!jQuery.support.pixelPosition&&jQuery.fn.position){jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]={get:function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed;}}};});}});if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||(!jQuery.support.reliableHiddenOffsets&&((elem.style&&elem.style.display)||jQuery.css(elem,"display"))==="none");};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem);};}
jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];}
return expanded;}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber;}});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray());},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this;}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!manipulation_rcheckableType.test(type));}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")};}):{name:elem.name,value:val.replace(rCRLF,"\r\n")};}).get();}});jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():(value==null?"":value);s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value);};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional;}
if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value);});}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add);}}
return s.join("&").replace(r20,"+");};function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v);}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add);}});}else if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add);}}else{add(prefix,obj);}}
jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name);};});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver);},bind:function(types,data,fn){return this.on(types,null,data,fn);},unbind:function(types,fn){return this.off(types,null,fn);},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn);},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn);}});var
ajaxLocParts,ajaxLocation,ajax_nonce=jQuery.now(),ajax_rquery=/\?/,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_load=jQuery.fn.load,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href;}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href;}
ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*";}
var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(core_rnotwhite)||[];if(jQuery.isFunction(func)){while((dataType=dataTypes[i++])){if(dataType[0]==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func);}else{(structure[dataType]=structure[dataType]||[]).push(func);}}}};}
function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=(structure===transports);function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false;}else if(seekingTransport){return!(selected=dataTypeOrTransport);}});return selected;}
return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*");}
function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:(deep||(deep={})))[key]=src[key];}}
if(deep){jQuery.extend(true,target,deep);}
return target;}
jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments);}
var selector,response,type,self=this,off=url.indexOf(" ");if(off>=0){selector=url.slice(off,url.length);url=url.slice(0,off);}
if(jQuery.isFunction(params)){callback=params;params=undefined;}else if(params&&typeof params==="object"){type="POST";}
if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText);}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR]);});}
return this;};jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn);};});jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target);},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined;}
options=options||{};var
parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()]=match[2];}}
match=responseHeaders[key.toLowerCase()];}
return match==null?null:match;},getAllResponseHeaders:function(){return state===2?responseHeadersString:null;},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value;}
return this;},overrideMimeType:function(type){if(!state){s.mimeType=type;}
return this;},statusCode:function(map){var code;if(map){if(state<2){for(code in map){statusCode[code]=[statusCode[code],map[code]];}}else{jqXHR.always(map[jqXHR.status]);}}
return this;},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText);}
done(0,finalText);return this;}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(core_rnotwhite)||[""];if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))));}
if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional);}
inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR;}
fireGlobals=s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart");}
s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=(s.url+=(ajax_rquery.test(cacheURL)?"&":"?")+s.data);delete s.data;}
if(s.cache===false){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+ajax_nonce++):cacheURL+(ajax_rquery.test(cacheURL)?"&":"?")+"_="+ajax_nonce++;}}
if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]);}
if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL]);}}
if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType);}
jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i]);}
if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort();}
strAbort="abort";for(i in{success:1,error:1,complete:1}){jqXHR[i](s[i]);}
transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport");}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s]);}
if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout");},s.timeout);}
try{state=1;transport.send(requestHeaders,done);}catch(e){if(state<2){done(-1,e);}else{throw e;}}}
function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return;}
state=2;if(timeoutTimer){clearTimeout(timeoutTimer);}
transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses);}
response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified;}
modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified;}}
if(status===204||s.type==="HEAD"){statusText="nocontent";}else if(status===304){statusText="notmodified";}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error;}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0;}}}
jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR]);}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);}
jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]);}
completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop");}}}
return jqXHR;},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json");},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script");}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined;}
return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback});};});function ajaxHandleResponses(s,jqXHR,responses){var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type");}}
if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break;}}}
if(dataTypes[0]in responses){finalDataType=dataTypes[0];}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break;}
if(!firstDataType){firstDataType=type;}}
finalDataType=finalDataType||firstDataType;}
if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType);}
return responses[finalDataType];}}
function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv];}}
current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response;}
if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType);}
prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev;}else if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2];}else if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1]);}
break;}}}}
if(conv!==true){if(conv&&s["throws"]){response=conv(response);}else{try{response=conv(response);}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current};}}}}}}
return{state:"success",data:response};}
jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){jQuery.globalEval(text);return text;}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false;}
if(s.crossDomain){s.type="GET";s.global=false;}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async=true;if(s.scriptCharset){script.charset=s.scriptCharset;}
script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(script.parentNode){script.parentNode.removeChild(script);}
script=null;if(!isAbort){callback(200,"success");}}};head.insertBefore(script,head.firstChild);},abort:function(){if(script){script.onload(undefined,true);}}};}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||(jQuery.expando+"_"+(ajax_nonce++));this[callback]=true;return callback;}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName);}else if(s.jsonp!==false){s.url+=(ajax_rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName;}
s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called");}
return responseContainer[0];};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments;};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName);}
if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0]);}
responseContainer=overwritten=undefined;});return"script";}});var xhrCallbacks,xhrSupported,xhrId=0,xhrOnUnloadAbort=window.ActiveXObject&&function(){var key;for(key in xhrCallbacks){xhrCallbacks[key](undefined,true);}};function createStandardXHR(){try{return new window.XMLHttpRequest();}catch(e){}}
function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP");}catch(e){}}
jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return!this.isLocal&&createStandardXHR()||createActiveXHR();}:createStandardXHR;xhrSupported=jQuery.ajaxSettings.xhr();jQuery.support.cors=!!xhrSupported&&("withCredentials"in xhrSupported);xhrSupported=jQuery.support.ajax=!!xhrSupported;if(xhrSupported){jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var handle,i,xhr=s.xhr();if(s.username){xhr.open(s.type,s.url,s.async,s.username,s.password);}else{xhr.open(s.type,s.url,s.async);}
if(s.xhrFields){for(i in s.xhrFields){xhr[i]=s.xhrFields[i];}}
if(s.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(s.mimeType);}
if(!s.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest";}
try{for(i in headers){xhr.setRequestHeader(i,headers[i]);}}catch(err){}
xhr.send((s.hasContent&&s.data)||null);callback=function(_,isAbort){var status,responseHeaders,statusText,responses;try{if(callback&&(isAbort||xhr.readyState===4)){callback=undefined;if(handle){xhr.onreadystatechange=jQuery.noop;if(xhrOnUnloadAbort){delete xhrCallbacks[handle];}}
if(isAbort){if(xhr.readyState!==4){xhr.abort();}}else{responses={};status=xhr.status;responseHeaders=xhr.getAllResponseHeaders();if(typeof xhr.responseText==="string"){responses.text=xhr.responseText;}
try{statusText=xhr.statusText;}catch(e){statusText="";}
if(!status&&s.isLocal&&!s.crossDomain){status=responses.text?200:404;}else if(status===1223){status=204;}}}}catch(firefoxAccessException){if(!isAbort){complete(-1,firefoxAccessException);}}
if(responses){complete(status,statusText,responses,responseHeaders);}};if(!s.async){callback();}else if(xhr.readyState===4){setTimeout(callback);}else{handle=++xhrId;if(xhrOnUnloadAbort){if(!xhrCallbacks){xhrCallbacks={};jQuery(window).unload(xhrOnUnloadAbort);}
xhrCallbacks[handle]=callback;}
xhr.onreadystatechange=callback;}},abort:function(){if(callback){callback(undefined,true);}}};}});}
var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+core_pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3];parts=parts||[];start=+target||1;do{scale=scale||".5";start=start / scale;jQuery.style(tween.elem,prop,start+unit);}while(scale!==(scale=tween.cur()/ target)&&scale!==1&&--maxIterations);}
if(parts){start=tween.start=+start||+target||0;tween.unit=unit;tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2];}
return tween;}]};function createFxNow(){setTimeout(function(){fxNow=undefined;});return(fxNow=jQuery.now());}
function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if((tween=collection[index].call(animation,prop,value))){return tween;}}}
function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem;}),tick=function(){if(stopped){return false;}
var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining / animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent);}
deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining;}else{deferred.resolveWith(elem,[animation]);return false;}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween;},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this;}
stopped=true;for(;index<length;index++){animation.tweens[index].run(1);}
if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd]);}else{deferred.rejectWith(elem,[animation,gotoEnd]);}
return this;}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result;}}
jQuery.map(props,createTween,animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation);}
jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always);}
function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0];}
if(index!==name){props[name]=value;delete props[index];}
hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing;}}}else{specialEasing[name]=easing;}}}
jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"];}else{props=props.split(" ");}
var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback);}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback);}else{animationPrefilters.push(callback);}}});function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire();}};}
hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire();}});});}
if(elem.nodeType===1&&("height"in props||"width"in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];if(jQuery.css(elem,"display")==="inline"&&jQuery.css(elem,"float")==="none"){if(!jQuery.support.inlineBlockNeedsLayout||css_defaultDisplay(elem.nodeName)==="inline"){style.display="inline-block";}else{style.zoom=1;}}}
if(opts.overflow){style.overflow="hidden";if(!jQuery.support.shrinkWrapBlocks){anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2];});}}
for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){continue;}
orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop);}}
if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden"in dataShow){hidden=dataShow.hidden;}}else{dataShow=jQuery._data(elem,"fxshow",{});}
if(toggle){dataShow.hidden=!hidden;}
if(hidden){jQuery(elem).show();}else{anim.done(function(){jQuery(elem).hide();});}
anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop]);}});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0;}}}}}
function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing);}
jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px");},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this);},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration);}else{this.pos=eased=percent;}
this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this);}
if(hooks&&hooks.set){hooks.set(this);}else{Tween.propHooks._default.set(this);}
return this;}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop];}
result=jQuery.css(tween.elem,tween.prop,"");return!result||result==="auto"?0:result;},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween);}else if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit);}else{tween.elem[tween.prop]=tween.now;}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now;}}};jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback);};});jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback);},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||jQuery._data(this,"finish")){anim.stop(true);}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation);},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd);};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined;}
if(clearQueue&&type!==false){this.queue(type||"fx",[]);}
return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index]);}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index]);}}}
for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1);}}
if(dequeue||!gotoEnd){jQuery.dequeue(this,type);}});},finish:function(type){if(type!==false){type=type||"fx";}
return this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true);}
for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1);}}
for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this);}}
delete data.finish;});}});function genFx(type,includeWidth){var which,attrs={height:type},i=0;includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type;}
if(includeWidth){attrs.opacity=attrs.width=type;}
return attrs;}
jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback);};});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx";}
opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this);}
if(opt.queue){jQuery.dequeue(this,opt.queue);}};return opt;};jQuery.easing={linear:function(p){return p;},swing:function(p){return 0.5-Math.cos(p*Math.PI)/ 2;}};jQuery.timers=[];jQuery.fx=Tween.prototype.init;jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1);}}
if(!timers.length){jQuery.fx.stop();}
fxNow=undefined;};jQuery.fx.timer=function(timer){if(timer()&&jQuery.timers.push(timer)){jQuery.fx.start();}};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval);}};jQuery.fx.stop=function(){clearInterval(timerId);timerId=null;};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fx.step={};if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem;}).length;};}
jQuery.fn.offset=function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i);});}
var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(!doc){return;}
docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return box;}
if(typeof elem.getBoundingClientRect!==core_strundefined){box=elem.getBoundingClientRect();}
win=getWindow(doc);return{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)};};jQuery.offset={setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");if(position==="static"){elem.style.position="relative";}
var curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={},curTop,curLeft;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left;}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0;}
if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset);}
if(options.top!=null){props.top=(options.top-curOffset.top)+curTop;}
if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft;}
if("using"in options){options.using.call(elem,props);}else{curElem.css(props);}}};jQuery.fn.extend({position:function(){if(!this[0]){return;}
var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect();}else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset();}
parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true);}
return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)};},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||docElem;while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent;}
return offsetParent||docElem;});}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return jQuery.access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?(prop in win)?win[prop]:win.document.documentElement[method]:elem[method];}
if(win){win.scrollTo(!top?val:jQuery(win).scrollLeft(),top?val:jQuery(win).scrollTop());}else{elem[method]=val;}},method,val,arguments.length,null);};});function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false;}
jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return jQuery.access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name];}
if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name]);}
return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra);},type,chainable?margin:undefined,chainable,null);};});});jQuery.fn.size=function(){return this.length;};jQuery.fn.andSelf=jQuery.fn.addBack;if(typeof module==="object"&&module&&typeof module.exports==="object"){module.exports=jQuery;}else{window.jQuery=window.$=jQuery;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery;});}}})(window);(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var
push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var
nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj;};if(typeof exports!=='undefined'){if(typeof module!=='undefined'&&module.exports){exports=module.exports=_;}
exports._=_;}else{root._=_;}
_.VERSION='1.5.2';var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context);}else if(obj.length===+obj.length){for(var i=0,length=obj.length;i<length;i++){if(iterator.call(context,obj[i],i,obj)===breaker)return;}}else{var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){if(iterator.call(context,obj[keys[i]],keys[i],obj)===breaker)return;}}};_.map=_.collect=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list));});return results;};var reduceError='Reduce of empty array with no initial value';_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduce&&obj.reduce===nativeReduce){if(context)iterator=_.bind(iterator,context);return initial?obj.reduce(iterator,memo):obj.reduce(iterator);}
each(obj,function(value,index,list){if(!initial){memo=value;initial=true;}else{memo=iterator.call(context,memo,value,index,list);}});if(!initial)throw new TypeError(reduceError);return memo;};_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context)iterator=_.bind(iterator,context);return initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);}
var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length;}
each(obj,function(value,index,list){index=keys?keys[--length]:--length;if(!initial){memo=obj[index];initial=true;}else{memo=iterator.call(context,memo,obj[index],index,list);}});if(!initial)throw new TypeError(reduceError);return memo;};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true;}});return result;};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeFilter&&obj.filter===nativeFilter)return obj.filter(iterator,context);each(obj,function(value,index,list){if(iterator.call(context,value,index,list))results.push(value);});return results;};_.reject=function(obj,iterator,context){return _.filter(obj,function(value,index,list){return!iterator.call(context,value,index,list);},context);};_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=true;if(obj==null)return result;if(nativeEvery&&obj.every===nativeEvery)return obj.every(iterator,context);each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker;});return!!result;};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=false;if(obj==null)return result;if(nativeSome&&obj.some===nativeSome)return obj.some(iterator,context);each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker;});return!!result;};_.contains=_.include=function(obj,target){if(obj==null)return false;if(nativeIndexOf&&obj.indexOf===nativeIndexOf)return obj.indexOf(target)!=-1;return any(obj,function(value){return value===target;});};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args);});};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key];});};_.where=function(obj,attrs,first){if(_.isEmpty(attrs))return first?void 0:[];return _[first?'find':'filter'](obj,function(value){for(var key in attrs){if(attrs[key]!==value[key])return false;}
return true;});};_.findWhere=function(obj,attrs){return _.where(obj,attrs,true);};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.max.apply(Math,obj);}
if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity,value:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>result.computed&&(result={value:value,computed:computed});});return result.value;};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.min.apply(Math,obj);}
if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity,value:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed});});return result.value;};_.shuffle=function(obj){var rand;var index=0;var shuffled=[];each(obj,function(value){rand=_.random(index++);shuffled[index-1]=shuffled[rand];shuffled[rand]=value;});return shuffled;};_.sample=function(obj,n,guard){if(arguments.length<2||guard){return obj[_.random(obj.length-1)];}
return _.shuffle(obj).slice(0,Math.max(0,n));};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value];};};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)};}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1;}
return left.index-right.index;}),'value');};var group=function(behavior){return function(obj,value,context){var result={};var iterator=value==null?_.identity:lookupIterator(value);each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value);});return result;};};_.groupBy=group(function(result,key,value){(_.has(result,key)?result[key]:(result[key]=[])).push(value);});_.indexBy=group(function(result,key,value){result[key]=value;});_.countBy=group(function(result,key){_.has(result,key)?result[key]++:result[key]=1;});_.sortedIndex=function(array,obj,iterator,context){iterator=iterator==null?_.identity:lookupIterator(iterator);var value=iterator.call(context,obj);var low=0,high=array.length;while(low<high){var mid=(low+high)>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid;}
return low;};_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(obj.length===+obj.length)return _.map(obj,_.identity);return _.values(obj);};_.size=function(obj){if(obj==null)return 0;return(obj.length===+obj.length)?obj.length:_.keys(obj).length;};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;return(n==null)||guard?array[0]:slice.call(array,0,n);};_.initial=function(array,n,guard){return slice.call(array,0,array.length-((n==null)||guard?1:n));};_.last=function(array,n,guard){if(array==null)return void 0;if((n==null)||guard){return array[array.length-1];}else{return slice.call(array,Math.max(array.length-n,0));}};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,(n==null)||guard?1:n);};_.compact=function(array){return _.filter(array,_.identity);};var flatten=function(input,shallow,output){if(shallow&&_.every(input,_.isArray)){return concat.apply(output,input);}
each(input,function(value){if(_.isArray(value)||_.isArguments(value)){shallow?push.apply(output,value):flatten(value,shallow,output);}else{output.push(value);}});return output;};_.flatten=function(array,shallow){return flatten(array,shallow,[]);};_.without=function(array){return _.difference(array,slice.call(arguments,1));};_.uniq=_.unique=function(array,isSorted,iterator,context){if(_.isFunction(isSorted)){context=iterator;iterator=isSorted;isSorted=false;}
var initial=iterator?_.map(array,iterator,context):array;var results=[];var seen=[];each(initial,function(value,index){if(isSorted?(!index||seen[seen.length-1]!==value):!_.contains(seen,value)){seen.push(value);results.push(array[index]);}});return results;};_.union=function(){return _.uniq(_.flatten(arguments,true));};_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0;});});};_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value);});};_.zip=function(){var length=_.max(_.pluck(arguments,"length").concat(0));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(arguments,''+i);}
return results;};_.object=function(list,values){if(list==null)return{};var result={};for(var i=0,length=list.length;i<length;i++){if(values){result[list[i]]=values[i];}else{result[list[i][0]]=list[i][1];}}
return result;};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i=0,length=array.length;if(isSorted){if(typeof isSorted=='number'){i=(isSorted<0?Math.max(0,length+isSorted):isSorted);}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1;}}
if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;i<length;i++)if(array[i]===item)return i;return-1;};_.lastIndexOf=function(array,item,from){if(array==null)return-1;var hasIndex=from!=null;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item);}
var i=(hasIndex?from:array.length);while(i--)if(array[i]===item)return i;return-1;};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0;}
step=arguments[2]||1;var length=Math.max(Math.ceil((stop-start)/ step),0);var idx=0;var range=new Array(length);while(idx<length){range[idx++]=start;start+=step;}
return range;};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;args=slice.call(arguments,2);return bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result)return result;return self;};};_.partial=function(func){var args=slice.call(arguments,1);return function(){return func.apply(this,args.concat(slice.call(arguments)));};};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length===0)throw new Error("bindAll must be passed function names");each(funcs,function(f){obj[f]=_.bind(obj[f],obj);});return obj;};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:(memo[key]=func.apply(this,arguments));};};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args);},wait);};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)));};_.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;options||(options={});var later=function(){previous=options.leading===false?0:new Date;timeout=null;result=func.apply(context,args);};return function(){var now=new Date;if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args);}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining);}
return result;};};_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;return function(){context=this;args=arguments;timestamp=new Date();var later=function(){var last=(new Date())-timestamp;if(last<wait){timeout=setTimeout(later,wait-last);}else{timeout=null;if(!immediate)result=func.apply(context,args);}};var callNow=immediate&&!timeout;if(!timeout){timeout=setTimeout(later,wait);}
if(callNow)result=func.apply(context,args);return result;};};_.once=function(func){var ran=false,memo;return function(){if(ran)return memo;ran=true;memo=func.apply(this,arguments);func=null;return memo;};};_.wrap=function(func,wrapper){return function(){var args=[func];push.apply(args,arguments);return wrapper.apply(this,args);};};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)];}
return args[0];};};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments);}};};_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError('Invalid object');var keys=[];for(var key in obj)if(_.has(obj,key))keys.push(key);return keys;};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=new Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]];}
return values;};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=new Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]];}
return pairs;};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i];}
return result;};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key);}
return names.sort();};_.extend=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){obj[prop]=source[prop];}}});return obj;};_.pick=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));each(keys,function(key){if(key in obj)copy[key]=obj[key];});return copy;};_.omit=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj){if(!_.contains(keys,key))copy[key]=obj[key];}
return copy;};_.defaults=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){if(obj[prop]===void 0)obj[prop]=source[prop];}}});return obj;};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj);};_.tap=function(obj,interceptor){interceptor(obj);return obj;};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1 / a==1 / b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!=toString.call(b))return false;switch(className){case'[object String]':return a==String(b);case'[object Number]':return a!=+a?b!=+b:(a==0?1 / a==1 / b:a==+b);case'[object Date]':case'[object Boolean]':return+a==+b;case'[object RegExp]':return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase;}
if(typeof a!='object'||typeof b!='object')return false;var length=aStack.length;while(length--){if(aStack[length]==a)return bStack[length]==b;}
var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&(aCtor instanceof aCtor)&&_.isFunction(bCtor)&&(bCtor instanceof bCtor))){return false;}
aStack.push(a);bStack.push(b);var size=0,result=true;if(className=='[object Array]'){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack)))break;}}}else{for(var key in a){if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))break;}}
if(result){for(key in b){if(_.has(b,key)&&!(size--))break;}
result=!size;}}
aStack.pop();bStack.pop();return result;};_.isEqual=function(a,b){return eq(a,b,[],[]);};_.isEmpty=function(obj){if(obj==null)return true;if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return false;return true;};_.isElement=function(obj){return!!(obj&&obj.nodeType===1);};_.isArray=nativeIsArray||function(obj){return toString.call(obj)=='[object Array]';};_.isObject=function(obj){return obj===Object(obj);};each(['Arguments','Function','String','Number','Date','RegExp'],function(name){_['is'+name]=function(obj){return toString.call(obj)=='[object '+name+']';};});if(!_.isArguments(arguments)){_.isArguments=function(obj){return!!(obj&&_.has(obj,'callee'));};}
if(typeof(/./)!=='function'){_.isFunction=function(obj){return typeof obj==='function';};}
_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj));};_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj;};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)=='[object Boolean]';};_.isNull=function(obj){return obj===null;};_.isUndefined=function(obj){return obj===void 0;};_.has=function(obj,key){return hasOwnProperty.call(obj,key);};_.noConflict=function(){root._=previousUnderscore;return this;};_.identity=function(value){return value;};_.times=function(n,iterator,context){var accum=Array(Math.max(0,n));for(var i=0;i<n;i++)accum[i]=iterator.call(context,i);return accum;};_.random=function(min,max){if(max==null){max=min;min=0;}
return min+Math.floor(Math.random()*(max-min+1));};var entityMap={escape:{'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#x27;'}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp('['+_.keys(entityMap.escape).join('')+']','g'),unescape:new RegExp('('+_.keys(entityMap.unescape).join('|')+')','g')};_.each(['escape','unescape'],function(method){_[method]=function(string){if(string==null)return'';return(''+string).replace(entityRegexes[method],function(match){return entityMap[method][match];});};});_.result=function(object,property){if(object==null)return void 0;var value=object[property];return _.isFunction(value)?value.call(object):value;};_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args));};});};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+'';return prefix?prefix+id:id;};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'",'\\':'\\','\r':'r','\n':'n','\t':'t','\u2028':'u2028','\u2029':'u2029'};var escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join('|')+'|$','g');var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,function(match){return'\\'+escapes[match];});if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'";}
if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'";}
if(evaluate){source+="';\n"+evaluate+"\n__p+='";}
index=offset+match.length;return match;});source+="';\n";if(!settings.variable)source='with(obj||{}){\n'+source+'}\n';source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+
source+"return __p;\n";try{render=new Function(settings.variable||'obj','_',source);}catch(e){e.source=source;throw e;}
if(data)return render(data,_);var template=function(data){return render.call(this,data,_);};template.source='function('+(settings.variable||'obj')+'){\n'+source+'}';return template;};_.chain=function(obj){return _(obj).chain();};var result=function(obj){return this._chain?_(obj).chain():obj;};_.mixin(_);each(['pop','push','reverse','shift','sort','splice','unshift'],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name=='shift'||name=='splice')&&obj.length===0)delete obj[0];return result.call(this,obj);};});each(['concat','join','slice'],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments));};});_.extend(_.prototype,{chain:function(){this._chain=true;return this;},value:function(){return this._wrapped;}});}).call(this);define("underscore",(function(global){return function(){var ret,fn;return ret||global._;};}(this)));(function(root,factory){if(typeof define==='function'&&define.amd){define('backbone',['underscore','jquery','exports'],function(_,$,exports){root.Backbone=factory(root,exports,_,$);});}else if(typeof exports!=='undefined'){var _=require('underscore');factory(root,exports,_);}else{root.Backbone=factory(root,{},root._,(root.jQuery||root.Zepto||root.ender||root.$));}}(this,function(root,Backbone,_,$){var previousBackbone=root.Backbone;var array=[];var push=array.push;var slice=array.slice;var splice=array.splice;Backbone.VERSION='1.1.2';Backbone.$=$;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this;};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,'on',name,[callback,context])||!callback)return this;this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);events.push({callback:callback,context:context,ctx:context||this});return this;},once:function(name,callback,context){if(!eventsApi(this,'once',name,[callback,context])||!callback)return this;var self=this;var once=_.once(function(){self.off(name,once);callback.apply(this,arguments);});once._callback=callback;return this.on(name,once,context);},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,'off',name,[callback,context]))return this;if(!name&&!callback&&!context){this._events=void 0;return this;}
names=name?[name]:_.keys(this._events);for(i=0,l=names.length;i<l;i++){name=names[i];if(events=this._events[name]){this._events[name]=retain=[];if(callback||context){for(j=0,k=events.length;j<k;j++){ev=events[j];if((callback&&callback!==ev.callback&&callback!==ev.callback._callback)||(context&&context!==ev.context)){retain.push(ev);}}}
if(!retain.length)delete this._events[name];}}
return this;},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1);if(!eventsApi(this,'trigger',name,args))return this;var events=this._events[name];var allEvents=this._events.all;if(events)triggerEvents(events,args);if(allEvents)triggerEvents(allEvents,arguments);return this;},stopListening:function(obj,name,callback){var listeningTo=this._listeningTo;if(!listeningTo)return this;var remove=!name&&!callback;if(!callback&&typeof name==='object')callback=this;if(obj)(listeningTo={})[obj._listenId]=obj;for(var id in listeningTo){obj=listeningTo[id];obj.off(name,callback,this);if(remove||_.isEmpty(obj._events))delete this._listeningTo[id];}
return this;}};var eventSplitter=/\s+/;var eventsApi=function(obj,action,name,rest){if(!name)return true;if(typeof name==='object'){for(var key in name){obj[action].apply(obj,[key,name[key]].concat(rest));}
return false;}
if(eventSplitter.test(name)){var names=name.split(eventSplitter);for(var i=0,l=names.length;i<l;i++){obj[action].apply(obj,[names[i]].concat(rest));}
return false;}
return true;};var triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:while(++i<l)(ev=events[i]).callback.call(ev.ctx);return;case 1:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:while(++i<l)(ev=events[i]).callback.apply(ev.ctx,args);return;}};var listenMethods={listenTo:'on',listenToOnce:'once'};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeningTo=this._listeningTo||(this._listeningTo={});var id=obj._listenId||(obj._listenId=_.uniqueId('l'));listeningTo[id]=obj;if(!callback&&typeof name==='object')callback=this;obj[implementation](name,callback,this);return this;};});Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var attrs=attributes||{};options||(options={});this.cid=_.uniqueId('c');this.attributes={};if(options.collection)this.collection=options.collection;if(options.parse)attrs=this.parse(attrs,options)||{};attrs=_.defaults({},attrs,_.result(this,'defaults'));this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments);};_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:'id',initialize:function(){},toJSON:function(options){return _.clone(this.attributes);},sync:function(){return Backbone.sync.apply(this,arguments);},get:function(attr){return this.attributes[attr];},escape:function(attr){return _.escape(this.get(attr));},has:function(attr){return this.get(attr)!=null;},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(key==null)return this;if(typeof key==='object'){attrs=key;options=val;}else{(attrs={})[key]=val;}
options||(options={});if(!this._validate(attrs,options))return false;unset=options.unset;silent=options.silent;changes=[];changing=this._changing;this._changing=true;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={};}
current=this.attributes,prev=this._previousAttributes;if(this.idAttribute in attrs)this.id=attrs[this.idAttribute];for(attr in attrs){val=attrs[attr];if(!_.isEqual(current[attr],val))changes.push(attr);if(!_.isEqual(prev[attr],val)){this.changed[attr]=val;}else{delete this.changed[attr];}
unset?delete current[attr]:current[attr]=val;}
if(!silent){if(changes.length)this._pending=options;for(var i=0,l=changes.length;i<l;i++){this.trigger('change:'+changes[i],this,current[changes[i]],options);}}
if(changing)return this;if(!silent){while(this._pending){options=this._pending;this._pending=false;this.trigger('change',this,options);}}
this._pending=false;this._changing=false;return this;},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:true}));},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:true}));},hasChanged:function(attr){if(attr==null)return!_.isEmpty(this.changed);return _.has(this.changed,attr);},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):false;var val,changed=false;var old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff){if(_.isEqual(old[attr],(val=diff[attr])))continue;(changed||(changed={}))[attr]=val;}
return changed;},previous:function(attr){if(attr==null||!this._previousAttributes)return null;return this._previousAttributes[attr];},previousAttributes:function(){return _.clone(this._previousAttributes);},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var model=this;var success=options.success;options.success=function(resp){if(!model.set(model.parse(resp,options),options))return false;if(success)success(model,resp,options);model.trigger('sync',model,resp,options);};wrapError(this,options);return this.sync('read',this,options);},save:function(key,val,options){var attrs,method,xhr,attributes=this.attributes;if(key==null||typeof key==='object'){attrs=key;options=val;}else{(attrs={})[key]=val;}
options=_.extend({validate:true},options);if(attrs&&!options.wait){if(!this.set(attrs,options))return false;}else{if(!this._validate(attrs,options))return false;}
if(attrs&&options.wait){this.attributes=_.extend({},attributes,attrs);}
if(options.parse===void 0)options.parse=true;var model=this;var success=options.success;options.success=function(resp){model.attributes=attributes;var serverAttrs=model.parse(resp,options);if(options.wait)serverAttrs=_.extend(attrs||{},serverAttrs);if(_.isObject(serverAttrs)&&!model.set(serverAttrs,options)){return false;}
if(success)success(model,resp,options);model.trigger('sync',model,resp,options);};wrapError(this,options);method=this.isNew()?'create':(options.patch?'patch':'update');if(method==='patch')options.attrs=attrs;xhr=this.sync(method,this,options);if(attrs&&options.wait)this.attributes=attributes;return xhr;},destroy:function(options){options=options?_.clone(options):{};var model=this;var success=options.success;var destroy=function(){model.trigger('destroy',model,model.collection,options);};options.success=function(resp){if(options.wait||model.isNew())destroy();if(success)success(model,resp,options);if(!model.isNew())model.trigger('sync',model,resp,options);};if(this.isNew()){options.success();return false;}
wrapError(this,options);var xhr=this.sync('delete',this,options);if(!options.wait)destroy();return xhr;},url:function(){var base=_.result(this,'urlRoot')||_.result(this.collection,'url')||urlError();if(this.isNew())return base;return base.replace(/([^\/])$/,'$1/')+encodeURIComponent(this.id);},parse:function(resp,options){return resp;},clone:function(){return new this.constructor(this.attributes);},isNew:function(){return!this.has(this.idAttribute);},isValid:function(options){return this._validate({},_.extend(options||{},{validate:true}));},_validate:function(attrs,options){if(!options.validate||!this.validate)return true;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error)return true;this.trigger('invalid',this,error,_.extend(options,{validationError:error}));return false;}});var modelMethods=['keys','values','pairs','invert','pick','omit'];_.each(modelMethods,function(method){Model.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.attributes);return _[method].apply(_,args);};});var Collection=Backbone.Collection=function(models,options){options||(options={});if(options.model)this.model=options.model;if(options.comparator!==void 0)this.comparator=options.comparator;this._reset();this.initialize.apply(this,arguments);if(models)this.reset(models,_.extend({silent:true},options));};var setOptions={add:true,remove:true,merge:true};var addOptions={add:true,remove:false};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options);});},sync:function(){return Backbone.sync.apply(this,arguments);},add:function(models,options){return this.set(models,_.extend({merge:false},options,addOptions));},remove:function(models,options){var singular=!_.isArray(models);models=singular?[models]:_.clone(models);options||(options={});var i,l,index,model;for(i=0,l=models.length;i<l;i++){model=models[i]=this.get(models[i]);if(!model)continue;delete this._byId[model.id];delete this._byId[model.cid];index=this.indexOf(model);this.models.splice(index,1);this.length--;if(!options.silent){options.index=index;model.trigger('remove',model,this,options);}
this._removeReference(model,options);}
return singular?models[0]:models;},set:function(models,options){options=_.defaults({},options,setOptions);if(options.parse)models=this.parse(models,options);var singular=!_.isArray(models);models=singular?(models?[models]:[]):_.clone(models);var i,l,id,model,attrs,existing,sort;var at=options.at;var targetModel=this.model;var sortable=this.comparator&&(at==null)&&options.sort!==false;var sortAttr=_.isString(this.comparator)?this.comparator:null;var toAdd=[],toRemove=[],modelMap={};var add=options.add,merge=options.merge,remove=options.remove;var order=!sortable&&add&&remove?[]:false;for(i=0,l=models.length;i<l;i++){attrs=models[i]||{};if(attrs instanceof Model){id=model=attrs;}else{id=attrs[targetModel.prototype.idAttribute||'id'];}
if(existing=this.get(id)){if(remove)modelMap[existing.cid]=true;if(merge){attrs=attrs===model?model.attributes:attrs;if(options.parse)attrs=existing.parse(attrs,options);existing.set(attrs,options);if(sortable&&!sort&&existing.hasChanged(sortAttr))sort=true;}
models[i]=existing;}else if(add){model=models[i]=this._prepareModel(attrs,options);if(!model)continue;toAdd.push(model);this._addReference(model,options);}
model=existing||model;if(order&&(model.isNew()||!modelMap[model.id]))order.push(model);modelMap[model.id]=true;}
if(remove){for(i=0,l=this.length;i<l;++i){if(!modelMap[(model=this.models[i]).cid])toRemove.push(model);}
if(toRemove.length)this.remove(toRemove,options);}
if(toAdd.length||(order&&order.length)){if(sortable)sort=true;this.length+=toAdd.length;if(at!=null){for(i=0,l=toAdd.length;i<l;i++){this.models.splice(at+i,0,toAdd[i]);}}else{if(order)this.models.length=0;var orderedModels=order||toAdd;for(i=0,l=orderedModels.length;i<l;i++){this.models.push(orderedModels[i]);}}}
if(sort)this.sort({silent:true});if(!options.silent){for(i=0,l=toAdd.length;i<l;i++){(model=toAdd[i]).trigger('add',model,this,options);}
if(sort||(order&&order.length))this.trigger('sort',this,options);}
return singular?models[0]:models;},reset:function(models,options){options||(options={});for(var i=0,l=this.models.length;i<l;i++){this._removeReference(this.models[i],options);}
options.previousModels=this.models;this._reset();models=this.add(models,_.extend({silent:true},options));if(!options.silent)this.trigger('reset',this,options);return models;},push:function(model,options){return this.add(model,_.extend({at:this.length},options));},pop:function(options){var model=this.at(this.length-1);this.remove(model,options);return model;},unshift:function(model,options){return this.add(model,_.extend({at:0},options));},shift:function(options){var model=this.at(0);this.remove(model,options);return model;},slice:function(){return slice.apply(this.models,arguments);},get:function(obj){if(obj==null)return void 0;return this._byId[obj]||this._byId[obj.id]||this._byId[obj.cid];},at:function(index){return this.models[index];},where:function(attrs,first){if(_.isEmpty(attrs))return first?void 0:[];return this[first?'find':'filter'](function(model){for(var key in attrs){if(attrs[key]!==model.get(key))return false;}
return true;});},findWhere:function(attrs){return this.where(attrs,true);},sort:function(options){if(!this.comparator)throw new Error('Cannot sort a set without a comparator');options||(options={});if(_.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this);}else{this.models.sort(_.bind(this.comparator,this));}
if(!options.silent)this.trigger('sort',this,options);return this;},pluck:function(attr){return _.invoke(this.models,'get',attr);},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var success=options.success;var collection=this;options.success=function(resp){var method=options.reset?'reset':'set';collection[method](resp,options);if(success)success(collection,resp,options);collection.trigger('sync',collection,resp,options);};wrapError(this,options);return this.sync('read',this,options);},create:function(model,options){options=options?_.clone(options):{};if(!(model=this._prepareModel(model,options)))return false;if(!options.wait)this.add(model,options);var collection=this;var success=options.success;options.success=function(model,resp){if(options.wait)collection.add(model,options);if(success)success(model,resp,options);};model.save(null,options);return model;},parse:function(resp,options){return resp;},clone:function(){return new this.constructor(this.models);},_reset:function(){this.length=0;this.models=[];this._byId={};},_prepareModel:function(attrs,options){if(attrs instanceof Model)return attrs;options=options?_.clone(options):{};options.collection=this;var model=new this.model(attrs,options);if(!model.validationError)return model;this.trigger('invalid',this,model.validationError,options);return false;},_addReference:function(model,options){this._byId[model.cid]=model;if(model.id!=null)this._byId[model.id]=model;if(!model.collection)model.collection=this;model.on('all',this._onModelEvent,this);},_removeReference:function(model,options){if(this===model.collection)delete model.collection;model.off('all',this._onModelEvent,this);},_onModelEvent:function(event,model,collection,options){if((event==='add'||event==='remove')&&collection!==this)return;if(event==='destroy')this.remove(model,options);if(model&&event==='change:'+model.idAttribute){delete this._byId[model.previous(model.idAttribute)];if(model.id!=null)this._byId[model.id]=model;}
this.trigger.apply(this,arguments);}});var methods=['forEach','each','map','collect','reduce','foldl','inject','reduceRight','foldr','find','detect','filter','select','reject','every','all','some','any','include','contains','invoke','max','min','toArray','size','first','head','take','initial','rest','tail','drop','last','without','difference','indexOf','shuffle','lastIndexOf','isEmpty','chain','sample'];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.models);return _[method].apply(_,args);};});var attributeMethods=['groupBy','countBy','sortBy','indexBy'];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value);};return _[method](this.models,iterator,context);};});var View=Backbone.View=function(options){this.cid=_.uniqueId('view');options||(options={});_.extend(this,_.pick(options,viewOptions));this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents();};var delegateEventSplitter=/^(\S+)\s*(.*)$/;var viewOptions=['model','collection','el','id','attributes','className','tagName','events'];_.extend(View.prototype,Events,{tagName:'div',$:function(selector){return this.$el.find(selector);},initialize:function(){},render:function(){return this;},remove:function(){this.$el.remove();this.stopListening();return this;},setElement:function(element,delegate){if(this.$el)this.undelegateEvents();this.$el=element instanceof Backbone.$?element:Backbone.$(element);this.el=this.$el[0];if(delegate!==false)this.delegateEvents();return this;},delegateEvents:function(events){if(!(events||(events=_.result(this,'events'))))return this;this.undelegateEvents();for(var key in events){var method=events[key];if(!_.isFunction(method))method=this[events[key]];if(!method)continue;var match=key.match(delegateEventSplitter);var eventName=match[1],selector=match[2];method=_.bind(method,this);eventName+='.delegateEvents'+this.cid;if(selector===''){this.$el.on(eventName,method);}else{this.$el.on(eventName,selector,method);}}
return this;},undelegateEvents:function(){this.$el.off('.delegateEvents'+this.cid);return this;},_ensureElement:function(){if(!this.el){var attrs=_.extend({},_.result(this,'attributes'));if(this.id)attrs.id=_.result(this,'id');if(this.className)attrs['class']=_.result(this,'className');var $el=Backbone.$('<'+_.result(this,'tagName')+'>').attr(attrs);this.setElement($el,false);}else{this.setElement(_.result(this,'el'),false);}}});Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:'json'};if(!options.url){params.url=_.result(model,'url')||urlError();}
if(options.data==null&&model&&(method==='create'||method==='update'||method==='patch')){params.contentType='application/json';params.data=JSON.stringify(options.attrs||model.toJSON(options));}
if(options.emulateJSON){params.contentType='application/x-www-form-urlencoded';params.data=params.data?{model:params.data}:{};}
if(options.emulateHTTP&&(type==='PUT'||type==='DELETE'||type==='PATCH')){params.type='POST';if(options.emulateJSON)params.data._method=type;var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader('X-HTTP-Method-Override',type);if(beforeSend)return beforeSend.apply(this,arguments);};}
if(params.type!=='GET'&&!options.emulateJSON){params.processData=false;}
if(params.type==='PATCH'&&noXhrPatch){params.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP");};}
var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger('request',model,xhr,options);return xhr;};var noXhrPatch=typeof window!=='undefined'&&!!window.ActiveXObject&&!(window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);var methodMap={'create':'POST','update':'PUT','patch':'PATCH','delete':'DELETE','read':'GET'};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments);};var Router=Backbone.Router=function(options){options||(options={});if(options.routes)this.routes=options.routes;this._bindRoutes();this.initialize.apply(this,arguments);};var optionalParam=/\((.*?)\)/g;var namedParam=/(\(\?)?:\w+/g;var splatParam=/\*\w+/g;var escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){if(!_.isRegExp(route))route=this._routeToRegExp(route);if(_.isFunction(name)){callback=name;name='';}
if(!callback)callback=this[name];var router=this;Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);router.execute(callback,args);router.trigger.apply(router,['route:'+name].concat(args));router.trigger('route',name,args);Backbone.history.trigger('route',router,name,args);});return this;},execute:function(callback,args){if(callback)callback.apply(this,args);},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this;},_bindRoutes:function(){if(!this.routes)return;this.routes=_.result(this,'routes');var route,routes=_.keys(this.routes);while((route=routes.pop())!=null){this.route(route,this.routes[route]);}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,'\\$&').replace(optionalParam,'(?:$1)?').replace(namedParam,function(match,optional){return optional?match:'([^/?]+)';}).replace(splatParam,'([^?]*?)');return new RegExp('^'+route+'(?:\\?([\\s\\S]*))?$');},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param,i){if(i===params.length-1)return param||null;return param?decodeURIComponent(param):null;});}});var History=Backbone.History=function(){this.handlers=[];_.bindAll(this,'checkUrl');if(typeof window!=='undefined'){this.location=window.location;this.history=window.history;}};var routeStripper=/^[#\/]|\s+$/g;var rootStripper=/^\/+|\/+$/g;var isExplorer=/msie [\w.]+/;var trailingSlash=/\/$/;var pathStripper=/#.*$/;History.started=false;_.extend(History.prototype,Events,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,'$&/')===this.root;},getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:'';},getFragment:function(fragment,forcePushState){if(fragment==null){if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=decodeURI(this.location.pathname+this.location.search);var root=this.root.replace(trailingSlash,'');if(!fragment.indexOf(root))fragment=fragment.slice(root.length);}else{fragment=this.getHash();}}
return fragment.replace(routeStripper,'');},start:function(options){if(History.started)throw new Error("Backbone.history has already been started");History.started=true;this.options=_.extend({root:'/'},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment();var docMode=document.documentMode;var oldIE=(isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7));this.root=('/'+this.root+'/').replace(rootStripper,'/');if(oldIE&&this._wantsHashChange){var frame=Backbone.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=frame.hide().appendTo('body')[0].contentWindow;this.navigate(fragment);}
if(this._hasPushState){Backbone.$(window).on('popstate',this.checkUrl);}else if(this._wantsHashChange&&('onhashchange'in window)&&!oldIE){Backbone.$(window).on('hashchange',this.checkUrl);}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval);}
this.fragment=fragment;var loc=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){this.fragment=this.getFragment(null,true);this.location.replace(this.root+'#'+this.fragment);return true;}else if(this._hasPushState&&this.atRoot()&&loc.hash){this.fragment=this.getHash().replace(routeStripper,'');this.history.replaceState({},document.title,this.root+this.fragment);}}
if(!this.options.silent)return this.loadUrl();},stop:function(){Backbone.$(window).off('popstate',this.checkUrl).off('hashchange',this.checkUrl);if(this._checkUrlInterval)clearInterval(this._checkUrlInterval);History.started=false;},route:function(route,callback){this.handlers.unshift({route:route,callback:callback});},checkUrl:function(e){var current=this.getFragment();if(current===this.fragment&&this.iframe){current=this.getFragment(this.getHash(this.iframe));}
if(current===this.fragment)return false;if(this.iframe)this.navigate(current);this.loadUrl();},loadUrl:function(fragment){fragment=this.fragment=this.getFragment(fragment);return _.any(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true;}});},navigate:function(fragment,options){if(!History.started)return false;if(!options||options===true)options={trigger:!!options};var url=this.root+(fragment=this.getFragment(fragment||''));fragment=fragment.replace(pathStripper,'');if(this.fragment===fragment)return;this.fragment=fragment;if(fragment===''&&url!=='/')url=url.slice(0,-1);if(this._hasPushState){this.history[options.replace?'replaceState':'pushState']({},document.title,url);}else if(this._wantsHashChange){this._updateHash(this.location,fragment,options.replace);if(this.iframe&&(fragment!==this.getFragment(this.getHash(this.iframe)))){if(!options.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,fragment,options.replace);}}else{return this.location.assign(url);}
if(options.trigger)return this.loadUrl(fragment);},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,'');location.replace(href+'#'+fragment);}else{location.hash='#'+fragment;}}});Backbone.history=new History;var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&_.has(protoProps,'constructor')){child=protoProps.constructor;}else{child=function(){return parent.apply(this,arguments);};}
_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child;};Surrogate.prototype=parent.prototype;child.prototype=new Surrogate;if(protoProps)_.extend(child.prototype,protoProps);child.__super__=parent.prototype;return child;};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified');};var wrapError=function(model,options){var error=options.error;options.error=function(resp){if(error)error(model,resp,options);model.trigger('error',model,resp,options);};};return Backbone;}));define('text',['module'],function(module){'use strict';var text,fs,Cc,Ci,xpcIsWindows,progIds=['Msxml2.XMLHTTP','Microsoft.XMLHTTP','Msxml2.XMLHTTP.4.0'],xmlRegExp=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,bodyRegExp=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,hasLocation=typeof location!=='undefined'&&location.href,defaultProtocol=hasLocation&&location.protocol&&location.protocol.replace(/\:/,''),defaultHostName=hasLocation&&location.hostname,defaultPort=hasLocation&&(location.port||undefined),buildMap={},masterConfig=(module.config&&module.config())||{};text={version:'2.0.14',strip:function(content){if(content){content=content.replace(xmlRegExp,"");var matches=content.match(bodyRegExp);if(matches){content=matches[1];}}else{content="";}
return content;},jsEscape:function(content){return content.replace(/(['\\])/g,'\\$1').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029");},createXhr:masterConfig.createXhr||function(){var xhr,i,progId;if(typeof XMLHttpRequest!=="undefined"){return new XMLHttpRequest();}else if(typeof ActiveXObject!=="undefined"){for(i=0;i<3;i+=1){progId=progIds[i];try{xhr=new ActiveXObject(progId);}catch(e){}
if(xhr){progIds=[progId];break;}}}
return xhr;},parseName:function(name){var modName,ext,temp,strip=false,index=name.lastIndexOf("."),isRelative=name.indexOf('./')===0||name.indexOf('../')===0;if(index!==-1&&(!isRelative||index>1)){modName=name.substring(0,index);ext=name.substring(index+1);}else{modName=name;}
temp=ext||modName;index=temp.indexOf("!");if(index!==-1){strip=temp.substring(index+1)==="strip";temp=temp.substring(0,index);if(ext){ext=temp;}else{modName=temp;}}
return{moduleName:modName,ext:ext,strip:strip};},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(url,protocol,hostname,port){var uProtocol,uHostName,uPort,match=text.xdRegExp.exec(url);if(!match){return true;}
uProtocol=match[2];uHostName=match[3];uHostName=uHostName.split(':');uPort=uHostName[1];uHostName=uHostName[0];return(!uProtocol||uProtocol===protocol)&&(!uHostName||uHostName.toLowerCase()===hostname.toLowerCase())&&((!uPort&&!uHostName)||uPort===port);},finishLoad:function(name,strip,content,onLoad){content=strip?text.strip(content):content;if(masterConfig.isBuild){buildMap[name]=content;}
onLoad(content);},load:function(name,req,onLoad,config){if(config&&config.isBuild&&!config.inlineText){onLoad();return;}
masterConfig.isBuild=config&&config.isBuild;var parsed=text.parseName(name),nonStripName=parsed.moduleName+
(parsed.ext?'.'+parsed.ext:''),url=req.toUrl(nonStripName),useXhr=(masterConfig.useXhr)||text.useXhr;if(url.indexOf('empty:')===0){onLoad();return;}
if(!hasLocation||useXhr(url,defaultProtocol,defaultHostName,defaultPort)){text.get(url,function(content){text.finishLoad(name,parsed.strip,content,onLoad);},function(err){if(onLoad.error){onLoad.error(err);}});}else{req([nonStripName],function(content){text.finishLoad(parsed.moduleName+'.'+parsed.ext,parsed.strip,content,onLoad);});}},write:function(pluginName,moduleName,write,config){if(buildMap.hasOwnProperty(moduleName)){var content=text.jsEscape(buildMap[moduleName]);write.asModule(pluginName+"!"+moduleName,"define(function () { return '"+
content+"';});\n");}},writeFile:function(pluginName,moduleName,req,write,config){var parsed=text.parseName(moduleName),extPart=parsed.ext?'.'+parsed.ext:'',nonStripName=parsed.moduleName+extPart,fileName=req.toUrl(parsed.moduleName+extPart)+'.js';text.load(nonStripName,req,function(value){var textWrite=function(contents){return write(fileName,contents);};textWrite.asModule=function(moduleName,contents){return write.asModule(moduleName,fileName,contents);};text.write(pluginName,nonStripName,textWrite,config);},config);}};if(masterConfig.env==='node'||(!masterConfig.env&&typeof process!=="undefined"&&process.versions&&!!process.versions.node&&!process.versions['node-webkit']&&!process.versions['atom-shell'])){fs=require.nodeRequire('fs');text.get=function(url,callback,errback){try{var file=fs.readFileSync(url,'utf8');if(file[0]==='\uFEFF'){file=file.substring(1);}
callback(file);}catch(e){if(errback){errback(e);}}};}else if(masterConfig.env==='xhr'||(!masterConfig.env&&text.createXhr())){text.get=function(url,callback,errback,headers){var xhr=text.createXhr(),header;xhr.open('GET',url,true);if(headers){for(header in headers){if(headers.hasOwnProperty(header)){xhr.setRequestHeader(header.toLowerCase(),headers[header]);}}}
if(masterConfig.onXhr){masterConfig.onXhr(xhr,url);}
xhr.onreadystatechange=function(evt){var status,err;if(xhr.readyState===4){status=xhr.status||0;if(status>399&&status<600){err=new Error(url+' HTTP status: '+status);err.xhr=xhr;if(errback){errback(err);}}else{callback(xhr.responseText);}
if(masterConfig.onXhrComplete){masterConfig.onXhrComplete(xhr,url);}}};xhr.send(null);};}else if(masterConfig.env==='rhino'||(!masterConfig.env&&typeof Packages!=='undefined'&&typeof java!=='undefined')){text.get=function(url,callback){var stringBuffer,line,encoding="utf-8",file=new java.io.File(url),lineSeparator=java.lang.System.getProperty("line.separator"),input=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file),encoding)),content='';try{stringBuffer=new java.lang.StringBuffer();line=input.readLine();if(line&&line.length()&&line.charAt(0)===0xfeff){line=line.substring(1);}
if(line!==null){stringBuffer.append(line);}
while((line=input.readLine())!==null){stringBuffer.append(lineSeparator);stringBuffer.append(line);}
content=String(stringBuffer.toString());}finally{input.close();}
callback(content);};}else if(masterConfig.env==='xpconnect'||(!masterConfig.env&&typeof Components!=='undefined'&&Components.classes&&Components.interfaces)){Cc=Components.classes;Ci=Components.interfaces;Components.utils['import']('resource://gre/modules/FileUtils.jsm');xpcIsWindows=('@mozilla.org/windows-registry-key;1'in Cc);text.get=function(url,callback){var inStream,convertStream,fileObj,readData={};if(xpcIsWindows){url=url.replace(/\//g,'\\');}
fileObj=new FileUtils.File(url);try{inStream=Cc['@mozilla.org/network/file-input-stream;1'].createInstance(Ci.nsIFileInputStream);inStream.init(fileObj,1,0,false);convertStream=Cc['@mozilla.org/intl/converter-input-stream;1'].createInstance(Ci.nsIConverterInputStream);convertStream.init(inStream,"utf-8",inStream.available(),Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER);convertStream.readString(inStream.available(),readData);convertStream.close();inStream.close();callback(readData.value);}catch(e){throw new Error((fileObj&&fileObj.path||'')+': '+e);}};}
return text;});define('aura/ext/debug',[],function(){'use strict';return{name:'debug',initialize:function(app){if(typeof window.attachDebugger==='function'){app.logger.log('Attaching debugger ...');window.attachDebugger(app);}}};});;!function(undefined){var isArray=Array.isArray?Array.isArray:function _isArray(obj){return Object.prototype.toString.call(obj)==="[object Array]";};var defaultMaxListeners=10;function init(){this._events={};if(this._conf){configure.call(this,this._conf);}}
function configure(conf){if(conf){this._conf=conf;conf.delimiter&&(this.delimiter=conf.delimiter);conf.maxListeners&&(this._events.maxListeners=conf.maxListeners);conf.wildcard&&(this.wildcard=conf.wildcard);conf.newListener&&(this.newListener=conf.newListener);if(this.wildcard){this.listenerTree={};}}}
function EventEmitter(conf){this._events={};this.newListener=false;configure.call(this,conf);}
function searchListenerTree(handlers,type,tree,i){if(!tree){return[];}
var listeners=[],leaf,len,branch,xTree,xxTree,isolatedBranch,endReached,typeLength=type.length,currentType=type[i],nextType=type[i+1];if(i===typeLength&&tree._listeners){if(typeof tree._listeners==='function'){handlers&&handlers.push(tree._listeners);return[tree];}else{for(leaf=0,len=tree._listeners.length;leaf<len;leaf++){handlers&&handlers.push(tree._listeners[leaf]);}
return[tree];}}
if((currentType==='*'||currentType==='**')||tree[currentType]){if(currentType==='*'){for(branch in tree){if(branch!=='_listeners'&&tree.hasOwnProperty(branch)){listeners=listeners.concat(searchListenerTree(handlers,type,tree[branch],i+1));}}
return listeners;}else if(currentType==='**'){endReached=(i+1===typeLength||(i+2===typeLength&&nextType==='*'));if(endReached&&tree._listeners){listeners=listeners.concat(searchListenerTree(handlers,type,tree,typeLength));}
for(branch in tree){if(branch!=='_listeners'&&tree.hasOwnProperty(branch)){if(branch==='*'||branch==='**'){if(tree[branch]._listeners&&!endReached){listeners=listeners.concat(searchListenerTree(handlers,type,tree[branch],typeLength));}
listeners=listeners.concat(searchListenerTree(handlers,type,tree[branch],i));}else if(branch===nextType){listeners=listeners.concat(searchListenerTree(handlers,type,tree[branch],i+2));}else{listeners=listeners.concat(searchListenerTree(handlers,type,tree[branch],i));}}}
return listeners;}
listeners=listeners.concat(searchListenerTree(handlers,type,tree[currentType],i+1));}
xTree=tree['*'];if(xTree){searchListenerTree(handlers,type,xTree,i+1);}
xxTree=tree['**'];if(xxTree){if(i<typeLength){if(xxTree._listeners){searchListenerTree(handlers,type,xxTree,typeLength);}
for(branch in xxTree){if(branch!=='_listeners'&&xxTree.hasOwnProperty(branch)){if(branch===nextType){searchListenerTree(handlers,type,xxTree[branch],i+2);}else if(branch===currentType){searchListenerTree(handlers,type,xxTree[branch],i+1);}else{isolatedBranch={};isolatedBranch[branch]=xxTree[branch];searchListenerTree(handlers,type,{'**':isolatedBranch},i+1);}}}}else if(xxTree._listeners){searchListenerTree(handlers,type,xxTree,typeLength);}else if(xxTree['*']&&xxTree['*']._listeners){searchListenerTree(handlers,type,xxTree['*'],typeLength);}}
return listeners;}
function growListenerTree(type,listener){type=typeof type==='string'?type.split(this.delimiter):type.slice();for(var i=0,len=type.length;i+1<len;i++){if(type[i]==='**'&&type[i+1]==='**'){return;}}
var tree=this.listenerTree;var name=type.shift();while(name){if(!tree[name]){tree[name]={};}
tree=tree[name];if(type.length===0){if(!tree._listeners){tree._listeners=listener;}
else if(typeof tree._listeners==='function'){tree._listeners=[tree._listeners,listener];}
else if(isArray(tree._listeners)){tree._listeners.push(listener);if(!tree._listeners.warned){var m=defaultMaxListeners;if(typeof this._events.maxListeners!=='undefined'){m=this._events.maxListeners;}
if(m>0&&tree._listeners.length>m){tree._listeners.warned=true;console.error('(node) warning: possible EventEmitter memory '+'leak detected. %d listeners added. '+'Use emitter.setMaxListeners() to increase limit.',tree._listeners.length);console.trace();}}}
return true;}
name=type.shift();}
return true;}
EventEmitter.prototype.delimiter='.';EventEmitter.prototype.setMaxListeners=function(n){this._events||init.call(this);this._events.maxListeners=n;if(!this._conf)this._conf={};this._conf.maxListeners=n;};EventEmitter.prototype.event='';EventEmitter.prototype.once=function(event,fn){this.many(event,1,fn);return this;};EventEmitter.prototype.many=function(event,ttl,fn){var self=this;if(typeof fn!=='function'){throw new Error('many only accepts instances of Function');}
function listener(){if(--ttl===0){self.off(event,listener);}
fn.apply(this,arguments);}
listener._origin=fn;this.on(event,listener);return self;};EventEmitter.prototype.emit=function(){this._events||init.call(this);var type=arguments[0];if(type==='newListener'&&!this.newListener){if(!this._events.newListener){return false;}}
if(this._all){var l=arguments.length;var args=new Array(l-1);for(var i=1;i<l;i++)args[i-1]=arguments[i];for(i=0,l=this._all.length;i<l;i++){this.event=type;this._all[i].apply(this,args);}}
if(type==='error'){if(!this._all&&!this._events.error&&!(this.wildcard&&this.listenerTree.error)){if(arguments[1]instanceof Error){throw arguments[1];}else{throw new Error("Uncaught, unspecified 'error' event.");}
return false;}}
var handler;if(this.wildcard){handler=[];var ns=typeof type==='string'?type.split(this.delimiter):type.slice();searchListenerTree.call(this,handler,ns,this.listenerTree,0);}
else{handler=this._events[type];}
if(typeof handler==='function'){this.event=type;if(arguments.length===1){handler.call(this);}
else if(arguments.length>1)
switch(arguments.length){case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:var l=arguments.length;var args=new Array(l-1);for(var i=1;i<l;i++)args[i-1]=arguments[i];handler.apply(this,args);}
return true;}
else if(handler){var l=arguments.length;var args=new Array(l-1);for(var i=1;i<l;i++)args[i-1]=arguments[i];var listeners=handler.slice();for(var i=0,l=listeners.length;i<l;i++){this.event=type;listeners[i].apply(this,args);}
return(listeners.length>0)||!!this._all;}
else{return!!this._all;}};EventEmitter.prototype.on=function(type,listener){if(typeof type==='function'){this.onAny(type);return this;}
if(typeof listener!=='function'){throw new Error('on only accepts instances of Function');}
this._events||init.call(this);this.emit('newListener',type,listener);if(this.wildcard){growListenerTree.call(this,type,listener);return this;}
if(!this._events[type]){this._events[type]=listener;}
else if(typeof this._events[type]==='function'){this._events[type]=[this._events[type],listener];}
else if(isArray(this._events[type])){this._events[type].push(listener);if(!this._events[type].warned){var m=defaultMaxListeners;if(typeof this._events.maxListeners!=='undefined'){m=this._events.maxListeners;}
if(m>0&&this._events[type].length>m){this._events[type].warned=true;console.error('(node) warning: possible EventEmitter memory '+'leak detected. %d listeners added. '+'Use emitter.setMaxListeners() to increase limit.',this._events[type].length);console.trace();}}}
return this;};EventEmitter.prototype.onAny=function(fn){if(typeof fn!=='function'){throw new Error('onAny only accepts instances of Function');}
if(!this._all){this._all=[];}
this._all.push(fn);return this;};EventEmitter.prototype.addListener=EventEmitter.prototype.on;EventEmitter.prototype.off=function(type,listener){if(typeof listener!=='function'){throw new Error('removeListener only takes instances of Function');}
var handlers,leafs=[];if(this.wildcard){var ns=typeof type==='string'?type.split(this.delimiter):type.slice();leafs=searchListenerTree.call(this,null,ns,this.listenerTree,0);}
else{if(!this._events[type])return this;handlers=this._events[type];leafs.push({_listeners:handlers});}
for(var iLeaf=0;iLeaf<leafs.length;iLeaf++){var leaf=leafs[iLeaf];handlers=leaf._listeners;if(isArray(handlers)){var position=-1;for(var i=0,length=handlers.length;i<length;i++){if(handlers[i]===listener||(handlers[i].listener&&handlers[i].listener===listener)||(handlers[i]._origin&&handlers[i]._origin===listener)){position=i;break;}}
if(position<0){continue;}
if(this.wildcard){leaf._listeners.splice(position,1);}
else{this._events[type].splice(position,1);}
if(handlers.length===0){if(this.wildcard){delete leaf._listeners;}
else{delete this._events[type];}}
return this;}
else if(handlers===listener||(handlers.listener&&handlers.listener===listener)||(handlers._origin&&handlers._origin===listener)){if(this.wildcard){delete leaf._listeners;}
else{delete this._events[type];}}}
return this;};EventEmitter.prototype.offAny=function(fn){var i=0,l=0,fns;if(fn&&this._all&&this._all.length>0){fns=this._all;for(i=0,l=fns.length;i<l;i++){if(fn===fns[i]){fns.splice(i,1);return this;}}}else{this._all=[];}
return this;};EventEmitter.prototype.removeListener=EventEmitter.prototype.off;EventEmitter.prototype.removeAllListeners=function(type){if(arguments.length===0){!this._events||init.call(this);return this;}
if(this.wildcard){var ns=typeof type==='string'?type.split(this.delimiter):type.slice();var leafs=searchListenerTree.call(this,null,ns,this.listenerTree,0);for(var iLeaf=0;iLeaf<leafs.length;iLeaf++){var leaf=leafs[iLeaf];leaf._listeners=null;}}
else{if(!this._events[type])return this;this._events[type]=null;}
return this;};EventEmitter.prototype.listeners=function(type){if(this.wildcard){var handlers=[];var ns=typeof type==='string'?type.split(this.delimiter):type.slice();searchListenerTree.call(this,handlers,ns,this.listenerTree,0);return handlers;}
this._events||init.call(this);if(!this._events[type])this._events[type]=[];if(!isArray(this._events[type])){this._events[type]=[this._events[type]];}
return this._events[type];};EventEmitter.prototype.listenersAny=function(){if(this._all){return this._all;}
else{return[];}};if(typeof define==='function'&&define.amd){define('eventemitter',[],function(){return EventEmitter;});}else if(typeof exports==='object'){exports.EventEmitter2=EventEmitter;}
else{window.EventEmitter2=EventEmitter;}}();define('aura/ext/mediator',['eventemitter','underscore'],function(){'use strict';return{name:'mediator',require:{paths:{eventemitter:'bower_components/eventemitter2/lib/eventemitter2',underscore:'bower_components/underscore/underscore'},shim:{underscore:{exports:'_'}}},initialize:function(app){var EventEmitter=require('eventemitter');var _=require('underscore');app.config.mediator=_.defaults(app.config.mediator||{},{wildcard:true,delimiter:'.',newListener:true,maxListeners:20});var mediator=new EventEmitter(app.config.mediator);app.core.mediator=mediator;var attachListener=function(listenerType){return function(name,listener,context){if(this.stopped){return;}
if(!_.isFunction(listener)||!_.isString(name)){throw new Error('Invalid arguments passed to sandbox.'+listenerType);}
context=context||this;var callback=function(){var args=Array.prototype.slice.call(arguments);try{listener.apply(context,args);}catch(e){app.logger.error("Error caught in listener '"+name+"', called with arguments: ",args,"\nError:",e.message,e,args);}};this._events=this._events||[];this._events.push({name:name,listener:listener,callback:callback});mediator[listenerType](name,callback);};};app.sandbox.on=attachListener('on');app.sandbox.once=attachListener('once');app.sandbox.off=function(name,listener){if(!this._events){return;}
this._events=_.reject(this._events,function(evt){var ret=(evt.name===name);if(ret){mediator.off(name,evt.callback);}
return ret;});};app.sandbox.emit=function(){if(this.stopped){return;}
var debug=app.config.debug;if(debug.enable&&(debug.components.length===0||debug.components.indexOf("aura:mediator")!==-1)){var eventData=Array.prototype.slice.call(arguments);eventData.unshift('Event emitted');app.logger.log.apply(app.logger,eventData);}
mediator.emit.apply(mediator,arguments);};app.sandbox.stopListening=function(){if(!this._events){return;}
_.each(this._events,function(evt){mediator.off(evt.name,evt.callback);});};var eventName=['aura','sandbox','stop'].join(app.config.mediator.delimiter);app.core.mediator.on(eventName,function(sandbox){sandbox.stopListening();});}};});define('aura/ext/components',[],function(){'use strict';return function(app){var ownProp=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key);};var core=app.core;var _=app.core.util._;core.Components=core.Components||{};var registeredComponents={};var componentsCallbacks={};function invokeCallbacks(stage,fnName,context,args){var callbacks=componentsCallbacks[stage+":"+fnName]||[];var dfds=[];app.core.util.each(callbacks,function(i,cb){if(typeof cb==='function'){dfds.push(cb.apply(context,args));}});var ret=app.core.data.when.apply(undefined,dfds).promise();return ret;}
function invokeWithCallbacks(fn,context){var fnName;if(typeof fn==='string'){fnName=fn;fn=context[fnName]||function(){};}else if(typeof fn.name==='string'){fnName=fn.name;fn=fn.fn||function(){};}else{throw new Error("Error invoking Component with callbacks: ",context.options.name,". first argument should be either the name of a function or of the form : { name: 'fnName', fn: function() { ... } } ");}
var dfd=app.core.data.deferred();var before,after,args=[].slice.call(arguments,2);before=invokeCallbacks("before",fnName,context,args);before.then(function(){return fn.apply(context,args);}).then(function(_res){return invokeCallbacks("after",fnName,context,args.concat(_res)).then(function(){core.data.when(_res).then(function(){dfd.resolve(_res);});},dfd.reject);}).fail(function(err){app.logger.error("Error in Component "+context.options.name+" "+fnName+" callback",err);dfd.reject(err);});return dfd.promise();}
function Component(options){var opts=_.clone(options);var dfd=core.data.deferred();var self=this;this.options=_.defaults(opts||{},this.options||{});this._ref=opts._ref;this.$el=core.dom.find(opts.el);this.initialized=dfd.promise();this.invokeWithCallbacks('initialize',this.options).then(function(){dfd.resolve(self);});return this;}
Component.prototype.initialize=function(){};Component.prototype.html=function(markup){var el=this.$el;el.html(markup);var self=this;_.defer(function(){self.sandbox.start(el,{reset:true});});return this;};Component.prototype.$find=function(selector){return this.$el.find(selector);};Component.prototype.invokeWithCallbacks=function(methodName){return invokeWithCallbacks.apply(undefined,[methodName,this].concat([].slice.call(arguments,1)));};var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&ownProp(protoProps,'constructor')){child=protoProps.constructor;}else{child=function(){parent.apply(this,arguments);};}
core.util.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child;};Surrogate.prototype=parent.prototype;child.prototype=new Surrogate();if(protoProps){core.util.extend(child.prototype,protoProps);}
child.__super__=parent.prototype;return child;};Component.extend=extend;Component.load=function(name,opts){var dfd=core.data.deferred(),ref=opts.ref,component,ComponentConstructor,el=opts.el;opts._ref=core.util._.uniqueId(ref+'+');var options=_.clone(opts);app.logger.log("Start loading component:",name);dfd.fail(function(err){app.logger.error("Error loading component:",name,err);});require.config(options.require);require([ref],function(componentDefinition){if(!componentDefinition){return dfd.reject("component "+ref+" Definition is empty !");}
try{if(registeredComponents[ref]){ComponentConstructor=registeredComponents[ref];}else{if(componentDefinition.type){ComponentConstructor=core.Components[componentDefinition.type];}else{ComponentConstructor=Component;}
if(!ComponentConstructor){throw new Error("Can't find component of type '"+componentDefinition.type+"', did you forget to include the extension that provides it ?");}
if(core.util._.isObject(componentDefinition)){ComponentConstructor=registeredComponents[ref]=ComponentConstructor.extend(componentDefinition);}}
var sandbox=app.sandboxes.create(opts._ref,{el:el});sandbox.logger.setName("Component '"+name+"'("+sandbox.logger.name+')');var ext={sandbox:sandbox};if(typeof componentDefinition==='function'){ext.initialize=componentDefinition;}
ComponentConstructor=ComponentConstructor.extend(ext);var newComponent=new ComponentConstructor(options);newComponent.$el.data('__sandbox_ref__',sandbox.ref);var initialized=newComponent.initialized;initialized.then(function(ret){dfd.resolve(ret);});initialized.fail(function(err){dfd.reject(err);});return initialized;}catch(err){app.logger.error(err.message);dfd.reject(err);}},function(err){dfd.reject(err);});return dfd.promise();};function parseComponentOptions(el,namespace,opts){var options=_.clone(opts||{});options.el=el;options.require={};var name,data=core.dom.data(el);core.util.each(data,function(k,v){k=k.replace(new RegExp("^"+namespace),"");k=k.charAt(0).toLowerCase()+k.slice(1);if(k!=="component"&&k!=='widget'){options[k]=v;}else{name=v;}});return buildComponentOptions(name,options);}
function buildComponentOptions(name,options){var ref=name.split("@"),componentName=core.util.decamelize(ref[0]),componentSource=ref[1]||"default",requireContext=require.s.contexts._,componentsPath=app.config.sources[componentSource]||"./aura_components";options.name=componentName;options.ref='__component__$'+componentName+"@"+componentSource;options.baseUrl=componentsPath+"/"+componentName;options.require=options.require||{};options.require.packages=options.require.packages||[];options.require.packages.push({name:options.ref,location:componentsPath+"/"+componentName});return options;}
Component.parseList=function(components){var list=[];if(Array.isArray(components)){_.map(components,function(w){var options=buildComponentOptions(w.name,w.options);list.push({name:w.name,options:options});});}else if(components&&core.dom.find(components)){var appNamespace=app.config.namespace;var selector=["[data-aura-component]","[data-aura-widget]"];if(appNamespace){selector.push("[data-"+appNamespace+"-component]");selector.push("[data-"+appNamespace+"-widget]");}
selector=selector.join(",");core.dom.find(selector,components||'body').each(function(){var ns="aura";if(appNamespace&&(this.getAttribute('data-'+appNamespace+'-component')||this.getAttribute('data-'+appNamespace+'-widget'))){ns=appNamespace;}
var options=parseComponentOptions(this,ns);list.push({name:options.name,options:options});});}
return list;};Component.startAll=function(components){var componentsList=Component.parseList(components);var list=[];core.util.each(componentsList,function(i,w){var ret=Component.load(w.name,w.options);list.push(ret);});var loadedComponents=core.data.when.apply(undefined,list);return loadedComponents.promise();};return{name:'components',require:{paths:{text:'bower_components/requirejs-text/text'}},initialize:function(app){app.core.Components.Base=Component;app.components.before=function(methodName,fn){var callbackName="before:"+methodName;registerComponentCallback(callbackName,fn);};app.components.after=function(methodName,fn){var callbackName="after:"+methodName;registerComponentCallback(callbackName,fn);};function registerComponentCallback(callbackName,fn){componentsCallbacks[callbackName]=componentsCallbacks[callbackName]||[];componentsCallbacks[callbackName].push(fn);}
app.components.addType=function(type,def){if(app.core.Components[type]){throw new Error("Component type "+type+" already defined");}
app.core.Components[type]=Component.extend(def);};app.sandbox.start=function(list,options){if(this.stopped){return;}
var event=['aura','sandbox','start'].join(app.config.mediator.delimiter);app.core.mediator.emit(event,this);var children=this._children||[];if(options&&options.reset){_.invoke(this._children||[],'stop');children=[];}
var self=this;return Component.startAll(list).done(function(){var components=Array.prototype.slice.call(arguments);_.each(components,function(w){w.sandbox._component=w;w.sandbox._parent=self;children.push(w.sandbox);});self._children=children;});};},afterAppStart:function(app){if(app.config.components!==false&&app.startOptions.components!==false){var el;if(Array.isArray(app.startOptions.components)){el=core.dom.find('body');}else{el=core.dom.find(app.startOptions.components);}
app.core.appSandbox=app.sandboxes.create(app.ref,{el:el});app.core.appSandbox.start(app.startOptions.components);}}};};});define('form/util',[],function(){'use strict';var ignoredKeys=['form','validation'];return{debugEnabled:false,getFields:function(element){return $(element).find('input:not([data-form="false"], [type="submit"], [type="button"], [type="checkbox"], [type="radio"]), textarea:not([data-form="false"]), select:not([data-form="false"]), *[data-form="true"], *[data-type="collection"], *[contenteditable="true"]');},findGroupedFieldsBySelector:function(element,filter){var groupedFields={},fieldName;$(element).find(filter).each(function(key,field){fieldName=$(field).data('mapper-property');if(!groupedFields[fieldName]){groupedFields[fieldName]=[];}
groupedFields[fieldName].push(field);});return groupedFields;},getCheckboxes:function(element){return this.findGroupedFieldsBySelector(element,'input[type="checkbox"]');},getRadios:function(element){return this.findGroupedFieldsBySelector(element,'input[type="radio"]');},parseData:function(el,namespace,defaults){var $el=$(el);return this.buildOptions($el.data(),namespace,'',defaults);},buildOptions:function(data,namespace,subNamespace,defaults){if(!subNamespace){subNamespace='';}
if(!defaults){defaults={};}
var options=$.extend({},defaults,{}),fullNamespace=namespace+this.ucFirst(subNamespace);$.each(data,function(key,value){var regExp=new RegExp('^'+fullNamespace);if(regExp.test(key)){if($.inArray(key,ignoredKeys)===-1){if(key!==fullNamespace){key=key.replace(regExp,'');}else{key=key.replace(new RegExp('^'+namespace),'');}
if(key!==''){key=this.lcFirst(key);options[key]=value;}}}}.bind(this));return options;},isValueField:function(el){var $el=$(el);return $el.is('input, select, textarea, option, button');},isCheckbox:function(el){var $el=$(el);return $el.is(':checkbox');},getValue:function(el){var $el=$(el);if(this.isCheckbox($el)){return $el.prop('checked');}else if(this.isValueField($el)){return $el.val();}else{return $el.html();}},setValue:function(el,value){var $el=$(el);if(this.isCheckbox($el)){$el.prop('checked',value);}else if(this.isValueField($el)){$el.val(value);}else{$el.html(value);}},debug:function(p1,p2,p3){if(!!this.debugEnabled){if(!!p1){if(!!p2){if(!!p3){console.log('Husky Validation:',p1,p2,p3);}else{console.log('Husky Validation:',p1,p2);}}else{console.log('Husky Validation:',p1);}}else{console.log('Husky Validation');}}},ucFirst:function(str){str+='';var f=str.charAt(0).toUpperCase();return f+str.substr(1);},lcFirst:function(str){return str.charAt(0).toLowerCase()+str.slice(1);},startsWith:function(str,starts){return str.indexOf(starts)===0;},print:function(object,stage){if(!stage){stage=1;}
var str='',oneIndent='&nbsp;&nbsp;&nbsp;&nbsp;',property,value,indent='',i=0;while(i<stage){indent+=oneIndent;i++;}
for(property in object){if(object.hasOwnProperty(property)){value=object[property];if(typeof value==='string'){if(this.isNumeric(value)){str+=indent+property+': '+value+'; </br>';}else{if(value.length>7){value=value.substring(0,6)+' ...';}
str+=indent+property+': \''+value+'\'; </br>';}}else{str+=indent+property+': { </br>'+indent+oneIndent+print(value,stage++)+'}';}}}
return str;},isNumeric:function(str){return str.match(/-?\d+(.\d+)?/);}};});define('form/element',['form/util'],function(Util){'use strict';return function(el,form,options){var defaults={type:null,validationTrigger:'focusout',validationAddClasses:true,validationAddClassesParent:true,validationErrorClass:'husky-validate-error',validationClass:'husky-validate',validation:true},ignoredOptions=['validation','validationTrigger','validationAddClasses','validationAddClassesParent','validationClass','validationErrorClass','validationSubmitEvent'],valid,validators={},type,lastValue=null,dfd=null,that={initialize:function(){dfd=$.Deferred();this.requireCounter=0;this.initialized=dfd.promise();this.$el=$(el);this.$el.data('element',this);this.options=$.extend({},defaults,options);if(!!this.options.validationAddClasses){this.$el.addClass(this.options.validationClass);}
if(!!this.options.validation){that.initValidation.call(this);}},resolveInitialization:function(){this.requireCounter--;if(this.requireCounter===0){dfd.resolve();}},initValidation:function(){that.bindValidationDomEvents.call(this);that.initValidators.call(this);that.initType.call(this);},bindValidationDomEvents:function(){var triggers=(!this.options.validationTrigger?'':this.options.validationTrigger);if(triggers===''||triggers==='none'){return;}
if(this.$el.is('select')){triggers+=new RegExp('change','i').test(triggers)?'':' change';}
triggers=triggers.replace(/^\s+/g,'').replace(/\s+$/g,'');this.$el.bind(triggers,this.validate.bind(this));},initValidators:function(){var addFunction=function(name,options){this.requireCounter++;require(['validator/'+name],function(Validator){validators[name]=new Validator(this.$el,form,this,options);Util.debug('Element Validator',name,options);that.resolveInitialization.call(this);}.bind(this));}.bind(this);$.each(this.options,function(key,val){if(!!val&&$.inArray(key,ignoredOptions)===-1&&Util.startsWith(key,'validation')){var name=Util.lcFirst(key.replace('validation','')),options=Util.buildOptions(this.options,'validation',name);addFunction(name,options);}}.bind(this));if(this.$el.attr('required')==='required'&&!validators.required){addFunction('required',{required:true});}
if(!!this.$el.attr('min')&&!validators.min){addFunction('min',{min:parseInt(this.$el.attr('min'),10)});}
if(!!this.$el.attr('max')&&!validators.max){addFunction('max',{max:parseInt(this.$el.attr('max'),10)});}
if(!!this.$el.attr('pattern')&&!validators.pattern){addFunction('regex',{regex:this.$el.attr('pattern')});}},initType:function(){var addFunction=function(typeName,options){this.requireCounter++;require(['type/'+typeName],function(Type){type=new Type(this.$el,options,form);type.initialized.then(function(){Util.debug('Element Type',typeName,options);that.resolveInitialization.call(this);}.bind(this));}.bind(this));}.bind(this),options=Util.buildOptions(this.options,'type'),typeName,tmpType;if(!!this.options.type){typeName=this.options.type;}else if(!!this.$el.attr('type')){tmpType=this.$el.attr('type');if(tmpType==='email'){typeName='email';}else if(tmpType==='url'){typeName='url';}else if(tmpType==='number'){typeName='decimal';}else if(tmpType==='date'){typeName='date';if(!!options.format){options.format='d';}}else if(tmpType==='time'){typeName='date';if(!!options.format){options.format='t';}}else if(tmpType==='datetime'){typeName='date';}else{typeName='string';}}else{typeName='string';}
addFunction(typeName,options);},hasConstraints:function(){var typeConstraint=(!!type&&type.needsValidation()),validatorsConstraint=Object.keys(validators).length>0;return validatorsConstraint||typeConstraint;},needsValidation:function(){return lastValue!==Util.getValue(this.$el);},reset:function(){var $element=this.$el;if(!!this.options.validationAddClassesParent){$element=$element.parent();}
$element.removeClass(this.options.validationErrorClass);},setValid:function(state){valid=state;if(!!this.options.validationAddClasses){that.reset.call(this);var $element=this.$el;if(!!this.options.validationAddClassesParent){$element=$element.parent();}
if(!state){$element.addClass(this.options.validationErrorClass);}}}},result={validate:function(force){var result=true,validated=false;if(force||that.needsValidation.call(this)){if(that.hasConstraints.call(this)){$.each(validators,function(key,validator){if(!validator.validate()){result=false;}});validated=true;}}
if(!!type&&type.needsValidation()){if(!type.validate()){result=false;}
validated=true;}
if(validated===true){if(!result){Util.debug('Field validate',!!result?'true':'false',this.$el);}
that.setValid.call(this,result);}
return result;},update:function(){if(!that.hasConstraints.call(this)){return true;}
var result=true;$.each(validators,function(key,validator){if(!validator.update()){result=false;}});if(type!==null&&!type.validate()){result=false;}
if(!result){Util.debug('Field validate',!!result?'true':'false',this.$el);}
that.setValid.call(this,result);return result;},isValid:function(){return valid;},updateConstraint:function(name,options){if($.inArray(name,Object.keys(validators))>-1){validators[name].updateConstraint(options);this.validate();}else{throw'No constraint with name: '+name;}},deleteConstraint:function(name){if($.inArray(name,Object.keys(validators))>-1){delete validators[name];this.validate(true);}else{throw'No constraint with name: '+name;}},addConstraint:function(name,options){if($.inArray(name,Object.keys(validators))===-1){require(['validator/'+name],function(Validator){validators[name]=new Validator(this.$el,form,this,options);}.bind(this));}else{throw'Constraint with name: '+name+' already exists';}},hasConstraint:function(name){return!!validators[name];},getConstraint:function(name){if(!this.hasConstraint(name)){return false;}
return validators[name];},fieldAdded:function(element){$.each(validators,function(key,validator){validator.fieldAdded(element);});},fieldRemoved:function(element){$.each(validators,function(key,validator){validator.fieldRemoved(element);});},setValue:function(value){var dfd=$.Deferred(),result;this.initialized.then(function(){result=type.setValue(value);if(!!result){result.then(function(){dfd.resolve();});}else{dfd.resolve();}}.bind(this));return dfd.promise();},getValue:function(data){return type.getValue(data);},getType:function(){return type;}};that.initialize.call(result);return result;};});define('form/elementGroup',[],function(){'use strict';var setMultipleValue=function(elements,values){elements.forEach(function(element){values.forEach(function(value){if(element.$el.val()===value){element.$el.prop('checked',true);}});});},setSingleValue=function(elements,value){for(var i=-1;++i<elements.length;){if(elements[i].$el.val()===value){elements[i].$el.prop('checked',true);return;}}};return function(elements,isSingleValue){var result={getValue:function(){var value=[];elements.forEach(function(element){if(element.$el.is(':checked')){value.push(element.$el.val());}});if(!!isSingleValue){if(value.length>1){throw new Error('Single value element group cannot return more than one value');}
return value[0];}
return value;},setValue:function(values){if(!!isSingleValue&&!!$.isArray(values)){throw new Error('Single value element cannot be set to an array value');}
if(!isSingleValue&&!$.isArray(values)){throw new Error('Field with multiple values cannot be set to a single value');}
if($.isArray(values)){setMultipleValue.call(this,elements,values);}else{setSingleValue.call(this,elements,values);}}};elements.forEach(function(element){element.$el.data('elementGroup',result);});return result;};});define('form/validation',['form/util'],function(Util){'use strict';return function(form){var valid,that={initialize:function(){that.bindValidationDomEvents.call(this);Util.debug('INIT Validation');},bindValidationDomEvents:function(){if(!!form.options.validationSubmitEvent){form.$el.on('submit',function(){return form.validation.validate();}.bind(this));}},setValid:function(state){valid=state;}},result={validate:function(force){var result=true;$.each(form.elements,function(key,element){if(!element.validate(force)){result=false;}});$.each(form.mapper.collections,function(i,collection){$.each(collection.items,function(j,item){$.each(item.data('collection').childElements,function(k,childElement){if(!childElement.validate(force)){result=false;}});});});that.setValid.call(this,result);Util.debug('Validation',!!result?'success':'error');return result;},isValid:function(){return valid;},updateConstraint:function(selector,name,options){var $element=$(selector);if(!!$element.data('element')){$(selector).data('element').updateConstraint(name,options);}else{throw'No validation element';}},deleteConstraint:function(selector,name){var $element=$(selector);if(!!$element.data('element')){$element.data('element').deleteConstraint(name);}else{throw'No validation element';}},addConstraint:function(selector,name,options){var $element=$(selector),element;if(!!$element.data('element')){$element.data('element').addConstraint(name,options);}else{element=form.addField(selector);element.addConstraint(name,options);form.elements.push(element);}}};that.initialize.call(result);return result;};});define('form/mapper',['form/util'],function(Util){'use strict';return function(form){var filters={},that={initialize:function(){Util.debug('INIT Mapper');this.collections=[];this.collectionsSet={};this.emptyTemplates={};this.templates={};form.initialized.then(function(){var selector='*[data-type="collection"]',$elements=form.$el.find(selector);$elements.each(that.initCollection.bind(this));}.bind(this));},initCollection:function(key,value){var $element=$(value),element=$element.data('element'),property=$element.data('mapper-property'),newChild,collection,emptyTemplate,dfd=$.Deferred(),counter=0,resolve=function(){counter--;if(counter===0){dfd.resolve();}};if(!$.isArray(property)){if(typeof property==='object'){property=[property];$element.data('mapper-property',property);}else{throw'no valid mapper-property value';}}
element.$children=$element.children().clone(true);$element.html('');collection={id:_.uniqueId('collection_'),property:property,$element:$element,element:element,items:[]};this.collections.push(collection);counter+=element.$children.length;element.$children.each(function(i,child){var $child=$(child),propertyName,x,len,propertyCount=0,resolveElement=function(){propertyCount--;if(propertyCount===0){resolve();}};if(!$child.is('script')){throw'template has to be defined as <script>';}
newChild={tpl:$child.html(),id:$child.attr('id'),collection:collection};element.$children[i]=newChild;for(x=-1,len=property.length;++x<len;){if(property[x].tpl===newChild.id){propertyName=property[x].data;emptyTemplate=property[x]['empty-tpl'];}
if(property[x]['empty-tpl']&&property[x]['empty-tpl']===newChild.id){this.emptyTemplates[property[x].data]={id:property[x]['empty-tpl'],tpl:$child.html()};}}
if(!!propertyName){newChild.propertyName=propertyName;propertyCount=collection.element.getType().getMinOccurs();this.templates[propertyName]={tpl:newChild,collection:collection,emptyTemplate:emptyTemplate,};for(x=collection.element.getType().getMinOccurs()+1;--x>0;){that.appendChildren.call(this,collection,newChild).then(function(){$('#current-counter-'+propertyName).text(collection.element.getType().getChildren(newChild.id).length);resolveElement();}.bind(this));}}else{resolveElement();}}.bind(this));$.each(property,function(i,item){form.$el.on('click','*[data-mapper-add="'+item.data+'"]',that.addClick.bind(this));form.$el.on('click','*[data-mapper-remove="'+item.data+'"]',that.removeClick.bind(this));dfd.then(function(){that.emitInitCollectionEvent(item.data);});}.bind(this));that.checkFullAndEmpty.call(this,property[0].data);dfd.then(function(){Util.debug('collection resolved');});return dfd.promise();},addClick:function(event){var $addButton=$(event.currentTarget),propertyName=$addButton.data('mapper-add'),tpl=this.templates[propertyName].tpl,collection=this.templates[propertyName].collection;if(collection.element.getType().canAdd(tpl.id)){that.appendChildren.call(this,collection,tpl).then(function(){$('#current-counter-'+propertyName).text(collection.element.getType().getChildren(tpl.id).length);that.emitAddEvent(propertyName,null);}.bind(this));}
that.checkFullAndEmpty.call(this,propertyName);},addEmptyTemplate:function($element,propertyName){if(this.emptyTemplates.hasOwnProperty(propertyName)){var $emptyTemplate=$(this.emptyTemplates[propertyName].tpl);$emptyTemplate.attr('id',this.emptyTemplates[propertyName].id);$element.append($emptyTemplate);}},removeClick:function(event){var $removeButton=$(event.currentTarget),propertyName=$removeButton.data('mapper-remove'),tpl=this.templates[propertyName].tpl,collection=this.templates[propertyName].collection,$element=$removeButton.closest('.'+propertyName+'-element');if(collection.element.getType().canRemove(tpl.id)){that.remove.call(this,$element);$('#current-counter-'+propertyName).text(collection.element.getType().getChildren(tpl.id).length);that.emitRemoveEvent(propertyName,null);}
that.checkFullAndEmpty.call(this,propertyName);},checkFullAndEmpty:function(propertyName){var $addButton=$("[data-mapper-add='"+propertyName+"']"),$removeButton=$("[data-mapper-remove='"+propertyName+"']"),tpl=this.templates[propertyName].tpl,collection=this.templates[propertyName].collection,fullClass=collection.element.$el.data('mapper-full-class')||'full',emptyClass=collection.element.$el.data('mapper-empty-class')||'empty';$addButton.removeClass(fullClass);$addButton.removeClass(emptyClass);$(collection.element.$el).removeClass(fullClass);$(collection.element.$el).removeClass(emptyClass);if(!!$addButton.length||!!$removeButton.length){if(!collection.element.getType().canAdd(tpl.id)){$addButton.addClass(fullClass);$(collection.element.$el).addClass(fullClass);}else if(!collection.element.getType().canRemove(tpl.id)){$addButton.addClass(emptyClass);$(collection.element.$el).addClass(emptyClass);}}},emitInitCollectionEvent:function(propertyName){$(form.$el).trigger('form-collection-init',[propertyName]);},emitAddEvent:function(propertyName,data){$(form.$el).trigger('form-add',[propertyName,data]);},emitRemoveEvent:function(propertyName,data){$(form.$el).trigger('form-remove',[propertyName,data]);},processData:function(el,collection,returnMapperId){var $el=$(el),type=$el.data('type'),property=$el.data('mapper-property'),element=$el.data('element'),result,filtersAction;if(collection&&!!filters[collection.data]){filtersAction=filters[collection.data];}else if(!!filters[property]){filtersAction=filters[property];}
if(type!=='collection'){if(!!element){return element.getValue();}else{return null;}}else{result=[];$.each($el.children(),function(key,value){if(!collection||collection.tpl===value.dataset.mapperPropertyTpl){var elements=$(value).data('collection').childElements,elementGroups=$(value).data('collection').childElementGroups,data={};elements.forEach(function(child){that.addDataFromElement.call(this,child,data,returnMapperId);});for(key in elementGroups){if(elementGroups.hasOwnProperty(key)){data[key]=elementGroups[key].getValue();}}
if(!!returnMapperId){data.mapperId=value.dataset.mapperId;}
var keys=Object.keys(data);if(keys.length===1){if(data[keys[0]]!==''){result.push(data[keys[0]]);}}else if(!filtersAction||filtersAction(data)){result.push(data);}}}.bind(this));return result;}},setCollectionData:function(data,collection){var $element=collection.$element,child=this.templates[collection.key].tpl,count=data.length,dfd=$.Deferred(),resolve=function(){count--;if(count===0){dfd.resolve();}},x,length;if(count===0){that.addEmptyTemplate.call(this,$element,child.propertyName);dfd.resolve();}else{if(data.length<collection.element.getType().getMinOccurs()){for(x=collection.element.getType().getMinOccurs()+1,length=data.length;--x>length;){data.push({});}}
collection.items=[];$.each(data,function(key,value){that.appendChildren.call(this,collection,child,value).then(function($newElement){that.setData.call(this,value,$newElement).then(function(){resolve();}.bind(this));}.bind(this));}.bind(this));}
$('#current-counter-'+$element.attr('id')).text(data.length);that.checkFullAndEmpty.call(this,collection.property[0].data);return dfd.promise();},appendChildren:function(collection,child,tplOptions,data,insertAfter){var clonedChild=$.extend(true,{},child),index=clonedChild.collection.element.getType().getChildren(clonedChild.id).length,options=$.extend({},{index:index},tplOptions||{}),template=_.template(clonedChild.tpl,options,form.options.delimiter),$template=$(template),$newFields=Util.getFields($template),$radioFields=Util.getRadios($template),$checkboxFields=Util.getCheckboxes($template),dfd=$.Deferred(),counter=$newFields.length,$element=collection.$element,$lastElement,element;$template.attr('data-mapper-property-tpl',clonedChild.id);$template.attr('data-mapper-id',_.uniqueId());if(insertAfter&&($lastElement=$element.find('*[data-mapper-property-tpl="'+clonedChild.id+'"]').last()).length>0){$lastElement.after($template);}else{$element.append($template);}
clonedChild.collection.childElements=[];clonedChild.collection.childElementGroups={};if($newFields.length>0){$newFields.each(function(key,field){element=form.createField($(field));clonedChild.collection.childElements.push(element);element.initialized.then(function(){counter--;if(counter===0){dfd.resolve($template);}});}.bind(this));}else{dfd.resolve($template);}
if(_.size($radioFields)>0){$.each($radioFields,function(key,field){clonedChild.collection.childElementGroups[key]=form.createFieldGroup(field,true);});}
if(_.size($checkboxFields)>0){$.each($checkboxFields,function(key,field){clonedChild.collection.childElementGroups[key]=form.createFieldGroup(field,false);});}
$template.data('collection',clonedChild.collection);if(!!data){dfd.then(function(){that.setData.call(this,data,$newFields);}.bind(this));}
collection.items.push($template);return dfd.promise();},getElementByMapperId:function(mapperId){for(var i=-1,iLength=this.collections.length;++i<iLength;){for(var j=-1,jLength=this.collections[i].items.length;++j<jLength;){if(this.collections[i].items[j].data('mapper-id')===mapperId){return this.collections[i].items[j];}}}
return null;},deleteElementByMapperId:function(mapperId){var templateName;$.each(this.collections,function(i,collection){$.each(collection.items,function(j,item){if(item.data('mapper-id').toString()!==mapperId.toString()){return true;}
templateName=item.attr('data-mapper-property-tpl');item.remove();collection.items.splice(j,1);return false;});}.bind(this));return templateName;},remove:function($element){$.each(Util.getFields($element),function(key,value){form.removeField(value);}.bind(this));$element.remove();},setData:function(data,$el){if(!$el){$el=form.$el;}
var dfd=$.Deferred(),selector,$element,element,count=1,resolve=function(){count--;if(count===0){dfd.resolve();}};if(typeof data!=='object'){selector='*[data-mapper-property]';$element=$el.find(selector);element=$element.data('element');if(!element){element=form.addField($element);element.initialized.then(function(){element.setValue(data).then(function(){resolve();});}.bind(this));}else{element.setValue(data).then(function(){resolve();});}}else if(data!==null&&!$.isEmptyObject(data)){count=Object.keys(data).length;$.each(data,function(key,value){var $element,element,collection;if($.isArray(value)&&this.templates.hasOwnProperty(key)){collection=this.templates[key].collection;collection.key=key;if(!this.collectionsSet.hasOwnProperty(collection.id)){collection.$element.children().each(function(key,value){$(value).remove();}.bind(this));}
this.collectionsSet[collection.id]=true;that.setCollectionData.call(this,value,collection).then(function(){resolve();});}else if(form.elementGroups.hasOwnProperty(key)){form.elementGroups[key].setValue(value);resolve();}else{selector='*[data-mapper-property="'+key+'"]';$element=$el.andSelf().find(selector);element=$element.data('element');if($element.length>0){if(!element){element=form.addField($element);element.initialized.then(function(){element.setValue(value).then(function(){resolve();});}.bind(this));}else{element.setValue(value).then(function(){resolve();});}}else{resolve();}}}.bind(this));}else{dfd.resolve();}
return dfd.promise();},addDataFromElement:function(element,data,returnMapperId){var $element=element.$el,property=$element.data('mapper-property'),parts;if(!property){return;}
if($.isArray(property)){$.each(property,function(i,prop){data[prop.data]=that.processData.call(this,$element,prop,returnMapperId);}.bind(this));}else if(property.match(/.*\..*/)){parts=property.split('.');data[parts[0]]={};data[parts[0]][parts[1]]=that.processData.call(this,$element);}else{data[property]=that.processData.call(this,$element);}},getDataFromElements:function(elements,elementGroups,returnMapperId){var data={};elements.forEach(function(element){that.addDataFromElement.call(this,element,data,returnMapperId);}.bind(this));for(var key in elementGroups){if(elementGroups.hasOwnProperty(key)){data[key]=elementGroups[key].getValue();}}
return data;}},result={setData:function(data,$el){this.collectionsSet={};return that.setData.call(this,data,$el);},getData:function($el,returnMapperId){if(!!$el&&!!$el.data('mapper-id')){var collection=that.getElementByMapperId.call(this,$el.data('mapper-id')).data('collection');return that.getDataFromElements(collection.childElements,collection.childElementGroups,returnMapperId);}else{return that.getDataFromElements(form.elements,form.elementGroups,returnMapperId);}},addCollectionFilter:function(name,callback){filters[name]=callback;},removeCollectionFilter:function(name){delete filters[name];},addToCollection:function(propertyName,data,append){var template=this.templates[propertyName],element=template.collection.$element,insertAfterLast=false,lastElement,$emptyTpl,dfd=$.Deferred();if(!append){insertAfterLast=true;}
if(template.emptyTemplate){$emptyTpl=$(element).find('#'+template.emptyTemplate);if($emptyTpl){$emptyTpl.remove();}}
that.appendChildren.call(this,template.collection,template.tpl,data,data,insertAfterLast).then(function($element){dfd.resolve($element);}.bind(this));return dfd;},editInCollection:function(mapperId,data){var $element=that.getElementByMapperId.call(this,mapperId);that.setData.call(this,data,$element);},removeFromCollection:function(mapperId){var i,templateName=that.deleteElementByMapperId.call(this,mapperId);if(form.$el.find('*[data-mapper-property-tpl='+templateName+']').length<1){for(i in this.templates){if(this.templates[i].tpl.id===templateName){that.addEmptyTemplate.call(this,this.templates[i].collection.$element,i);return;}}}}};that.initialize.call(result);return result;};});require.config({paths:{'form':'js/form','form/mapper':'js/mapper','form/validation':'js/validation','form/element':'js/element','form/elementGroup':'js/elementGroup','form/util':'js/util','type/default':'js/types/default','type/readonly-select':'js/types/readonlySelect','type/string':'js/types/string','type/date':'js/types/date','type/decimal':'js/types/decimal','type/hiddenData':'js/types/hiddenData','type/mappingData':'js/types/mappingData','type/email':'js/types/email','type/url':'js/types/url','type/label':'js/types/label','type/select':'js/types/select','type/collection':'js/types/collection','type/attributes':'js/types/attributes','validator/default':'js/validators/default','validator/min':'js/validators/min','validator/max':'js/validators/max','validator/minLength':'js/validators/min-length','validator/maxLength':'js/validators/max-length','validator/required':'js/validators/required','validator/unique':'js/validators/unique','validator/equal':'js/validators/equ al','validator/regex':'js/validators/regex'}});define('form',['form/element','form/elementGroup','form/validation','form/mapper','form/util'],function(Element,ElementGroup,Validation,Mapper,Util){'use strict';return function(el,options){var defaults={debug:false,delimiter:{interpolate:/<~=(.+?)~>/g,escape:/<~-(.+?)~>/g,evaluate:/<~(.+?)~>/g},validation:true,validationTrigger:'focusout',validationAddClassesParent:true,validationAddClasses:true,validationSubmitEvent:true,mapper:true},that={initialize:function(){this.$el=$(el);this.options=$.extend(defaults,this.$el.data(),options);Util.debugEnabled=this.options.debug;this.initialized=that.initFields.call(this);if(!!this.options.validation){this.validation=new Validation(this);}
if(!!this.options.mapper){this.mapper=new Mapper(this);}
this.$el.data('form-object',this);},initFields:function($el){var dfd=$.Deferred(),requireCounter=0,resolve=function(){requireCounter--;if(requireCounter===0){dfd.resolve();}};$.each(Util.getFields($el||this.$el),function(key,value){requireCounter++;that.addField.call(this,value).initialized.then(resolve.bind(this));}.bind(this));that.addGroupedFields.call(this,$el);return dfd.promise();},bindValidationDomEvents:function(){if(!!this.options.validationSubmitEvent){this.$el.on('submit',function(){return this.validation.validate();}.bind(this));}},createField:function(selector){var $element=$(selector),options=Util.parseData($element,'',this.options);return new Element($element,result,options);},createFieldGroup:function(selectors,single){return new ElementGroup(selectors.map(function(selector){var $element=$(selector),options=Util.parseData($element,'',this.options);return new Element($element,result,options);}.bind(this)),single);},addField:function(selector){var element=this.createField(selector);this.elements.push(element);Util.debug('Element created',options);return element;},addSingleGroupedField:function(key,selectors,single){this.elementGroups[key]=this.createFieldGroup(selectors,single);},addGroupedFields:function($el){$.each(Util.getCheckboxes($el||this.$el),function(key,value){if(value.length>1){that.addSingleGroupedField.call(this,key,value,false);}else{that.addField.call(this,value);}}.bind(this));$.each(Util.getRadios($el||this.$el),function(key,value){that.addSingleGroupedField.call(this,key,value,true);}.bind(this));}},result={elements:[],elementGroups:{},options:{},validation:false,mapper:false,createField:function(selector){var element=that.createField(selector);element.initialized.then(function(){element.fieldAdded(element);}.bind(this));return element;},createFieldGroup:function(selectors,single){return that.createFieldGroup(selectors,single);},addField:function(selector){var element=that.addField.call(this,selector);element.initialized.then(function(){$.each(this.elements,function(key,element){element.fieldAdded(element);});}.bind(this));return element;},addGroupedFields:function($el){return that.addGroupedFields.call(this,$el);},initFields:function($el){return that.initFields.call(this,$el);},removeFields:function($el){Util.getFields($el).each(function(i,item){this.removeField(item);}.bind(this));},removeField:function(selector){var $element=$(selector),el=$element.data('element');$.each(this.elements,function(key,element){element.fieldRemoved(el);});this.elements.splice(this.elements.indexOf(el),1);}};that.initialize.call(result);return result;};});define('type/default',['form/util'],function(Util){'use strict';return function($el,defaults,options,name,typeInterface,form){var that={initialize:function(){this.$el=$el;this.options=$.extend({},defaults,options);var dfd=$.Deferred();this.requireCounter=0;this.initialized=dfd.promise();if(!!this.initializeSub){this.initializeSub();}
dfd.resolve();}},defaultInterface={name:name,form:form,needsValidation:function(){return true;},updateConstraint:function(options){$.extend(this.options,options);},setValue:function(value){Util.setValue(this.$el,this.getViewData.call(this,value));},getValue:function(){return this.getModelData.call(this,Util.getValue(this.$el));},getViewData:function(value){return value;},getModelData:function(value){return value;}},result=$.extend({},defaultInterface,typeInterface);that.initialize.call(result);return result;};});define('type/string',['type/default'],function(Default){'use strict';return function($el,options){var defaults={},typeInterface={needsValidation:function(){return false;},validate:function(){return true;}};return new Default($el,defaults,options,'string',typeInterface);};});define('type/date',['type/default','form/util'],function(Default,Util){'use strict';return function($el,options){var defaults={format:'d'},getDate=function(value){Util.debug(value,new Date(value));return new Date(value);},subType={validate:function(){var val=Util.getValue(this.$el),date;if(val===''){return true;}
date=Globalize.parseDate(val,this.options.format);return date!==null;},needsValidation:function(){var val=Util.getValue(this.$el);return val!=='';},getViewData:function(value){return Globalize.format(getDate(value),this.options.format);},getModelData:function(value){if(value!==''){var date=Globalize.parseDate(value,this.options.format);return date.toISOString();}else{return value;}}};return new Default($el,defaults,options,'date',subType);};});define('type/decimal',['type/default'],function(Default){'use strict';return function($el,options){var defaults={format:'n',regExp:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/},typeInterface={initializeSub:function(){},validate:function(){var val=this.getValue();if(val===''){return true;}
return this.options.regExp.test(val);},getModelData:function(val){if(val===''){return'';}
return Globalize.parseFloat(val);},getViewData:function(val){if(typeof val==='string'){if(val===''){return'';}
val=parseFloat(val);}
return Globalize.format(val,this.options.format);}};return new Default($el,defaults,options,'decimal',typeInterface);};});define('type/hiddenData',['type/default'],function(Default){'use strict';return function($el,options){var defaults={id:'id',defaultValue:null},typeInterface={hiddenData:null,setValue:function(value){this.hiddenData=value;if(!!value&&typeof value==='object'&&!!value[this.options.id]){this.$el.data('id',value[this.options.id]);}},getValue:function(){if(this.hiddenData!==null){return this.hiddenData;}else{return this.options.defaultValue;}},needsValidation:function(){return false;},validate:function(){return true;}};return new Default($el,defaults,options,'hiddenData',typeInterface);};});define('type/mappingData',['type/default'],function(Default){'use strict';return function($el,options){var defaults={defaultValue:null,mapping:null,searchProperty:'id',showProperty:'name'},typeInterface={setValue:function(value){if(value!==null&&typeof value!=='object'){this.$el.data('value',value);this.$el.text(this.getMappingValue(value)||this.options.defaultValue);}},getValue:function(){var value=this.$el.data('value');if(value!==null){return value;}else{return this.options.defaultValue;}},needsValidation:function(){return false;},validate:function(){return true;},getMappingValue:function(val){var key,obj=this.options.mapping;if(!!obj){for(key in this.options.mapping){if(!!obj.hasOwnProperty(key)){if(obj[key].hasOwnProperty(this.options.searchProperty)&&obj[key].hasOwnProperty(this.options.showProperty)&&String(obj[key][this.options.searchProperty])===String(val)){return obj[key][this.options.showProperty];}}}}}};return new Default($el,defaults,options,'hiddenData',typeInterface);};});define('type/email',['type/default','form/util'],function(Default,Util){'use strict';return function($el,options){var defaults={regExp:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))){2,6}$/i},typeInterface={validate:function(){var val=this.getValue();if(val===''){return true;}
return this.options.regExp.test(val);},needsValidation:function(){var val=this.getValue();return val!=='';}};return new Default($el,defaults,options,'email',typeInterface);};});define('type/url',['type/default','form/util'],function(Default,Util){'use strict';return function($el,options){var defaults={regExp:/^(https?|s?ftp|git):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\ .|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},typeInterface={validate:function(){var val=this.getValue();if(val===''){return true;}
if(this.options['url-strict']!=='true'){val=new RegExp('(https?|s?ftp|git)','i').test(val)?val:'http://'+val;}
return this.options.regExp.test(val);},needsValidation:function(){var val=this.getValue();return val!=='';}};return new Default($el,defaults,options,'email',typeInterface);};});define('type/label',['type/default'],function(Default){'use strict';return function($el,options){var defaults={id:'id',label:'name',translate:true},typeInterface={setValue:function(value){if(!!value[this.options.label]){var label=value[this.options.label],labelValue=value[this.options.label];if(!!this.options.translate){labelValue=Globalize.localize(label,Globalize.culture().name);if(labelValue===undefined){labelValue=label;}}
this.$el.text(labelValue);}
if(!!value[this.options.id]){this.$el.data(this.options.id,value[this.options.id]);}},getValue:function(){var result={};result[this.options.id]=this.$el.data(this.options.id);result[this.options.label]=this.$el.text();return result;},needsValidation:function(){return false;},validate:function(){return true;}};return new Default($el,defaults,options,'label',typeInterface);};});define('type/select',['type/default','form/util'],function(Default,Util){'use strict';return function($el,options){var defaults={id:'id',label:'name',type:'object'},typeInterface={setValue:function(value){if(typeof value==='object'){this.$el.val(value[this.options.id]);}else{this.$el.find('option[id='+value+']').attr('selected','selected');this.options.type='string';}},getValue:function(){if(this.options.type==='object'){var result={};result[this.options.id]=Util.getValue(this.$el);result[this.options.label]=this.$el.find('option:selected').text();return result;}else{return this.$el.children(':selected').attr('id');}},needsValidation:function(){return false;},validate:function(){return true;}};return new Default($el,defaults,options,'select',typeInterface);};});define('type/readonly-select',['type/default'],function(Default){'use strict';return function($el,options){var defaults={id:null,data:[],idProperty:'id',outputProperty:'name'},typeInterface={setValue:function(value){var data=this.options.data,idProperty=this.options.idProperty,i,len;if(typeof value==='object'){if(value.hasOwnProperty(idProperty)){value=value[idProperty];}else{throw"value has no property named "+idProperty;}}else if(value===null){return;}
this.$el.data('id',value);if(data.length>0){for(i=-1,len=data.length;++i<len;){if(data[i].hasOwnProperty(idProperty)&&data[i][idProperty].toString()===value.toString()){this.$el.html(data[i][this.options.outputProperty]);break;}}}},getValue:function(){var id=this.$el.data('id'),i,len;for(i=-1,len=this.options.data.length;++i<len;){if(this.options.data[i][this.options.idProperty].toString()===id.toString()){return this.options.data[i];}}
return null;},needsValidation:function(){return false;},validate:function(){return true;}};return new Default($el,defaults,options,'readonly-select',typeInterface);};});define('type/collection',['type/default'],function(Default){'use strict';return function($el,options){var defaults={min:0,max:null},subType={validate:function(){return true;},needsValidation:function(){return false;},getChildren:function(id){return this.$el.find('*[data-mapper-property-tpl="'+id+'"]');},getMinOccurs:function(){return this.options.min;},getMaxOccurs:function(){return this.options.max;},canAdd:function(id){var length=this.getChildren(id).length;return this.getMaxOccurs()===null||length<this.getMaxOccurs();},canRemove:function(id){var length=this.getChildren(id).length;return length>this.getMinOccurs();}};return new Default($el,defaults,options,'collection',subType);};});define('type/attributes',['type/default'],function(Default){'use strict';return function($el,options){var defaults={},typeInterface={setValue:function(value){this.$el.data('attributes',value);},getValue:function(){return this.$el.data('attributes');},needsValidation:function(){return false;},validate:function(){return true;}};return new Default($el,defaults,options,'attributes',typeInterface);};});define('validator/default',[],function(){'use strict';return function($el,form,defaults,options,name){return{name:name,initialize:function(){this.$el=$el;this.data=$.extend(defaults,this.$el.data(),options);this.updateData();if(!!this.initializeSub){this.initializeSub();}},validate:function(){},update:function(){return this.validate();},updateConstraint:function(options){$.extend(this.data,options);this.updateData();},updateData:function(){$.each(this.data,function(key,value){this.$el.data(key,value);}.bind(this));},fieldRemoved:function(){},fieldAdded:function(){}};};});define('validator/min',['validator/default'],function(Default){'use strict';return function($el,form,element,options){var defaults={min:0},result=$.extend(new Default($el,form,defaults,options,'min'),{validate:function(){var val=this.data.element.getValue();return Number(val)>=this.data.min;}});result.initialize();return result;};});define('validator/max',['validator/default'],function(Default){'use strict';return function($el,form,element,options){var defaults={max:999},result=$.extend(new Default($el,form,defaults,options,'max'),{validate:function(){var val=this.data.element.getValue();return Number(val)<=this.data.max;}});result.initialize();return result;};});define('validator/minLength',['validator/default'],function(Default){'use strict';return function($el,form,element,options){var defaults={minLength:0},result=$.extend(new Default($el,form,defaults,options,'min-length'),{validate:function(){var val=this.data.element.getValue();return val.length>=this.data.minLength;}});result.initialize();return result;};});define('validator/maxLength',['validator/default'],function(Default){'use strict';return function($el,form,element,options){var defaults={maxLength:999},result=$.extend(new Default($el,form,defaults,options,'max-length'),{validate:function(){var val=this.data.element.getValue();return val.length<=this.data.maxLength;}});result.initialize();return result;};});define('validator/required',['validator/default'],function(Default){'use strict';return function($el,form,element,options){var defaults={},result=$.extend(new Default($el,form,defaults,options,'required'),{validate:function(){if(!!this.data.required){var val=this.data.element.getValue();if(typeof val==='number'){return true;}
if(!!_.isString(val)){val=val.trim();}
if(!val){return false;}
return _.size(val)>0;}
return true;}});result.initialize();return result;};});define('validator/unique',['validator/default','form/util'],function(Default,Util){'use strict';return function($el,form,element,options){var defaults={validationUnique:null},relatedElements=[],isElementRelated=function(element,group){return relatedElements.indexOf(element)&&!!element.options.validationUnique&&element.options.validationUnique===group;},validateElements=function(val){var result=true;$.each(relatedElements,function(key,element){if(!validateElement(val,element)){result=false;return false;}
return true;});return result;},validateElement=function(val,element){return val!==element.getValue();},updateRelatedElements=function(){$.each(relatedElements,function(key,element){element.update();});},result=$.extend({},new Default($el,form,defaults,options,'unique'),{initializeSub:function(){element.initialized.then(function(){$.each(form.elements,function(key,element){this.fieldAdded(element);}.bind(this));}.bind(this));},validate:function(){var val=this.data.element.getValue(),result;if(!!this.data.unique){result=validateElements(val);updateRelatedElements();return result;}else{throw'No option group set';}},update:function(){var val=this.data.element.getValue(),result;if(!!this.data.unique){result=validateElements(val);return result;}else{throw'No option group set';}},fieldAdded:function(element){if(element.$el!==this.$el&&isElementRelated(element,this.data.unique)){Util.debug('field added',this.$el);relatedElements.push(element);}},fieldRemoved:function(element){Util.debug('field removed',this.$el);relatedElements=relatedElements.splice(relatedElements.indexOf(element),1);}});result.initialize();return result;};});define('validator/equal',['validator/default'],function(Default){'use strict';return function($el,form,element,options){var defaults={equal:null},relatedElements=[],isElementRelated=function(element,group){return relatedElements.indexOf(element)&&!!element.options.validationEqual&&element.options.validationEqual===group;},validateElements=function(val){var result=true;$.each(relatedElements,function(key,element){if(!validateElement(val,element)){result=false;return false;}
return true;});return result;},validateElement=function(val,element){return val===element.getValue();},updateRelatedElements=function(){$.each(relatedElements,function(key,element){element.update();});},result=$.extend(new Default($el,form,defaults,options,'equal'),{initializeSub:function(){element.initialized.then(function(){$.each(form.elements,function(key,element){this.fieldAdded(element);}.bind(this));}.bind(this));},validate:function(){var val=this.$el.val(),result;if(!!this.data.equal){result=validateElements(val);updateRelatedElements();return result;}else{throw'No option group set';}},update:function(){var val=this.data.element.getValue(),result;if(!!this.data.equal){result=validateElements(val);return result;}else{throw'No option group set';}},fieldAdded:function(element){if(element.$el!==this.$el&&isElementRelated(element,this.data.equal)){relatedElements.push(element);}},fieldRemoved:function(element){relatedElements=relatedElements.splice(relatedElements.indexOf(element),1);}});result.initialize();return result;};});define('validator/regex',['validator/default'],function(Default){'use strict';return function($el,form,element,options){var defaults={regex:/\w*/},result=$.extend(new Default($el,form,defaults,options,'regex'),{validate:function(){var pattern=this.data.regex,regex=new RegExp(pattern),val=this.data.element.getValue();if(val===''){return true;}
return regex.test(val);}});result.initialize();return result;};});define("husky-validation",function(){});(function(window,undefined){var Globalize,regexHex,regexInfinity,regexParseFloat,regexTrim,arrayIndexOf,endsWith,extend,isArray,isFunction,isObject,startsWith,trim,truncate,zeroPad,appendPreOrPostMatch,expandFormat,formatDate,formatNumber,getTokenRegExp,getEra,getEraYear,parseExact,parseNegativePattern;Globalize=function(cultureSelector){return new Globalize.prototype.init(cultureSelector);};if(typeof require!=="undefined"&&typeof exports!=="undefined"&&typeof module!=="undefined"){module.exports=Globalize;}else{window.Globalize=Globalize;}
Globalize.cultures={};Globalize.prototype={constructor:Globalize,init:function(cultureSelector){this.cultures=Globalize.cultures;this.cultureSelector=cultureSelector;return this;}};Globalize.prototype.init.prototype=Globalize.prototype;Globalize.cultures["default"]={name:"en",englishName:"English",nativeName:"English",isRTL:false,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-","NaN":"NaN",negativeInfinity:"-Infinity",positiveInfinity:"Infinity",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{"name":"A.D.","start":null,"offset":0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy\u0027-\u0027MM\u0027-\u0027dd\u0027T\u0027HH\u0027:\u0027mm\u0027:\u0027ss"}}},messages:{}};Globalize.cultures["default"].calendar=Globalize.cultures["default"].calendars.standard;Globalize.cultures.en=Globalize.cultures["default"];Globalize.cultureSelector="en";regexHex=/^0x[a-f0-9]+$/i;regexInfinity=/^[+\-]?infinity$/i;regexParseFloat=/^[+\-]?\d*\.?\d*(e[+\-]?\d+)?$/;regexTrim=/^\s+|\s+$/g;arrayIndexOf=function(array,item){if(array.indexOf){return array.indexOf(item);}
for(var i=0,length=array.length;i<length;i++){if(array[i]===item){return i;}}
return-1;};endsWith=function(value,pattern){return value.substr(value.length-pattern.length)===pattern;};extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2;}
if(typeof target!=="object"&&!isFunction(target)){target={};}
for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue;}
if(deep&&copy&&(isObject(copy)||(copyIsArray=isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&isArray(src)?src:[];}else{clone=src&&isObject(src)?src:{};}
target[name]=extend(deep,clone,copy);}else if(copy!==undefined){target[name]=copy;}}}}
return target;};isArray=Array.isArray||function(obj){return Object.prototype.toString.call(obj)==="[object Array]";};isFunction=function(obj){return Object.prototype.toString.call(obj)==="[object Function]";};isObject=function(obj){return Object.prototype.toString.call(obj)==="[object Object]";};startsWith=function(value,pattern){return value.indexOf(pattern)===0;};trim=function(value){return(value+"").replace(regexTrim,"");};truncate=function(value){if(isNaN(value)){return NaN;}
return Math[value<0?"ceil":"floor"](value);};zeroPad=function(str,count,left){var l;for(l=str.length;l<count;l+=1){str=(left?("0"+str):(str+"0"));}
return str;};appendPreOrPostMatch=function(preMatch,strings){var quoteCount=0,escaped=false;for(var i=0,il=preMatch.length;i<il;i++){var c=preMatch.charAt(i);switch(c){case"\'":if(escaped){strings.push("\'");}
else{quoteCount++;}
escaped=false;break;case"\\":if(escaped){strings.push("\\");}
escaped=!escaped;break;default:strings.push(c);escaped=false;break;}}
return quoteCount;};expandFormat=function(cal,format){format=format||"F";var pattern,patterns=cal.patterns,len=format.length;if(len===1){pattern=patterns[format];if(!pattern){throw"Invalid date format string \'"+format+"\'.";}
format=pattern;}
else if(len===2&&format.charAt(0)==="%"){format=format.charAt(1);}
return format;};formatDate=function(value,format,culture){var cal=culture.calendar,convert=cal.convert,ret;if(!format||!format.length||format==="i"){if(culture&&culture.name.length){if(convert){ret=formatDate(value,cal.patterns.F,culture);}
else{var eraDate=new Date(value.getTime()),era=getEra(value,cal.eras);eraDate.setFullYear(getEraYear(value,cal,era));ret=eraDate.toLocaleString();}}
else{ret=value.toString();}
return ret;}
var eras=cal.eras,sortable=format==="s";format=expandFormat(cal,format);ret=[];var hour,zeros=["0","00","000"],foundDay,checkedDay,dayPartRegExp=/([^d]|^)(d|dd)([^d]|$)/g,quoteCount=0,tokenRegExp=getTokenRegExp(),converted;function padZeros(num,c){var r,s=num+"";if(c>1&&s.length<c){r=(zeros[c-2]+s);return r.substr(r.length-c,c);}
else{r=s;}
return r;}
function hasDay(){if(foundDay||checkedDay){return foundDay;}
foundDay=dayPartRegExp.test(format);checkedDay=true;return foundDay;}
function getPart(date,part){if(converted){return converted[part];}
switch(part){case 0:return date.getFullYear();case 1:return date.getMonth();case 2:return date.getDate();default:throw"Invalid part value "+part;}}
if(!sortable&&convert){converted=convert.fromGregorian(value);}
for(;;){var index=tokenRegExp.lastIndex,ar=tokenRegExp.exec(format);var preMatch=format.slice(index,ar?ar.index:format.length);quoteCount+=appendPreOrPostMatch(preMatch,ret);if(!ar){break;}
if(quoteCount%2){ret.push(ar[0]);continue;}
var current=ar[0],clength=current.length;switch(current){case"ddd":case"dddd":var names=(clength===3)?cal.days.namesAbbr:cal.days.names;ret.push(names[value.getDay()]);break;case"d":case"dd":foundDay=true;ret.push(padZeros(getPart(value,2),clength));break;case"MMM":case"MMMM":var part=getPart(value,1);ret.push((cal.monthsGenitive&&hasDay())?(cal.monthsGenitive[clength===3?"namesAbbr":"names"][part]):(cal.months[clength===3?"namesAbbr":"names"][part]));break;case"M":case"MM":ret.push(padZeros(getPart(value,1)+1,clength));break;case"y":case"yy":case"yyyy":part=converted?converted[0]:getEraYear(value,cal,getEra(value,eras),sortable);if(clength<4){part=part%100;}
ret.push(padZeros(part,clength));break;case"h":case"hh":hour=value.getHours()%12;if(hour===0)hour=12;ret.push(padZeros(hour,clength));break;case"H":case"HH":ret.push(padZeros(value.getHours(),clength));break;case"m":case"mm":ret.push(padZeros(value.getMinutes(),clength));break;case"s":case"ss":ret.push(padZeros(value.getSeconds(),clength));break;case"t":case"tt":part=value.getHours()<12?(cal.AM?cal.AM[0]:" "):(cal.PM?cal.PM[0]:" ");ret.push(clength===1?part.charAt(0):part);break;case"f":case"ff":case"fff":ret.push(padZeros(value.getMilliseconds(),3).substr(0,clength));break;case"z":case"zz":hour=value.getTimezoneOffset()/ 60;ret.push((hour<=0?"+":"-")+padZeros(Math.floor(Math.abs(hour)),clength));break;case"zzz":hour=value.getTimezoneOffset()/ 60;ret.push((hour<=0?"+":"-")+padZeros(Math.floor(Math.abs(hour)),2)+":"+padZeros(Math.abs(value.getTimezoneOffset()%60),2));break;case"g":case"gg":if(cal.eras){ret.push(cal.eras[getEra(value,eras)].name);}
break;case"/":ret.push(cal["/"]);break;default:throw"Invalid date format pattern \'"+current+"\'.";}}
return ret.join("");};(function(){var expandNumber;expandNumber=function(number,precision,formatInfo){var groupSizes=formatInfo.groupSizes,curSize=groupSizes[0],curGroupIndex=1,factor=Math.pow(10,precision),rounded=Math.round(number*factor)/ factor;if(!isFinite(rounded)){rounded=number;}
number=rounded;var numberString=number+"",right="",split=numberString.split(/e/i),exponent=split.length>1?parseInt(split[1],10):0;numberString=split[0];split=numberString.split(".");numberString=split[0];right=split.length>1?split[1]:"";var l;if(exponent>0){right=zeroPad(right,exponent,false);numberString+=right.slice(0,exponent);right=right.substr(exponent);}
else if(exponent<0){exponent=-exponent;numberString=zeroPad(numberString,exponent+1,true);right=numberString.slice(-exponent,numberString.length)+right;numberString=numberString.slice(0,-exponent);}
if(precision>0){right=formatInfo["."]+
((right.length>precision)?right.slice(0,precision):zeroPad(right,precision));}
else{right="";}
var stringIndex=numberString.length-1,sep=formatInfo[","],ret="";while(stringIndex>=0){if(curSize===0||curSize>stringIndex){return numberString.slice(0,stringIndex+1)+(ret.length?(sep+ret+right):right);}
ret=numberString.slice(stringIndex-curSize+1,stringIndex+1)+(ret.length?(sep+ret):"");stringIndex-=curSize;if(curGroupIndex<groupSizes.length){curSize=groupSizes[curGroupIndex];curGroupIndex++;}}
return numberString.slice(0,stringIndex+1)+sep+ret+right;};formatNumber=function(value,format,culture){if(!isFinite(value)){if(value===Infinity){return culture.numberFormat.positiveInfinity;}
if(value===-Infinity){return culture.numberFormat.negativeInfinity;}
return culture.numberFormat["NaN"];}
if(!format||format==="i"){return culture.name.length?value.toLocaleString():value.toString();}
format=format||"D";var nf=culture.numberFormat,number=Math.abs(value),precision=-1,pattern;if(format.length>1)precision=parseInt(format.slice(1),10);var current=format.charAt(0).toUpperCase(),formatInfo;switch(current){case"D":pattern="n";number=truncate(number);if(precision!==-1){number=zeroPad(""+number,precision,true);}
if(value<0)number="-"+number;break;case"N":formatInfo=nf;case"C":formatInfo=formatInfo||nf.currency;case"P":formatInfo=formatInfo||nf.percent;pattern=value<0?formatInfo.pattern[0]:(formatInfo.pattern[1]||"n");if(precision===-1)precision=formatInfo.decimals;number=expandNumber(number*(current==="P"?100:1),precision,formatInfo);break;default:throw"Bad number format specifier: "+current;}
var patternParts=/n|\$|-|%/g,ret="";for(;;){var index=patternParts.lastIndex,ar=patternParts.exec(pattern);ret+=pattern.slice(index,ar?ar.index:pattern.length);if(!ar){break;}
switch(ar[0]){case"n":ret+=number;break;case"$":ret+=nf.currency.symbol;break;case"-":if(/[1-9]/.test(number)){ret+=nf["-"];}
break;case"%":ret+=nf.percent.symbol;break;}}
return ret;};}());getTokenRegExp=function(){return(/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g);};getEra=function(date,eras){if(!eras)return 0;var start,ticks=date.getTime();for(var i=0,l=eras.length;i<l;i++){start=eras[i].start;if(start===null||ticks>=start){return i;}}
return 0;};getEraYear=function(date,cal,era,sortable){var year=date.getFullYear();if(!sortable&&cal.eras){year-=cal.eras[era].offset;}
return year;};(function(){var expandYear,getDayIndex,getMonthIndex,getParseRegExp,outOfRange,toUpper,toUpperArray;expandYear=function(cal,year){if(year<100){var now=new Date(),era=getEra(now),curr=getEraYear(now,cal,era),twoDigitYearMax=cal.twoDigitYearMax;twoDigitYearMax=typeof twoDigitYearMax==="string"?new Date().getFullYear()%100+parseInt(twoDigitYearMax,10):twoDigitYearMax;year+=curr-(curr%100);if(year>twoDigitYearMax){year-=100;}}
return year;};getDayIndex=function(cal,value,abbr){var ret,days=cal.days,upperDays=cal._upperDays;if(!upperDays){cal._upperDays=upperDays=[toUpperArray(days.names),toUpperArray(days.namesAbbr),toUpperArray(days.namesShort)];}
value=toUpper(value);if(abbr){ret=arrayIndexOf(upperDays[1],value);if(ret===-1){ret=arrayIndexOf(upperDays[2],value);}}
else{ret=arrayIndexOf(upperDays[0],value);}
return ret;};getMonthIndex=function(cal,value,abbr){var months=cal.months,monthsGen=cal.monthsGenitive||cal.months,upperMonths=cal._upperMonths,upperMonthsGen=cal._upperMonthsGen;if(!upperMonths){cal._upperMonths=upperMonths=[toUpperArray(months.names),toUpperArray(months.namesAbbr)];cal._upperMonthsGen=upperMonthsGen=[toUpperArray(monthsGen.names),toUpperArray(monthsGen.namesAbbr)];}
value=toUpper(value);var i=arrayIndexOf(abbr?upperMonths[1]:upperMonths[0],value);if(i<0){i=arrayIndexOf(abbr?upperMonthsGen[1]:upperMonthsGen[0],value);}
return i;};getParseRegExp=function(cal,format){var re=cal._parseRegExp;if(!re){cal._parseRegExp=re={};}
else{var reFormat=re[format];if(reFormat){return reFormat;}}
var expFormat=expandFormat(cal,format).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),regexp=["^"],groups=[],index=0,quoteCount=0,tokenRegExp=getTokenRegExp(),match;while((match=tokenRegExp.exec(expFormat))!==null){var preMatch=expFormat.slice(index,match.index);index=tokenRegExp.lastIndex;quoteCount+=appendPreOrPostMatch(preMatch,regexp);if(quoteCount%2){regexp.push(match[0]);continue;}
var m=match[0],len=m.length,add;switch(m){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":add="(\\D+)";break;case"tt":case"t":add="(\\D*)";break;case"yyyy":case"fff":case"ff":case"f":add="(\\d{"+len+"})";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":add="(\\d\\d?)";break;case"zzz":add="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":add="([+-]?\\d\\d?)";break;case"/":add="(\\/)";break;default:throw"Invalid date format pattern \'"+m+"\'.";}
if(add){regexp.push(add);}
groups.push(match[0]);}
appendPreOrPostMatch(expFormat.slice(index),regexp);regexp.push("$");var regexpStr=regexp.join("").replace(/\s+/g,"\\s+"),parseRegExp={"regExp":regexpStr,"groups":groups};return re[format]=parseRegExp;};outOfRange=function(value,low,high){return value<low||value>high;};toUpper=function(value){return value.split("\u00A0").join(" ").toUpperCase();};toUpperArray=function(arr){var results=[];for(var i=0,l=arr.length;i<l;i++){results[i]=toUpper(arr[i]);}
return results;};parseExact=function(value,format,culture){value=trim(value);var cal=culture.calendar,parseInfo=getParseRegExp(cal,format),match=new RegExp(parseInfo.regExp).exec(value);if(match===null){return null;}
var groups=parseInfo.groups,era=null,year=null,month=null,date=null,weekDay=null,hour=0,hourOffset,min=0,sec=0,msec=0,tzMinOffset=null,pmHour=false;for(var j=0,jl=groups.length;j<jl;j++){var matchGroup=match[j+1];if(matchGroup){var current=groups[j],clength=current.length,matchInt=parseInt(matchGroup,10);switch(current){case"dd":case"d":date=matchInt;if(outOfRange(date,1,31))return null;break;case"MMM":case"MMMM":month=getMonthIndex(cal,matchGroup,clength===3);if(outOfRange(month,0,11))return null;break;case"M":case"MM":month=matchInt-1;if(outOfRange(month,0,11))return null;break;case"y":case"yy":case"yyyy":year=clength<4?expandYear(cal,matchInt):matchInt;if(outOfRange(year,0,9999))return null;break;case"h":case"hh":hour=matchInt;if(hour===12)hour=0;if(outOfRange(hour,0,11))return null;break;case"H":case"HH":hour=matchInt;if(outOfRange(hour,0,23))return null;break;case"m":case"mm":min=matchInt;if(outOfRange(min,0,59))return null;break;case"s":case"ss":sec=matchInt;if(outOfRange(sec,0,59))return null;break;case"tt":case"t":pmHour=cal.PM&&(matchGroup===cal.PM[0]||matchGroup===cal.PM[1]||matchGroup===cal.PM[2]);if(!pmHour&&(!cal.AM||(matchGroup!==cal.AM[0]&&matchGroup!==cal.AM[1]&&matchGroup!==cal.AM[2])))return null;break;case"f":case"ff":case"fff":msec=matchInt*Math.pow(10,3-clength);if(outOfRange(msec,0,999))return null;break;case"ddd":case"dddd":weekDay=getDayIndex(cal,matchGroup,clength===3);if(outOfRange(weekDay,0,6))return null;break;case"zzz":var offsets=matchGroup.split(/:/);if(offsets.length!==2)return null;hourOffset=parseInt(offsets[0],10);if(outOfRange(hourOffset,-12,13))return null;var minOffset=parseInt(offsets[1],10);if(outOfRange(minOffset,0,59))return null;tzMinOffset=(hourOffset*60)+(startsWith(matchGroup,"-")?-minOffset:minOffset);break;case"z":case"zz":hourOffset=matchInt;if(outOfRange(hourOffset,-12,13))return null;tzMinOffset=hourOffset*60;break;case"g":case"gg":var eraName=matchGroup;if(!eraName||!cal.eras)return null;eraName=trim(eraName.toLowerCase());for(var i=0,l=cal.eras.length;i<l;i++){if(eraName===cal.eras[i].name.toLowerCase()){era=i;break;}}
if(era===null)return null;break;}}}
var result=new Date(),defaultYear,convert=cal.convert;defaultYear=convert?convert.fromGregorian(result)[0]:result.getFullYear();if(year===null){year=defaultYear;}
else if(cal.eras){year+=cal.eras[(era||0)].offset;}
if(month===null){month=0;}
if(date===null){date=1;}
if(convert){result=convert.toGregorian(year,month,date);if(result===null)return null;}
else{result.setFullYear(year,month,date);if(result.getDate()!==date)return null;if(weekDay!==null&&result.getDay()!==weekDay){return null;}}
if(pmHour&&hour<12){hour+=12;}
result.setHours(hour,min,sec,msec);if(tzMinOffset!==null){var adjustedMin=result.getMinutes()-(tzMinOffset+result.getTimezoneOffset());result.setHours(result.getHours()+parseInt(adjustedMin / 60,10),adjustedMin%60);}
return result;};}());parseNegativePattern=function(value,nf,negativePattern){var neg=nf["-"],pos=nf["+"],ret;switch(negativePattern){case"n -":neg=" "+neg;pos=" "+pos;case"n-":if(endsWith(value,neg)){ret=["-",value.substr(0,value.length-neg.length)];}
else if(endsWith(value,pos)){ret=["+",value.substr(0,value.length-pos.length)];}
break;case"- n":neg+=" ";pos+=" ";case"-n":if(startsWith(value,neg)){ret=["-",value.substr(neg.length)];}
else if(startsWith(value,pos)){ret=["+",value.substr(pos.length)];}
break;case"(n)":if(startsWith(value,"(")&&endsWith(value,")")){ret=["-",value.substr(1,value.length-2)];}
break;}
return ret||["",value];};Globalize.prototype.findClosestCulture=function(cultureSelector){return Globalize.findClosestCulture.call(this,cultureSelector);};Globalize.prototype.format=function(value,format,cultureSelector){return Globalize.format.call(this,value,format,cultureSelector);};Globalize.prototype.localize=function(key,cultureSelector){return Globalize.localize.call(this,key,cultureSelector);};Globalize.prototype.parseInt=function(value,radix,cultureSelector){return Globalize.parseInt.call(this,value,radix,cultureSelector);};Globalize.prototype.parseFloat=function(value,radix,cultureSelector){return Globalize.parseFloat.call(this,value,radix,cultureSelector);};Globalize.prototype.culture=function(cultureSelector){return Globalize.culture.call(this,cultureSelector);};Globalize.addCultureInfo=function(cultureName,baseCultureName,info){var base={},isNew=false;if(typeof cultureName!=="string"){info=cultureName;cultureName=this.culture().name;base=this.cultures[cultureName];}else if(typeof baseCultureName!=="string"){info=baseCultureName;isNew=(this.cultures[cultureName]==null);base=this.cultures[cultureName]||this.cultures["default"];}else{isNew=true;base=this.cultures[baseCultureName];}
this.cultures[cultureName]=extend(true,{},base,info);if(isNew){this.cultures[cultureName].calendar=this.cultures[cultureName].calendars.standard;}};Globalize.findClosestCulture=function(name){var match;if(!name){return this.findClosestCulture(this.cultureSelector)||this.cultures["default"];}
if(typeof name==="string"){name=name.split(",");}
if(isArray(name)){var lang,cultures=this.cultures,list=name,i,l=list.length,prioritized=[];for(i=0;i<l;i++){name=trim(list[i]);var pri,parts=name.split(";");lang=trim(parts[0]);if(parts.length===1){pri=1;}
else{name=trim(parts[1]);if(name.indexOf("q=")===0){name=name.substr(2);pri=parseFloat(name);pri=isNaN(pri)?0:pri;}
else{pri=1;}}
prioritized.push({lang:lang,pri:pri});}
prioritized.sort(function(a,b){if(a.pri<b.pri){return 1;}else if(a.pri>b.pri){return-1;}
return 0;});for(i=0;i<l;i++){lang=prioritized[i].lang;match=cultures[lang];if(match){return match;}}
for(i=0;i<l;i++){lang=prioritized[i].lang;do{var index=lang.lastIndexOf("-");if(index===-1){break;}
lang=lang.substr(0,index);match=cultures[lang];if(match){return match;}}
while(1);}
for(i=0;i<l;i++){lang=prioritized[i].lang;for(var cultureKey in cultures){var culture=cultures[cultureKey];if(culture.language==lang){return culture;}}}}
else if(typeof name==="object"){return name;}
return match||null;};Globalize.format=function(value,format,cultureSelector){var culture=this.findClosestCulture(cultureSelector);if(value instanceof Date){value=formatDate(value,format,culture);}
else if(typeof value==="number"){value=formatNumber(value,format,culture);}
return value;};Globalize.localize=function(key,cultureSelector){return this.findClosestCulture(cultureSelector).messages[key]||this.cultures["default"].messages[key];};Globalize.parseDate=function(value,formats,culture){culture=this.findClosestCulture(culture);var date,prop,patterns;if(formats){if(typeof formats==="string"){formats=[formats];}
if(formats.length){for(var i=0,l=formats.length;i<l;i++){var format=formats[i];if(format){date=parseExact(value,format,culture);if(date){break;}}}}}else{patterns=culture.calendar.patterns;for(prop in patterns){date=parseExact(value,patterns[prop],culture);if(date){break;}}}
return date||null;};Globalize.parseInt=function(value,radix,cultureSelector){return truncate(Globalize.parseFloat(value,radix,cultureSelector));};Globalize.parseFloat=function(value,radix,cultureSelector){if(typeof radix!=="number"){cultureSelector=radix;radix=10;}
var culture=this.findClosestCulture(cultureSelector);var ret=NaN,nf=culture.numberFormat;if(value.indexOf(culture.numberFormat.currency.symbol)>-1){value=value.replace(culture.numberFormat.currency.symbol,"");value=value.replace(culture.numberFormat.currency["."],culture.numberFormat["."]);}
if(value.indexOf(culture.numberFormat.percent.symbol)>-1){value=value.replace(culture.numberFormat.percent.symbol,"");}
value=value.replace(/ /g,"");if(regexInfinity.test(value)){ret=parseFloat(value);}
else if(!radix&&regexHex.test(value)){ret=parseInt(value,16);}
else{var signInfo=parseNegativePattern(value,nf,nf.pattern[0]),sign=signInfo[0],num=signInfo[1];if(sign===""&&nf.pattern[0]!=="(n)"){signInfo=parseNegativePattern(value,nf,"(n)");sign=signInfo[0];num=signInfo[1];}
if(sign===""&&nf.pattern[0]!=="-n"){signInfo=parseNegativePattern(value,nf,"-n");sign=signInfo[0];num=signInfo[1];}
sign=sign||"+";var exponent,intAndFraction,exponentPos=num.indexOf("e");if(exponentPos<0)exponentPos=num.indexOf("E");if(exponentPos<0){intAndFraction=num;exponent=null;}
else{intAndFraction=num.substr(0,exponentPos);exponent=num.substr(exponentPos+1);}
var integer,fraction,decSep=nf["."],decimalPos=intAndFraction.indexOf(decSep);if(decimalPos<0){integer=intAndFraction;fraction=null;}
else{integer=intAndFraction.substr(0,decimalPos);fraction=intAndFraction.substr(decimalPos+decSep.length);}
var groupSep=nf[","];integer=integer.split(groupSep).join("");var altGroupSep=groupSep.replace(/\u00A0/g," ");if(groupSep!==altGroupSep){integer=integer.split(altGroupSep).join("");}
var p=sign+integer;if(fraction!==null){p+="."+fraction;}
if(exponent!==null){var expSignInfo=parseNegativePattern(exponent,nf,"-n");p+="e"+(expSignInfo[0]||"+")+expSignInfo[1];}
if(regexParseFloat.test(p)){ret=parseFloat(p);}}
return ret;};Globalize.culture=function(cultureSelector){if(typeof cultureSelector!=="undefined"){this.cultureSelector=cultureSelector;}
return this.findClosestCulture(cultureSelector)||this.cultures["default"];};}(this));define("globalize_lib",function(){});(function(){if(!window.CKEDITOR||!window.CKEDITOR.dom)window.CKEDITOR||(window.CKEDITOR=function(){var a=/(^|.*[\\\/])ckeditor\.js(?:\?.*|;.*)?$/i,e={timestamp:"F0RF",version:"4.4.7 (Standard)",revision:"3a35b3d",rnd:Math.floor(900*Math.random())+100,_:{pending:[],basePathSrcPattern:a},status:"unloaded",basePath:function(){var c=window.CKEDITOR_BASEPATH||"";if(!c)for(var d=document.getElementsByTagName("script"),b=0;b<d.length;b++){var f=d[b].src.match(a);if(f){c=f[1];break}}-1==c.indexOf(":/")&&"//"!=c.slice(0,2)&&(c=0===c.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+c:location.href.match(/^[^\?]*\/(?:)/)[0]+c);if(!c)throw'The CKEditor installation path could not be automatically detected. Please set the global variable "CKEDITOR_BASEPATH" before creating editor instances.';return c}(),getUrl:function(a){-1==a.indexOf(":/")&&0!==a.indexOf("/")&&(a=this.basePath+a);this.timestamp&&("/"!=a.charAt(a.length-1)&&!/[&?]t=/.test(a))&&(a+=(0<=a.indexOf("?")?"&":"?")+"t="+this.timestamp);return a},domReady:function(){function a(){try{document.addEventListener?(document.removeEventListener("DOMContentLoaded",a,!1),d()):document.attachEvent&&"complete"===document.readyState&&(document.detachEvent("onreadystatechange",a),d())}catch(b){}}function d(){for(var a;a=b.shift();)a()}var b=[];return function(d){function g(){try{document.documentElement.doScroll("left")}catch(k){setTimeout(g,1);return}a()}b.push(d);"complete"===document.readyState&&setTimeout(a,1);if(1==b.length)if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",a,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",a);window.attachEvent("onload",a);d=!1;try{d=!window.frameElement}catch(e){}document.documentElement.doScroll&&d&&g()}}}()},b=window.CKEDITOR_GETURL;if(b){var g=e.getUrl;e.getUrl=function(a){return b.call(e,a)||g.call(e,a)}}return e}()),CKEDITOR.event||(CKEDITOR.event=function(){},CKEDITOR.event.implementOn=function(a){var e=CKEDITOR.event.prototype,b;for(b in e)a[b]==null&&(a[b]=e[b])},CKEDITOR.event.prototype=function(){function a(a){var c=e(this);return c[a]||(c[a]=new b(a))}var e=function(a){a=a.getPrivate&&a.getPrivate()||a._||(a._={});return a.events||(a.events={})},b=function(a){this.name=a;this.listeners=[]};b.prototype={getListenerIndex:function(a){for(var c=0,d=this.listeners;c<d.length;c++)if(d[c].fn==a)return c;return-1}};return{define:function(b,c){var d=a.call(this,b);CKEDITOR.tools.extend(d,c,true)},on:function(b,c,d,j,f){function h(a,k,f,h){a={name:b,sender:this,editor:a,data:k,listenerData:j,stop:f,cancel:h,removeListener:e};return c.call(d,a)===false?false:a.data}function e(){n.removeListener(b,c)}var k=a.call(this,b);if(k.getListenerIndex(c)<0){k=k.listeners;d||(d=this);isNaN(f)&&(f=10);var n=this;h.fn=c;h.priority=f;for(var o=k.length-1;o>=0;o--)if(k[o].priority<=f){k.splice(o+1,0,h);return{removeListener:e}}k.unshift(h)}return{removeListener:e}},once:function(){var a=Array.prototype.slice.call(arguments),c=a[1];a[1]=function(a){a.removeListener();return c.apply(this,arguments)};return this.on.apply(this,a)},capture:function(){CKEDITOR.event.useCapture=1;var a=this.on.apply(this,arguments);CKEDITOR.event.useCapture=0;return a},fire:function(){var a=0,c=function(){a=1},d=0,b=function(){d=1};return function(f,h,i){var k=e(this)[f],f=a,n=d;a=d=0;if(k){var o=k.listeners;if(o.length)for(var o=o.slice(0),q,m=0;m<o.length;m++){if(k.errorProof)try{q=o[m].call(this,i,h,c,b)}catch(l){}else q=o[m].call(this,i,h,c,b);q===false?d=1:typeof q!="undefined"&&(h=q);if(a||d)break}}h=d?false:typeof h=="undefined"?true:h;a=f;d=n;return h}}(),fireOnce:function(a,c,d){c=this.fire(a,c,d);delete e(this)[a];return c},removeListener:function(a,c){var d=e(this)[a];if(d){var b=d.getListenerIndex(c);b>=0&&d.listeners.splice(b,1)}},removeAllListeners:function(){var a=e(this),c;for(c in a)delete a[c]},hasListeners:function(a){return(a=e(this)[a])&&a.listeners.length>0}}}()),CKEDITOR.editor||(CKEDITOR.editor=function(){CKEDITOR._.pending.push([this,arguments]);CKEDITOR.event.call(this)},CKEDITOR.editor.prototype.fire=function(a,e){a in{instanceReady:1,loaded:1}&&(this[a]=true);return CKEDITOR.event.prototype.fire.call(this,a,e,this)},CKEDITOR.editor.prototype.fireOnce=function(a,e){a in{instanceReady:1,loaded:1}&&(this[a]=true);return CKEDITOR.event.prototype.fireOnce.call(this,a,e,this)},CKEDITOR.event.implementOn(CKEDITOR.editor.prototype)),CKEDITOR.env||(CKEDITOR.env=function(){var a=navigator.userAgent.toLowerCase(),e={ie:a.indexOf("trident/")>-1,webkit:a.indexOf(" applewebkit/")>-1,air:a.indexOf(" adobeair/")>-1,mac:a.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"&&(!document.documentMode||document.documentMode<10),mobile:a.indexOf("mobile")>-1,iOS:/(ipad|iphone|ipod)/.test(a),isCustomDomain:function(){if(!this.ie)return false;var a=document.domain,d=window.location.hostname;return a!=d&&a!="["+d+"]"},secure:location.protocol=="https:"};e.gecko=navigator.product=="Gecko"&&!e.webkit&&!e.ie;if(e.webkit)a.indexOf("chrome")>-1?e.chrome=true:e.safari=true;var b=0;if(e.ie){b=e.quirks||!document.documentMode?parseFloat(a.match(/msie (\d+)/)[1]):document.documentMode;e.ie9Compat=b==9;e.ie8Compat=b==8;e.ie7Compat=b==7;e.ie6Compat=b<7||e.quirks}if(e.gecko){var g=a.match(/rv:([\d\.]+)/);if(g){g=g[1].split(".");b=g[0]*1E4+(g[1]||0)*100+(g[2]||0)*1}}e.air&&(b=parseFloat(a.match(/ adobeair\/(\d+)/)[1]));e.webkit&&(b=parseFloat(a.match(/ applewebkit\/(\d+)/)[1]));e.version=b;e.isCompatible=e.iOS&&b>=534||!e.mobile&&(e.ie&&b>6||e.gecko&&b>=2E4||e.air&&b>=1||e.webkit&&b>=522||false);e.hidpi=window.devicePixelRatio>=2;e.needsBrFiller=e.gecko||e.webkit||e.ie&&b>10;e.needsNbspFiller=e.ie&&b<11;e.cssClass="cke_browser_"+(e.ie?"ie":e.gecko?"gecko":e.webkit?"webkit":"unknown");if(e.quirks)e.cssClass=e.cssClass+" cke_browser_quirks";if(e.ie)e.cssClass=e.cssClass+(" cke_browser_ie"+(e.quirks?"6 cke_browser_iequirks":e.version));if(e.air)e.cssClass=e.cssClass+" cke_browser_air";if(e.iOS)e.cssClass=e.cssClass+" cke_browser_ios";if(e.hidpi)e.cssClass=e.cssClass+" cke_hidpi";return e}()),"unloaded"==CKEDITOR.status&&function(){CKEDITOR.event.implementOn(CKEDITOR);CKEDITOR.loadFullCore=function(){if(CKEDITOR.status!="basic_ready")CKEDITOR.loadFullCore._load=1;else{delete CKEDITOR.loadFullCore;var a=document.createElement("script");a.type="text/javascript";a.src=CKEDITOR.basePath+"ckeditor.js";document.getElementsByTagName("head")[0].appendChild(a)}};CKEDITOR.loadFullCoreTimeout=0;CKEDITOR.add=function(a){(this._.pending||(this._.pending=[])).push(a)};(function(){CKEDITOR.domReady(function(){var a=CKEDITOR.loadFullCore,e=CKEDITOR.loadFullCoreTimeout;if(a){CKEDITOR.status="basic_ready";a&&a._load?a():e&&setTimeout(function(){CKEDITOR.loadFullCore&&CKEDITOR.loadFullCore()},e*1E3)}})})();CKEDITOR.status="basic_loaded"}(),CKEDITOR.dom={},function(){var a=[],e=CKEDITOR.env.gecko?"-moz-":CKEDITOR.env.webkit?"-webkit-":CKEDITOR.env.ie?"-ms-":"",b=/&/g,g=/>/g,c=/</g,d=/"/g,j=/&amp;/g,f=/&gt;/g,h=/&lt;/g,i=/&quot;/g;CKEDITOR.on("reset",function(){a=[]});CKEDITOR.tools={arrayCompare:function(a,c){if(!a&&!c)return true;if(!a||!c||a.length!=c.length)return false;for(var d=0;d<a.length;d++)if(a[d]!=c[d])return false;return true},clone:function(a){var c;if(a&&a instanceof Array){c=[];for(var d=0;d<a.length;d++)c[d]=CKEDITOR.tools.clone(a[d]);return c}if(a===null||typeof a!="object"||a instanceof String||a instanceof Number||a instanceof Boolean||a instanceof Date||a instanceof RegExp||a.nodeType||a.window===a)return a;c=new a.constructor;for(d in a)c[d]=CKEDITOR.tools.clone(a[d]);return c},capitalize:function(a,c){return a.charAt(0).toUpperCase()+(c?a.slice(1):a.slice(1).toLowerCase())},extend:function(a){var c=arguments.length,d,b;if(typeof(d=arguments[c-1])=="boolean")c--;else if(typeof(d=arguments[c-2])=="boolean"){b=arguments[c-1];c=c-2}for(var f=1;f<c;f++){var g=arguments[f],j;for(j in g)if(d===true||a[j]==null)if(!b||j in b)a[j]=g[j]}return a},prototypedCopy:function(a){var c=function(){};c.prototype=a;return new c},copy:function(a){var c={},d;for(d in a)c[d]=a[d];return c},isArray:function(a){return Object.prototype.toString.call(a)=="[object Array]"},isEmpty:function(a){for(var c in a)if(a.hasOwnProperty(c))return false;return true},cssVendorPrefix:function(a,c,d){if(d)return e+a+":"+c+";"+a+":"+c;d={};d[a]=c;d[e+a]=c;return d},cssStyleToDomStyle:function(){var a=document.createElement("div").style,c=typeof a.cssFloat!="undefined"?"cssFloat":typeof a.styleFloat!="undefined"?"styleFloat":"float";return function(a){return a=="float"?c:a.replace(/-./g,function(a){return a.substr(1).toUpperCase()})}}(),buildStyleHtml:function(a){for(var a=[].concat(a),c,d=[],b=0;b<a.length;b++)if(c=a[b])/@import|[{}]/.test(c)?d.push("<style>"+
c+"</style>"):d.push('<link type="text/css" rel=stylesheet href="'+c+'">');return d.join("")},htmlEncode:function(a){return(""+a).replace(b,"&amp;").replace(g,"&gt;").replace(c,"&lt;")},htmlDecode:function(a){return a.replace(j,"&").replace(f,">").replace(h,"<")},htmlEncodeAttr:function(a){return a.replace(d,"&quot;").replace(c,"&lt;").replace(g,"&gt;")},htmlDecodeAttr:function(a){return a.replace(i,'"').replace(h,"<").replace(f,">")},getNextNumber:function(){var a=0;return function(){return++a}}(),getNextId:function(){return"cke_"+this.getNextNumber()},override:function(a,c){var d=c(a);d.prototype=a.prototype;return d},setTimeout:function(a,c,d,b,f){f||(f=window);d||(d=f);return f.setTimeout(function(){b?a.apply(d,[].concat(b)):a.apply(d)},c||0)},trim:function(){var a=/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g;return function(c){return c.replace(a,"")}}(),ltrim:function(){var a=/^[ \t\n\r]+/g;return function(c){return c.replace(a,"")}}(),rtrim:function(){var a=/[ \t\n\r]+$/g;return function(c){return c.replace(a,"")}}(),indexOf:function(a,c){if(typeof c=="function")for(var d=0,b=a.length;d<b;d++){if(c(a[d]))return d}else{if(a.indexOf)return a.indexOf(c);d=0;for(b=a.length;d<b;d++)if(a[d]===c)return d}return-1},search:function(a,c){var d=CKEDITOR.tools.indexOf(a,c);return d>=0?a[d]:null},bind:function(a,c){return function(){return a.apply(c,arguments)}},createClass:function(a){var c=a.$,d=a.base,b=a.privates||a._,f=a.proto,a=a.statics;!c&&(c=function(){d&&this.base.apply(this,arguments)});if(b)var g=c,c=function(){var a=this._||(this._={}),c;for(c in b){var d=b[c];a[c]=typeof d=="function"?CKEDITOR.tools.bind(d,this):d}g.apply(this,arguments)};if(d){c.prototype=this.prototypedCopy(d.prototype);c.prototype.constructor=c;c.base=d;c.baseProto=d.prototype;c.prototype.base=function(){this.base=d.prototype.base;d.apply(this,arguments);this.base=arguments.callee}}f&&this.extend(c.prototype,f,true);a&&this.extend(c,a,true);return c},addFunction:function(c,d){return a.push(function(){return c.apply(d||this,arguments)})-1},removeFunction:function(c){a[c]=null},callFunction:function(c){var d=a[c];return d&&d.apply(window,Array.prototype.slice.call(arguments,1))},cssLength:function(){var a=/^-?\d+\.?\d*px$/,c;return function(d){c=CKEDITOR.tools.trim(d+"")+"px";return a.test(c)?c:d||""}}(),convertToPx:function(){var a;return function(c){if(!a){a=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;margin:0px;padding:0px;border:0px;"></div>',CKEDITOR.document);CKEDITOR.document.getBody().append(a)}if(!/%$/.test(c)){a.setStyle("width",c);return a.$.clientWidth}return c}}(),repeat:function(a,c){return Array(c+1).join(a)},tryThese:function(){for(var a,c=0,d=arguments.length;c<d;c++){var b=arguments[c];try{a=b();break}catch(f){}}return a},genKey:function(){return Array.prototype.slice.call(arguments).join("-")},defer:function(a){return function(){var c=arguments,d=this;window.setTimeout(function(){a.apply(d,c)},0)}},normalizeCssText:function(a,c){var d=[],b,f=CKEDITOR.tools.parseCssText(a,true,c);for(b in f)d.push(b+":"+f[b]);d.sort();return d.length?d.join(";")+";":""},convertRgbToHex:function(a){return a.replace(/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi,function(a,c,d,b){a=[c,d,b];for(c=0;c<3;c++)a[c]=("0"+parseInt(a[c],10).toString(16)).slice(-2);return"#"+a.join("")})},parseCssText:function(a,c,d){var b={};if(d){d=new CKEDITOR.dom.element("span");d.setAttribute("style",a);a=CKEDITOR.tools.convertRgbToHex(d.getAttribute("style")||"")}if(!a||a==";")return b;a.replace(/&quot;/g,'"').replace(/\s*([^:;\s]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(a,d,f){if(c){d=d.toLowerCase();d=="font-family"&&(f=f.toLowerCase().replace(/["']/g,"").replace(/\s*,\s*/g,","));f=CKEDITOR.tools.trim(f)}b[d]=f});return b},writeCssText:function(a,c){var d,b=[];for(d in a)b.push(d+":"+a[d]);c&&b.sort();return b.join("; ")},objectCompare:function(a,c,d){var b;if(!a&&!c)return true;if(!a||!c)return false;for(b in a)if(a[b]!=c[b])return false;if(!d)for(b in c)if(a[b]!=c[b])return false;return true},objectKeys:function(a){var c=[],d;for(d in a)c.push(d);return c},convertArrayToObject:function(a,c){var d={};arguments.length==1&&(c=true);for(var b=0,f=a.length;b<f;++b)d[a[b]]=c;return d},fixDomain:function(){for(var a;;)try{a=window.parent.document.domain;break}catch(c){a=a?a.replace(/.+?(?:\.|$)/,""):document.domain;if(!a)break;document.domain=a}return!!a},eventsBuffer:function(a,c){function d(){f=(new Date).getTime();b=false;c()}var b,f=0;return{input:function(){if(!b){var c=(new Date).getTime()-f;c<a?b=setTimeout(d,a-c):d()}},reset:function(){b&&clearTimeout(b);b=f=0}}},enableHtml5Elements:function(a,c){for(var d=["abbr","article","aside","audio","bdi","canvas","data","datalist","details","figcaption","figure","footer","header","hgroup","mark","meter","nav","output","progress","section","summary","time","video"],b=d.length,f;b--;){f=a.createElement(d[b]);c&&a.appendChild(f)}},checkIfAnyArrayItemMatches:function(a,c){for(var d=0,b=a.length;d<b;++d)if(a[d].match(c))return true;return false},checkIfAnyObjectPropertyMatches:function(a,c){for(var d in a)if(d.match(c))return true;return false},transparentImageData:"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="}}(),CKEDITOR.dtd=function(){var a=CKEDITOR.tools.extend,e=function(a,c){for(var d=CKEDITOR.tools.clone(a),b=1;b<arguments.length;b++){var c=arguments[b],f;for(f in c)delete d[f]}return d},b={},g={},c={address:1,article:1,aside:1,blockquote:1,details:1,div:1,dl:1,fieldset:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,menu:1,nav:1,ol:1,p:1,pre:1,section:1,table:1,ul:1},d={command:1,link:1,meta:1,noscript:1,script:1,style:1},j={},f={"#":1},h={center:1,dir:1,noframes:1};a(b,{a:1,abbr:1,area:1,audio:1,b:1,bdi:1,bdo:1,br:1,button:1,canvas:1,cite:1,code:1,command:1,datalist:1,del:1,dfn:1,em:1,embed:1,i:1,iframe:1,img:1,input:1,ins:1,kbd:1,keygen:1,label:1,map:1,mark:1,meter:1,noscript:1,object:1,output:1,progress:1,q:1,ruby:1,s:1,samp:1,script:1,select:1,small:1,span:1,strong:1,sub:1,sup:1,textarea:1,time:1,u:1,"var":1,video:1,wbr:1},f,{acronym:1,applet:1,basefont:1,big:1,font:1,isindex:1,strike:1,style:1,tt:1});a(g,c,b,h);e={a:e(b,{a:1,button:1}),abbr:b,address:g,area:j,article:g,aside:g,audio:a({source:1,track:1},g),b:b,base:j,bdi:b,bdo:b,blockquote:g,body:g,br:j,button:e(b,{a:1,button:1}),canvas:b,caption:g,cite:b,code:b,col: j,colgroup:{col:1},command:j,datalist:a({option:1},b),dd:g,del:b,details:a({summary:1},g),dfn:b,div:g,dl:{dt:1,dd:1},dt:g,em:b,embed:j,fieldset:a({legend:1},g),figcaption:g,figure:a({figcaption:1},g),footer:g,form:g,h1:b,h2:b,h3:b,h4:b,h5:b,h6:b,head:a({title:1,base:1},d),header:g,hgroup:{h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},hr:j,html:a({head:1,body:1},g,d),i:b,iframe:f,img:j,input:j,ins:b,kbd:b,keygen:j,label:b,legend:b,li:g,link:j,main:g,map:g,mark:b,menu:a({li:1},g),meta:j,meter:e(b,{meter:1}),nav:g,noscript:a({link:1,meta:1,style:1},b),object:a({param:1},b),ol:{li:1},optgroup:{option:1},option:f,output:b,p:b,param:j,pre:b,progress:e(b,{progress:1}),q:b,rp:b,rt:b,ruby:a({rp:1,rt:1},b),s:b,samp:b,script:f,section:g,select:{optgroup:1,option:1},small:b,source:j,span:b,strong:b,style:f,sub:b,summary:b,sup:b,table:{caption:1,colgroup:1,thead:1,tfoot:1,tbody:1,tr:1},tbody:{tr:1},td:g,textarea:f,tfoot:{tr:1},th:g,thead:{tr:1},time:e(b,{time:1}),title:f,tr:{th:1,td:1},track:j,u:b,ul:{li:1},"var ":b,video:a({source:1,track:1},g),wbr:j,acronym:b,applet:a({param:1},g),basefont:j,big:b,center:g,dialog:j,dir:{li:1},font:b,isindex:j,noframes:g,strike:b,tt:b};a(e,{$block:a({audio:1,dd:1,dt:1,figcaption:1,li:1,video:1},c,h),$blockLimit:{article:1,aside:1,audio:1,body:1,caption:1,details:1,dir:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,header:1,hgroup:1,main:1,menu:1,nav:1,ol:1,section:1,table:1,td:1,th:1,tr:1,ul:1,video:1},$cdata:{script:1,style:1},$editable:{address:1,article:1,aside:1,blockquote:1,body:1,details:1,div:1,fieldset:1,figcaption:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,main:1,nav:1,p:1,pre:1,section:1},$empty:{area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},$inline:b,$list:{dl:1,ol:1,ul:1},$listItem:{dd:1,dt:1,li:1},$nonBodyContent:a({body:1,head:1,html:1},e.head),$nonEditable:{applet:1,audio:1,button:1,embed:1,iframe:1,map:1,o bject:1,option:1,param:1,script:1,textarea:1,video:1},$object:{applet:1,audio:1,button:1,hr:1,iframe:1,img:1,input:1,object:1,select:1,table:1,textarea:1,video:1},$removeEmpty:{abbr:1,acronym:1,b:1,bdi:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,mark:1,meter:1,output:1,q:1,ruby:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,time:1,tt:1,u:1,"var":1},$tabIndex:{a:1,area:1,button:1,input:1,object:1,select:1,textarea:1},$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},$transparent:{a:1,audio:1,canvas:1,del:1,ins:1,map:1,noscript:1,object:1,video:1},$intermediate:{caption:1,colgroup:1,dd:1,dt:1,figcaption:1,legend:1,li:1,optgroup:1,option:1,rp:1,rt:1,summary:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1}});return e}(),CKEDITOR.dom.event=function(a){this.$=a},CKEDITOR.dom.event.prototype={getKey:function(){return this.$.keyCode||this.$.which},getKeystroke:function(){var a=this.getKey();if(this.$.ctrlKey||this.$.metaKey)a=a+CKEDITOR.CTRL;this.$.shiftKey&&(a=a+CKEDITOR.SHIFT);this.$.altKey&&(a=a+CKEDITOR.ALT);return a},preventDefault:function(a){var e=this.$;e.preventDefault?e.preventDefault():e.returnValue=false;a&&this.stopPropagation()},stopPropagation:function(){var a=this.$;a.stopPropagation?a.stopPropagation():a.cancelBubble=true},getTarget:function(){var a=this.$.target||this.$.srcElement;return a?new CKEDITOR.dom.node(a):null},getPhase:function(){return this.$.eventPhase||2},getPageOffset:function(){var a=this.getTarget().getDocument().$;return{x:this.$.pageX||this.$.clientX+(a.documentElement.scrollLeft||a.body.scrollLeft),y:this.$.pageY||this.$.clientY+(a.documentElement.scrollTop||a.body.scrollTop)}}},CKEDITOR.CTRL=1114112,CKEDITOR.SHIFT=2228224,CKEDITOR.ALT=4456448,CKEDITOR.EVENT_PHASE_CAPTURING=1,CKEDITOR.EVENT_PHASE_AT_TARGET=2,CKEDITOR.EVENT_PHASE_BUBBLING=3,CKEDITOR.dom.domObject=function(a){if(a)this.$=a},CKEDITOR.dom.domObject.prototype=function(){var a=function(a,b){return function(g){typeof CKEDITOR!="undefined"&&a.fire(b,new CKEDITOR.dom.event(g))}};return{getPrivate:function(){var a;if(!(a=this.getCustomData("_")))this.setCustomData("_",a={});return a},on:function(e){var b=this.getCustomData("_cke_nativeListeners");if(!b){b={};this.setCustomData("_cke_nativeListeners",b)}if(!b[e]){b=b[e]=a(this,e);this.$.addEventListener?this.$.addEventListener(e,b,!!CKEDITOR.event.useCapture):this.$.attachEvent&&this.$.attachEvent("on"+e,b)}return CKEDITOR.event.prototype.on.apply(this,arguments)},removeListener:function(a){CKEDITOR.event.prototype.removeListener.apply(this,arguments);if(!this.hasListeners(a)){var b=this.getCustomData("_cke_nativeListeners"),g=b&&b[a];if(g){this.$.removeEventListener?this.$.removeEventListener(a,g,false):this.$.detachEvent&&this.$.detachEvent("on"+
a,g);delete b[a]}}},removeAllListeners:function(){var a=this.getCustomData("_cke_nativeListeners"),b;for(b in a){var g=a[b];this.$.detachEvent?this.$.detachEvent("on"+b,g):this.$.removeEventListener&&this.$.removeEventListener(b,g,false);delete a[b]}CKEDITOR.event.prototype.removeAllListeners.call(this)}}}(),function(a){var e={};CKEDITOR.on("reset",function(){e={}});a.equals=function(a){try{return a&&a.$===this.$}catch(g){return false}};a.setCustomData=function(a,g){var c=this.getUniqueId();(e[c]||(e[c]={}))[a]=g;return this};a.getCustomData=function(a){var g=this.$["data-cke-expando"];return(g=g&&e[g])&&a in g?g[a]:null};a.removeCustomData=function(a){var g=this.$["data-cke-expando"],g=g&&e[g],c,d;if(g){c=g[a];d=a in g;delete g[a]}return d?c:null};a.clearCustomData=function(){this.removeAllListeners();var a=this.$["data-cke-expando"];a&&delete e[a]};a.getUniqueId=function(){return this.$["data-cke-expando"]||(this.$["data-cke-expando"]=CKEDITOR.tools.getNextNumber())};CKEDITOR.event.implementOn(a)}(CKEDITOR.dom.domObject.prototype),CKEDITOR.dom.node=function(a){return a?new CKEDITOR.dom[a.nodeType==CKEDITOR.NODE_DOCUMENT?"document":a.nodeType==CKEDITOR.NODE_ELEMENT?"element":a.nodeType==CKEDITOR.NODE_TEXT?"text":a.nodeType==CKEDITOR.NODE_COMMENT?"comment":a.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT?"documentFragment":"domObject"](a):this},CKEDITOR.dom.node.prototype=new CKEDITOR.dom.domObject,CKEDITOR.NODE_ELEMENT=1,CKEDITOR.NODE_DOCUMENT=9,CKEDITOR.NODE_TEXT=3,CKEDITOR.NODE_COMMENT=8,CKEDITOR.NODE_DOCUMENT_FRAGMENT=11,CKEDITOR.POSITION_IDENTICAL=0,CKEDITOR.POSITION_DISCONNECTED=1,CKEDITOR.POSITION_FOLLOWING=2,CKEDITOR.POSITION_PRECEDING=4,CKEDITOR.POSITION_IS_CONTAINED=8,CKEDITOR.POSITION_CONTAINS=16,CKEDITOR.tools.extend(CKEDITOR.dom.node.prototype,{appendTo:function(a,e){a.append(this,e);return a},clone:function(a,e){var b=this.$.cloneNode(a),g=function(c){c["data-cke-expando"]&&(c["data-cke-expando"]=false);if(c.nodeType==CKEDITOR.NODE_ELEMENT){e||c.removeAttribute("id",false);if(a)for(var c=c.childNodes,d=0;d<c.length;d++)g(c[d])}};g(b);return new CKEDITOR.dom.node(b)},hasPrevious:function(){return!!this.$.previousSibling},hasNext:function(){return!!this.$.nextSibling},insertAfter:function(a){a.$.parentNode.insertBefore(this.$,a.$.nextSibling);return a},insertBefore:function(a){a.$.parentNode.insertBefore(this.$,a.$);return a},insertBeforeMe:function(a){this.$.parentNode.insertBefore(a.$,this.$);return a},getAddress:function(a){for(var e=[],b=this.getDocument().$.documentElement,g=this.$;g&&g!=b;){var c=g.parentNode;c&&e.unshift(this.getIndex.call({$:g},a));g=c}return e},getDocument:function(){return new CKEDITOR.dom.document(this.$.ownerDocument||this.$.parentNode.ownerDocument)},getIndex:function(a){function e(a,c){var b=c?a.nextSibling:a.previousSibling;return!b||b.nodeType!=CKEDITOR.NODE_TEXT?null:b.nodeValue?b:e(b,c)}var b=this.$,g=-1,c;if(!this.$.parentNode||a&&b.nodeType==CKEDITOR.NODE_TEXT&&!b.nodeValue&&!e(b)&&!e(b,true))return-1;do if(!a||!(b!=this.$&&b.nodeType==CKEDITOR.NODE_TEXT&&(c||!b.nodeValue))){g++;c=b.nodeType==CKEDITOR.NODE_TEXT}while(b=b.previousSibling);return g},getNextSourceNode:function(a,e,b){if(b&&!b.call)var g=b,b=function(a){return!a.equals(g)};var a=!a&&this.getFirst&&this.getFirst(),c;if(!a){if(this.type==CKEDITOR.NODE_ELEMENT&&b&&b(this,true)===false)return null;a=this.getNext()}for(;!a&&(c=(c||this).getParent());){if(b&&b(c,true)===false)return null;a=c.getNext()}return!a||b&&b(a)===false?null:e&&e!=a.type?a.getNextSourceNode(false,e,b):a},getPreviousSourceNode:function(a,e,b){if(b&&!b.call)var g=b,b=function(a){return!a.equals(g)};var a=!a&&this.getLast&&this.getLast(),c;if(!a){if(this.type==CKEDITOR.NODE_ELEMENT&&b&&b(this,true)===false)return null;a=this.getPrevious()}for(;!a&&(c=(c||this).getParent());){if(b&&b(c,true)===false)return null;a=c.getPrevious()}return!a||b&&b(a)===false?null:e&&a.type!=e?a.getPreviousSourceNode(false,e,b):a},getPrevious:function(a){var e=this.$,b;do b=(e=e.previousSibling)&&e.nodeType!=10&&new CKEDITOR.dom.node(e);while(b&&a&&!a(b));return b},getNext:function(a){var e=this.$,b;do b=(e=e.nextSibling)&&new CKEDITOR.dom.node(e);while(b&&a&&!a(b));return b},getParent:function(a){var e=this.$.parentNode;return e&&(e.nodeType==CKEDITOR.NODE_ELEMENT||a&&e.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)?new CKEDITOR.dom.node(e):null},getParents:function(a){var e=this,b=[];do b[a?"push":"unshift"](e);while(e=e.getParent());return b},getCommonAncestor:function(a){if(a.equals(this))return this;if(a.contains&&a.contains(this))return a;var e=this.contains?this:this.getParent();do if(e.contains(a))return e;while(e=e.getParent());return null},getPosition:function(a){var e=this.$,b=a.$;if(e.compareDocumentPosition)return e.compareDocumentPosition(b);if(e==b)return CKEDITOR.POSITION_IDENTICAL;if(this.type==CKEDITOR.NODE_ELEMENT&&a.type==CKEDITOR.NODE_ELEMENT){if(e.contains){if(e.contains(b))return CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING;if(b.contains(e))return CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING}if("sourceIndex"in e)return e.sourceIndex<0||b.sourceIndex<0?CKEDITOR.POSITION_DISCONNECTED:e.sourceIndex<b.sourceIndex?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING}for(var e=this.getAddress(),a=a.getAddress(),b=Math.min(e.length,a.length),g=0;g<=b-1;g++)if(e[g]!=a[g]){if(g<b)return e[g]<a[g]?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING;break}return e.length<a.length?CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING},getAscendant:function(a,e){var b=this.$,g,c;if(!e)b=b.parentNode;if(typeof a=="function"){c=true;g=a}else{c=false;g=function(c){c=typeof c.nodeName=="string"?c.nodeName.toLowerCase():"";return typeof a=="string"?c==a:c in a}}for(;b;){if(g(c?new CKEDITOR.dom.node(b):b))return new CKEDITOR.dom.node(b);try{b=b.parentNode}catch(d){b=null}}return null},hasAscendant:function(a,e){var b=this.$;if(!e)b=b.parentNode;for(;b;){if(b.nodeName&&b.nodeName.toLowerCase()==a)return true;b=b.parentNode}return false},move:function(a,e){a.append(this.remove(),e)},remove:function(a){var e=this.$,b=e.parentNode;if(b){if(a)for(;a=e.firstChild;)b.insertBefore(e.removeChild(a),e);b.removeChild(e)}return this},replace:function(a){this.insertBefore(a);a.remove()},trim:function(){this.ltrim();this.rtrim()},ltrim:function(){for(var a;this.getFirst&&(a=this.getFirst());){if(a.type==CKEDITOR.NODE_TEXT){var e=CKEDITOR.tools.ltrim(a.getText()),b=a.getLength();if(e){if(e.length<b){a.split(b-e.length);this.$.removeChild(this.$.firstChild)}}else{a.remove();continue}}break}},rtrim:function(){for(var a;this.getLast&&(a=this.getLast());){if(a.type==CKEDITOR.NODE_TEXT){var e=CKEDITOR.tools.rtrim(a.getText()),b=a.getLength();if(e){if(e.length<b){a.split(e.length);this.$.lastChild.parentNode.removeChild(this.$.lastChild)}}else{a.remove();continue}}break}if(CKEDITOR.env.needsBrFiller)(a=this.$.lastChild)&&(a.type==1&&a.nodeName.toLowerCase()=="br")&&a.parentNode.removeChild(a)},isReadOnly:function(){var a=this;this.type!=CKEDITOR.NODE_ELEMENT&&(a=this.getParent());if(a&&typeof a.$.isContentEditable!="undefined")return!(a.$.isContentEditable||a.data("cke-editable"));for(;a;){if(a.data("cke-editable"))break;if(a.getAttribute("contentEditable")=="false")return true;if(a.getAttribute("contentEditable")=="true")break;a=a.getParent()}return!a}}),CKEDITOR.dom.window=function(a){CKEDITOR.dom.domObject.call(this,a)},CKEDITOR.dom.window.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.window.prototype,{focus:function(){this.$.focus()},getViewPaneSize:function(){var a=this.$.document,e=a.compatMode=="CSS1Compat";return{width:(e?a.documentElement.clientWidth:a.body.clientWidth)||0,height:(e?a.documentElement.clientHeight:a.body.clientHeight)||0}},getScrollPosition:function(){var a=this.$;if("pageXOffset"in a)return{x:a.pageXOffset||0,y:a.pageYOffset||0};a=a.document;return{x:a.documentElement.scrollLeft||a.body.scrollLeft||0,y:a.documentElement.scrollTop||a.body.scrollTop||0}},getFrame:function(){var a=this.$.frameElement;return a?new CKEDITOR.dom.element.get(a):null}}),CKEDITOR.dom.document=function(a){CKEDITOR.dom.domObject.call(this,a)},CKEDITOR.dom.document.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.document.prototype,{type:CKEDITOR.NODE_DOCUMENT,appendStyleSheet:function(a){if(this.$.createStyleSheet)this.$.createStyleSheet(a);else{var e=new CKEDITOR.dom.element("link");e.setAttributes({rel:"stylesheet",type:"text/css",href:a});this.getHead().append(e)}},appendStyleText:function(a){if(this.$.createStyleSheet){var e=this.$.createStyleSheet("");e.cssText=a}else{var b=new CKEDITOR.dom.element("style",this);b.append(new CKEDITOR.dom.text(a,this));this.getHead().append(b)}return e||b.$.sheet},createElement:function(a,e){var b=new CKEDITOR.dom.element(a,this);if(e){e.attributes&&b.setAttributes(e.attributes);e.styles&&b.setStyles(e.styles)}return b},createText:function(a){return new CKEDITOR.dom.text(a,this)},focus:function(){this.getWindow().focus()},getActive:function(){var a;try{a=this.$.activeElement}catch(e){return null}return new CKEDITOR.dom.element(a)},getById:function(a){return(a=this.$.getElementById(a))?new CKEDITOR.dom.element(a):null},getByAddress:function(a,e){for(var b=this.$.documentElement,g=0;b&&g<a.length;g++){var c=a[g];if(e)for(var d=-1,j=0;j<b.childNodes.length;j++){var f=b.childNodes[j];if(!(e===true&&f.nodeType==3&&f.previousSibling&&f.previousSibling.nodeType==3)){d++;if(d==c){b=f;break}}}else b=b.childNodes[c]}return b?new CKEDITOR.dom.node(b):null},getElementsByTag:function(a,e){!(CKEDITOR.env.ie&&document.documentMode<=8)&&e&&(a=e+":"+a);return new CKEDITOR.dom.nodeList(this.$.getElementsByTagName(a))},getHead:function(){var a=this.$.getElementsByTagName("head")[0];return a=a?new CKEDITOR.dom.element(a):this.getDocumentElement().append(new CKEDITOR.dom.element("head"),true)},getBody:function(){return new CKEDITOR.dom.element(this.$.body)},getDocumentElement:function(){return new CKEDITOR.dom.element(this.$.documentElement)},getWindow:function(){return new CKEDITOR.dom.window(this.$.parentWindow||this.$.defaultView)},write:function(a){this.$.open("text/html","replace");CKEDITOR.env.ie&&(a=a.replace(/(?:^\s*<!DOCTYPE[^>]*?>)|^/i,'$&\n<script data-cke-temp="1">('+CKEDITOR.tools.fixDomain+")();<\/script>"));this.$.write(a);this.$.close()},find:function(a){return new CKEDITOR.dom.nodeList(this.$.querySelectorAll(a))},findOne:function(a){return(a=this.$.querySelector(a))?new CKEDITOR.dom.element(a):null},_getHtml5ShivFrag:function(){var a=this.getCustomData("html5ShivFrag");if(!a){a=this.$.createDocumentFragment();CKEDITOR.tools.enableHtml5Elements(a,true);this.setCustomData("html5ShivFrag",a)}return a}}),CKEDITOR.dom.nodeList=function(a){this.$=a},CKEDITOR.dom.nodeList.prototype={count:function(){return this.$.length},getItem:function(a){if(a<0||a>=this.$.length)return null;return(a=this.$[a])?new CKEDITOR.dom.node(a):null}},CKEDITOR.dom.element=function(a,e){typeof a=="string"&&(a=(e?e.$:document).createElement(a));CKEDITOR.dom.domObject.call(this,a)},CKEDITOR.dom.element.get=function(a){return(a=typeof a=="string"?document.getElementById(a)||document.getElementsByName(a)[0]:a)&&(a.$?a:new CKEDITOR.dom.element(a))},CKEDITOR.dom.element.prototype=new CKEDITOR.dom.node,CKEDITOR.dom.element.createFromHtml=function(a,e){var b=new CKEDITOR.dom.element("div",e);b.setHtml(a);return b.getFirst().remove()},CKEDITOR.dom.element.setMarker=function(a,e,b,g){var c=e.getCustomData("list_marker_id")||e.setCustomData("list_marker_id",CKEDITOR.tools.getNextNumber()).getCustomData("list_marker_id"),d=e.getCustomData("list_marker_names")||e.setCustomData("list_marker_names",{}).getCustomData("list_marker_names");a[c]=e;d[b]=1;return e.setCustomData(b,g)},CKEDITOR.dom.element.clearAllMarkers=function(a){for(var e in a)CKEDITOR.dom.element.clearMarkers(a,a[e],1)},CKEDITOR.dom.element.clearMarkers=function(a,e,b){var g=e.getCustomData("list_marker_names"),c=e.getCustomData("list_marker_id"),d;for(d in g)e.removeCustomData(d);e.removeCustomData("list_marker_names");if(b){e.removeCustomData("list_marker_id");delete a[c]}},function(){function a(a){var d=true;if(!a.$.id){a.$.id="cke_tmp_"+CKEDITOR.tools.getNextNumber();d=false}return function(){d||a.removeAttribute("id")}}function e(a,d){return"#"+
a.$.id+" "+d.split(/,\s*/).join(", #"+a.$.id+" ")}function b(a){for(var d=0,b=0,f=g[a].length;b<f;b++)d=d+(parseInt(this.getComputedStyle(g[a][b])||0,10)||0);return d}CKEDITOR.tools.extend(CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_ELEMENT,addClass:function(a){var d=this.$.className;d&&(RegExp("(?:^|\\s)"+a+"(?:\\s|$)","").test(d)||(d=d+(" "+a)));this.$.className=d||a;return this},removeClass:function(a){var d=this.getAttribute("class");if(d){a=RegExp("(?:^|\\s+)"+a+"(?=\\s|$)","i");if(a.test(d))(d=d.replace(a,"").replace(/^\s+/,""))?this.setAttribute("class",d):this.removeAttribute("class")}return this},hasClass:function(a){return RegExp("(?:^|\\s+)"+a+"(?=\\s|$)","").test(this.getAttribute("class"))},append:function(a,d){typeof a=="string"&&(a=this.getDocument().createElement(a));d?this.$.insertBefore(a.$,this.$.firstChild):this.$.appendChild(a.$);return a},appendHtml:function(a){if(this.$.childNodes.length){var d=new CKEDITOR.dom.element("div",this.getDocument());d.setHtml(a);d.moveChildren(this)}else this.setHtml(a)},appendText:function(a){this.$.text!=null?this.$.text=this.$.text+a:this.append(new CKEDITOR.dom.text(a))},appendBogus:function(a){if(a||CKEDITOR.env.needsBrFiller){for(a=this.getLast();a&&a.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.rtrim(a.getText());)a=a.getPrevious();if(!a||!a.is||!a.is("br")){a=this.getDocument().createElement("br");CKEDITOR.env.gecko&&a.setAttribute("type","_moz");this.append(a)}}},breakParent:function(a){var d=new CKEDITOR.dom.range(this.getDocument());d.setStartAfter(this);d.setEndAfter(a);a=d.extractContents();d.insertNode(this.remove());a.insertAfterNode(this)},contains:CKEDITOR.env.ie||CKEDITOR.env.webkit?function(a){var d=this.$;return a.type!=CKEDITOR.NODE_ELEMENT?d.contains(a.getParent().$):d!=a.$&&d.contains(a.$)}:function(a){return!!(this.$.compareDocumentPosition(a.$)&16)},focus:function(){function a(){try{this.$.focus()}catch(c){}}return function(d){d?CKEDITOR.tools.setTimeout(a,100,this):a.call(this)}}(),getHtml:function(){var a=this.$.innerHTML;return CKEDITOR.env.ie?a.replace(/<\?[^>]*>/g,""):a},getOuterHtml:function(){if(this.$.outerHTML)return this.$.outerHTML.replace(/<\?[^>]*>/,"");var a=this.$.ownerDocument.createElement("div");a.appendChild(this.$.cloneNode(true));return a.innerHTML},getClientRect:function(){var a=CKEDITOR.tools.extend({},this.$.getBoundingClientRect());!a.width&&(a.width=a.right-a.left);!a.height&&(a.height=a.bottom-a.top);return a},setHtml:CKEDITOR.env.ie&&CKEDITOR.env.version<9?function(a){try{var d=this.$;if(this.getParent())return d.innerHTML=a;var b=this.getDocument()._getHtml5ShivFrag();b.appendChild(d);d.innerHTML=a;b.removeChild(d);return a}catch(f){this.$.innerHTML="";d=new CKEDITOR.dom.element("body",this.getDocument());d.$.innerHTML=a;for(d=d.getChildren();d.count();)this.append(d.getItem(0));return a}}:function(a){return this.$.innerHTML=a},setText:function(){var a=document.createElement("p");a.innerHTML="x";a=a.textContent;return function(d){this.$[a?"textContent":"innerText"]=d}}(),getAttribute:function(){var a=function(a){return this.$.getAttribute(a,2)};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(a){switch(a){case"class":a="className";break;case"http-equiv":a="httpEquiv";break;case"name":return this.$.name;case"tabindex":a=this.$.getAttribute(a,2);a!==0&&this.$.tabIndex===0&&(a=null);return a;case"checked":a=this.$.attributes.getNamedItem(a);return(a.specified?a.nodeValue:this.$.checked)?"checked":null;case"hspace":case"value":return this.$[a];case"style":return this.$.style.cssText;case"contenteditable":case"contentEditable":return this.$.attributes.getNamedItem("contentEditable").specified?this.$.getAttribute("contentEditable"):null}return this.$.getAttribute(a,2)}:a}(),getChildren:function(){return new CKEDITOR.dom.nodeList(this.$.childNodes)},getComputedStyle:CKEDITOR.env.ie?function(a){return this.$.currentStyle[CKEDITOR.tools.cssStyleToDomStyle(a)]}:function(a){var d=this.getWindow().$.getComputedStyle(this.$,null);return d?d.getPropertyValue(a):""},getDtd:function(){var a=CKEDITOR.dtd[this.getName()];this.getDtd=function(){return a};return a},getElementsByTag:CKEDITOR.dom.document.prototype.getElementsByTag,getTabIndex:CKEDITOR.env.ie?function(){var a=this.$.tabIndex;a===0&&(!CKEDITOR.dtd.$tabIndex[this.getName()]&&parseInt(this.getAttribute("tabindex"),10)!==0)&&(a=-1);return a}:CKEDITOR.env.webkit?function(){var a=this.$.tabIndex;if(a===void 0){a=parseInt(this.getAttribute("tabindex"),10);isNaN(a)&&(a=-1)}return a}:function(){return this.$.tabIndex},getText:function(){return this.$.textContent||this.$.innerText||""},getWindow:function(){return this.getDocument().getWindow()},getId:function(){return this.$.id||null},getNameAtt:function(){return this.$.name||null},getName:function(){var a=this.$.nodeName.toLowerCase();if(CKEDITOR.env.ie&&document.documentMode<=8){var d=this.$.scopeName;d!="HTML"&&(a=d.toLowerCase()+":"+a)}this.getName=function(){return a};return this.getName()},getValue:function(){return this.$.value},getFirst:function(a){var d=this.$.firstChild;(d=d&&new CKEDITOR.dom.node(d))&&(a&&!a(d))&&(d=d.getNext(a));return d},getLast:function(a){var d=this.$.lastChild;(d=d&&new CKEDITOR.dom.node(d))&&(a&&!a(d))&&(d=d.getPrevious(a));return d},getStyle:function(a){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(a)]},is:function(){var a=this.getName();if(typeof arguments[0]=="object")return!!arguments[0][a];for(var d=0;d<arguments.length;d++)if(arguments[d]==a)return true;return false},isEditable:function(a){var d=this.getName();if(this.isReadOnly()||this.getComputedStyle("display")=="none"||this.getComputedStyle("visibility")=="hidden"||CKEDITOR.dtd.$nonEditable[d]||CKEDITOR.dtd.$empty[d]||this.is("a")&&(this.data("cke-saved-name")||this.hasAttribute("name"))&&!this.getChildCount())return false;if(a!==false){a=CKEDITOR.dtd[d]||CKEDITOR.dtd.span;return!(!a||!a["#"])}return true},isIdentical:function(a){var d=this.clone(0,1),a=a.clone(0,1);d.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]);a.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]);if(d.$.isEqualNode){d.$.style.cssText=CKEDITOR.tools.normalizeCssText(d.$.style.cssText);a.$.style.cssText=CKEDITOR.tools.normalizeCssText(a.$.style.cssText);return d.$.isEqualNode(a.$)}d=d.getOuterHtml();a=a.getOuterHtml();if(CKEDITOR.env.ie&&CKEDITOR.env.version<9&&this.is("a")){var b=this.getParent();if(b.type==CKEDITOR.NODE_ELEMENT){b=b.clone();b.setHtml(d);d=b.getHtml();b.setHtml(a);a=b.getHtml()}}return d==a},isVisible:function(){var a=(this.$.offsetHeight||this.$.offsetWidth)&&this.getComputedStyle("visibility")!="hidden",d,b;if(a&&CKEDITOR.env.webkit){d=this.getWindow();if(!d.equals(CKEDITOR.document.getWindow())&&(b=d.$.frameElement))a=(new CKEDITOR.dom.element(b)).isVisible()}return!!a},isEmptyInlineRemoveable:function(){if(!CKEDITOR.dtd.$removeEmpty[this.getName()])return false;for(var a=this.getChildren(),d=0,b=a.count();d<b;d++){var f=a.getItem(d);if(!(f.type==CKEDITOR.NODE_ELEMENT&&f.data("cke-bookmark"))&&(f.type==CKEDITOR.NODE_ELEMENT&&!f.isEmptyInlineRemoveable()||f.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(f.getText())))return false}return true},hasAttributes:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(){for(var a=this.$.attributes,d=0;d<a.length;d++){var b=a[d];switch(b.nodeName){case"class":if(this.getAttribute("class"))return true;case"data-cke-expando":continue;default:if(b.specified)return true}}return false}:function(){var a=this.$.attributes,d=a.length,b={"data-cke-expando":1,_moz_dirty:1};return d>0&&(d>2||!b[a[0].nodeName]||d==2&&!b[a[1].nodeName])},hasAttribute:function(){function a(c){var b=this.$.attributes.getNamedItem(c);if(this.getName()=="input")switch(c){case"class":return this.$.className.length>0;case"checked":return!!this.$.checked;case"value":c=this.getAttribute("type");return c=="checkbox"||c=="radio"?this.$.value!="on":!!this.$.value}return!b?false:b.specified}return CKEDITOR.env.ie?CKEDITOR.env.version<8?function(d){return d=="name"?!!this.$.name:a.call(this,d)}:a:function(a){return!!this.$.attributes.getNamedItem(a)}}(),hide:function(){this.setStyle("display","none")},moveChildren:function(a,d){var b=this.$,a=a.$;if(b!=a){var f;if(d)for(;f=b.lastChild;)a.insertBefore(b.removeChild(f),a.firstChild);else for(;f=b.firstChild;)a.appendChild(b.removeChild(f))}},mergeSiblings:function(){function a(c,b,f){if(b&&b.type==CKEDITOR.NODE_ELEMENT){for(var g=[];b.data("cke-bookmark")||b.isEmptyInlineRemoveable();){g.push(b);b=f?b.getNext():b.getPrevious();if(!b||b.type!=CKEDITOR.NODE_ELEMENT)return}if(c.isIdentical(b)){for(var e=f?c.getLast():c.getFirst();g.length;)g.shift().move(c,!f);b.moveChildren(c,!f);b.remove();e&&e.type==CKEDITOR.NODE_ELEMENT&&e.mergeSiblings()}}}return function(d){if(d===false||CKEDITOR.dtd.$removeEmpty[this.getName()]||this.is("a")){a(this,this.getNext(),true);a(this,this.getPrevious())}}}(),show:function(){this.setStyles({display:"",visibility:""})},setAttribute:function(){var a=function(a,c){this.$.setAttribute(a,c);return this};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(d,b){d=="class"?this.$.className=b:d=="style"?this.$.style.cssText=b:d=="tabindex"?this.$.tabIndex=b:d=="checked"?this.$.checked=b:d=="contenteditable"?a.call(this,"contentEditable",b):a.apply(this,arguments);return this}:CKEDITOR.env.ie8Compat&&CKEDITOR.env.secure?function(b,g){if(b=="src"&&g.match(/^http:\/\//))try{a.apply(this,arguments)}catch(f){}else a.apply(this,arguments);return this}:a}(),setAttributes:function(a){for(var b in a)this.setAttribute(b,a[b]);return this},setValue:function(a){this.$.value=a;return this},removeAttribute:function(){var a=function(a){this.$.removeAttribute(a)};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(a){a=="class"?a="className":a=="tabindex"?a="tabIndex":a=="contenteditable"&&(a="contentEditable");this.$.removeAttribute(a)}:a}(),removeAttributes:function(a){if(CKEDITOR.tools.isArray(a))for(var b=0;b<a.length;b++)this.removeAttribute(a[b]);else for(b in a)a.hasOwnProperty(b)&&this.removeAttribute(b)},removeStyle:function(a){var b=this.$.style;if(!b.removeProperty&&(a=="border"||a=="margin"||a=="padding")){var g=["top","left","right","bottom"],f;a=="border"&&(f=["color","style","width"]);for(var b=[],h=0;h<g.length;h++)if(f)for(var e=0;e<f.length;e++)b.push([a,g[h],f[e]].join("-"));else b.push([a,g[h]].join("-"));for(a=0;a<b.length;a++)this.removeStyle(b[a])}else{b.removeProperty?b.removeProperty(a):b.removeAttribute(CKEDITOR.tools.cssStyleToDomStyle(a));this.$.style.cssText||this.removeAttribute("style")}},setStyle:function(a,b){this.$.style[CKEDITOR.tools.cssStyleToDomStyle(a)]=b;return this},setStyles:function(a){for(var b in a)this.setStyle(b,a[b]);return this},setOpacity:function(a){if(CKEDITOR.env.ie&&CKEDITOR.env.version<9){a=Math.round(a*100);this.setStyle("filter",a>=100?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+a+")")}else this.setStyle("opacity",a)},unselectable:function(){this.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","none"));if(CKEDITOR.env.ie){this.setAttribute("unselectable","on");for(var a,b=this.getElementsByTag("*"),g=0,f=b.count();g<f;g++){a=b.getItem(g);a.setAttribute("unselectable","on")}}},getPositionedAncestor:function(){for(var a=this;a.getName()!="html";){if(a.getComputedStyle("position")!="static")return a;a=a.getParent()}return null},getDocumentPosition:function(a){var b=0,g=0,f=this.getDocument(),h=f.getBody(),e=CKEDITOR.env.quirks;if(document.documentElement.getBoundingClientRect){var k=this.$.getBoundingClientRect(),n=f.$.documentElement,o=n.clientTop||h.$.clientTop||0,q=n.clientLeft||h.$.clientLeft||0,m=true;if(CKEDITOR.env.ie){m=f.getDocumentElement().contains(this);f=f.getBody().contains(this);m=e&&f||!e&&m}if(m){if(CKEDITOR.env.webkit){b=h.$.scrollLeft||n.scrollLeft;g=h.$.scrollTop||n.scrollTop}else{g=e?h.$:n;b=g.scrollLeft;g=g.scrollTop}b=k.left+b-q;g=k.top+g-o}}else{o=this;for(q=null;o&&!(o.getName()=="body"||o.getName()=="html");){b=b+(o.$.offsetLeft-o.$.scrollLeft);g=g+(o.$.offsetTop-o.$.scrollTop);if(!o.equals(this)){b=b+(o.$.clientLeft||0);g=g+(o.$.clientTop||0)}for(;q&&!q.equals(o);){b=b-q.$.scrollLeft;g=g-q.$.scrollTop;q=q.getParent()}q=o;o=(k=o.$.offsetParent)?new CKEDITOR.dom.element(k):null}}if(a){k=this.getWindow();o=a.getWindow();if(!k.equals(o)&&k.$.frameElement){a=(new CKEDITOR.dom.element(k.$.frameElement)).getDocumentPosition(a);b=b+a.x;g=g+a.y}}if(!document.documentElement.getBoundingClientRect&&CKEDITOR.env.gecko&&!e){b=b+(this.$.clientLeft?1:0);g=g+(this.$.clientTop?1:0)}return{x:b,y:g}},scrollIntoView:function(a){var b=this.getParent();if(b){do{(b.$.clientWidth&&b.$.clientWidth<b.$.scrollWidth||b.$.clientHeight&&b.$.clientHeight<b.$.scrollHeight)&&!b.is("body")&&this.scrollIntoParent(b,a,1);if(b.is("html")){var g=b.getWindow();try{var f=g.$.frameElement;f&&(b=new CKEDITOR.dom.element(f))}catch(h){}}}while(b=b.getParent())}},scrollIntoParent:function(a,b,g){var f,h,e,k;function n(b,d){if(/body|html/.test(a.getName()))a.getWindow().$.scrollBy(b,d);else{a.$.scrollLeft=a.$.scrollLeft+b;a.$.scrollTop=a.$.scrollTop+d}}function o(a,b){var c={x:0,y:0};if(!a.is(m?"body":"html")){var d=a.$.getBoundingClientRect();c.x=d.left;c.y=d.top}d=a.getWindow();if(!d.equals(b)){d=o(CKEDITOR.dom.element.get(d.$.frameElement),b);c.x=c.x+d.x;c.y=c.y+d.y}return c}function q(a,b){return parseInt(a.getComputedStyle("margin-"+b)||0,10)||0}!a&&(a=this.getWindow());e=a.getDocument();var m=e.$.compatMode=="BackCompat";a instanceof CKEDITOR.dom.window&&(a=m?e.getBody():e.getDocumentElement());e=a.getWindow();h=o(this,e);var l=o(a,e),p=this.$.offsetHeight;f=this.$.offsetWidth;var t=a.$.clientHeight,s=a.$.clientWidth;e=h.x-q(this,"left")-l.x||0;k=h.y-q(this,"top")-l.y||0;f=h.x+f+q(this,"right")-(l.x+s)||0;h=h.y+p+q(this,"bottom")-(l.y+t)||0;if(k<0||h>0)n(0,b===true?k:b===false?h:k<0?k:h);if(g&&(e<0||f>0))n(e<0?e:f,0)},setState:function(a,b,g){b=b||"cke";switch(a){case CKEDITOR.TRISTATE_ON:this.addClass(b+"_on");this.removeClass(b+"_off");this.removeClass(b+"_disabled");g&&this.setAttribute("aria-pressed",true);g&&this.removeAttribute("aria-disabled");break;case CKEDITOR.TRISTATE_DISABLED:this.addClass(b+"_disabled");this.removeClass(b+"_off");this.removeClass(b+"_on");g&&this.setAttribute("aria-disabled",true);g&&this.removeAttribute("aria-pressed");break;default:this.addClass(b+"_off");this.removeClass(b+"_on");this.removeClass(b+"_disabled");g&&this.removeAttribute("aria-pressed");g&&this.removeAttribute("aria-disabled")}},getFrameDocument:function(){var a=this.$;try{a.contentWindow.document}catch(b){a.src=a.src}return a&&new CKEDITOR.dom.document(a.contentWindow.document)},copyAttributes:function(a,b){for(var g=this.$.attributes,b=b||{},f=0;f<g.length;f++){var h=g[f],e=h.nodeName.toLowerCase(),k;if(!(e in b))if(e=="checked"&&(k=this.getAttribute(e)))a.setAttribute(e,k);else if(!CKEDITOR.env.ie||this.hasAttribute(e)){k=this.getAttribute(e);if(k===null)k=h.nodeValue;a.setAttribute(e,k)}}if(this.$.style.cssText!=="")a.$.style.cssText=this.$.style.cssText},renameNode:function(a){if(this.getName()!=a){var b=this.getDocument(),a=new CKEDITOR.dom.element(a,b);this.copyAttributes(a);this.moveChildren(a);this.getParent()&&this.$.parentNode.replaceChild(a.$,this.$);a.$["data-cke-expando"]=this.$["data-cke-expando"];this.$=a.$;delete this.getName}},getChild:function(){function a(b,c){var f=b.childNodes;if(c>=0&&c<f.length)return f[c]}return function(b){var g=this.$;if(b.slice)for(;b.length>0&&g;)g=a(g,b.shift());else g=a(g,b);return g?new CKEDITOR.dom.node(g):null}}(),getChildCount:function(){return this.$.childNodes.length},disableContextMenu:function(){this.on("contextmenu",function(a){a.data.getTarget().hasClass("cke_enable_context_menu")||a.data.preventDefault()})},getDirection:function(a){return a?this.getComputedStyle("direction")||this.getDirection()||this.getParent()&&this.getParent().getDirection(1)||this.getDocument().$.dir||"ltr":this.getStyle("direction")||this.getAttribute("dir")},data:function(a,b){a="data-"+a;if(b===void 0)return this.getAttribute(a);b===false?this.removeAttribute(a):this.setAttribute(a,b);return null},getEditor:function(){var a=CKEDITOR.instances,b,g;for(b in a){g=a[b];if(g.element.equals(this)&&g.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO)return g}return null},find:function(b){var d=a(this),b=new CKEDITOR.dom.nodeList(this.$.querySelectorAll(e(this,b)));d();return b},findOne:function(b){var d=a(this),b=this.$.querySelector(e(this,b));d();return b?new CKEDITOR.dom.element(b):null},forEach:function(a,b,g){if(!g&&(!b||this.type==b))var f=a(this);if(f!==false)for(var g=this.getChildren(),h=0;h<g.count();h++){f=g.getItem(h);f.type==CKEDITOR.NODE_ELEMENT?f.forEach(a,b):(!b||f.type==b)&&a(f)}}});var g={width:["border-left-width","border-right-width","padding-left","padding-right"],height:["border-top-width","border-bottom-width","padding-top","padding-bottom"]};CKEDITOR.dom.element.prototype.setSize=function(a,d,g){if(typeof d=="number"){if(g&&(!CKEDITOR.env.ie||!CKEDITOR.env.quirks))d=d-b.call(this,a);this.setStyle(a,d+"px")}};CKEDITOR.dom.element.prototype.getSize=function(a,d){var g=Math.max(this.$["offset"+CKEDITOR.tools.capitalize(a)],this.$["client"+CKEDITOR.tools.capitalize(a)])||0;d&&(g=g-b.call(this,a));return g}}(),CKEDITOR.dom.documentFragment=function(a){a=a||CKEDITOR.document;this.$=a.type==CKEDITOR.NODE_DOCUMENT?a.$.createDocumentFragment():a},CKEDITOR.tools.extend(CKEDITOR.dom.documentFragment.prototype,CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,insertAfterNode:function(a){a=a.$;a.parentNode.insertBefore(this.$,a.nextSibling)}},!0,{append:1,appendBogus:1,getFirst:1,getLast:1,getParent:1,getNext:1,getPrevious:1,appendTo:1,moveChildren:1,insertBefore:1,insertAfterNode:1,replace:1,trim:1,type:1,ltrim:1,rtrim:1,getDocument:1,getChildCount:1,getChild:1,getChildren:1}),function(){function a(a,b){var c=this.range;if(this._.end)return null;if(!this._.start){this._.start=1;if(c.collapsed){this.end();return null}c.optimize()}var d,f=c.startContainer;d=c.endContainer;var g=c.startOffset,k=c.endOffset,h,e=this.guard,j=this.type,i=a?"getPreviousSourceNode":"getNextSourceNode";if(!a&&!this._.guardLTR){var v=d.type==CKEDITOR.NODE_ELEMENT?d:d.getParent(),r=d.type==CKEDITOR.NODE_ELEMENT?d.getChild(k):d.getNext();this._.guardLTR=function(a,b){return(!b||!v.equals(a))&&(!r||!a.equals(r))&&(a.type!=CKEDITOR.NODE_ELEMENT||!b||!a.equals(c.root))}}if(a&&!this._.guardRTL){var y=f.type==CKEDITOR.NODE_ELEMENT?f:f.getParent(),z=f.type==CKEDITOR.NODE_ELEMENT?g?f.getChild(g-1):null:f.getPrevious();this._.guardRTL=function(a,b){return(!b||!y.equals(a))&&(!z||!a.equals(z))&&(a.type!=CKEDITOR.NODE_ELEMENT||!b||!a.equals(c.root))}}var B=a?this._.guardRTL:this._.guardLTR;h=e?function(a,b){return B(a,b)===false?false:e(a,b)}:B;if(this.current)d=this.current[i](false,j,h);else{if(a)d.type==CKEDITOR.NODE_ELEMENT&&(d=k>0?d.getChild(k-
1):h(d,true)===false?null:d.getPreviousSourceNode(true,j,h));else{d=f;if(d.type==CKEDITOR.NODE_ELEMENT&&!(d=d.getChild(g)))d=h(f,true)===false?null:f.getNextSourceNode(true,j,h)}d&&h(d)===false&&(d=null)}for(;d&&!this._.end;){this.current=d;if(!this.evaluator||this.evaluator(d)!==false){if(!b)return d}else if(b&&this.evaluator)return false;d=d[i](false,j,h)}this.end();return this.current=null}function e(b){for(var c,d=null;c=a.call(this,b);)d=c;return d}function b(a){if(i(a))return false;if(a.type==CKEDITOR.NODE_TEXT)return true;if(a.type==CKEDITOR.NODE_ELEMENT){if(a.is(CKEDITOR.dtd.$inline)||a.is("hr")||a.getAttribute("contenteditable")=="false")return true;var b;if(b=!CKEDITOR.env.needsBrFiller)if(b=a.is(k))a:{b=0;for(var c=a.getChildCount();b<c;++b)if(!i(a.getChild(b))){b=false;break a}b=true}if(b)return true}return false}CKEDITOR.dom.walker=CKEDITOR.tools.createClass({$:function(a){this.range=a;this._={}},proto:{end:function(){this._.end=1},next:function(){return a.call(this)},previous:function(){return a.call(this,1)},checkForward:function(){return a.call(this,0,1)!==false},checkBackward:function(){return a.call(this,1,1)!==false},lastForward:function(){return e.call(this)},lastBackward:function(){return e.call(this,1)},reset:function(){delete this.current;this._={}}}});var g={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},c={absolute:1,fixed:1};CKEDITOR.dom.element.prototype.isBlockBoundary=function(a){return this.getComputedStyle("float")=="none"&&!(this.getComputedStyle("position")in c)&&g[this.getComputedStyle("display")]?true:!!(this.is(CKEDITOR.dtd.$block)||a&&this.is(a))};CKEDITOR.dom.walker.blockBoundary=function(a){return function(b){return!(b.type==CKEDITOR.NODE_ELEMENT&&b.isBlockBoundary(a))}};CKEDITOR.dom.walker.listItemBoundary=function(){return this.blockBoundary({br:1})};CKEDITOR.dom.walker.bookmark=function(a,b){function c(a){return a&&a.getName&&a.getName()=="span"&&a.data("cke-bookmark")}return function(d){var f,g;f=d&&d.type!=CKEDITOR.NODE_ELEMENT&&(g=d.getParent())&&c(g);f=a?f:f||c(d);return!!(b^f)}};CKEDITOR.dom.walker.whitespaces=function(a){return function(b){var c;b&&b.type==CKEDITOR.NODE_TEXT&&(c=!CKEDITOR.tools.trim(b.getText())||CKEDITOR.env.webkit&&b.getText()==" ​");return!!(a^c)}};CKEDITOR.dom.walker.invisible=function(a){var b=CKEDITOR.dom.walker.whitespaces(),c=CKEDITOR.env.webkit?1:0;return function(d){if(b(d))d=1;else{d.type==CKEDITOR.NODE_TEXT&&(d=d.getParent());d=d.$.offsetWidth<=c}return!!(a^d)}};CKEDITOR.dom.walker.nodeType=function(a,b){return function(c){return!!(b^c.type==a)}};CKEDITOR.dom.walker.bogus=function(a){function b(a){return!j(a)&&!f(a)}return function(c){var f=CKEDITOR.env.needsBrFiller?c.is&&c.is("br"):c.getText&&d.test(c.getText());if(f){f=c.getParent();c=c.getNext(b);f=f.isBlockBoundary()&&(!c||c.type==CKEDITOR.NODE_ELEMENT&&c.isBlockBoundary())}return!!(a^f)}};CKEDITOR.dom.walker.temp=function(a){return function(b){b.type!=CKEDITOR.NODE_ELEMENT&&(b=b.getParent());b=b&&b.hasAttribute("data-cke-temp");return!!(a^b)}};var d=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,j=CKEDITOR.dom.walker.whitespaces(),f=CKEDITOR.dom.walker.bookmark(),h=CKEDITOR.dom.walker.temp();CKEDITOR.dom.walker.ignored=function(a){return function(b){b=j(b)||f(b)||h(b);return!!(a^b)}};var i=CKEDITOR.dom.walker.ignored(),k=function(a){var b={},c;for(c in a)CKEDITOR.dtd[c]["#"]&&(b[c]=1);return b}(CKEDITOR.dtd.$block);CKEDITOR.dom.walker.editable=function(a){return function(c){return!!(a^b(c))}};CKEDITOR.dom.element.prototype.getBogus=function(){var a=this;do a=a.getPreviousSourceNode();while(f(a)||j(a)||a.type==CKEDITOR.NODE_ELEMENT&&a.is(CKEDITOR.dtd.$inline)&&!a.is(CKEDITOR.dtd.$empty));return a&&(CKEDITOR.env.needsBrFiller?a.is&&a.is("br"):a.getText&&d.test(a.getText()))?a:false}}(),CKEDITOR.dom.range=function(a){this.endOffset=this.endContainer=this.startOffset=this.startContainer=null;this.collapsed=true;var e=a instanceof CKEDITOR.dom.document;this.document=e?a:a.getDocument();this.root=e?a.getBody():a},function(){function a(){var a=false,b=CKEDITOR.dom.walker.whitespaces(),c=CKEDITOR.dom.walker.bookmark(true),f=CKEDITOR.dom.walker.bogus();return function(g){if(c(g)||b(g))return true;if(f(g)&&!a)return a=true;return g.type==CKEDITOR.NODE_TEXT&&(g.hasAscendant("pre")||CKEDITOR.tools.trim(g.getText()).length)||g.type==CKEDITOR.NODE_ELEMENT&&!g.is(d)?false:true}}function e(a){var b=CKEDITOR.dom.walker.whitespaces(),c=CKEDITOR.dom.walker.bookmark(1);return function(d){return c(d)||b(d)?true:!a&&j(d)||d.type==CKEDITOR.NODE_ELEMENT&&d.is(CKEDITOR.dtd.$removeEmpty)}}function b(a){return function(){var b;return this[a?"getPreviousNode":"getNextNode"](function(a){!b&&i(a)&&(b=a);return h(a)&&!(j(a)&&a.equals(b))})}}var g=function(a){a.collapsed=a.startContainer&&a.endContainer&&a.startContainer.equals(a.endContainer)&&a.startOffset==a.endOffset},c=function(a,b,c,d){a.optimizeBookmark();var f=a.startContainer,g=a.endContainer,h=a.startOffset,e=a.endOffset,j,i;if(g.type==CKEDITOR.NODE_TEXT)g=g.split(e);else if(g.getChildCount()>0)if(e>=g.getChildCount()){g=g.append(a.document.createText(""));i=true}else g=g.getChild(e);if(f.type==CKEDITOR.NODE_TEXT){f.split(h);f.equals(g)&&(g=f.getNext())}else if(h)if(h>=f.getChildCount()){f=f.append(a.document.createText(""));j=true}else f=f.getChild(h).getPrevious();else{f=f.append(a.document.createText(""),1);j=true}var h=f.getParents(),e=g.getParents(),w,x,v;for(w=0;w<h.length;w++){x=h[w];v=e[w];if(!x.equals(v))break}for(var r=c,y,z,B,A=w;A<h.length;A++){y=h[A];r&&!y.equals(f)&&(z=r.append(y.clone()));for(y=y.getNext();y;){if(y.equals(e[A])||y.equals(g))break;B=y.getNext();if(b==2)r.append(y.clone(true));else{y.remove();b==1&&r.append(y)}y=B}r&&(r=z)}r=c;for(c=w;c<e.length;c++){y=e[c];b>0&&!y.equals(g)&&(z=r.append(y.clone()));if(!h[c]||y.$.parentNode!=h[c].$.parentNode)for(y=y.getPrevious();y;){if(y.equals(h[c])||y.equals(f))break;B=y.getPrevious();if(b==2)r.$.insertBefore(y.$.cloneNode(true),r.$.firstChild);else{y.remove();b==1&&r.$.insertBefore(y.$,r.$.firstChild)}y=B}r&&(r=z)}if(b==2){x=a.startContainer;if(x.type==CKEDITOR.NODE_TEXT){x.$.data=x.$.data+x.$.nextSibling.data;x.$.parentNode.removeChild(x.$.nextSibling)}a=a.endContainer;if(a.type==CKEDITOR.NODE_TEXT&&a.$.nextSibling){a.$.data=a.$.data+a.$.nextSibling.data;a.$.parentNode.removeChild(a.$.nextSibling)}}else{if(x&&v&&(f.$.parentNode!=x.$.parent Node||g.$.parentNode!=v.$.parentNode)){b=v.getIndex();j&&v.$.parentNode==f.$.parentNode&&b--;if(d&&x.type==CKEDITOR.NODE_ELEMENT){d=CKEDITOR.dom.element.createFromHtml('<span data-cke-bookmark="1" style="display:none">&nbsp;</span>',a.document);d.insertAfter(x);x.mergeSiblings(false);a.moveToBookmark({startNode:d})}else a.setStart(v.getParent(),b)}a.collapse(true)}j&&f.remove();i&&g.$.parentNode&&g.remove()},d={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},j=CKEDITOR.dom.walker.bogus(),f=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,h=CKEDITOR.dom.walker.editable(),i=CKEDITOR.dom.walker.ignored(true);CKEDITOR.dom.range.prototype={clone:function(){var a=new CKEDITOR.dom.range(this.root);a._setStartContainer(this.startContainer);a.startOffset=this.startOffset;a._setEndContainer(this.endContainer);a.endOffset=this.endOffset;a.collapsed=this.collapsed;return a},collapse:function(a){if(a){this._setEndContainer(this.startContainer);this.endOffset=this.startOffset}else{this._setStartContainer(this.endContainer);this.startOffset=this.endOffset}this.collapsed=true},cloneContents:function(){var a=new CKEDITOR.dom.documentFragment(this.document);this.collapsed||c(this,2,a);return a},deleteContents:function(a){this.collapsed||c(this,0,null,a)},extractContents:function(a){var b=new CKEDITOR.dom.documentFragment(this.document);this.collapsed||c(this,1,b,a);return b},createBookmark:function(a){var b,c,d,f,g=this.collapsed;b=this.document.createElement("span");b.data("cke-bookmark",1);b.setStyle("display","none");b.setHtml("&nbsp;");if(a){d="cke_bm_"+CKEDITOR.tools.getNextNumber();b.setAttribute("id",d+(g?"C":"S"))}if(!g){c=b.clone();c.setHtml("&nbsp;");a&&c.setAttribute("id",d+"E");f=this.clone();f.collapse();f.insertNode(c)}f=this.clone();f.collapse(true);f.insertNode(b);if(c){this.setStartAfter(b);this.setEndBefore(c)}else this.moveToPosition(b,CKEDITOR.POSITION_AFTER_END);return{startNode:a?d+(g?"C":"S"):b,endNode:a?d+"E":c,serializable:a,collapsed:g}},createBookmark2:function(){function a(c){var d=c.container,f=c.offset,g;g=d;var h=f;g=g.type!=CKEDITOR.NODE_ELEMENT||h===0||h==g.getChildCount()?0:g.getChild(h-1).type==CKEDITOR.NODE_TEXT&&g.getChild(h).type==CKEDITOR.NODE_TEXT;if(g){d=d.getChild(f-1);f=d.getLength()}d.type==CKEDITOR.NODE_ELEMENT&&f>1&&(f=d.getChild(f-1).getIndex(true)+1);if(d.type==CKEDITOR.NODE_TEXT){g=d;for(h=0;(g=g.getPrevious())&&g.type==CKEDITOR.NODE_TEXT;)h=h+g.getLength();g=h;if(d.getText())f=f+g;else{h=d.getPrevious(b);if(g){f=g;d=h?h.getNext():d.getParent().getFirst()}else{d=d.getParent();f=h?h.getIndex(true)+1:0}}}c.container=d;c.offset=f}var b=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_TEXT,true);return function(b){var c=this.collapsed,d={container:this.startContainer,offset:this.startOffset},f={container:this.endContainer,offset:this.endOffset};if(b){a(d);c||a(f)}return{start:d.container.getAddress(b),end:c?null:f.container.getAddress(b),startOffset:d.offset,endOffset:f.offset,normalized:b,collapsed:c,is2:true}}}(),moveToBookmark:function(a){if(a.is2){var b=this.document.getByAddress(a.start,a.normalized),c=a.startOffset,d=a.end&&this.document.getByAddress(a.end,a.normalized),a=a.endOffset;this.setStart(b,c);d?this.setEnd(d,a):this.collapse(true)}else{b=(c=a.serializable)?this.document.getById(a.startNode):a.startNode;a=c?this.document.getById(a.endNode):a.endNode;this.setStartBefore(b);b.remove();if(a){this.setEndBefore(a);a.remove()}else this.collapse(true)}},getBoundaryNodes:function(){var a=this.startContainer,b=this.endContainer,c=this.startOffset,d=this.endOffset,f;if(a.type==CKEDITOR.NODE_ELEMENT){f=a.getChildCount();if(f>c)a=a.getChild(c);else if(f<1)a=a.getPreviousSourceNode();else{for(a=a.$;a.lastChild;)a=a.lastChild;a=new CKEDITOR.dom.node(a);a=a.getNextSourceNode()||a}}if(b.type==CKEDITOR.NODE_ELEMENT){f=b.getChildCount();if(f>d)b=b.getChild(d).getPreviousSourceNode(true);else if(f<1)b=b.getPreviousSourceNode();else{for(b=b.$;b.lastChild;)b=b.lastChild;b=new CKEDITOR.dom.node(b)}}a.getPosition(b)&CKEDITOR.POSITION_FOLLOWING&&(a=b);return{startNode:a,endNode:b}},getCommonAncestor:function(a,b){var c=this.startContainer,d=this.endContainer,c=c.equals(d)?a&&c.type==CKEDITOR.NODE_ELEMENT&&this.startOffset==this.endOffset-
1?c.getChild(this.startOffset):c:c.getCommonAncestor(d);return b&&!c.is?c.getParent():c},optimize:function(){var a=this.startContainer,b=this.startOffset;a.type!=CKEDITOR.NODE_ELEMENT&&(b?b>=a.getLength()&&this.setStartAfter(a):this.setStartBefore(a));a=this.endContainer;b=this.endOffset;a.type!=CKEDITOR.NODE_ELEMENT&&(b?b>=a.getLength()&&this.setEndAfter(a):this.setEndBefore(a))},optimizeBookmark:function(){var a=this.startContainer,b=this.endContainer;a.is&&(a.is("span")&&a.data("cke-bookmark"))&&this.setStartAt(a,CKEDITOR.POSITION_BEFORE_START);b&&(b.is&&b.is("span")&&b.data("cke-bookmark"))&&this.setEndAt(b,CKEDITOR.POSITION_AFTER_END)},trim:function(a,b){var c=this.startContainer,d=this.startOffset,f=this.collapsed;if((!a||f)&&c&&c.type==CKEDITOR.NODE_TEXT){if(d)if(d>=c.getLength()){d=c.getIndex()+1;c=c.getParent()}else{var g=c.split(d),d=c.getIndex()+1,c=c.getParent();if(this.startContainer.equals(this.endContainer))this.setEnd(g,this.endOffset-this.startOffset);else if(c.equals(this.endContainer))this.endOffset=this.endOffset+1}else{d=c.getIndex();c=c.getParent()}this.setStart(c,d);if(f){this.collapse(true);return}}c=this.endContainer;d=this.endOffset;if(!b&&!f&&c&&c.type==CKEDITOR.NODE_TEXT){if(d){d>=c.getLength()||c.split(d);d=c.getIndex()+1}else d=c.getIndex();c=c.getParent();this.setEnd(c,d)}},enlarge:function(a,b){function c(a){return a&&a.type==CKEDITOR.NODE_ELEMENT&&a.hasAttribute("contenteditable")?null:a}var d=RegExp(/[^\s\ufeff]/);switch(a){case CKEDITOR.ENLARGE_INLINE:var f=1;case CKEDITOR.ENLARGE_ELEMENT:if(this.collapsed)break;var g=this.getCommonAncestor(),h=this.root,e,j,i,w,x,v=false,r,y;r=this.startContainer;var z=this.startOffset;if(r.type==CKEDITOR.NODE_TEXT){if(z){r=!CKEDITOR.tools.trim(r.substring(0,z)).length&&r;v=!!r}if(r&&!(w=r.getPrevious()))i=r.getParent()}else{z&&(w=r.getChild(z-1)||r.getLast());w||(i=r)}for(i=c(i);i||w;){if(i&&!w){!x&&i.equals(g)&&(x=true);if(f?i.isBlockBoundary():!h.contains(i))break;if(!v||i.getComputedStyle("display")!="inline"){v=false;x?e=i:this.setStartBefore(i)}w=i.getPrevious()}for(;w;){r=false;if(w.type==CKEDITOR.NODE_COMMENT)w=w.getPrevious();else{if(w.type==CKEDITOR.NODE_TEXT){y=w.getText();d.test(y)&&(w=null);r=/[\s\ufeff]$/.test(y)}else if((w.$.offsetWidth>(CKEDITOR.env.webkit?1:0)||b&&w.is("br"))&&!w.data("cke-bookmark"))if(v&&CKEDITOR.dtd.$removeEmpty[w.getName()]){y=w.getText();if(d.test(y))w=null;else for(var z=w.$.getElementsByTagName("*"),B=0,A;A=z[B++];)if(!CKEDITOR.dtd.$removeEmpty[A.nodeName.toLowerCase()]){w=null;break}w&&(r=!!y.length)}else w=null;r&&(v?x?e=i:i&&this.setStartBefore(i):v=true);if(w){r=w.getPrevious();if(!i&&!r){i=w;w=null;break}w=r}else i=null}}i&&(i=c(i.getParent()))}r=this.endContainer;z=this.endOffset;i=w=null;x=v=false;var G=function(a,b){var c=new CKEDITOR.dom.range(h);c.setStart(a,b);c.setEndAt(h,CKEDITOR.POSITION_BEFORE_END);var c=new CKEDITOR.dom.walker(c),f;for(c.guard=function(a){return!(a.type==CKEDITOR.NODE_ELEMENT&&a.isBlockBoundary())};f=c.next();){if(f.type!=CKEDITOR.NODE_TEXT)return false;y=f!=a?f.getText():f.substring(b);if(d.test(y))return false}return true};if(r.type==CKEDITOR.NODE_TEXT)if(CKEDITOR.tools.trim(r.substring(z)).length)v=true;else{v=!r.getLength();if(z==r.getLength()){if(!(w=r.getNext()))i=r.getParent()}else G(r,z)&&(i=r.getParent())}else(w=r.getChild(z))||(i=r);for(;i||w;){if(i&&!w){!x&&i.equals(g)&&(x=true);if(f?i.isBlockBoundary():!h.contains(i))break;if(!v||i.getComputedStyle("display")!="inline"){v=false;x?j=i:i&&this.setEndAfter(i)}w=i.getNext()}for(;w;){r=false;if(w.type==CKEDITOR.NODE_TEXT){y=w.getText();G(w,0)||(w=null);r=/^[\s\ufeff]/.test(y)}else if(w.type==CKEDITOR.NODE_ELEMENT){if((w.$.offsetWidth>0||b&&w.is("br"))&&!w.data("cke-bookmark"))if(v&&CKEDITOR.dtd.$removeEmpty[w.getName()]){y=w.getText();if(d.test(y))w=null;else{z=w.$.getElementsByTagName("*");for(B=0;A=z[B++];)if(!CKEDITOR.dtd.$removeEmpty[A.nodeName.toLowerCase()]){w=null;break}}w&&(r=!!y.length)}else w=null}else r=1;r&&v&&(x?j=i:this.setEndAfter(i));if(w){r=w.getNext();if(!i&&!r){i=w;w=null;break}w=r}else i=null}i&&(i=c(i.getParent()))}if(e&&j){g=e.contains(j)?j:e;this.setStartBefore(g);this.setEndAfter(g)}break;case CKEDITOR.ENLARGE_BLOCK_CONTENTS:case CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:i=new CKEDITOR.dom.range(this.root);h=this.root;i.setStartAt(h,CKEDITOR.POSITION_AFTER_START);i.setEnd(this.startContainer,this.startOffset);i=new CKEDITOR.dom.walker(i);var D,J,C=CKEDITOR.dom.walker.blockBoundary(a==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?{br:1}:null),F=null,E=function(a){if(a.type==CKEDITOR.NODE_ELEMENT&&a.getAttribute("contenteditable")=="false")if(F){if(F.equals(a)){F=null;return}}else F=a;else if(F)return;var b=C(a);b||(D=a);return b},f=function(a){var b=E(a);!b&&(a.is&&a.is("br"))&&(J=a);return b};i.guard=E;i=i.lastBackward();D=D||h;this.setStartAt(D,!D.is("br")&&(!i&&this.checkStartOfBlock()||i&&D.contains(i))?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_AFTER_END);if(a==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS){i=this.clone();i=new CKEDITOR.dom.walker(i);var I=CKEDITOR.dom.walker.whitespaces(),L=CKEDITOR.dom.walker.bookmark();i.evaluator=function(a){return!I(a)&&!L(a)};if((i=i.previous())&&i.type==CKEDITOR.NODE_ELEMENT&&i.is("br"))break}i=this.clone();i.collapse();i.setEndAt(h,CKEDITOR.POSITION_BEFORE_END);i=new CKEDITOR.dom.walker(i);i.guard=a==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?f:E;D=F=J=null;i=i.lastForward();D=D||h;this.setEndAt(D,!i&&this.checkEndOfBlock()||i&&D.contains(i)?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_BEFORE_START);J&&this.setEndAfter(J)}},shrink:function(a,b,c){if(!this.collapsed){var a=a||CKEDITOR.SHRINK_TEXT,d=this.clone(),f=this.startContainer,g=this.endContainer,h=this.startOffset,e=this.endOffset,i=1,j=1;if(f&&f.type==CKEDITOR.NODE_TEXT)if(h)if(h>=f.getLength())d.setStartAfter(f);else{d.setStartBefore(f);i=0}else d.setStartBefore(f);if(g&&g.type==CKEDITOR.NODE_TEXT)if(e)if(e>=g.getLength())d.setEndAfter(g);else{d.setEndAfter(g);j=0}else d.setEndBefore(g);var d=new CKEDITOR.dom.walker(d),w=CKEDITOR.dom.walker.bookmark();d.evaluator=function(b){return b.type==(a==CKEDITOR.SHRINK_ELEMENT?CKEDITOR.NODE_ELEMENT:CKEDITOR.NODE_TEXT)};var x;d.guard=function(b,d){if(w(b))return true;if(a==CKEDITOR.SHRINK_ELEMENT&&b.type==CKEDITOR.NODE_TEXT||d&&b.equals(x)||c===false&&b.type==CKEDITOR.NODE_ELEMENT&&b.isBlockBoundary()||b.type==CKEDITOR.NODE_ELEMENT&&b.hasAttribute("contenteditable"))return false;!d&&b.type==CKEDITOR.NODE_ELEMENT&&(x=b);return true};if(i)(f=d[a==CKEDITOR.SHRINK_ELEMENT?"lastForward":"next"]())&&this.setStartAt(f,b?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_START);if(j){d.reset();(d=d[a==CKEDITOR.SHRINK_ELEMENT?"lastBackward":"previous"]())&&this.setEndAt(d,b?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_END)}return!(!i&&!j)}},insertNode:function(a){this.optimizeBookmark();this.trim(false,true);var b=this.startContainer,c=b.getChild(this.startOffset);c?a.insertBefore(c):b.append(a);a.getParent()&&a.getParent().equals(this.endContainer)&&this.endOffset++;this.setStartBefore(a)},moveToPosition:function(a,b){this.setStartAt(a,b);this.collapse(true)},moveToRange:function(a){this.setStart(a.startContainer,a.startOffset);this.setEnd(a.endContainer,a.endOffset)},selectNodeContents:function(a){this.setStart(a,0);this.setEnd(a,a.type==CKEDITOR.NODE_TEXT?a.getLength():a.getChildCount())},setStart:function(a,b){if(a.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[a.getName()]){b=a.getIndex();a=a.getParent()}this._setStartContainer(a);this.startOffset=b;if(!this.endContainer){this._setEndContainer(a);this.endOffset=b}g(this)},setEnd:function(a,b){if(a.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[a.getName()]){b=a.getIndex()+1;a=a.getParent()}this._setEndContainer(a);this.endOffset=b;if(!this.startContainer){this._setStartContainer(a);this.startOffset =b}g(this)},setStartAfter:function(a){this.setStart(a.getParent(),a.getIndex()+1)},setStartBefore:function(a){this.setStart(a.getParent(),a.getIndex())},setEndAfter:function(a){this.setEnd(a.getParent(),a.getIndex()+1)},setEndBefore:function(a){this.setEnd(a.getParent(),a.getIndex())},setStartAt:function(a,b){switch(b){case CKEDITOR.POSITION_AFTER_START:this.setStart(a,0);break;case CKEDITOR.POSITION_BEFORE_END:a.type==CKEDITOR.NODE_TEXT?this.setStart(a,a.getLength()):this.setStart(a,a.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setStartBefore(a);break;case CKEDITOR.POSITION_AFTER_END:this.setStartAfter(a)}g(this)},setEndAt:function(a,b){switch(b){case CKEDITOR.POSITION_AFTER_START:this.setEnd(a,0);break;case CKEDITOR.POSITION_BEFORE_END:a.type==CKEDITOR.NODE_TEXT?this.setEnd(a,a.getLength()):this.setEnd(a,a.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setEndBefore(a);break;case CKEDITOR.POSITION_AFTER_END:this.setEndAfter(a)}g(this)},fixBlock:function(a,b){var c=this.createBookmark(),d=this.document.createElement(b);this.collapse(a);this.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS);this.extractContents().appendTo(d);d.trim();d.appendBogus();this.insertNode(d);this.moveToBookmark(c);return d},splitBlock:function(a){var b=new CKEDITOR.dom.elementPath(this.startContainer,this.root),c=new CKEDITOR.dom.elementPath(this.endContainer,this.root),d=b.block,f=c.block,g=null;if(!b.blockLimit.equals(c.blockLimit))return null;if(a!="br"){if(!d){d=this.fixBlock(true,a);f=(new CKEDITOR.dom.elementPath(this.endContainer,this.root)).block}f||(f=this.fixBlock(false,a))}a=d&&this.checkStartOfBlock();b=f&&this.checkEndOfBlock();this.deleteContents();if(d&&d.equals(f))if(b){g=new CKEDITOR.dom.elementPath(this.startContainer,this.root);this.moveToPosition(f,CKEDITOR.POSITION_AFTER_END);f=null}else if(a){g=new CKEDITOR.dom.elementPath(this.startContainer,this.root);this.moveToPosition(d,CKEDITOR.POSITION_BEFORE_START);d=null}else{f=this.splitElement(d);d.is("ul","ol")||d.appendBogus()}return{previousBlock:d,nextBlock:f,wasStartOfBlock:a,wasEndOfBlock:b,elementPath:g}},splitElement:function(a){if(!this.collapsed)return null;this.setEndAt(a,CKEDITOR.POSITION_BEFORE_END);var b=this.extractContents(),c=a.clone(false);b.appendTo(c);c.insertAfter(a);this.moveToPosition(a,CKEDITOR.POSITION_AFTER_END);return c},removeEmptyBlocksAtEnd:function(){function a(d){return function(a){return b(a)||(c(a)||a.type==CKEDITOR.NODE_ELEMENT&&a.isEmptyInlineRemoveable())||d.is("table")&&a.is("caption")?false:true}}var b=CKEDITOR.dom.walker.whitespaces(),c=CKEDITOR.dom.walker.bookmark(false);return function(b){for(var c=this.createBookmark(),d=this[b?"endPath":"startPath"](),f=d.block||d.blockLimit,g;f&&!f.equals(d.root)&&!f.getFirst(a(f));){g=f.getParent();this[b?"setEndAt":"setStartAt"](f,CKEDITOR.POSITION_AFTER_END);f.remove(1);f=g}this.moveToBookmark(c)}}(),startPath:function(){return new CKEDITOR.dom.elementPath(this.startContainer,this.root)},endPath:function(){return new CKEDITOR.dom.elementPath(this.endContainer,this.root)},checkBoundaryOfElement:function(a,b){var c=b==CKEDITOR.START,d=this.clone();d.collapse(c);d[c?"setStartAt":"setEndAt"](a,c?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END);d=new CKEDITOR.dom.walker(d);d.evaluator=e(c);return d[c?"checkBackward":"checkForward"]()},checkStartOfBlock:function(){var b=this.startContainer,c=this.startOffset;if(CKEDITOR.env.ie&&c&&b.type==CKEDITOR.NODE_TEXT){b=CKEDITOR.tools.ltrim(b.substring(0,c));f.test(b)&&this.trim(0,1)}this.trim();b=new CKEDITOR.dom.elementPath(this.startContainer,this.root);c=this.clone();c.collapse(true);c.setStartAt(b.block||b.blockLimit,CKEDITOR.POSITION_AFTER_START);b=new CKEDITOR.dom.walker(c);b.evaluator=a();return b.checkBackward()},checkEndOfBlock:function(){var b=this.endContainer,c=this.endOffset;if(CKEDITOR.env.ie&&b.type==CKEDITOR.NODE_TEXT){b=CKEDITOR.tools.rtrim(b.substring(c));f.test(b)&&this.trim(1,0)}this.trim();b=new CKEDITOR.dom.elementPath(this.endContainer,this.root);c=this.clone();c.collapse(false);c.setEndAt(b.block||b.blockLimit,CKEDITOR.POSITION_BEFORE_END);b=new CKEDITOR.dom.walker(c);b.evaluator=a();return b.checkForward()},getPreviousNode:function(a,b,c){var d=this.clone();d.collapse(1);d.setStartAt(c||this.root,CKEDITOR.POSITION_AFTER_START);c=new CKEDITOR.dom.walker(d);c.evaluator=a;c.guard=b;return c.previous()},getNextNode:function(a,b,c){var d=this.clone();d.collapse();d.setEndAt(c||this.root,CKEDITOR.POSITION_BEFORE_END);c=new CKEDITOR.dom.walker(d);c.evaluator=a;c.guard=b;return c.next()},checkReadOnly:function(){function a(b,c){for(;b;){if(b.type==CKEDITOR.NODE_ELEMENT){if(b.getAttribute("contentEditable")=="false"&&!b.data("cke-editable"))return 0;if(b.is("html")||b.getAttribute("contentEditable")=="true"&&(b.contains(c)||b.equals(c)))break}b=b.getParent()}return 1}return function(){var b=this.startContainer,c=this.endContainer;return!(a(b,c)&&a(c,b))}}(),moveToElementEditablePosition:function(a,b){if(a.type==CKEDITOR.NODE_ELEMENT&&!a.isEditable(false)){this.moveToPosition(a,b?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START);return true}for(var c=0;a;){if(a.type==CKEDITOR.NODE_TEXT){b&&this.endContainer&&this.checkEndOfBlock()&&f.test(a.getText())?this.moveToPosition(a,CKEDITOR.POSITION_BEFORE_START):this.moveToPosition(a,b?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START);c=1;break}if(a.type==CKEDITOR.NODE_ELEMENT)if(a.isEditable()){this.moveToPosition(a,b?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_START);c=1}else if(b&&a.is("br")&&this.endContainer&&this.checkEndOfBlock())this.moveToPosition(a,CKEDITOR.POSITION_BEFORE_START);else if(a.getAttribute("contenteditable")=="false"&&a.is(CKEDITOR.dtd.$block)){this.setStartBefore(a);this.setEndAfter(a);return true}var d=a,g=c,h=void 0;d.type==CKEDITOR.NODE_ELEMENT&&d.isEditable(false)&&(h=d[b?"getLast":"getFirst"](i));!g&&!h&&(h=d[b?"getPrevious":"getNext"](i));a=h}return!!c},moveToClosestEditablePosition:function(a,b){var c=new CKEDITOR.dom.range(this.root),d=0,f,g=[CKEDITOR.POSITION_AFTER_END,CKEDITOR.POSITION_BEFORE_START];c.moveToPosition(a,g[b?0:1]);if(a.is(CKEDITOR.dtd.$block)){if(f=c[b?"getNextEditableNode":"getPreviousEditableNode"]()){d=1;if(f.type==CKEDITOR.NODE_ELEMENT&&f.is(CKEDITOR.dtd.$block)&&f.getAttribute("contenteditable")=="false"){c.setStartAt(f,CKEDITOR.POSITION_BEFORE_START);c.setEndAt(f,CKEDITOR.POSITION_AFTER_END)}else c.moveToPosition(f,g[b?1:0])}}else d=1;d&&this.moveToRange(c);return!!d},moveToElementEditStart:function(a){return this.moveToElementEditablePosition(a)},moveToElementEditEnd:function(a){return this.moveToElementEditablePosition(a,true)},getEnclosedNode:function(){var a=this.clone();a.optimize();if(a.startContainer.type!=CKEDITOR.NODE_ELEMENT||a.endContainer.type!=CKEDITOR.NODE_ELEMENT)return null;var a=new CKEDITOR.dom.walker(a),b=CKEDITOR.dom.walker.bookmark(false,true),c=CKEDITOR.dom.walker.whitespaces(true);a.evaluator=function(a){return c(a)&&b(a)};var d=a.next();a.reset();return d&&d.equals(a.previous())?d:null},getTouchedStartNode:function(){var a=this.startContainer;return this.collapsed||a.type!=CKEDITOR.NODE_ELEMENT?a:a.getChild(this.startOffset)||a},getTouchedEndNode:function(){var a=this.endContainer;return this.collapsed||a.type!=CKEDITOR.NODE_ELEMENT?a:a.getChild(this.endOffset-1)||a},getNextEditableNode:b(),getPreviousEditableNode:b(1),scrollIntoView:function(){var a=new CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",this.document),b,c,d,f=this.clone();f.optimize();if(d=f.startContainer.type==CKEDITOR.NODE_TEXT){c=f.startContainer.getText();b=f.startContainer.split(f.startOffset);a.insertAfter(f.startContainer)}else f.insertNode(a);a.scrollIntoView();if(d){f.startContainer.setText(c);b.remove()}a.remove()},_setStartContainer:function(a){this.startContainer=a},_setEndContainer:function(a){this.endContainer=a}}}(),CKEDITOR.POSITION_AFTER_START=1,CKEDITOR.POSITION_BEFORE_END=2,CKEDITOR.POSITION_BEFORE_START=3,CKEDITOR.POSITION_AFTER_END=4,CKEDITOR.ENLARGE_ELEMENT=1,CKEDITOR.ENLARGE_BLOCK_CONTENTS=2,CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS=3,CKEDITOR.ENLARGE_INLINE=4,CKEDITOR.START=1,CKEDITOR.END=2,CKEDITOR.SHRINK_ELEMENT=1,CKEDITOR.SHRINK_TEXT=2,"use strict",function(){function a(a){if(!(arguments.length<1)){this.range=a;this.forceBrBreak=0;this.enlargeBr=1;this.enforceRealBlocks=0;this._||(this._={})}}function e(a){var b=[];a.forEach(function(a){if(a.getAttribute("contenteditable")=="true"){b.push(a);return false}},CKEDITOR.NODE_ELEMENT,true);return b}function b(a,c,d,f){a:{f==null&&(f=e(d));for(var g;g=f.shift();)if(g.getDtd().p){f={element:g,remaining:f};break a}f=null}if(!f)return 0;if((g=CKEDITOR.filter.instances[f.element.data("cke-filter")])&&!g.check(c))return b(a,c,d,f.remaining);c=new CKEDITOR.dom.range(f.element);c.selectNodeContents(f.element);c=c.createIterator();c.enlargeBr=a.enlargeBr;c.enforceRealBlocks=a.enforceRealBlocks;c.activeFilter=c.filter=g;a._.nestedEditable={element:f.element,container:d,remaining:f.remaining,iterator:c};return 1}function g(a,b,c){if(!b)return false;a=a.clone();a.collapse(!c);return a.checkBoundaryOfElement(b,c?CKEDITOR.START:CKEDITOR.END)}var c=/^[\r\n\t ]+$/,d=CKEDITOR.dom.walker.bookmark(false,true),j=CKEDITOR.dom.walker.whitespaces(true),f=function(a){return d(a)&&j(a)},h={dd:1,dt:1,li:1};a.prototype={getNextParagraph:function(a){var e,j,o,q,m,a=a||"p";if(this._.nestedEditable){if(e=this._.nestedEditable.iterator.getNextParagraph(a)){this.activeFilter=this._.nestedEditable.iterator.activeFilter;return e}this.activeFilter=this.filter;if(b(this,a,this._.nestedEditable.container,this._.nestedEditable.remaining)){this.activeFilter=this._.nestedEditable.iterator.activeFilter;return this._.nestedEditable.iterator.getNextParagraph(a)}this._.nestedEditable=null}if(!this.range.root.getDtd()[a])return null;if(!this._.started){var l=this.range.clone();j=l.startPath();var p=l.endPath(),t=!l.collapsed&&g(l,j.block),s=!l.collapsed&&g(l,p.block,1);l.shrink(CKEDITOR.SHRINK_ELEMENT,true);t&&l.setStartAt(j.block,CKEDITOR.POSITION_BEFORE_END);s&&l.setEndAt(p.block,CKEDITOR.POSITION_AFTER_START);j=l.endContainer.hasAscendant("pre",true)||l.startContainer.hasAscendant("pre",true);l.enlarge(this.forceBrBreak&&!j||!this.enlargeBr?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS);if(!l.collapsed){j=new CKEDITOR.dom.walker(l.clone());p=CKEDITOR.dom.walker.bookmark(true,true);j.evaluator=p;this._.nextNode=j.next();j=new CKEDITOR.dom.walker(l.clone());j.evaluator=p;j=j.previous();this._.lastNode=j.getNextSourceNode(true,null,l.root);if(this._.lastNode&&this._.lastNode.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(this._.lastNode.getText())&&this._.lastNode.getParent().isBlockBoundary()){p=this.range.clone();p.moveToPosition(this._.lastNode,CKEDITOR.POSITION_AFTER_END);if(p.checkEndOfBlock()){p=new CKEDITOR.dom.elementPath(p.endContainer,p.root);this._.lastNode=(p.block||p.blockLimit).getNextSourceNode(true)}}if(!this._.lastNode||!l.root.contains(this._.lastNode)){this._.lastNode=this._.docEndMarker=l.document.createText("");this._.lastNode.insertAfter(j)}l=null}this._.started=1;j=l}p=this._.nextNode;l=this._.lastNode;for(this._.nextNode=null;p;){var t=0,s=p.hasAscendant("pre"),u=p.type!=CKEDITOR.NODE_ELEMENT,w=0;if(u)p.type==CKEDITOR.NODE_TEXT&&c.test(p.getText())&&(u=0);else{var x=p.getName();if(CKEDITOR.dtd.$block[x]&&p.getAttribute("contenteditable")=="false"){e=p;b(this,a,e);break}else if(p.isBlockBoundary(this.forceBrBreak&&!s&&{br:1})){if(x=="br")u=1;else if(!j&&!p.getChildCount()&&x!="hr"){e=p;o=p.equals(l);break}if(j){j.setEndAt(p,CKEDITOR.POSITION_BEFORE_START);if(x!="br")this._.nextNode=p}t=1}else{if(p.getFirst()){if(!j){j=this.range.clone();j.setStartAt(p,CKEDITOR.POSITION_BEFORE_START)}p=p.getFirst();continue}u=1}}if(u&&!j){j=this.range.clone();j.setStartAt(p,CKEDITOR.POSITION_BEFORE_START)}o=(!t||u)&&p.equals(l);if(j&&!t)for(;!p.getNext(f)&&!o;){x=p.getParent();if(x.isBlockBoundary(this.forceBrBreak&&!s&&{br:1})){t=1;u=0;o||x.equals(l);j.setEndAt(x,CKEDITOR.POSITION_BEFORE_END);break}p=x;u=1;o=p.equals(l);w=1}u&&j.setEndAt(p,CKEDITOR.POSITION_AFTER_END);p=this._getNextSourceNode(p,w,l);if((o=!p)||t&&j)break}if(!e){if(!j){this._.docEndMarker&&this._.docEndMarker.remove();return this._.nextNode=null}e=new CKEDITOR.dom.elementPath(j.startContainer,j.root);p=e.blockLimit;t={div:1,th:1,td:1};e=e.block;if(!e&&p&&!this.enforceRealBlocks&&t[p.getName()]&&j.checkStartOfBlock()&&j.checkEndOfBlock()&&!p.equals(j.root))e=p;else if(!e||this.enforceRealBlocks&&e.is(h)){e=this.range.document.createElement(a);j.extractContents().appendTo(e);e.trim();j.insertNode(e);q=m=true}else if(e.getName()!="li"){if(!j.checkStartOfBlock()||!j.checkEndOfBlock()){e=e.clone(false);j.extractContents().appendTo(e);e.trim();m=j.splitBlock();q=!m.wasStartOfBlock;m=!m.wasEndOfBlock;j.insertNode(e)}}else if(!o)this._.nextNode=e.equals(l)?null:this._getNextSourceNode(j.getBoundaryNodes().endNode,1,l)}if(q)(q=e.getPrevious())&&q.type==CKEDITOR.NODE_ELEMENT&&(q.getName()=="br"?q.remove():q.getLast()&&q.getLast().$.nodeName.toLowerCase()=="br"&&q.getLast().remove());if(m)(q=e.getLast())&&q.type==CKEDITOR.NODE_ELEMENT&&q.getName()=="br"&&(!CKEDITOR.env.needsBrFiller||q.getPrevious(d)||q.getNext(d))&&q.remove();if(!this._.nextNode)this._.nextNode=o||e.equals(l)||!l?null:this._getNextSourceNode(e,1,l);return e},_getNextSourceNode:function(a,b,c){function f(a){return!(a.equals(c)||a.equals(g))}for(var g=this.range.root,a=a.getNextSourceNode(b,null,f);!d(a);)a=a.getNextSourceNode(b,null,f);return a}};CKEDITOR.dom.range.prototype.createIterator=function(){return new a(this)}}(),CKEDITOR.command=function(a,e){this.uiItems=[];this.exec=function(b){if(this.state==CKEDITOR.TRISTATE_DISABLED||!this.checkAllowed())return false;this.editorFocus&&a.focus();return this.fire("exec")===false?true:e.exec.call(this,a,b)!==false};this.refresh=function(a,b){if(!this.readOnly&&a.readOnly)return true;if(this.context&&!b.isContextFor(this.context)){this.disable();return true}if(!this.checkAllowed(true)){this.disable();return true}this.startDisabled||this.enable();this.modes&&!this.modes[a.mode]&&this.disable();return this.fire("refresh",{editor:a,path:b})===false?true:e.refresh&&e.refresh.apply(this,arguments)!==false};var b;this.checkAllowed=function(g){return!g&&typeof b=="boolean"?b:b=a.activeFilter.checkFeature(this)};CKEDITOR.tools.extend(this,e,{modes:{wysiwyg:1},editorFocus:1,contextSensitive:!!e.context,state:CKEDITOR.TRISTATE_DISABLED});CKEDITOR.event.call(this)},CKEDITOR.command.prototype={enable:function(){this.state==CKEDITOR.TRISTATE_DISABLED&&this.checkAllowed()&&this.setState(!this.preserveState||typeof this.previousState=="undefined"?CKEDITOR.TRISTATE_OFF:this.previousState)},disable:function(){this.setState(CKEDITOR.TRISTATE_DISABLED)},setState:function(a){if(this.state==a||a!=CKEDITOR.TRISTATE_DISABLED&&!this.checkAllowed())return false;this.previousState=this.state;this.state=a;this.fire("state");return true},toggleState:function(){this.state==CKEDITOR.TRISTATE_OFF?this.setState(CKEDITOR.TRISTATE_ON):this.state==CKEDITOR.TRISTATE_ON&&this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.event.implementOn(CKEDITOR.command.prototype),CKEDITOR.ENTER_P=1,CKEDITOR.ENTER_BR=2,CKEDITOR.ENTER_DIV=3,CKEDITOR.config={customConfig:"config.js",autoUpdateElement:!0,language:"",defaultLanguage:"en",contentsLangDirection:"",enterMode:CKEDITOR.ENTER_P,forceEnterMode:!1,shiftEnterMode:CKEDITOR.ENTER_BR,docType:"<!DOCTYPE html>",bodyId:"",bodyClass:"",fullPage:!1,height:200,extraPlugins:"",removePlugins:"",protectedSource:[],tabIndex:0,width:"",baseFloatZIndex:1E4,blockedKeystrokes:[CKEDITOR.CTRL+66,CKEDITOR.CTRL+73,CKEDITOR.CTRL+85]},function(){function a(a,b,c,d,f){var g,h,a=[];for(g in b){h=b[g];h=typeof h=="boolean"?{}:typeof h=="function"?{match:h}:G(h);if(g.charAt(0)!="$")h.elements=g;if(c)h.featureName=c.toLowerCase();var e=h;e.elements=j(e.elements,/\s+/)||null;e.propertiesOnly=e.propertiesOnly||e.elements===true;var i=/\s*,\s*/,p=void 0;for(p in F){e[p]=j(e[p],i)||null;var m=e,k=E[p],x=j(e[E[p]],i),s=e[p],w=[],l=true,C=void 0;x?l=false:x={};for(C in s)if(C.charAt(0)=="!"){C=C.slice(1);w.push(C);x[C]=true;l=false}for(;C=w.pop();){s[C]=s["!"+C];delete s["!"+C]}m[k]=(l?false:x)||null}e.match=e.match||null;d.push(h);a.push(h)}for(var b=f.elements,f=f.generic,n,c=0,d=a.length;c<d;++c){g=G(a[c]);h=g.classes===true||g.styles===true||g.attributes===true;e=g;p=k=i=void 0;for(i in F)e[i]=t(e[i]);m=true;for(p in E){i=E[p];k=e[i];x=[];s=void 0;for(s in k)s.indexOf("*")>-1?x.push(RegExp("^"+s.replace(/\*/g,".*")+"$")):x.push(s);k=x;if(k.length){e[i]=k;m=false}}e.nothingRequired=m;e.noProperties=!(e.attributes||e.classes||e.styles);if(g.elements===true||g.elements===null)f[h?"unshift":"push"](g);else{e=g.elements;delete g.elements;for(n in e)if(b[n])b[n][h?"unshift":"push"](g);else b[n]=[g]}}}function e(a,c,d,g){if(!a.match||a.match(c))if(g||f(a,c)){if(!a.propertiesOnly)d.valid=true;if(!d.allAttributes)d.allAttributes=b(a.attributes,c.attributes,d.validAttributes);if(!d.allStyles)d.allStyles=b(a.styles,c.styles,d.validStyles);if(!d.allClasses){a=a.classes;c=c.classes;g=d.validClasses;if(a)if(a===true)a=true;else{for(var h=0,e=c.length,j;h<e;++h){j=c[h];g[j]||(g[j]=a(j))}a=false}else a=false;d.allClasses=a}}}function b(a,b,c){if(!a)return false;if(a===true)return true;for(var d in b)c[d]||(c[d]=a(d));return false}function g(a,b,d){if(!a.match||a.match(b)){if(a.noProperties)return false;d.hadInvalidAttribute=c(a.attributes,b.attributes)||d.hadInvalidAttribute;d.hadInvalidStyle=c(a.styles,b.styles)||d.hadInvalidStyle;a=a.classes;b=b.classes;if(a){for(var f=false,g=a===true,h=b.length;h--;)if(g||a(b[h])){b.splice(h,1);f=true}a=f}else a=false;d.hadInvalidClass=a||d.hadInvalidClass}}function c(a,b){if(!a)return false;var c=false,d=a===true,f;for(f in b)if(d||a(f)){delete b[f];c=true}return c}function d(a,b,c){if(a.disabled||a.customConfig&&!c||!b)return false;a._.cachedChecks={};return true}function j(a,b){if(!a)return false;if(a===true)return a;if(typeof a=="string"){a=D(a);return a=="*"?true:CKEDITOR.tools.convertArrayToObject(a.split(b))}if(CKEDITOR.tools.isArray(a))return a.length?CKEDITOR.tools.convertArrayToObject(a):false;var c={},d=0,f;for(f in a){c[f]=a[f];d++}return d?c:false}function f(a,b){if(a.nothingRequired)return true;var c,d,f,g;if(f=a.requiredClasses){g=b.classes;for(c=0;c<f.length;++c){d=f[c];if(typeof d=="string"){if(CKEDITOR.tools.indexOf(g,d)==-1)return false}else if(!CKEDITOR.tools.checkIfAnyArrayItemMatches(g,d))return false}}return h(b.styles,a.requiredStyles)&&h(b.attributes,a.requiredAttributes)}function h(a,b){if(!b)return true;for(var c=0,d;c<b.length;++c){d=b[c];if(typeof d=="string"){if(!(d in a))return false}else if(!CKEDITOR.tools.checkIfAnyObjectPropertyMatches(a,d))return false}return true}function i(a){if(!a)return{};for(var a=a.split(/\s*,\s*/).sort(),b={};a.length;)b[a.shift()]=J;return b}function k(a){for(var b,c,d,f,g={},h=1,a=D(a);b=a.match(I);){if(c=b[2]){d=n(c,"styles");f=n(c,"attrs");c=n(c,"classes")}else d=f=c=null;g["$"+h++]={elements:b[1],classes:c,styles:d,attributes:f};a=a.slice(b[0].length)}return g}function n(a,b){var c=a.match(L[b]);return c?D(c[1]):null}function o(a){var b=a.styleBackup=a.attributes.style,c=a.classBackup=a.attributes["class"];if(!a.styles)a.styles=CKEDITOR.tools.parseCssText(b||"",1);if(!a.classes)a.classes=c?c.split(/\s+/):[]}function q(a,b,c,d){var f=0,h;if(d.toHtml)b.name=b.name.replace(H,"$1");if(d.doCallbacks&&a.elementCallbacks){a:for(var j=a.elementCallbacks,i=0,m=j.length,t;i<m;++i)if(t=j[i](b)){h=t;break a}if(h)return h}if(d.doTransform)if(h=a._.transformations[b.name]){o(b);for(j=0;j<h.length;++j)x(a,b,h[j]);l(b)}if(d.doFilter){a:{j=b.name;i=a._;a=i.allowedRules.elements[j];h=i.allowedRules.generic;j=i.disallowedRules.elements[j];i=i.disallowedRules.generic;m=d.skipRequired;t={valid:false,validAttributes:{},validClasses:{},validStyles:{},allAttributes:false,allClasses:false,allStyles:false,hadInvalidAttribute:false,hadInvalidClass:false,hadInvalidStyle:false};var k,s;if(!a&&!h)a=null;else{o(b);if(j){k=0;for(s=j.length;k<s;++k)if(g(j[k],b,t)===false){a=null;break a}}if(i){k=0;for(s=i.length;k<s;++k)g(i[k],b,t)}if(a){k=0;for(s=a.length;k<s;++k)e(a[k],b,t,m)}if(h){k=0;for(s=h.length;k<s;++k)e(h[k],b,t,m)}a=t}}if(!a){c.push(b);return A}if(!a.valid){c.push(b);return A}s=a.validAttributes;var w=a.validStyles;h=a.validClasses;var j=b.attributes,C=b.styles,i=b.classes,m=b.classBackup,n=b.styleBackup,v,F,r=[];t=[];var u=/^data-cke-/;k=false;delete j.style;delete j["class"];delete b.classBackup;delete b.styleBackup;if(!a.allAttributes)for(v in j)if(!s[v])if(u.test(v)){if(v!=(F=v.replace(/^data-cke-saved-/,""))&&!s[F]){delete j[v];k=true}}else{delete j[v];k=true}if(!a.allStyles||a.hadInvalidStyle){for(v in C)a.allStyles||w[v]?r.push(v+":"+C[v]):k=true;if(r.length)j.style=r.sort().join("; ")}else if(n)j.style=n;if(!a.allClasses||a.hadInvalidClass){for(v=0;v<i.length;++v)(a.allClasses||h[i[v]])&&t.push(i[v]);t.length&&(j["class"]=t.sort().join(" "));m&&t.length<m.split(/\s+/).length&&(k=true)}else m&&(j["class"]=m);k&&(f=A);if(!d.skipFinalValidation&&!p(b)){c.push(b);return A}}if(d.toHtml)b.name=b.name.replace(Q,"cke:$1");return f}function m(a){var b=[],c;for(c in a)c.indexOf("*")>-1&&b.push(c.replace(/\*/g,".*"));return b.length?RegExp("^(?:"+b.join("|")+")$"):null}function l(a){var b=a.attributes,c;delete b.style;delete b["class"];if(c=CKEDITOR.tools.writeCssText(a.styles,true))b.style=c;a.classes.length&&(b["class"]=a.classes.sort().join(" "))}function p(a){switch(a.name){case"a":if(!a.children.length&&!a.attributes.name)return false;break;case"img":if(!a.attributes.src)return false}return true}function t(a){if(!a)return false;if(a===true)return true;var b=m(a);return function(c){return c in a||b&&c.match(b)}}function s(){return new CKEDITOR.htmlParser.element("br")}function u(a){return a.type==CKEDITOR.NODE_ELEMENT&&(a.name=="br"||B.$block[a.name])}function w(a,b,c){var d=a.name;if(B.$empty[d]||!a.children.length)if(d=="hr"&&b=="br")a.replaceWith(s());else{a.parent&&c.push({check:"it",el:a.parent});a.remove()}else if(B.$block[d]||d=="tr")if(b=="br"){if(a.previous&&!u(a.previous)){b=s();b.insertBefore(a)}if(a.next&&!u(a.next)){b=s();b.insertAfter(a)}a.replaceWithChildren()}else{var d=a.children,f;b:{f=B[b];for(var g=0,h=d.length,e;g<h;++g){e=d[g];if(e.type==CKEDITOR.NODE_ELEMENT&&!f[e.name]){f=false;break b}}f=true}if(f){a.name=b;a.attributes={};c.push({check:"parent-down",el:a})}else{f=a.parent;for(var g=f.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||f.name=="body",j,i,h=d.length;h>0;){e=d[--h];if(g&&(e.type==CKEDITOR.NODE_TEXT||e.type==CKEDITOR.NODE_ELEMENT&&B.$inline[e.name])){if(!j){j=new CKEDITOR.htmlParser.element(b);j.insertAfter(a);c.push({check:"parent-down",el:j})}j.add(e,0)}else{j=null;i=B[f.name]||B.span;e.insertAfter(a);f.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT&&(e.type==CKEDITOR.NODE_ELEMENT&&!i[e.name])&&c.push({check:"el-up",el:e})}}a.remove()}}else if(d=="style")a.remove();else{a.parent&&c.push({check:"it",el:a.parent});a.replaceWithChildren()}}function x(a,b,c){var d,f;for(d=0;d<c.length;++d){f=c[d];if((!f.check||a.check(f.check,false))&&(!f.left||f.left(b))){f.right(b,O);break}}}function v(a,b){var c=b.getDefinition(),d=c.attributes,f=c.styles,g,h,e,j;if(a.name!=c.element)return false;for(g in d)if(g=="class"){c=d[g].split(/\s+/);for(e=a.classes.join("|");j=c.pop();)if(e.indexOf(j)==-1)return false}else if(a.attributes[g]!=d[g])return false;for(h in f)if(a.styles[h]!=f[h])return false;return true}function r(a,b){var c,d;if(typeof a=="string")c=a;else if(a instanceof CKEDITOR.style)d=a;else{c=a[0];d=a[1]}return[{element:c,left:d,right:function(a,c){c.transform(a,b)}}]}function y(a){return function(b){return v(b,a)}}function z(a){return function(b,c){c[a](b)}}var B=CKEDITOR.dtd,A=1,G=CKEDITOR.tools.copy,D=CKEDITOR.tools.trim,J="cke-test",C=["","p","br","div"];CKEDITOR.FILTER_SKIP_TREE=2;CKEDITOR.filter=function(a){this.allowedContent=[];this.disallowedContent=[];this.elementCallbacks=null;this.disabled=false;this.editor=null;this.id=CKEDITOR.tools.getNextNumber();this._={allowedRules:{elements:{},generic:[]},disallowedRules:{elements:{},generic:[]},transformations:{},cachedTests:{}};CKEDITOR.filter.instances[this.id]=this;if(a instanceof CKEDITOR.editor){a=this.editor=a;this.customConfig=true;var b=a.config.allowedContent;if(b===true)this.disabled=true;else{if(!b)this.customConfig=false;this.allow(b,"config",1);this.allow(a.config.extraAllowedContent,"extra",1);this.allow(C[a.enterMode]+" "+C[a.shiftEnterMode],"default",1);this.disallow(a.config.disallowedContent)}}else{this.customConfig=false;this.allow(a,"default",1)}};CKEDITOR.filter.instances={};CKEDITOR.filter.prototype={allow:function(b,c,f){if(!d(this,b,f))return false;var g,h;if(typeof b=="string")b=k(b);else if(b instanceof CKEDITOR.style){if(b.toAllowedContentRules)return this.allow(b.toAllowedContentRules(this.editor),c,f);g=b.getDefinition();b={};f=g.attributes;b[g.element]=g={styles:g.styles,requiredStyles:g.styles&&CKEDITOR.tools.objectKeys(g.styles)};if(f){f=G(f);g.classes=f["class"]?f["class"].split(/\s+/):null;g.requiredClasses=g.classes;delete f["class"];g.attributes=f;g.requiredAttributes=f&&CKEDITOR.tools.objectKeys(f)}}else if(CKEDITOR.tools.isArray(b)){for(g=0;g<b.length;++g)h=this.allow(b[g],c,f);return h}a(this,b,c,this.allowedContent,this._.allowedRules);return true},applyTo:function(a,b,c,d){if(this.disabled)return false;var f=this,g=[],h=this.editor&&this.editor.config.protectedSource,e,j=false,i={doFilter:!c,doTransform:true,doCallbacks:true,toHtml:b};a.forEach(function(a){if(a.type==CKEDITOR.NODE_ELEMENT){if(a.attributes["data-cke-filter"]=="off")return false;if(!b||!(a.name=="span"&&~CKEDITOR.tools.objectKeys(a.attributes).join("|").indexOf("data-cke-"))){e=q(f,a,g,i);if(e&A)j=true;else if(e&2)return false}}else if(a.type==CKEDITOR.NODE_COMMENT&&a.value.match(/^\{cke_protected\}(?!\{C\})/)){var c;a:{var d=decodeURIComponent(a.value.replace(/^\{cke_protected\}/,""));c=[];var p,m,t;if(h)for(m=0;m<h.length;++m)if((t=d.match(h[m]))&&t[0].length==d.length){c=true;break a}d=CKEDITOR.htmlParser.fragment.fromHtml(d);d.children.length==1&&(p=d.children[0]).type==CKEDITOR.NODE_ELEMENT&&q(f,p,c,i);c=!c.length}c||g.push(a)}},null,true);g.length&&(j=true);for(var m,a=[],d=C[d||(this.editor?this.editor.enterMode:CKEDITOR.ENTER_P)],t;c=g.pop();)c.type==CKEDITOR.NODE_ELEMENT?w(c,d,a):c.remove();for(;m=a.pop();){c=m.el;if(c.parent){t=B[c.parent.name]||B.span;switch(m.check){case"it":B.$removeEmpty[c.name]&&!c.children.length?w(c,d,a):p(c)||w(c,d,a);break;case"el-up":c.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT&&!t[c.name]&&w(c,d,a);break;case"parent-down":c.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT&&!t[c.name]&&w(c.parent,d,a)}}}return j},checkFeature:function(a){if(this.disabled||!a)return true;a.toFeature&&(a=a.toFeature(this.editor));return!a.requiredContent||this.check(a.requiredContent)},disable:function(){this.disabled=true},disallow:function(b){if(!d(this,b,true))return false;typeof b=="string"&&(b=k(b));a(this,b,null,this.disallowedContent,this._.disallowedRules);return true},addContentForms:function(a){if(!this.disabled&&a){var b,c,d=[],f;for(b=0;b<a.length&&!f;++b){c=a[b];if((typeof c=="string"||c instanceof CKEDITOR.style)&&this.check(c))f=c}if(f){for(b=0;b<a.length;++b)d.push(r(a[b],f));this.addTransformations(d)}}},addElementCallback:function(a){if(!this.elementCallbacks)this.elementCallbacks=[];this.elementCallbacks.push(a)},addFeature:function(a){if(this.disabled||!a)return true;a.toFeature&&(a=a.toFeature(this.editor));this.allow(a.allowedContent,a.name);this.addTransformations(a.contentTransformations);this.addContentForms(a.contentForms);return a.requiredContent&&(this.customConfig||this.disallowedContent.length)?this.check(a.requiredContent):true},addTransformations:function(a){var b,c;if(!this.disabled&&a){var d=this._.transformations,f;for(f=0;f<a.length;++f){b=a[f];var g=void 0,h=void 0,e=void 0,j=void 0,i=void 0,p=void 0;c=[];for(h=0;h<b.length;++h){e=b[h];if(typeof e=="string"){e=e.split(/\s*:\s*/);j=e[0];i=null;p=e[1]}else{j=e.check;i=e.left;p=e.right}if(!g){g=e;g=g.element?g.element:j?j.match(/^([a-z0-9]+)/i)[0]:g.left.getDefinition().element}i instanceof CKEDITOR.style&&(i=y(i));c.push({check:j==g?null:j,left:i,right:typeof p=="string"?z(p):p})}b=g;d[b]||(d[b]=[]);d[b].push(c)}}},check:function(a,b,c){if(this.disabled)return true;if(CKEDITOR.tools.isArray(a)){for(var d=a.length;d--;)if(this.check(a[d],b,c))return true;return false}var f,g;if(typeof a=="string"){g=a+"<"+(b===false?"0":"1")+(c?"1":"0")+">";if(g in this._.cachedChecks)return this._.cachedChecks[g];d=k(a).$1;f=d.styles;var h=d.classes;d.name=d.elements;d.classes=h=h?h.split(/\s*,\s*/):[];d.styles=i(f);d.attributes=i(d.attributes);d.children=[];h.length&&(d.attributes["class"]=h.join(" "));if(f)d.attributes.style=CKEDITOR.tools.writeCssText(d.styles);f=d}else{d=a.getDefinition();f=d.styles;h=d.attributes||{};if(f){f=G(f);h.style=CKEDITOR.tools.writeCssText(f,true)}else f={};f={name:d.element,attributes:h,classes:h["class"]?h["class"].split(/\s+/):[],styles:f,children:[]}}var h=CKEDITOR.tools.clone(f),e=[],j;if(b!==false&&(j=this._.transformations[f.name])){for(d=0;d<j.length;++d)x(this,f,j[d]);l(f)}q(this,h,e,{doFilter:true,doTransform:b!==false,skipRequired:!c,skipFinalValidation:!c});b=e.length>0?false:CKEDITOR.tools.objectCompare(f.attributes,h.attributes,true)?true:false;typeof a=="string"&&(this._.cachedChecks[g]=b);return b},getAllowedEnterMode:function(){var a=["p","div","br"],b={p:CKEDITOR.ENTER_P,div:CKEDITOR.ENTER_DIV,br:CKEDITOR.ENTER_BR};return function(c,d){var f=a.slice(),g;if(this.check(C[c]))return c;for(d||(f=f.reverse());g=f.pop();)if(this.check(g))return b[g];return CKEDITOR.ENTER_BR}}(),destroy:function(){delete CKEDITOR.filter.instances[this.id];delete this._;delete this.allowedContent;delete this.disallowedContent}};var F={styles:1,attributes:1,classes:1},E={styles:"requiredStyles",attributes:"requiredAttributes",classes:"requiredClasses"},I=/^([a-z0-9\-*\s]+)((?:\s*\{[!\w\-,\s\*]+\}\s*|\s*\[[!\w\-,\s\*]+\]\s*|\s*\([!\w\-,\s\*]+\)\s*){0,3})(?:;\s*|$)/i,L={styles:/{([^}]+)}/,attrs:/\[([^\]]+)\]/,classes:/\(([^\)]+)\)/},H=/^cke:(object|embed|param)$/,Q=/^(object|embed|param)$/,O=CKEDITOR.filter.transformationsTools={sizeToStyle:function(a){this.lengthToStyle(a,"width");this.lengthToStyle(a,"height")},sizeToAttribute:function(a){this.lengthToAttribute(a,"width");this.lengthToAttribute(a,"height")},lengthToStyle:function(a,b,c){c=c||b;if(!(c in a.styles)){var d=a.attributes[b];if(d){/^\d+$/.test(d)&&(d=d+"px");a.styles[c]=d}}delete a.attributes[b]},lengthToAttribute:function(a,b,c){c=c||b;if(!(c in a.attributes)){var d=a.styles[b],f=d&&d.match(/^(\d+)(?:\.\d*)?px$/);f?a.attributes[c]=f[1]:d==J&&(a.attributes[c]=J)}delete a.styles[b]},alignmentToStyle:function(a){if(!("float"in a.styles)){var b=a.attributes.align;if(b=="left"||b=="right")a.styles["float"]=b}delete a.attributes.align},alignmentToAttribute:function(a){if(!("align"in a.attributes)){var b=a.styles["float"];if(b=="left"||b=="right")a.attributes.align=b}delete a.styles["float"]},matchesStyle:v,transform:function(a,b){if(typeof b=="string")a.name=b;else{var c=b.getDefinition(),d=c.styles,f=c.attributes,g,h,e,j;a.name=c.element;for(g in f)if(g=="class"){c=a.classes.join("|");for(e=f[g].split(/\s+/);j=e.pop();)c.indexOf(j)==-1&&a.classes.push(j)}else a.attributes[g]=f[g];for(h in d)a.styles[h]=d[h]}}}}(),function(){CKEDITOR.focusManager=function(a){if(a.focusManager)return a.focusManager;this.hasFocus=false;this.currentActive=null;this._={editor:a};return this};CKEDITOR.focusManager._={blurDelay:200};CKEDITOR.focusManager.prototype={focus:function(a){this._.timer&&clearTimeout(this._.timer);if(a)this.currentActive=a;if(!this.hasFocus&&!this._.locked){(a=CKEDITOR.currentInstance)&&a.focusManager.blur(1);this.hasFocus=true;(a=this._.editor.container)&&a.addClass("cke_focus");this._.editor.fire("focus")}},lock:function(){this._.locked=1},unlock:function(){delete this._.locked},blur:function(a){function e(){if(this.hasFocus){this.hasFocus=false;var a=this._.editor.container;a&&a.removeClass("cke_focus");this._.editor.fire("blur")}}if(!this._.locked){this._.timer&&clearTimeout(this._.timer);var b=CKEDITOR.focusManager._.blurDelay;a||!b?e.call(this):this._.timer=CKEDITOR.tools.setTimeout(function(){delete this._.timer;e.call(this)},b,this)}},add:function(a,e){var b=a.getCustomData("focusmanager");if(!b||b!=this){b&&b.remove(a);var b="focus",g="blur";if(e)if(CKEDITOR.env.ie){b="focusin";g="focusout"}else CKEDITOR.event.useCapture=1;var c={blur:function(){a.equals(this.currentActive)&&this.blur()},focus:function(){this.focus(a)}};a.on(b,c.focus,this);a.on(g,c.blur,this);if(e)CKEDITOR.event.useCapture=0;a.setCustomData("focusmanager",this);a.setCustomData("focusmanager_handlers",c)}},remove:function(a){a.removeCustomData("focusmanager");var e=a.removeCustomData("focusmanager_handlers");a.removeListener("blur",e.blur);a.removeListener("focus",e.focus)}}}(),CKEDITOR.keystrokeHandler=function(a){if(a.keystrokeHandler)return a.keystrokeHandler;this.keystrokes={};this.blockedKeystrokes={};this._={editor:a};return this},function(){var a,e=function(b){var b=b.data,c=b.getKeystroke(),d=this.keystrokes[c],e=this._.editor;a=e.fire("key",{keyCode:c,domEvent:b})===false;if(!a){d&&(a=e.execCommand(d,{from:"keystrokeHandler"})!==false);a||(a=!!this.blockedKeystrokes[c])}a&&b.preventDefault(true);return!a},b=function(b){if(a){a=false;b.data.preventDefault(true)}};CKEDITOR.keystrokeHandler.prototype={attach:function(a){a.on("keydown",e,this);if(CKEDITOR.env.gecko&&CKEDITOR.env.mac)a.on("keypress",b,this)}}}(),function(){CKEDITOR.lang={languages:{af:1,ar:1,bg:1,bn:1,bs:1,ca:1,cs:1,cy:1,da:1,de:1,el:1,"en-au":1,"en-ca":1,"en-gb":1,en:1,eo:1,es:1,et:1,eu:1,fa:1,fi:1,fo:1,"fr-ca":1,fr:1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,is:1,it:1,ja:1,ka:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,ms:1,nb:1,nl:1,no:1,pl:1,"pt-br":1,pt:1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,"sr-latn":1,sr:1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,"zh-cn":1,zh:1},rtl:{ar:1,fa:1,he:1,ku:1,ug:1},load:function(a,e,b){if(!a||!CKEDITOR.lang.languages[a])a=this.detect(e,a);var g=this,e=function(){g[a].dir=g.rtl[a]?"rtl":"ltr";b(a,g[a])};this[a]?e():CKEDITOR.scriptLoader.load(CKEDITOR.getUrl("lang/"+a+".js"),e,this)},detect:function(a,e){var b=this.languages,e=e||navigator.userLanguage||navigator.language||a,g=e.toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/),c=g[1],g=g[2];b[c+"-"+g]?c=c+"-"+g:b[c]||(c=null);CKEDITOR.lang.detect=c?function(){return c}:function(a){return a};return c||a}}}(),CKEDITOR.scriptLoader=function(){var a={},e={};return{load:function(b,g,c,d){var j=typeof b=="string";j&&(b=[b]);c||(c=CKEDITOR);var f=b.length,h=[],i=[],k=function(a){g&&(j?g.call(c,a):g.call(c,h,i))};if(f===0)k(true);else{var n=function(a,b){(b?h:i).push(a);if(--f<=0){d&&CKEDITOR.document.getDocumentElement().removeStyle("cursor");k(b)}},o=function(b,c){a[b]=1;var d=e[b];delete e[b];for(var f=0;f<d.length;f++)d[f](b,c)},q=function(b){if(a[b])n(b,true);else{var c=e[b]||(e[b]=[]);c.push(n);if(!(c.length>1)){var d=new CKEDITOR.dom.element("script");d.setAttributes({type:"text/javascript",src:b});if(g)if(CKEDITOR.env.ie&&CKEDITOR.env.version<11)d.$.onreadystatechange=function(){if(d.$.readyState=="loaded"||d.$.readyState=="complete"){d.$.onreadystatechange=null;o(b,true)}};else{d.$.onload=function(){setTimeout(function(){o(b,true)},0)};d.$.onerror=function(){o(b,false)}}d.appendTo(CKEDITOR.document.getHead())}}};d&&CKEDITOR.document.getDocumentElement().setStyle("cursor","wait");for(var m=0;m<f;m++)q(b[m])}},queue:function(){function a(){var b;(b=g[0])&&this.load(b.scriptUrl,b.callback,CKEDITOR,0)}var g=[];return function(c,d){var e=this;g.push({scriptUrl:c,callback:function(){d&&d.apply(this,arguments);g.shift();a.call(e)}});g.length==1&&a.call(this)}}()}}(),CKEDITOR.resourceManager=function(a,e){this.basePath=a;this.fileName=e;this.registered={};this.loaded={};this.externals={};this._={waitingList:{}}},CKEDITOR.resourceManager.prototype={add:function(a,e){if(this.registered[a])throw'[CKEDITOR.resourceManager.add] The resource name "'+a+'" is already registered.';var b=this.registered[a]=e||{};b.name=a;b.path=this.getPath(a);CKEDITOR.fire(a+CKEDITOR.tools.capitalize(this.fileName)+"Ready",b);return this.get(a)},get:function(a){return this.registered[a]||null},getPath:function(a){var e=this.externals[a];return CKEDITOR.getUrl(e&&e.dir||this.basePath+a+"/")},getFilePath:function(a){var e=this.externals[a];return CKEDITOR.getUrl(this.getPath(a)+(e?e.file:this.fileName+".js"))},addExternal:function(a,e,b){for(var a=a.split(","),g=0;g<a.length;g++){var c=a[g];b||(e=e.replace(/[^\/]+$/,function(a){b=a;return""}));this.externals[c]={dir:e,file:b||this.fileName+".js"}}},load:function(a,e,b){CKEDITOR.tools.isArray(a)||(a=a?[a]:[]);for(var g=this.loaded,c=this.registered,d=[],j={},f={},h=0;h<a.length;h++){var i=a[h];if(i)if(!g[i]&&!c[i]){var k=this.getFilePath(i);d.push(k);k in j||(j[k]=[]);j[k].push(i)}else f[i]=this.get(i)}CKEDITOR.scriptLoader.load(d,function(a,c){if(c.length)throw'[CKEDITOR.resourceManager.load] Resource name "'+j[c[0]].join(",")+'" was not found at "'+c[0]+'".';for(var d=0;d<a.length;d++)for(var h=j[a[d]],i=0;i<h.length;i++){var p=h[i];f[p]=this.get(p);g[p]=1}e.call(b,f)},this)}},CKEDITOR.plugins=new CKEDITOR.resourceManager("plugins/","plugin"),CKEDITOR.plugins.load=CKEDITOR.tools.override(CKEDITOR.plugins.load,function(a){var e={};return function(b,g,c){var d={},j=function(b){a.call(this,b,function(a){CKEDITOR.tools.extend(d,a);var b=[],f;for(f in a){var n=a[f],o=n&&n.requires;if(!e[f]){if(n.icons)for(var q=n.icons.split(","),m=q.length;m--;)CKEDITOR.skin.addIcon(q[m],n.path+"icons/"+(CKEDITOR.env.hidpi&&n.hidpi?"hidpi/":"")+q[m]+".png");e[f]=1}if(o){o.split&&(o=o.split(","));for(n=0;n<o.length;n++)d[o[n]]||b.push(o[n])}}if(b.length)j.call(this,b);else{for(f in d){n=d[f];if(n.onLoad&&!n.onLoad._called){n.onLoad()===false&&delete d[f];n.onLoad._called=1}}g&&g.call(c||window,d)}},this)};j.call(this,b)}}),CKEDITOR.plugins.setLang=function(a,e,b){var g=this.get(a),a=g.langEntries||(g.langEntries={}),g=g.lang||(g.lang=[]);g.split&&(g=g.split(","));CKEDITOR.tools.indexOf(g,e)==-1&&g.push(e);a[e]=b},CKEDITOR.ui=function(a){if(a.ui)return a.ui;this.items={};this.instances={};this.editor=a;this._={handlers:{}};return this},CKEDITOR.ui.prototype={add:function(a,e,b){b.name=a.toLowerCase();var g=this.items[a]={type:e,command:b.command||null,args:Array.prototype.slice.call(arguments,2)};CKEDITOR.tools.extend(g,b)},get:function(a){return this.instances[a]},create:function(a){var e=this.items[a],b=e&&this._.handlers[e.type],g=e&&e.command&&this.editor.getCommand(e.command),b=b&&b.create.apply(this,e.args);this.instances[a]=b;g&&g.uiItems.push(b);if(b&&!b.type)b.type=e.type;return b},addHandler:function(a,e){this._.handlers[a]=e},space:function(a){return CKEDITOR.document.getById(this.spaceId(a))},spaceId:function(a){return this.editor.id+"_"+a}},CKEDITOR.event.implementOn(CKEDITOR.ui),function(){function a(a,d,f){CKEDITOR.event.call(this);a=a&&CKEDITOR.tools.clone(a);if(d!==void 0){if(d instanceof CKEDITOR.dom.element){if(!f)throw Error("One of the element modes must be specified.");}else throw Error("Expect element of type CKEDITOR.dom.element.");if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&f==CKEDITOR.ELEMENT_MODE_INLINE)throw Error("Inline element mode is not supported on IE quirks.");if(!(f==CKEDITOR.ELEMENT_MODE_INLINE?d.is(CKEDITOR.dtd.$editable)||d.is("textarea"):f==CKEDITOR.ELEMENT_MODE_REPLACE?!d.is(CKEDITOR.dtd.$nonBodyContent):1))throw Error('The specified element mode is not supported on element: "'+d.getName()+'".');this.element=d;this.elementMode=f;this.name=this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO&&(d.getId()||d.getNameAtt())}else this.elementMode=CKEDITOR.ELEMENT_MODE_NONE;this._={};this.commands={};this.templates={};this.name=this.name||e();this.id=CKEDITOR.tools.getNextId();this.status="unloaded";this.config=CKEDITOR.tools.prototypedCopy(CKEDITOR.config);this.ui=new CKEDITOR.ui(this);this.focusManager=new CKEDITOR.focusManager(this);this.keystrokeHandler=new CKEDITOR.keystrokeHandler(this);this.on("readOnly",b);this.on("selectionChange",function(a){c(this,a.data.path)});this.on("activeFilterChange",function(){c(this,this.elementPath(),true)});this.on("mode",b);this.on("instanceReady",function(){this.config.startupFocus&&this.focus()});CKEDITOR.fire("instanceCreated",null,this);CKEDITOR.add(this);CKEDITOR.tools.setTimeout(function(){j(this,a)},0,this)}function e(){do var a="editor"+ ++o;while(CKEDITOR.instances[a]);return a}function b(){var a=this.commands,b;for(b in a)g(this,a[b])}function g(a,b){b[b.startDisabled?"disable":a.readOnly&&!b.readOnly?"disable":b.modes[a.mode]?"enable":"disable"]()}function c(a,b,c){if(b){var d,f,g=a.commands;for(f in g){d=g[f];(c||d.contextSensitive)&&d.refresh(a,b)}}}function d(a){var b=a.config.customConfig;if(!b)return false;var b=CKEDITOR.getUrl(b),c=q[b]||(q[b]={});if(c.fn){c.fn.call(a,a.config);(CKEDITOR.getUrl(a.config.customConfig)==b||!d(a))&&a.fireOnce("customConfigLoaded")}else CKEDITOR.scriptLoader.queue(b,function(){c.fn=CKEDITOR.editorConfig?CKEDITOR.editorConfig:function(){};d(a)});return true}function j(a,b){a.on("customConfigLoaded",function(){if(b){if(b.on)for(var c in b.on)a.on(c,b.on[c]);CKEDITOR.tools.extend(a.config,b,true);delete a.config.on}c=a.config;a.readOnly=!(!c.readOnly&&!(a.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?a.element.is("textarea")?a.element.hasAttribute("disabled"):a.element.isReadOnly():a.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&a.element.hasAttribute("disabled")));a.blockless=a.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?!(a.element.is("textarea")||CKEDITOR.dtd[a.element.getName()].p):false;a.tabIndex=c.tabIndex||a.element&&a.element.getAttribute("tabindex")||0;a.activeEnterMode=a.enterMode=a.blockless?CKEDITOR.ENTER_BR:c.enterMode;a.activeShiftEnterMode=a.shiftEnterMode=a.blockless?CKEDITOR.ENTER_BR:c.shiftEnterMode;if(c.skin)CKEDITOR.skinName=c.skin;a.fireOnce("configLoaded");a.dataProcessor=new CKEDITOR.htmlDataProcessor(a);a.filter=a.activeFilter=new CKEDITOR.filter(a);f(a)});if(b&&b.customConfig!=null)a.config.customConfig=b.customConfig;d(a)||a.fireOnce("customConfigLoaded")}function f(a){CKEDITOR.skin.loadPart("editor",function(){h(a)})}function h(a){CKEDITOR.lang.load(a.config.language,a.config.defaultLanguage,function(b,c){var d=a.config.title;a.langCode=b;a.lang=CKEDITOR.tools.prototypedCopy(c);a.title=typeof d=="string"||d===false?d:[a.lang.editor,a.name].join(", ");if(!a.config.contentsLangDirection)a.config.contentsLangDirection=a.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?a.element.getDirection(1):a.lang.dir;a.fire("langLoaded");i(a)})}function i(a){a.getStylesSet(function(b){a.once("loaded",function(){a.fire("stylesSet",{styles:b})},null,null,1);k(a)})}function k(a){var b=a.config,c=b.plugins,d=b.extraPlugins,f=b.removePlugins;if(d)var g=RegExp("(?:^|,)(?:"+d.replace(/\s*,\s*/g,"|")+")(?=,|$)","g"),c=c.replace(g,""),c=c+(","+d);if(f)var h=RegExp("(?:^|,)(?:"+f.replace(/\s*,\s*/g,"|")+")(?=,|$)","g"),c=c.replace(h,"");CKEDITOR.env.air&&(c=c+",adobeair");CKEDITOR.plugins.load(c.split(","),function(c){var d=[],f=[],g=[];a.plugins=c;for(var e in c){var j=c[e],i=j.lang,p=null,t=j.requires,k;CKEDITOR.tools.isArray(t)&&(t=t.join(","));if(t&&(k=t.match(h)))for(;t=k.pop();)CKEDITOR.tools.setTimeout(function(a,b){throw Error('Plugin "'+a.replace(",","")+'" cannot be removed from the plugins list, because it\'s required by "'+b+'" plugin.');},0,null,[t,e]);if(i&&!a.lang[e]){i.split&&(i=i.split(","));if(CKEDITOR.tools.indexOf(i,a.langCode)>=0)p=a.langCode;else{p=a.langCode.replace(/-.*/,"");p=p!=a.langCode&&CKEDITOR.tools.indexOf(i,p)>=0?p:CKEDITOR.tools.indexOf(i,"en")>=0?"en":i[0]}if(!j.langEntries||!j.langEntries[p])g.push(CKEDITOR.getUrl(j.path+"lang/"+p+".js"));else{a.lang[e]=j.langEntries[p];p=null}}f.push(p);d.push(j)}CKEDITOR.scriptLoader.load(g,function(){for(var c=["beforeInit","init","afterInit"],g=0;g<c.length;g++)for(var h=0;h<d.length;h++){var e=d[h];g===0&&(f[h]&&e.lang&&e.langEntries)&&(a.lang[e.name]=e.langEntries[f[h]]);if(e[c[g]])e[c[g]](a)}a.fireOnce("pluginsLoaded");b.keystrokes&&a.setKeystroke(a.config.keystrokes);for(h=0;h<a.config.blockedKeystrokes.length;h++)a.keystrokeHandler.blockedKeystrokes[a.config.blockedKeystrokes[h]]=1;a.status="loaded";a.fireOnce("loaded");CKEDITOR.fire("instanceLoaded",null,a)})})}function n(){var a=this.element;if(a&&this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO){var b=this.getData();this.config.htmlEncodeOutput&&(b=CKEDITOR.tools.htmlEncode(b));a.is("textarea")?a.setValue(b):a.setHtml(b);return true}return false}a.prototype=CKEDITOR.editor.prototype;CKEDITOR.editor=a;var o=0,q={};CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{addCommand:function(a,b){b.name=a.toLowerCase();var c=new CKEDITOR.command(this,b);this.mode&&g(this,c);return this.commands[a]=c},_attachToForm:function(){function a(d){b.updateElement();b._.required&&(!c.getValue()&&b.fire("required")===false)&&d.data.preventDefault()}var b=this,c=b.element,d=new CKEDITOR.dom.element(c.$.form);if(c.is("textarea")&&d){d.on("submit",a);if(d.$.submit&&d.$.submit.call&&d.$.submit.apply)d.$.submit=CKEDITOR.tools.override(d.$.submit,function(b){return function(){a();b.apply?b.apply(this):b()}});b.on("destroy",function(){d.removeListener("submit",a)})}},destroy:function(a){this.fire("beforeDestroy");!a&&n.call(this);this.editable(null);this.filter.destroy();delete this.filter;delete this.activeFilter;this.status="destroyed";this.fire("destroy");this.removeAllListeners();CKEDITOR.remove(this);CKEDITOR.fire("instanceDestroyed",null,this)},elementPath:function(a){if(!a){a=this.getSelection();if(!a)return null;a=a.getStartElement()}return a?new CKEDITOR.dom.elementPath(a,this.editable()):null},createRange:function(){var a=this.editable();return a?new CKEDITOR.dom.range(a):null},execCommand:function(a,b){var c=this.getCommand(a),d={name:a,commandData:b,command:c};if(c&&c.state!=CKEDITOR.TRISTATE_DISABLED&&this.fire("beforeCommandExec",d)!==false){d.returnValue=c.exec(d.commandData);if(!c.async&&this.fire("afterCommandExec",d)!==false)return d.returnValue}return false},getCommand:function(a){return this.commands[a]},getData:function(a){!a&&this.fire("beforeGetData");var b=this._.data;if(typeof b!="string")b=(b=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?b.is("textarea")?b.getValue():b.getHtml():"";b={dataValue:b};!a&&this.fire("getData",b);return b.dataValue},getSnapshot:function(){var a=this.fire("getSnapshot");if(typeof a!="string"){var b=this.element;b&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(a=b.is("textarea")?b.getValue():b.getHtml())}return a},loadSnapshot:function(a){this.fire("loadSnapshot",a)},setData:function(a,b,c){var d=true,f=b;if(b&&typeof b=="object"){c=b.internal;f=b.callback;d=!b.noSnapshot}!c&&d&&this.fire("saveSnapshot");if(f||!c)this.once("dataReady",function(a){!c&&d&&this.fire("saveSnapshot");f&&f.call(a.editor)});a={dataValue:a};!c&&this.fire("setData",a);this._.data=a.dataValue;!c&&this.fire("afterSetData",a)},setReadOnly:function(a){a=a==null||a;if(this.readOnly!=a){this.readOnly=a;this.keystrokeHandler.blockedKeystrokes[8]=+a;this.editable().setReadOnly(a);this.fire("readOnly")}},insertHtml:function(a,b){this.fire("insertHtml",{dataValue:a,mode:b})},insertText:function(a){this.fire("insertText",a)},insertElement:function(a){this.fire("insertElement",a)},focus:function(){this.fire("beforeFocus")},checkDirty:function(){return this.status=="ready"&&this._.previousValue!==this.getSnapshot()},resetDirty:function(){this._.previousValue=this.getSnapshot()},updateElement:function(){return n.call(this)},setKeystroke:function(){for(var a=this.keystrokeHandler.keystrokes,b=CKEDITOR.tools.isArray(arguments[0])?arguments[0]:[[].slice.call(arguments,0)],c,d,f=b.length;f--;){c=b[f];d=0;if(CKEDITOR.tools.isArray(c)){d=c[1];c=c[0]}d?a[c]=d:delete a[c]}},addFeature:function(a){return this.filter.addFeature(a)},setActiveFilter:function(a){if(!a)a=this.filter;if(this.activeFilter!==a){this.activeFilter=a;this.fire("activeFilterChange");a===this.filter?this.setActiveEnterMode(null,null):this.setActiveEnterMode(a.getAllowedEnterMode(this.enterMode),a.getAllowedEnterMode(this.shiftEnterMode,true))}},setActiveEnterMode:function(a,b){a=a?this.blockless?CKEDITOR.ENTER_BR:a:this.enterMode;b=b?this.blockless?CKEDITOR.ENTER_BR:b:this.shiftEnterMode;if(this.activeEnterMode!=a||this.activeShiftEnterMode!=b){this.activeEnterMode=a;this.activeShiftEnterMode=b;this.fire("activeEnterModeChange")}}})}(),CKEDITOR.ELEMENT_MODE_NONE=0,CKEDITOR.ELEMENT_MODE_REPLACE=1,CKEDITOR.ELEMENT_MODE_APPENDTO=2,CKEDITOR.ELEMENT_MODE_INLINE=3,CKEDITOR.htmlParser=function(){this._={htmlPartsRegex:/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--\>)|(?:([^\/\s>]+)((?:\s+[\w\-:.]+(?:\s*=\s*?(?:(?:"[^"]*")|(?:'[^']*')|[^\s"'\/>]+))?)*)[\S\s]*?(\/?)>))/g}},function(){var a=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,e={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1};CKEDITOR.htmlParser.prototype={onTagOpen:function(){},onTagClose:function(){},onText:function(){},onCDATA:function(){},onComment:function(){},parse:function(b){for(var g,c,d=0,j;g=this._.htmlPartsRegex.exec(b);){c=g.index;if(c>d){d=b.substring(d,c);if(j)j.push(d);else this.onText(d)}d=this._.htmlPartsRegex.lastIndex;if(c=g[1]){c=c.toLowerCase();if(j&&CKEDITOR.dtd.$cdata[c]){this.onCDATA(j.join(""));j=null}if(!j){this.onTagClose(c);continue}}if(j)j.push(g[0]);else if(c=g[3]){c=c.toLowerCase();if(!/="/.test(c)){var f={},h,i=g[4];g=!!g[5];if(i)for(;h=a.exec(i);){var k=h[1].toLowerCase();h=h[2]||h[3]||h[4]||"";f[k]=!h&&e[k]?k:CKEDITOR.tools.htmlDecodeAttr(h)}this.onTagOpen(c,f,g);!j&&CKEDITOR.dtd.$cdata[c]&&(j=[])}}else if(c=g[2])this.onComment(c)}if(b.length>d)this.onText(b.substring(d,b.length))}}}(),CKEDITOR.htmlParser.basicWriter=CKEDITOR.tools.createClass({$:function(){this._={output:[]}},proto:{openTag:function(a){this._.output.push("<",a)},openTagClose:function(a,e){e?this._.output.push(" />"):this._.output.push(">")},attribute:function(a,e){typeof e=="string"&&(e=CKEDITOR.tools.htmlEncodeAttr(e));this._.output.push(" ",a,'="',e,'"')},closeTag:function(a){this._.output.push("</",a,">")},text:function(a){this._.output.push(a)},comment:function(a){this._.output.push("<\!--",a,"--\>")},write:function(a){this._.output.push(a)},reset:function(){this._.output=[];this._.indent=false},getHtml:function(a){var e=this._.output.join("");a&&this.reset();return e}}}),"use strict",function(){CKEDITOR.htmlParser.node=function(){};CKEDITOR.htmlParser.node.prototype={remove:function(){var a=this.parent.children,e=CKEDITOR.tools.indexOf(a,this),b=this.previous,g=this.next;b&&(b.next=g);g&&(g.previous=b);a.splice(e,1);this.parent=null},replaceWith:function(a){var e=this.parent.children,b=CKEDITOR.tools.indexOf(e,this),g=a.previous=this.previous,c=a.next=this.next;g&&(g.next=a);c&&(c.previous=a);e[b]=a;a.parent=this.parent;this.parent=null},insertAfter:function(a){var e=a.parent.children,b=CKEDITOR.tools.indexOf(e,a),g=a.next;e.splice(b+1,0,this);this.next=a.next;this.previous=a;a.next=this;g&&(g.previous=this);this.parent=a.parent},insertBefore:function(a){var e=a.parent.children,b=CKEDITOR.tools.indexOf(e,a);e.splice(b,0,this);this.next=a;(this.previous=a.previous)&&(a.previous.next=this);a.previous=this;this.parent=a.parent},getAscendant:function(a){var e=typeof a=="function"?a:typeof a=="string"?function(b){return b.name==a}:function(b){return b.name in a},b=this.parent;for(;b&&b.type==CKEDITOR.NODE_ELEMENT;){if(e(b))return b;b=b.parent}return null},wrapWith:function(a){this.replaceWith(a);a.add(this);return a},getIndex:function(){return CKEDITOR.tools.indexOf(this.parent.children,this)},getFilterContext:function(a){return a||{}}}}(),"use strict",CKEDITOR.htmlParser.comment=function(a){this.value=a;this._={isBlockLike:false}},CKEDITOR.htmlParser.comment.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_COMMENT,filter:function(a,e){var b=this.value;if(!(b=a.onComment(e,b,this))){this.remove();return false}if(typeof b!="string"){this.replaceWith(b);return false}this.value=b;return true},writeHtml:function(a,e){e&&this.filter(e);a.comment(this.value)}}),"use strict",function(){CKEDITOR.htmlParser.text=function(a){this.value=a;this._={isBlockLike:false}};CKEDITOR.htmlParser.text.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(a,e){if(!(this.value=a.onText(e,this.value,this))){this.remove();return false}},writeHtml:function(a,e){e&&this.filter(e);a.text(this.value)}})}(),"use strict",function(){CKEDITOR.htmlParser.cdata=function(a){this.value=a};CKEDITOR.htmlParser.cdata.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(){},writeHtml:function(a){a.write(this.value)}})}(),"use strict",CKEDITOR.htmlParser.fragment=function(){this.children=[];this.parent=null;this._={isBlockLike:true,hasInlineStarted:false}},function(){function a(a){return a.attributes["data-cke-survive"]?false:a.name=="a"&&a.attributes.href||CKEDITOR.dtd.$removeEmpty[a.name]}var e=CKEDITOR.tools.extend({table:1,ul:1,ol:1,dl:1},CKEDITOR.dtd.table,CKEDITOR.dtd.ul,CKEDITOR.dtd.ol,CKEDITOR.dtd.dl),b={ol:1,ul:1},g=CKEDITOR.tools.extend({},{html:1},CKEDITOR.dtd.html,CKEDITOR.dtd.body,CKEDITOR.dtd.head,{style:1,script:1}),c={ul:"li",ol:"li",dl:"dd",table:"tbody",tbody:"tr",thead:"tr",tfoot:"tr",tr:"td"};CKEDITOR.htmlParser.fragment.fromHtml=function(d,j,f){function h(a){var b;if(p.length>0)for(var c=0;c<p.length;c++){var d=p[c],f=d.name,g=CKEDITOR.dtd[f],h=s.name&&CKEDITOR.dtd[s.name];if((!h||h[f])&&(!a||!g||g[a]||!CKEDITOR.dtd[a])){if(!b){i();b=1}d=d.clone();d.parent=s;s=d;p.splice(c,1);c--}else if(f==s.name){n(s,s.parent,1);c--}}}function i(){for(;t.length;)n(t.shift(),s)}function k(a){if(a._.isBlockLike&&a.name!="pre"&&a.name!="textarea"){var b=a.children.length,c=a.children[b-1],d;if(c&&c.type==CKEDITOR.NODE_TEXT)(d=CKEDITOR.tools.rtrim(c.value))?c.value=d:a.children.length=b-1}}function n(b,c,d){var c=c||s||l,g=s;if(b.previous===void 0){if(o(c,b)){s=c;m.onTagOpen(f,{});b.returnPoint=c=s}k(b);(!a(b)||b.children.length)&&c.add(b);b.name=="pre"&&(w=false);b.name=="textarea"&&(u=false)}if(b.returnPoint){s=b.returnPoint;delete b.returnPoint}else s=d?c:g}function o(a,b){if((a==l||a.name=="body")&&f&&(!a.name||CKEDITOR.dtd[a.name][f])){var c,d;return(c=b.attributes&&(d=b.attributes["data-cke-real-element-type"])?d:b.name)&&c in CKEDITOR.dtd.$inline&&!(c in CKEDITOR.dtd.head)&&!b.isOrphan||b.type==CKEDITOR.NODE_TEXT}}function q(a,b){return a in CKEDITOR.dtd.$listItem||a in CKEDITOR.dtd.$tableContent?a==b||a=="dt"&&b=="dd"||a=="dd"&&b=="dt":false}var m=new CKEDITOR.htmlParser,l=j instanceof CKEDITOR.htmlParser.element?j:typeof j=="string"?new CKEDITOR.htmlParser.element(j):new CKEDITOR.htmlParser.fragment,p=[],t=[],s=l,u=l.name=="textarea",w=l.name=="pre";m.onTagOpen=function(c,d,f,j){d=new CKEDITOR.htmlParser.element(c,d);if(d.isUnknown&&f)d.isEmpty=true;d.isOptionalClose=j;if(a(d))p.push(d);else{if(c=="pre")w=true;else{if(c=="br"&&w){s.add(new CKEDITOR.htmlParser.text("\n"));return}c=="textarea"&&(u=true)}if(c=="br")t.push(d);else{for(;;){j=(f=s.name)?CKEDITOR.dtd[f]||(s._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):g;if(!d.isUnknown&&!s.isUnknown&&!j[c])if(s.isOptionalClose)m.onTagClose(f);else if(c in b&&f in b){f=s.children;(f=f[f.length-1])&&f.name=="li"||n(f=new CKEDITOR.htmlParser.element("li"),s);!d.returnPoint&&(d.returnPoint=s);s=f}else if(c in CKEDITOR.dtd.$listItem&&!q(c,f))m.onTagOpen(c=="li"?"ul":"dl",{},0,1);else if(f in e&&!q(c,f)){!d.returnPoint&&(d.returnPoint=s);s=s.parent}else{f in CKEDITOR.dtd.$inline&&p.unshift(s);if(s.parent)n(s,s.parent,1);else{d.isOrphan=1;break}}else break}h(c);i();d.parent=s;d.isEmpty?n(d):s=d}}};m.onTagClose=function(a){for(var b=p.length-1;b>=0;b--)if(a==p[b].name){p.splice(b,1);return}for(var c=[],d=[],g=s;g!=l&&g.name!=a;){g._.isBlockLike||d.unshift(g);c.push(g);g=g.returnPoint||g.parent}if(g!=l){for(b=0;b<c.length;b++){var h=c[b];n(h,h.parent)}s=g;g._.isBlockLike&&i();n(g,g.parent);if(g==s)s=s.parent;p=p.concat(d)}a=="body"&&(f=false)};m.onText=function(a){if((!s._.hasInlineStarted||t.length)&&!w&&!u){a=CKEDITOR.tools.ltrim(a);if(a.length===0)return}var b=s.name,d=b?CKEDITOR.dtd[b]||(s._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):g;if(!u&&!d["#"]&&b in e){m.onTagOpen(c[b]||"");m.onText(a)}else{i();h();!w&&!u&&(a=a.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," "));a=new CKEDITOR.htmlParser.text(a);if(o(s,a))this.onTagOpen(f,{},0,1);s.add(a)}};m.onCDATA=function(a){s.add(new CKEDITOR.htmlParser.cdata(a))};m.onComment=function(a){i();h();s.add(new CKEDITOR.htmlParser.comment(a))};m.parse(d);for(i();s!=l;)n(s,s.parent,1);k(l);return l};CKEDITOR.htmlParser.fragment.prototype={type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,add:function(a,b){isNaN(b)&&(b=this.children.length);var c=b>0?this.children[b-1]:null;if(c){if(a._.isBlockLike&&c.type==CKEDITOR.NODE_TEXT){c.value=CKEDITOR.tools.rtrim(c.value);if(c.value.length===0){this.children.pop();this.add(a);return}}c.next=a}a.previous=c;a.parent=this;this.children.splice(b,0,a);if(!this._.hasInlineStarted)this._.hasInlineStarted=a.type==CKEDITOR.NODE_TEXT||a.type==CKEDITOR.NODE_ELEMENT&&!a._.isBlockLike},filter:function(a,b){b=this.getFilterContext(b);a.onRoot(b,this);this.filterChildren(a,false,b)},filterChildren:function(a,b,c){if(this.childrenFilteredBy!=a.id){c=this.getFilterContext(c);if(b&&!this.parent)a.onRoot(c,this);this.childrenFilteredBy=a.id;for(b=0;b<this.children.length;b++)this.children[b].filter(a,c)===false&&b--}},writeHtml:function(a,b){b&&this.filter(b);this.writeChildrenHtml(a)},writeChildrenHtml:function(a,b,c){var g=this.getFilterContext();if(c&&!this.parent&&b)b.onRoot(g,this);b&&this.filterChildren(b,false,g);b=0;c=this.children;for(g=c.length;b<g;b++)c[b].writeHtml(a)},forEach:function(a,b,c){if(!c&&(!b||this.type==b))var g=a(this);if(g!==false)for(var c=this.children,e=0;e<c.length;e++){g=c[e];g.type==CKEDITOR.NODE_ELEMENT?g.forEach(a,b):(!b||g.type==b)&&a(g)}},getFilterContext:function(a){return a||{}}}}(),"use strict",function(){function a(){this.rules=[]}function e(b,g,c,d){var e,f;for(e in g){(f=b[e])||(f=b[e]=new a);f.add(g[e],c,d)}}CKEDITOR.htmlParser.filter=CKEDITOR.tools.createClass({$:function(b){this.id=CKEDITOR.tools.getNextNumber();this.elementNameRules=new a;this.attributeNameRules=new a;this.elementsRules={};this.attributesRules={};this.textRules=new a;this.commentRules=new a;this.rootRules=new a;b&&this.addRules(b,10)},proto:{addRules:function(a,g){var c;if(typeof g=="number")c=g;else if(g&&"priority"in g)c=g.priority;typeof c!="number"&&(c=10);typeof g!="object"&&(g={});a.elementNames&&this.elementNameRules.addMany(a.elementNames,c,g);a.attributeNames&&this.attributeNameRules.addMany(a.attributeNames,c,g);a.elements&&e(this.elementsRules,a.elements,c,g);a.attributes&&e(this.attributesRules,a.attributes,c,g);a.text&&this.textRules.add(a.text,c,g);a.comment&&this.commentRules.add(a.comment,c,g);a.root&&this.rootRules.add(a.root,c,g)},applyTo:function(a){a.filter(this)},onElementName:function(a,g){return this.elementNameRules.execOnName(a,g)},onAttributeName:function(a,g){return this.attributeNameRules.execOnName(a,g)},onText:function(a,g,c){return this.textRules.exec(a,g,c)},onComment:function(a,g,c){return this.commentRules.exec(a,g,c)},onRoot:function(a,g){return this.rootRules.exec(a,g)},onElement:function(a,g){for(var c=[this.elementsRules["^"],this.elementsRules[g.name],this.elementsRules.$],d,e=0;e<3;e++)if(d=c[e]){d=d.exec(a,g,this);if(d===false)return null;if(d&&d!=g)return this.onNode(a,d);if(g.parent&&!g.name)break}return g},onNode:function(a,g){var c=g.type;return c==CKEDITOR.NODE_ELEMENT?this.onElement(a,g):c==CKEDITOR.NODE_TEXT?new CKEDITOR.htmlParser.text(this.onText(a,g.value)):c==CKEDITOR.NODE_COMMENT?new CKEDITOR.htmlParser.comment(this.onComment(a,g.value)):null},onAttribute:function(a,g,c,d){return(c=this.attributesRules[c])?c.exec(a,d,g,this):d}}});CKEDITOR.htmlParser.filterRulesGroup=a;a.prototype={add:function(a,g,c){this.rules.splice(this.findIndex(g),0,{value:a,priority:g,options:c})},addMany:function(a,g,c){for(var d=[this.findIndex(g),0],e=0,f=a.length;e<f;e++)d.push({value:a[e],priority:g,options:c});this.rules.splice.apply(this.rules,d)},findIndex:function(a){for(var g=this.rules,c=g.length-1;c>=0&&a<g[c].priority;)c--;return c+1},exec:function(a,g){var c=g instanceof CKEDITOR.htmlParser.node||g instanceof CKEDITOR.htmlParser.fragment,d=Array.prototype.slice.call(arguments,1),e=this.rules,f=e.length,h,i,k,n;for(n=0;n<f;n++){if(c){h=g.type;i=g.name}k=e[n];if(!(a.nonEditable&&!k.options.applyToAll||a.nestedEditable&&k.options.excludeNestedEditable)){k=k.value.apply(null,d);if(k===false||c&&k&&(k.name!=i||k.type!=h))return k;k!=null&&(d[0]=g=k)}}return g},execOnName:function(a,g){for(var c=0,d=this.rules,e=d.length,f;g&&c<e;c++){f=d[c];!(a.nonEditable&&!f.options.applyToAll||a.nestedEditable&&f.options.excludeNestedEditable)&&(g=g.replace(f.value[0],f.value[1]))}return g}}}(),function(){function a(a,f){function h(a){return a||CKEDITOR.env.needsNbspFiller?new CKEDITOR.htmlParser.text(" "):new CKEDITOR.htmlParser.element("br",{"data-cke-bogus":1})}function e(a,c){return function(f){if(f.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var e=[],j=b(f),p,k;if(j)for(i(j,1)&&e.push(j);j;){if(d(j)&&(p=g(j))&&i(p))if((k=g(p))&&!d(k))e.push(p);else{h(t).insertAfter(p);p.remove()}j=j.previous}for(j=0;j<e.length;j++)e[j].remove();if(e=!a||(typeof c=="function"?c(f):c)!==false)if(!t&&!CKEDITOR.env.needsBrFiller&&f.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)e=false;else if(!t&&!CKEDITOR.env.needsBrFiller&&(document.documentMode>7||f.name in CKEDITOR.dtd.tr||f.name in CKEDITOR.dtd.$listItem))e=false;else{e=b(f);e=!e||f.name=="form"&&e.name=="input"}e&&f.add(h(a))}}}function i(a,b){if((!t||CKEDITOR.env.needsBrFiller)&&a.type==CKEDITOR.NODE_ELEMENT&&a.name=="br"&&!a.attributes["data-cke-eol"])return true;var c;if(a.type==CKEDITOR.NODE_TEXT&&(c=a.value.match(p))){if(c.index){(new CKEDITOR.htmlParser.text(a.value.substring(0,c.index))).insertBefore(a);a.value=c[0]}if(!CKEDITOR.env.needsBrFiller&&t&&(!b||a.parent.name in x))return true;if(!t)if((c=a.previous)&&c.name=="br"||!c||d(c))return true}return false}var k={elements:{}},t=f=="html",x=CKEDITOR.tools.extend({},w),C;for(C in x)"#"in s[C]||delete x[C];for(C in x)k.elements[C]=e(t,a.config.fillEmptyBlocks);k.root=e(t,false);k.elements.br=function(a){return function(b){if(b.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var f=b.attributes;if("data-cke-bogus"in f||"data-cke-eol"in f)delete f["data-cke-bogus"];else{for(f=b.next;f&&c(f);)f=f.next;var e=g(b);!f&&d(b.parent)?j(b.parent,h(a)):d(f)&&(e&&!d(e))&&h(a).insertBefore(f)}}}}(t);return k}function e(a,b){return a!=CKEDITOR.ENTER_BR&&b!==false?a==CKEDITOR.ENTER_DIV?"div":"p":false}function b(a){for(a=a.children[a.children.length-1];a&&c(a);)a=a.previous;return a}function g(a){for(a=a.previous;a&&c(a);)a=a.previous;return a}function c(a){return a.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(a.value)||a.type==CKEDITOR.NODE_ELEMENT&&a.attributes["data-cke-bookmark"]}function d(a){return a&&(a.type==CKEDITOR.NODE_ELEMENT&&a.name in
w||a.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)}function j(a,b){var c=a.children[a.children.length-1];a.children.push(b);b.parent=a;if(c){c.next=b;b.previous=c}}function f(a){a=a.attributes;a.contenteditable!="false"&&(a["data-cke-editable"]=a.contenteditable?"true":1);a.contenteditable="false"}function h(a){a=a.attributes;switch(a["data-cke-editable"]){case"true":a.contenteditable="true";break;case"1":delete a.contenteditable}}function i(a){return a.replace(z,function(a,b,c){return"<"+b+c.replace(B,function(a,b){return A.test(b)&&c.indexOf("data-cke-saved-"+b)==-1?" data-cke-saved-"+a+" data-cke-"+CKEDITOR.rnd+"-"+a:a})+">"})}function k(a,b){return a.replace(b,function(a,b,c){a.indexOf("<textarea")===0&&(a=b+q(c).replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</textarea>");return"<cke:encoded>"+encodeURIComponent(a)+"</cke:encoded>"})}function n(a){return a.replace(J,function(a,b){return decodeURIComponent(b)})}function o(a){return a.replace(/<\!--(?!{cke_protected})[\s\S]+?--\>/g,function(a){return"<\!--"+
t+"{C}"+encodeURIComponent(a).replace(/--/g,"%2D%2D")+"--\>"})}function q(a){return a.replace(/<\!--\{cke_protected\}\{C\}([\s\S]+?)--\>/g,function(a,b){return decodeURIComponent(b)})}function m(a,b){var c=b._.dataStore;return a.replace(/<\!--\{cke_protected\}([\s\S]+?)--\>/g,function(a,b){return decodeURIComponent(b)}).replace(/\{cke_protected_(\d+)\}/g,function(a,b){return c&&c[b]||""})}function l(a,b){for(var c=[],d=b.config.protectedSource,f=b._.dataStore||(b._.dataStore={id:1}),g=/<\!--\{cke_temp(comment)?\}(\d*?)--\>/g,d=[/<script[\s\S]*?<\/script>/gi,/<noscript[\s\S]*?<\/noscript>/gi,/<meta[\s\S]*?\/?>/gi].concat(d),a=a.replace(/<\!--[\s\S]*?--\>/g,function(a){return"<\!--{cke_tempcomment}"+(c.push(a)-1)+"--\>"}),h=0;h<d.length;h++)a=a.replace(d[h],function(a){a=a.replace(g,function(a,b,d){return c[d]});return/cke_temp(comment)?/.test(a)?a:"<\!--{cke_temp}"+(c.push(a)-1)+"--\>"});a=a.replace(g,function(a,b,d){return"<\!--"+t+(b?"{C}":"")+encodeURIComponent(c[d]).replace(/--/g,"%2D%2D")+"--\>"});a=a.replace(/<\w+(?:\s+(?:(?:[^\s=>]+\s*=\s*(?:[^'"\s>]+|'[^']*'|"[^"]*"))|[^\s=>]+))+\s*>/g,function(a){return a.replace(/<\!--\{cke_protected\}([^>]*)--\>/g,function(a,b){f[f.id]=decodeURIComponent(b);return"{cke_protected_"+f.id++ +"}"})});return a=a.replace(/<(title|iframe|textarea)([^>]*)>([\s\S]*?)<\/\1>/g,function(a,c,d,f){return"<"+c+d+">"+m(q(f),b)+"</"+c+">"})}CKEDITOR.htmlDataProcessor=function(b){var c,d,f=this;this.editor=b;this.dataFilter=c=new CKEDITOR.htmlParser.filter;this.htmlFilter=d=new CKEDITOR.htmlParser.filter;this.writer=new CKEDITOR.htmlParser.basicWriter;c.addRules(x);c.addRules(v,{applyToAll:true});c.addRules(a(b,"data"),{applyToAll:true});d.addRules(r);d.addRules(y,{applyToAll:true});d.addRules(a(b,"html"),{applyToAll:true});b.on("toHtml",function(a){var a=a.data,c=a.dataValue,d,c=l(c,b),c=k(c,D),c=i(c),c=k(c,G),c=c.replace(C,"$1cke:$2"),c=c.replace(E,"<cke:$1$2></cke:$1>"),c=c.replace(/(<pre\b[^>]*>)(\r\n|\n)/g,"$1$2$2"),c=c.replace(/([^a-z0-9<\-])(on\w{3,})(?!>)/gi,"$1data-cke-"+CKEDITOR.rnd+"-$2");d=a.context||b.editable().getName();var f;if(CKEDITOR.env.ie&&CKEDITOR.env.version<9&&d=="pre"){d="div";c="<pre>"+c+"</pre>";f=1}d=b.document.createElement(d);d.setHtml("a"+c);c=d.getHtml().substr(1);c=c.replace(RegExp("data-cke-"+CKEDITOR.rnd+"-","ig"),"");f&&(c=c.replace(/^<pre>|<\/pre>$/gi,""));c=c.replace(F,"$1$2");c=n(c);c=q(c);d=a.fixForBody===false?false:e(a.enterMode,b.config.autoParagraph);c=CKEDITOR.htmlParser.fragment.fromHtml(c,a.context,d);if(d){f=c;if(!f.children.length&&CKEDITOR.dtd[f.name][d]){d=new CKEDITOR.htmlParser.element(d);f.add(d)}}a.dataValue=c},null,null,5);b.on("toHtml",function(a){a.data.filter.applyTo(a.data.dataValue,true,a.data.dontFilter,a.data.enterMode)&&b.fire("dataFiltered")},null,null,6);b.on("toHtml",function(a){a.data.dataValue.filterChildren(f.dataFilter,true)},null,null,10);b.on("toHtml",function(a){var a=a.data,b=a.dataValue,c=new CKEDITOR.htmlParser.basicWriter;b.writeChildrenHtml(c);b=c.getHtml(true);a.dataValue=o(b)},null,null,15);b.on("toDataFormat",function(a){var c=a.data.dataValue;a.data.enterMode!=CKEDITOR.ENTER_BR&&(c=c.replace(/^<br *\/?>/i,""));a.data.dataValue=CKEDITOR.htmlParser.fragment.fromHtml(c,a.data.context,e(a.data.enterMode,b.config.autoParagraph))},null,null,5);b.on("toDataFormat",function(a){a.data.dataValue.filterChildren(f.htmlFilter,true)},null,null,10);b.on("toDataFormat",function(a){a.data.filter.applyTo(a.data.dataValue,false,true)},null,null,11);b.on("toDataFormat",function(a){var c=a.data.dataValue,d=f.writer;d.reset();c.writeChildrenHtml(d);c=d.getHtml(true);c=q(c);c=m(c,b);a.data.dataValue=c},null,null,15)};CKEDITOR.htmlDataProcessor.prototype={toHtml:function(a,b,c,d){var f=this.editor,g,h,e;if(b&&typeof b=="object"){g=b.context;c=b.fixForBody;d=b.dontFilter;h=b.filter;e=b.enterMode}else g=b;!g&&g!==null&&(g=f.editable().getName());return f.fire("toHtml",{dataValue:a,context:g,fixForBody:c,dontFilter:d,filter:h||f.filter,enterMode:e||f.enterMode}).dataValue},toDataFormat:function(a,b){var c,d,f;if(b){c=b.context;d=b.filter;f=b.enterMode}!c&&c!==null&&(c=this.editor.editable().getName());return this.editor.fire("toDataFormat",{dataValue:a,filter:d||this.editor.filter,context:c,enterMode:f||this.editor.enterMode}).dataValue}};var p=/(?:&nbsp;|\xa0)$/,t="{cke_protected}",s=CKEDITOR.dtd,u=["caption","colgroup","col","thead","tfoot","tbody"],w=CKEDITOR.tools.extend({},s.$blockLimit,s.$block),x={elements:{input:f,textarea:f}},v={attributeNames:[[/^on/,"data-cke-pa-on"],[/^data-cke-expando$/,""]]},r={elements:{embed:function(a){var b=a.parent;if(b&&b.name=="object"){var c=b.attributes.width,b=b.attributes.height;if(c)a.attributes.width=c;if(b)a.attributes.height=b}},a:function(a){if(!a.children.length&&!a.attributes.name&&!a.attributes["data-cke-saved-name"])return false}}},y={elementNames:[[/^cke:/,""],[/^\?xml:namespace$/,""]],attributeNames:[[/^data-cke-(saved|pa)-/,""],[/^data-cke-.*/,""],["hidefocus",""]],elements:{$:function(a){var b=a.attributes;if(b){if(b["data-cke-temp"])return false;for(var c=["name","href","src"],d,f=0;f<c.length;f++){d="data-cke-saved-"+c[f];d in b&&delete b[c[f]]}}return a},table:function(a){a.children.slice(0).sort(function(a,b){var c,d;if(a.type==CKEDITOR.NODE_ELEMENT&&b.type==a.type){c=CKEDITOR.tools.indexOf(u,a.name);d=CKEDITOR.tools.indexOf(u,b.name)}if(!(c>-1&&d>-1&&c!=d)){c=a.parent?a.getIndex():-1;d=b.parent?b.getIndex():-1}return c>d?1:-1})},param:function(a){a.children=[];a.isEmpty=true;return a},span:function(a){a.attributes["class"]=="Apple-style-span"&&delete a.name},html:function(a){delete a.attributes.contenteditable;delete a.attributes["class"]},body:function(a){delete a.attributes.spellcheck;delete a.attributes.contenteditable},style:function(a){var b=a.children[0];if(b&&b.value)b.value=CKEDITOR.tools.trim(b.value);if(!a.attributes.type)a.attributes.type="text/css"},title:function(a){var b=a.children[0];!b&&j(a,b=new CKEDITOR.htmlParser.text);b.value=a.attributes["data-cke-title"]||""},input:h,textarea:h},attributes:{"class":function(a){return CKEDITOR.tools.ltrim(a.replace(/(?:^|\s+)cke_[^\s]*/g,""))||false}}};if(CKEDITOR.env.ie)y.attributes.style=function(a){return a.replace(/(^|;)([^\:]+)/g,function(a){return a.toLowerCase()})};var z=/<(a|area|img|input|source)\b([^>]*)>/gi,B=/([\w-]+)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+))/gi,A=/^(href|src|name)$/i,G=/(?:<style(?=[ >])[^>]*>[\s\S]*?<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,D=/(<textarea(?=[ >])[^>]*>)([\s\S]*?)(?:<\/textarea>)/gi,J=/<cke:encoded>([^<]*)<\/cke:encoded>/gi,C=/(<\/?)((?:object|embed|param|html|body|head|title)[^>]*>)/gi,F=/(<\/?)cke:((?:html|body|head|title)[^>]*>)/gi,E=/<cke:(param|embed)([^>]*?)\/?>(?!\s*<\/cke:\1)/gi}(),"use strict",CKEDITOR.htmlParser.element=function(a,e){this.name=a;this.attributes=e||{};this.children=[];var b=a||"",g=b.match(/^cke:(.*)/);g&&(b=g[1]);b=!(!CKEDITOR.dtd.$nonBodyContent[b]&&!CKEDITOR.dtd.$block[b]&&!CKEDITOR.dtd.$listItem[b]&&!CKEDITOR.dtd.$tableContent[b]&&!(CKEDITOR.dtd.$nonEditable[b]||b=="br"));this.isEmpty=!!CKEDITOR.dtd.$empty[a];this.isUnknown=!CKEDITOR.dtd[a];this._={isBlockLike:b,hasInlineStarted:this.isEmpty||!b}},CKEDITOR.htmlParser.cssStyle=function(a){var e={};((a instanceof
CKEDITOR.htmlParser.element?a.attributes.style:a)||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(a,g,c){g=="font-family"&&(c=c.replace(/["']/g,""));e[g.toLowerCase()]=c});return{rules:e,populate:function(a){var g=this.toString();if(g)a instanceof CKEDITOR.dom.element?a.setAttribute("style",g):a instanceof CKEDITOR.htmlParser.element?a.attributes.style=g:a.style=g},toString:function(){var a=[],g;for(g in e)e[g]&&a.push(g,":",e[g],";");return a.join("")}}},function(){function a(a){return function(b){return b.type==CKEDITOR.NODE_ELEMENT&&(typeof a=="string"?b.name==a:b.name in a)}}var e=function(a,b){a=a[0];b=b[0];return a<b?-1:a>b?1:0},b=CKEDITOR.htmlParser.fragment.prototype;CKEDITOR.htmlParser.element.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_ELEMENT,add:b.add,clone:function(){return new CKEDITOR.htmlParser.element(this.name,this.attributes)},filter:function(a,b){var d=this,e,f,b=d.getFilterContext(b);if(b.off)return true;if(!d.parent)a.onRoot(b,d);for(;;){e=d.name;if(!(f=a.onElementName(b,e))){this.remove();return false}d.name=f;if(!(d=a.onElement(b,d))){this.remove();return false}if(d!==this){this.replaceWith(d);return false}if(d.name==e)break;if(d.type!=CKEDITOR.NODE_ELEMENT){this.replaceWith(d);return false}if(!d.name){this.replaceWithChildren();return false}}e=d.attributes;var h,i;for(h in e){i=h;for(f=e[h];;)if(i=a.onAttributeName(b,h))if(i!=h){delete e[h];h=i}else break;else{delete e[h];break}i&&((f=a.onAttribute(b,d,i,f))===false?delete e[i]:e[i]=f)}d.isEmpty||this.filterChildren(a,false,b);return true},filterChildren:b.filterChildren,writeHtml:function(a,b){b&&this.filter(b);var d=this.name,j=[],f=this.attributes,h,i;a.openTag(d,f);for(h in f)j.push([h,f[h]]);a.sortAttributes&&j.sort(e);h=0;for(i=j.length;h<i;h++){f=j[h];a.attribute(f[0],f[1])}a.openTagClose(d,this.isEmpty);this.writeChildrenHtml(a);this.isEmpty||a.closeTag(d)},writeChildrenHtml:b.writeChildrenHtml,replaceWithChildren:function(){for(var a=this.children,b=a.length;b;)a[--b].insertAfter(this);this.remove()},forEach:b.forEach,getFirst:function(b){if(!b)return this.children.length?this.children[0]:null;typeof b!="function"&&(b=a(b));for(var c=0,d=this.children.length;c<d;++c)if(b(this.children[c]))return this.children[c];return null},getHtml:function(){var a=new CKEDITOR.htmlParser.basicWriter;this.writeChildrenHtml(a);return a.getHtml()},setHtml:function(a){for(var a=this.children=CKEDITOR.htmlParser.fragment.fromHtml(a).children,b=0,d=a.length;b<d;++b)a[b].parent=this},getOuterHtml:function(){var a=new CKEDITOR.htmlParser.basicWriter;this.writeHtml(a);return a.getHtml()},split:function(a){for(var b=this.children.splice(a,this.children.length-a),d=this.clone(),e=0;e<b.length;++e)b[e].parent=d;d.children=b;if(b[0])b[0].previous=null;if(a>0)this.children[a-1].next=null;this.parent.add(d,this.getIndex()+1);return d},addClass:function(a){if(!this.hasClass(a)){var b=this.attributes["class"]||"";this.attributes["class"]=b+(b?" ":"")+a}},removeClass:function(a){var b=this.attributes["class"];if(b)(b=CKEDITOR.tools.trim(b.replace(RegExp("(?:\\s+|^)"+a+"(?:\\s+|$)")," ")))?this.attributes["class"]=b:delete this.attributes["class"]},hasClass:function(a){var b=this.attributes["class"];return!b?false:RegExp("(?:^|\\s)"+a+"(?=\\s|$)").test(b)},getFilterContext:function(a){var b=[];a||(a={off:false,nonEditable:false,nestedEditable:false});!a.off&&this.attributes["data-cke-processor"]=="off"&&b.push("off",true);!a.nonEditable&&this.attributes.contenteditable=="false"?b.push("nonEditable",true):a.nonEditable&&(!a.nestedEditable&&this.attributes.contenteditable=="true")&&b.push("nestedEditable",true);if(b.length)for(var a=CKEDITOR.tools.copy(a),d=0;d<b.length;d=d+2)a[b[d]]=b[d+1];return a}},true)}(),function(){var a={},e=/{([^}]+)}/g,b=/([\\'])/g,g=/\n/g,c=/\r/g;CKEDITOR.template=function(d){if(a[d])this.output=a[d];else{var j=d.replace(b,"\\$1").replace(g,"\\n").replace(c,"\\r").replace(e,function(a,b){return"',data['"+b+"']==undefined?'{"+b+"}':data['"+b+"'],'"});this.output=a[d]=Function("data","buffer","return buffer?buffer.push('"+j+"'):['"+j+"'].join('');")}}}(),delete CKEDITOR.loadFullCore,CKEDITOR.instances={},CKEDITOR.document=new CKEDITOR.dom.document(document),CKEDITOR.add=function(a){CKEDITOR.instances[a.name]=a;a.on("focus",function(){if(CKEDITOR.currentInstance!=a){CKEDITOR.currentInstance=a;CKEDITOR.fire("currentInstance")}});a.on("blur",function(){if(CKEDITOR.currentInstance==a){CKEDITOR.currentInstance=null;CKEDITOR.fire("currentInstance")}});CKEDITOR.fire("instance",null,a)},CKEDITOR.remove=function(a){delete CKEDITOR.instances[a.name]},function(){var a={};CKEDITOR.addTemplate=function(e,b){var g=a[e];if(g)return g;g={name:e,source:b};CKEDITOR.fire("template",g);return a[e]=new CKEDITOR.template(g.source)};CKEDITOR.getTemplate=function(e){return a[e]}}(),function(){var a=[];CKEDITOR.addCss=function(e){a.push(e)};CKEDITOR.getCss=function(){return a.join("\n")}}(),CKEDITOR.on("instanceDestroyed",function(){CKEDITOR.tools.isEmpty(this.instances)&&CKEDITOR.fire("reset")}),CKEDITOR.TRISTATE_ON=1,CKEDITOR.TRISTATE_OFF=2,CKEDITOR.TRISTATE_DISABLED=0,function(){CKEDITOR.inline=function(a,e){if(!CKEDITOR.env.isCompatible)return null;a=CKEDITOR.dom.element.get(a);if(a.getEditor())throw'The editor instance "'+a.getEditor().name+'" is already attached to the provided element.';var b=new CKEDITOR.editor(e,a,CKEDITOR.ELEMENT_MODE_INLINE),g=a.is("textarea")?a:null;if(g){b.setData(g.getValue(),null,true);a=CKEDITOR.dom.element.createFromHtml('<div contenteditable="'+!!b.readOnly+'" class="cke_textarea_inline">'+
g.getValue()+"</div>",CKEDITOR.document);a.insertAfter(g);g.hide();g.$.form&&b._attachToForm()}else b.setData(a.getHtml(),null,true);b.on("loaded",function(){b.fire("uiReady");b.editable(a);b.container=a;b.setData(b.getData(1));b.resetDirty();b.fire("contentDom");b.mode="wysiwyg";b.fire("mode");b.status="ready";b.fireOnce("instanceReady");CKEDITOR.fire("instanceReady",null,b)},null,null,1E4);b.on("destroy",function(){if(g){b.container.clearCustomData();b.container.remove();g.show()}b.element.clearCustomData();delete b.element});return b};CKEDITOR.inlineAll=function(){var a,e,b;for(b in CKEDITOR.dtd.$editable)for(var g=CKEDITOR.document.getElementsByTag(b),c=0,d=g.count();c<d;c++){a=g.getItem(c);if(a.getAttribute("contenteditable")=="true"){e={element:a,config:{}};CKEDITOR.fire("inline",e)!==false&&CKEDITOR.inline(a,e.config)}}};CKEDITOR.domReady(function(){!CKEDITOR.disableAutoInline&&CKEDITOR.inlineAll()})}(),CKEDITOR.replaceClass="ckeditor",function(){function a(a,c,d,j){if(!CKEDITOR.env.isCompatible)return null;a=CKEDITOR.dom.element.get(a);if(a.getEditor())throw'The editor instance "'+a.getEditor().name+'" is already attached to the provided element.';var f=new CKEDITOR.editor(c,a,j);if(j==CKEDITOR.ELEMENT_MODE_REPLACE){a.setStyle("visibility","hidden");f._.required=a.hasAttribute("required");a.removeAttribute("required")}d&&f.setData(d,null,true);f.on("loaded",function(){b(f);j==CKEDITOR.ELEMENT_MODE_REPLACE&&(f.config.autoUpdateElement&&a.$.form)&&f._attachToForm();f.setMode(f.config.startupMode,function(){f.resetDirty();f.status="ready";f.fireOnce("instanceReady");CKEDITOR.fire("instanceReady",null,f)})});f.on("destroy",e);return f}function e(){var a=this.container,b=this.element;if(a){a.clearCustomData();a.remove()}if(b){b.clearCustomData();if(this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE){b.show();this._.required&&b.setAttribute("required","required")}delete this.element}}function b(a){var b=a.name,d=a.element,e=a.elementMode,f=a.fire("uiSpace",{space:"top",html:""}).html,h=a.fire("uiSpace",{space:"bottom",html:""}).html,i=new CKEDITOR.template('<{outerEl} id="cke_{name}" class="{id} cke cke_reset cke_chrome cke_editor_{name} cke_{langDir} '+CKEDITOR.env.cssClass+'"  dir="{langDir}" lang="{langCode}" role="application"'+(a.title?' aria-labelledby="cke_{name}_arialbl"':"")+">"+(a.title?'<span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span>':"")+'<{outerEl} class="cke_inner cke_reset" role="presentation">{topHtml}<{outerEl} id="{contentId}" class="cke_contents cke_reset" role="presentation"></{outerEl}>{bottomHtml}</{outerEl}></{outerEl}>'),b=CKEDITOR.dom.element.createFromHtml(i.output({id:a.id,name:b,langDir:a.lang.dir,langCode:a.langCode,voiceLabel:a.title,topHtml:f?'<span id="'+a.ui.spaceId("top")+'" class="cke_top cke_reset_all" role="presentation" style="height:auto">'+f+"</span>":"",contentId:a.ui.spaceId("contents"),bottomHtml:h?'<span id="'+a.ui.spaceId("bottom")+'" class="cke_bottom cke_reset_all" role="presentation">'+h+"</span>":"",outerEl:CKEDITOR.env.ie?"span":"div"}));if(e==CKEDITOR.ELEMENT_MODE_REPLACE){d.hide();b.insertAfter(d)}else d.append(b);a.container=b;f&&a.ui.space("top").unselectable();h&&a.ui.space("bottom").unselectable();d=a.config.width;e=a.config.height;d&&b.setStyle("width",CKEDITOR.tools.cssLength(d));e&&a.ui.space("contents").setStyle("height",CKEDITOR.tools.cssLength(e));b.disableContextMenu();CKEDITOR.env.webkit&&b.on("focus",function(){a.focus()});a.fireOnce("uiReady")}CKEDITOR.replace=function(b,c){return a(b,c,null,CKEDITOR.ELEMENT_MODE_REPLACE)};CKEDITOR.appendTo=function(b,c,d){return a(b,c,d,CKEDITOR.ELEMENT_MODE_APPENDTO)};CKEDITOR.replaceAll=function(){for(var a=document.getElementsByTagName("textarea"),b=0;b<a.length;b++){var d=null,e=a[b];if(e.name||e.id){if(typeof arguments[0]=="string"){if(!RegExp("(?:^|\\s)"+arguments[0]+"(?:$|\\s)").test(e.className))continue}else if(typeof arguments[0]=="function"){d={};if(arguments[0](e,d)===false)continue}this.replace(e,d)}}};CKEDITOR.editor.prototype.addMode=function(a,b){(this._.modes||(this._.modes={}))[a]=b};CKEDITOR.editor.prototype.setMode=function(a,b){var d=this,e=this._.modes;if(!(a==d.mode||!e||!e[a])){d.fire("beforeSetMode",a);if(d.mode){var f=d.checkDirty(),e=d._.previousModeData,h,i=0;d.fire("beforeModeUnload");d.editable(0);d._.previousMode=d.mode;d._.previousModeData=h=d.getData(1);if(d.mode=="source"&&e==h){d.fire("lockSnapshot",{forceUpdate:true});i=1}d.ui.space("contents").setHtml("");d.mode=""}else d._.previousModeData=d.getData(1);this._.modes[a](function(){d.mode=a;f!==void 0&&!f&&d.resetDirty();i?d.fire("unlockSnapshot"):a=="wysiwyg"&&d.fire("saveSnapshot");setTimeout(function(){d.fire("mode");b&&b.call(d)},0)})}};CKEDITOR.editor.prototype.resize=function(a,b,d,e){var f=this.container,h=this.ui.space("contents"),i=CKEDITOR.env.webkit&&this.document&&this.document.getWindow().$.frameElement,e=e?this.container.getFirst(function(a){return a.type==CKEDITOR.NODE_ELEMENT&&a.hasClass("cke_inner")}):f;e.setSize("width",a,true);i&&(i.style.width="1%");h.setStyle("height",Math.max(b-(d?0:(e.$.offsetHeight||0)-(h.$.clientHeight||0)),0)+"px");i&&(i.style.width="100%");this.fire("resize")};CKEDITOR.editor.prototype.getResizable=function(a){return a?this.ui.space("contents"):this.container};CKEDITOR.domReady(function(){CKEDITOR.replaceClass&&CKEDITOR.replaceAll(CKEDITOR.replaceClass)})}(),CKEDITOR.config.startupMode="wysiwyg",function(){function a(a){var b=a.editor,c=a.data.path,d=c.blockLimit,f=a.data.selection,h=f.getRanges()[0],i;if(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller)if(f=e(f,c)){f.appendBogus();i=CKEDITOR.env.ie}if(j(b,c.block,d)&&h.collapsed&&!h.getCommonAncestor().isReadOnly()){c=h.clone();c.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS);d=new CKEDITOR.dom.walker(c);d.guard=function(a){return!g(a)||a.type==CKEDITOR.NODE_COMMENT||a.isReadOnly()};if(!d.checkForward()||c.checkStartOfBlock()&&c.checkEndOfBlock()){b=h.fixBlock(true,b.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p");if(!CKEDITOR.env.needsBrFiller)(b=b.getFirst(g))&&(b.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(b.getText()).match(/^(?:&nbsp;|\xa0)$/))&&b.remove();i=1;a.cancel()}}i&&h.select()}function e(a,b){if(a.isFake)return 0;var c=b.block||b.blockLimit,d=c&&c.getLast(g);if(c&&c.isBlockBoundary()&&(!d||!(d.type==CKEDITOR.NODE_ELEMENT&&d.isBlockBoundary()))&&!c.is("pre")&&!c.getBogus())return c}function b(a){var b=a.data.getTarget();if(b.is("input")){b=b.getAttribute("type");(b=="submit"||b=="reset")&&a.data.preventDefault()}}function g(a){return o(a)&&q(a)}function c(a,b){return function(c){var d=CKEDITOR.dom.element.get(c.data.$.toElement||c.data.$.fromElement||c.data.$.relatedTarget);(!d||!b.equals(d)&&!b.contains(d))&&a.call(this,c)}}function d(a){function b(a){return function(b,d){d&&(b.type==CKEDITOR.NODE_ELEMENT&&b.is(f))&&(c=b);if(!d&&g(b)&&(!a||!k(b)))return false}}var c,d=a.getRanges()[0],a=a.root,f={table:1,ul:1,ol:1,dl:1};if(d.startPath().contains(f)){var e=d.clone();e.collapse(1);e.setStartAt(a,CKEDITOR.POSITION_AFTER_START);a=new CKEDITOR.dom.walker(e);a.guard=b();a.checkBackward();if(c){e=d.clone();e.collapse();e.setEndAt(c,CKEDITOR.POSITION_AFTER_END);a=new CKEDITOR.dom.walker(e);a.guard=b(true);c=false;a.checkForward();return c}}return null}function j(a,b,c){return a.config.autoParagraph!==false&&a.activeEnterMode!=CKEDITOR.ENTER_BR&&a.editable().equals(c)&&!b||b&&b.getAttribute("contenteditable")=="true"}function f(a){a.editor.focus();a.editor.fire("saveSnapshot")}function h(a){var b=a.editor;b.getSelection().scrollIntoView();setTimeout(function(){b.fire("saveSnapshot")},0)}function i(a,b,c){for(var d=a.getCommonAncestor(b),b=a=c?b:a;(a=a.getParent())&&!d.equals(a)&&a.getChildCount()==1;)b=a;b.remove()}CKEDITOR.editable=CKEDITOR.tools.createClass({base:CKEDITOR.dom.element,$:function(a,b){this.base(b.$||b);this.editor=a;this.status="unloaded";this.hasFocus=false;this.setup()},proto:{focus:function(){var a;if(CKEDITOR.env.webkit&&!this.hasFocus){a=this.editor._.previousActive||this.getDocument().getActive();if(this.contains(a)){a.focus();return}}try{this.$[CKEDITOR.env.ie&&this.getDocument().equals(CKEDITOR.document)?"setActive":"focus"]()}catch(b){if(!CKEDITOR.env.ie)throw b;}if(CKEDITOR.env.safari&&!this.isInline()){a=CKEDITOR.document.getActive();a.equals(this.getWindow().getFrame())||this.getWindow().focus()}},on:function(a,b){var d=Array.prototype.slice.call(arguments,0);if(CKEDITOR.env.ie&&/^focus|blur$/.exec(a)){a=a=="focus"?"focusin":"focusout";b=c(b,this);d[0]=a;d[1]=b}return CKEDITOR.dom.element.prototype.on.apply(this,d)},attachListener:function(a){!this._.listeners&&(this._.listeners=[]);var b=Array.prototype.slice.call(arguments,1),b=a.on.apply(a,b);this._.listeners.push(b);return b},clearListeners:function(){var a=this._.listeners;try{for(;a.length;)a.pop().removeListener()}catch(b){}},restoreAttrs:function(){var a=this._.attrChanges,b,c;for(c in a)if(a.hasOwnProperty(c)){b=a[c];b!==null?this.setAttribute(c,b):this.removeAttribute(c)}},attachClass:function(a){var b=this.getCustomData("classes");if(!this.hasClass(a)){!b&&(b=[]);b.push(a);this.setCustomData("classes",b);this.addClass(a)}},changeAttr:function(a,b){var c=this.getAttribute(a);if(b!==c){!this._.attrChanges&&(this._.attrChanges={});a in this._.attrChanges||(this._.attrChanges[a]=c);this.setAttribute(a,b)}},insertHtml:function(a,b){f(this);m(this,b||"html",a)},insertText:function(a){f(this);var b=this.editor,c=b.getSelection().getStartElement().hasAscendant("pre",true)?CKEDITOR.ENTER_BR:b.activeEnterMode,b=c==CKEDITOR.ENTER_BR,d=CKEDITOR.tools,a=d.htmlEncode(a.replace(/\r\n/g,"\n")),a=a.replace(/\t/g,"&nbsp;&nbsp; &nbsp;"),c=c==CKEDITOR.ENTER_P?"p":"div";if(!b){var g=/\n{2}/g;if(g.test(a))var e="<"+c+">",h="</"+c+">",a=e+a.replace(g,function(){return h+e})+h}a=a.replace(/\n/g,"<br>");b||(a=a.replace(RegExp("<br>(?=</"+c+">)"),function(a){return d.repeat(a,2)}));a=a.replace(/^ | $/g,"&nbsp;");a=a.replace(/(>|\s) /g,function(a,b){return b+"&nbsp;"}).replace(/ (?=<)/g,"&nbsp;");m(this,"text",a)},insertElement:function(a,b){b?this.insertElementIntoRange(a,b):this.insertElementIntoSelection(a)},insertElementIntoRange:function(a,b){var c=this.editor,d=c.config.enterMode,f=a.getName(),g=CKEDITOR.dtd.$block[f];if(b.checkReadOnly())return false;b.deleteContents(1);b.startContainer.type==CKEDITOR.NODE_ELEMENT&&b.startContainer.is({tr:1,table:1,tbody:1,thead:1,tfoot:1})&&l(b);var e,h;if(g)for(;(e=b.getCommonAncestor(0,1))&&(h=CKEDITOR.dtd[e.getName()])&&(!h||!h[f]);)if(e.getName()in CKEDITOR.dtd.span)b.splitElement(e);else if(b.checkStartOfBlock()&&b.checkEndOfBlock()){b.setStartBefore(e);b.collapse(true);e.remove()}else b.splitBlock(d==CKEDITOR.ENTER_DIV?"div":"p",c.editable());b.insertNode(a);return true},insertElementIntoSelection:function(a){f(this);var b=this.editor,c=b.activeEnterMode,b=b.getSelection(),d=b.getRanges()[0],e=a.getName(),e=CKEDITOR.dtd.$block[e];if(this.insertElementIntoRange(a,d)){d.moveToPosition(a,CKEDITOR.POSITION_AFTER_END);if(e)if((e=a.getNext(function(a){return g(a)&&!k(a)}))&&e.type==CKEDITOR.NODE_ELEMENT&&e.is(CKEDITOR.dtd.$block))e.getDtd()["#"]?d.moveToElementEditStart(e):d.moveToElementEditEnd(a);else if(!e&&c!=CKEDITOR.ENTER_BR){e=d.fixBlock(true,c==CKEDITOR.ENTER_DIV?"div":"p");d.moveToElementEditStart(e)}}b.selectRanges([d]);h(this)},setData:function(a,b){b||(a=this.editor.dataProcessor.toHtml(a));this.setHtml(a);this.fixInitialSelection();if(this.status=="unloaded")this.status="ready";this.editor.fire("dataReady")},getData:function(a){var b=this.getHtml();a||(b=this.editor.dataProcessor.toDataFormat(b));return b},setReadOnly:function(a){this.setAttribute("contenteditable",!a)},detach:function(){this.removeClass("cke_editable");this.status="detached";var a=this.editor;this._.detach();delete a.document;delete a.window},isInline:function(){return this.getDocument().equals(CKEDITOR.document)},fixInitialSelection:function(){function a(){var b=c.getDocument().$,d=b.getSelection(),f;if(d.anchorNode&&d.anchorNode==c.$)f=true;else if(CKEDITOR.env.webkit){var g=c.getDocument().getActive();g&&(g.equals(c)&&!d.anchorNode)&&(f=true)}if(f){f=new CKEDITOR.dom.range(c);f.moveToElementEditStart(c);b=b.createRange();b.setStart(f.startContainer.$,f.startOffset);b.collapse(true);d.removeAllRanges();d.addRange(b)}}function b(){var a=c.getDocument().$,d=a.selection,f=c.getDocument().getActive();if(d.type=="None"&&f.equals(c)){d=new CKEDITOR.dom.range(c);a=a.body.createTextRange();d.moveToElementEditStart(c);d=d.startContainer;d.type!=CKEDITOR.NODE_ELEMENT&&(d=d.getParent());a.moveToElementText(d.$);a.collapse(true);a.select()}}var c=this;if(CKEDITOR.env.ie&&(CKEDITOR.env.version<9||CKEDITOR.env.quirks)){if(this.hasFocus){this.focus();b()}}else if(this.hasFocus){this.focus();a()}else this.once("focus",function(){a()},null,null,-999)},setup:function(){var a=this.editor;this.attachListener(a,"beforeGetData",function(){var b=this.getData();this.is("textarea")||a.config.ignoreEmptyParagraph!==false&&(b=b.replace(n,function(a,b){return b}));a.setData(b,null,1)},this);this.attachListener(a,"getSnapshot",function(a){a.data=this.getData(1)},this);this.attachListener(a,"afterSetData",function(){this.setData(a.getData(1))},this);this.attachListener(a,"loadSnapshot",function(a){this.setData(a.data,1)},this);this.attachListener(a,"beforeFocus",function(){var b=a.getSelection();(b=b&&b.getNative())&&b.type=="Control"||this.focus()},this);this.attachListener(a,"insertHtml",function(a){this.insertHtml(a.data.dataValue,a.data.mode)},this);this.attachListener(a,"insertElement",function(a){this.insertElement(a.data)},this);this.attachListener(a,"insertText",function(a){this.insertText(a.data)},this);this.setReadOnly(a.readOnly);this.attachClass("cke_editable");this.attachClass(a.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?"cke_editable_inline":a.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE||a.elementMode==CKEDITOR.ELEMENT_MODE_APPENDTO?"cke_editable_themed":"");this.attachClass("cke_contents_"+a.config.contentsLangDirection);a.keystrokeHandler.blockedKeystrokes[8]=+a.readOnly;a.keystrokeHandler.attach(this);this.on("blur",function(){this.hasFocus=false},null,null,-1);this.on("focus",function(){this.hasFocus=true},null,null,-1);a.focusManager.add(this);if(this.equals(CKEDITOR.document.getActive())){this.hasFocus=true;a.once("cont entDom",function(){a.focusManager.focus(this)},this)}this.isInline()&&this.changeAttr("tabindex",a.tabIndex);if(!this.is("textarea")){a.document=this.getDocument();a.window=this.getWindow();var c=a.document;this.changeAttr("spellcheck",!a.config.disableNativeSpellChecker);var f=a.config.contentsLangDirection;this.getDirection(1)!=f&&this.changeAttr("dir",f);var e=CKEDITOR.getCss();if(e){f=c.getHead();if(!f.getCustomData("stylesheet")){e=c.appendStyleText(e);e=new CKEDITOR.dom.element(e.ownerNode||e.owningElement);f.setCustomData("stylesheet",e);e.data("cke-temp",1)}}f=c.getCustomData("stylesheet_ref")||0;c.setCustomData("stylesheet_ref",f+1);this.setCustomData("cke_includeReadonly",!a.config.disableReadonlyStyling);this.attachListener(this,"click",function(a){var a=a.data,b=(new CKEDITOR.dom.elementPath(a.getTarget(),this)).contains("a");b&&(a.$.button!=2&&b.isReadOnly())&&a.preventDefault()});var h={8:1,46:1};this.attachListener(a,"key",function(b){if(a.readOnly)return true;var c=b.data.domEvent.getKey(),f;if(c in h){var b=a.getSelection(),e,g=b.getRanges()[0],i=g.startPath(),j,k,t,c=c==8;if(CKEDITOR.env.ie&&CKEDITOR.env.version<11&&(e=b.getSelectedElement())||(e=d(b))){a.fire("saveSnapshot");g.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START);e.remove();g.select();a.fire("saveSnapshot");f=1}else if(g.collapsed)if((j=i.block)&&(t=j[c?"getPrevious":"getNext"](o))&&t.type==CKEDITOR.NODE_ELEMENT&&t.is("table")&&g[c?"checkStartOfBlock":"checkEndOfBlock"]()){a.fire("saveSnapshot");g[c?"checkEndOfBlock":"checkStartOfBlock"]()&&j.remove();g["moveToElementEdit"+(c?"End":"Start")](t);g.select();a.fire("saveSnapshot");f=1}else if(i.blockLimit&&i.blockLimit.is("td")&&(k=i.blockLimit.getAscendant("table"))&&g.checkBoundaryOfElement(k,c?CKEDITOR.START:CKEDITOR.END)&&(t=k[c?"getPrevious":"getNext"](o))){a.fire("saveSnapshot");g["moveToElementEdit"+(c?"End":"Start")](t);g.checkStartOfBlock()&&g.checkEndOfBlock()?t.remove():g.select();a.fire("saveSnapshot");f=1}else if((k=i.contains(["td","th","caption"]))&&g.checkBoundaryOfElement(k,c?CKEDITOR.START:CKEDITOR.END))f=1}return!f});a.blockless&&(CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller)&&this.attachListener(this,"keyup",function(b){if(b.data.getKeystroke()in h&&!this.getFirst(g)){this.appendBogus();b=a.createRange();b.moveToPosition(this,CKEDITOR.POSITION_AFTER_START);b.select()}});this.attachListener(this,"dblclick",function(b){if(a.readOnly)return false;b={element:b.data.getTarget()};a.fire("doubleclick",b)});CKEDITOR.env.ie&&this.attachListener(this,"click",b);CKEDITOR.env.ie||this.attachListener(this,"mousedown",function(b){var c=b.data.getTarget();if(c.is("img","hr","input","textarea","select")&&!c.isReadOnly()){a.getSelection().selectElement(c);c.is("input","textarea","select")&&b.data.preventDefault()}});CKEDITOR.env.gecko&&this.attachListener(this,"mouseup",function(b){if(b.data.$.button==2){b=b.data.getTarget();if(!b.getOuterHtml().replace(n,"")){var c=a.createRange();c.moveToElementEditStart(b);c.select(true)}}});if(CKEDITOR.env.webkit){this.attachListener(this,"click",function(a){a.data.getTarget().is("input","select")&&a.data.preventDefault()});this.attachListener(this,"mouseup",function(a){a.data.getTarget().is("input","textarea")&&a.data.preventDefault()})}CKEDITOR.env.webkit&&this.attachListener(a,"key",function(b){b=b.data.domEvent.getKey();if(b in h){var c=b==8,d=a.getSelection().getRanges()[0],b=d.startPath();if(d.collapsed){var f;a:{var g=b.block;if(g)if(d[c?"checkStartOfBlock":"checkEndOfBlock"]())if(!d.moveToClosestEditablePosition(g,!c)||!d.collapsed)f=false;else{if(d.startContainer.type==CKEDITOR.NODE_ELEMENT){var e=d.startContainer.getChild(d.startOffset-(c?1:0));if(e&&e.type==CKEDITOR.NODE_ELEMENT&&e.is("hr")){a.fire("saveSnapshot");e.remove();f=true;break a}}if((d=d.startPath().block)&&(!d||!d.contains(g))){a.fire("saveSnapshot");var j;(j=(c?d:g).getBogus())&&j.remove();f=a.getSelection();j=f.createBookmarks();(c?g:d).moveChildren(c?d:g,false);b.lastElement.mergeSiblings();i(g,d,!c);f.selectBookmarks(j);f=true}}else f=false;else f=false}if(!f)return}else{c=d;f=b.block;j=c.endPath().block;if(!f||!j||f.equals(j))b=false;else{a.fire("saveSnapshot");(g=f.getBogus())&&g.remove();c.deleteContents();if(j.getParent()){j.moveChildren(f,false);b.lastElement.mergeSiblings();i(f,j,true)}c=a.getSelection().getRanges()[0];c.collapse(1);c.select();b=true}if(!b)return}a.getSelection().scrollIntoView();a.fire("saveSnapshot");return false}},this,null,100)}}},_:{detach:function(){this.editor.setData(this.editor.getData(),0,1);this.clearListeners();this.restoreAttrs();var a;if(a=this.removeCustomData("classes"))for(;a.length;)this.removeClass(a.pop());if(!this.is("textarea")){a=this.getDocument();var b=a.getHead();if(b.getCustomData("stylesheet")){var c=a.getCustomData("stylesheet_ref");if(--c)a.setCustomData("stylesheet_ref",c);else{a.removeCustomData("stylesheet_ref");b.removeCustomData("stylesheet").remove()}}}this.editor.fire("contentDomUnload");delete this.editor}}});CKEDITOR.editor.prototype.editable=function(a){var b=this._.editable;if(b&&a)return 0;if(arguments.length)b=this._.editable=a?a instanceof CKEDITOR.editable?a:new CKEDITOR.editable(this,a):(b&&b.detach(),null);return b};var k=CKEDITOR.dom.walker.bogus(),n=/(^|<body\b[^>]*>)\s*<(p|div|address|h\d|center|pre)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\2>)?\s*(?=$|<\/body>)/gi,o=CKEDITOR.dom.walker.whitespaces(true),q=CKEDITOR.dom.walker.bookmark(false,true);CKEDITOR.on("instanceLoaded",function(b){var c=b.editor;c.on("insertElement",function(a){a=a.data;if(a.type==CKEDITOR.NODE_ELEMENT&&(a.is("input")||a.is("textarea"))){a.getAttribute("contentEditable")!="false"&&a.data("cke-editable",a.hasAttribute("contenteditable")?"true":"1");a.setAttribute("contentEditable",false)}});c.on("selectionChange",function(b){if(!c.readOnly){var d=c.getSelection();if(d&&!d.isLocked){d=c.checkDirty();c.fire("lockSnapshot");a(b);c.fire("unlockSnapshot");!d&&c.resetDirty()}}})});CKEDITOR.on("instanceCreated",function(a){var b=a.editor;b.on("mode",function(){var a=b.editable();if(a&&a.isInline()){var c=b.title;a.changeAttr("role","textbox");a.changeAttr("aria-label",c);c&&a.changeAttr("title",c);var d=b.fire("ariaEditorHelpLabel",{}).label;if(d)if(c=this.ui.space(this.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?"top":"contents")){var f=CKEDITOR.tools.getNextId(),d=CKEDITOR.dom.element.createFromHtml('<span id="'+f+'" class="cke_voice_label">'+d+"</span>");c.append(d);a.changeAttr("aria-describedby",f)}}})});CKEDITOR.addCss(".cke_editable{cursor:text}.cke_editable img,.cke_editable input,.cke_editable textarea{cursor:default}");var m=function(){function a(b){return b.type==CKEDITOR.NODE_ELEMENT}function b(c,d){var f,g,e,h,j=[],k=d.range.startContainer;f=d.range.startPath();for(var k=i[k.getName()],m=0,n=c.getChildren(),w=n.count(),s=-1,x=-1,l=0,r=f.contains(i.$list);m<w;++m){f=n.getItem(m);if(a(f)){e=f.getName();if(r&&e in CKEDITOR.dtd.$list)j=j.concat(b(f,d));else{h=!!k[e];if(e=="br"&&f.data("cke-eol")&&(!m||m==w-1)){l=(g=m?j[m-1].node:n.getItem(m+1))&&(!a(g)||!g.is("br"));g=g&&a(g)&&i.$block[g.getName()]}s==-1&&!h&&(s=m);h||(x=m);j.push({isElement:1,isLineBreak:l,isBlock:f.isBlockBoundary(),hasBlockSibling:g,node:f,name:e,allowed:h});g=l=0}}else j.push({isElement:0,node:f,allowed:1})}if(s>-1)j[s].firstNotAllowed=1;if(x>-1)j[x].lastNotAllowed=1;return j}function c(b,d){var f=[],g=b.getChildren(),e=g.count(),h,j=0,k=i[d],m=!b.is(i.$inline)||b.is("br");for(m&&f.push(" ");j<e;j++){h=g.getItem(j);a(h)&&!h.is(k)?f=f.concat(c(h,d)):f.push(h)}m&&f.push(" ");return f}function d(b){return b&&a(b)&&(b.is(i.$removeEmpty)||b.is("a")&&!b.isBlockBoundary())}function f(b,c,d,g){var e=b.clone(),h,j;e.setEndAt(c,CKEDITOR.POSITION_BEFORE_END);if((h=(new CKEDITOR.dom.walker(e)).next())&&a(h)&&k[h.getName()]&&(j=h.getPrevious())&&a(j)&&!j.getParent().equals(b.startContainer)&&d.contains(j)&&g.contains(h)&&h.isIdentical(j)){h.moveChildren(j);h.remove();f(b,c,d,g)}}function e(b,c){function d(b,c){if(c.isBlock&&c.isElement&&!c.node.is("br")&&a(b)&&b.is("br")){b.remove();return 1}}var f=c.endContainer.getChild(c.endOffset),g=c.endContainer.getChild(c.endOffset-
1);f&&d(f,b[b.length-1]);if(g&&d(g,b[0])){c.setEnd(c.endContainer,c.endOffset-1);c.collapse()}}var i=CKEDITOR.dtd,k={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,li:1,pre:1,dl:1,blockquote:1},m={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},n=CKEDITOR.tools.extend({},i.$inline);delete n.br;return function(k,l,r){var q=k.editor,o=q.getSelection().getRanges()[0],C=false;if(l=="unfiltered_html"){l="html";C=true}if(!o.checkReadOnly()){var F=(new CKEDITOR.dom.elementPath(o.startContainer,o.root)).blockLimit||o.root,l={type:l,dontFilter:C,editable:k,editor:q,range:o,blockLimit:F,mergeCandidates:[],zombies:[]},q=l.range,C=l.mergeCandidates,E,I,L,H;if(l.type=="text"&&q.shrink(CKEDITOR.SHRINK_ELEMENT,true,false)){E=CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",q.document);q.insertNode(E);q.setStartAfter(E)}I=new CKEDITOR.dom.elementPath(q.startContainer);l.endPath=L=new CKEDITOR.dom.elementPath(q.endContainer);if(!q.collapsed){var F=L.block||L.blockLimit,Q=q.getCommonAncestor();F&&(!F.equals(Q)&&!F.contains(Q)&&q.checkEndOfBlock())&&l.zombies.push(F);q.deleteContents()}for(;(H=a(q.startContainer)&&q.startContainer.getChild(q.startOffset-1))&&a(H)&&H.isBlockBoundary()&&I.contains(H);)q.moveToPosition(H,CKEDITOR.POSITION_BEFORE_END);f(q,l.blockLimit,I,L);if(E){q.setEndBefore(E);q.collapse();E.remove()}E=q.startPath();if(F=E.contains(d,false,1)){q.splitElement(F);l.inlineStylesRoot=F;l.inlineStylesPeak=E.lastElement}E=q.createBookmark();(F=E.startNode.getPrevious(g))&&a(F)&&d(F)&&C.push(F);(F=E.startNode.getNext(g))&&a(F)&&d(F)&&C.push(F);for(F=E.startNode;(F=F.getParent())&&d(F);)C.push(F);q.moveToBookmark(E);if(E=r){E=l.range;if(l.type=="text"&&l.inlineStylesRoot){H=l.inlineStylesPeak;q=H.getDocument().createText("{cke-peak}");for(C=l.inlineStylesRoot.getParent();!H.equals(C);){q=q. appendTo(H.clone());H=H.getParent()}r=q.getOuterHtml().split("{cke-peak}").join(r)}H=l.blockLimit.getName();if(/^\s+|\s+$/.test(r)&&"span"in CKEDITOR.dtd[H])var O='<span data-cke-marker="1">&nbsp;</span>',r=O+r+O;r=l.editor.dataProcessor.toHtml(r,{context:null,fixForBody:false,dontFilter:l.dontFilter,filter:l.editor.activeFilter,enterMode:l.editor.activeEnterMode});H=E.document.createElement("body");H.setHtml(r);if(O){H.getFirst().remove();H.getLast().remove()}if((O=E.startPath().block)&&!(O.getChildCount()==1&&O.getBogus()))a:{var M;if(H.getChildCount()==1&&a(M=H.getFirst())&&M.is(m)){O=M.getElementsByTag("*");E=0;for(C=O.count();E<C;E++){q=O.getItem(E);if(!q.is(n))break a}M.moveChildren(M.getParent(1));M.remove()}}l.dataWrapper=H;E=r}if(E){M=l.range;var O=M.document,K,r=l.blockLimit;E=0;var R;H=[];var N,T,C=q=0,P,V;I=M.startContainer;var F=l.endPath.elements[0],W;L=F.getPosition(I);Q=!!F.getCommonAncestor(I)&&L!=CKEDITOR.POSITION_IDENTICAL&&!(L&CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED);I=b(l.dataWrapper,l);for(e(I,M);E<I.length;E++){L=I[E];if(K=L.isLineBreak){K=M;P=r;var S=void 0,Y=void 0;if(L.hasBlockSibling)K=1;else{S=K.startContainer.getAscendant(i.$block,1);if(!S||!S.is({div:1,p:1}))K=0;else{Y=S.getPosition(P);if(Y==CKEDITOR.POSITION_IDENTICAL||Y==CKEDITOR.POSITION_CONTAINS)K=0;else{P=K.splitElement(S);K.moveToPosition(P,CKEDITOR.POSITION_AFTER_START);K=1}}}}if(K)C=E>0;else{K=M.startPath();if(!L.isBlock&&j(l.editor,K.block,K.blockLimit)&&(T=l.editor.activeEnterMode!=CKEDITOR.ENTER_BR&&l.editor.config.autoParagraph!==false?l.editor.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p":false)){T=O.createElement(T);T.appendBogus();M.insertNode(T);CKEDITOR.env.needsBrFiller&&(R=T.getBogus())&&R.remove();M.moveToPosition(T,CKEDITOR.POSITION_BEFORE_END)}if((K=M.startPath().block)&&!K.equals(N)){if(R=K.getBogus()){R.remove();H.push(K)}N=K}L.firstNotAllowed&&(q=1);if(q&&L.isElement){K=M.startContainer;for(P=null;K&&!i[K.getName()][L.name];){if(K.equals(r)){K=null;break}P=K;K=K.getParent()}if(K){if(P){ V=M.splitElement(P);l.zombies.push(V);l.zombies.push(P)}}else{P=r.getName();W=!E;K=E==I.length-1;P=c(L.node,P);for(var S=[],Y=P.length,Z=0,ba=void 0,X=0,aa=-1;Z<Y;Z++){ba=P[Z];if(ba==" "){if(!X&&(!W||Z)){S.push(new CKEDITOR.dom.text(" "));aa=S.length}X=1}else{S.push(ba);X=0}}K&&aa==S.length&&S.pop();W=S}}if(W){for(;K=W.pop();)M.insertNode(K);W=0}else M.insertNode(L.node);if(L.lastNotAllowed&&E<I.length-1){(V=Q?F:V)&&M.setEndAt(V,CKEDITOR.POSITION_AFTER_START);q=0}M.collapse()}}l.dontMoveCaret=C;l.bogusNeededBlocks=H}R=l.range;var U;V=l.bogusNeededBlocks;for(W=R.createBookmark();N=l.zombies.pop();)if(N.getParent()){T=R.clone();T.moveToElementEditStart(N);T.removeEmptyBlocksAtEnd()}if(V)for(;N=V.pop();)CKEDITOR.env.needsBrFiller?N.appendBogus():N.append(R.document.createText(" "));for(;N=l.mergeCandidates.pop();)N.mergeSiblings();R.moveToBookmark(W);if(!l.dontMoveCaret){for(N=a(R.startContainer)&&R.startContainer.getChild(R.startOffset-1);N&&a(N)&&!N.is(i.$empty);){if(N.isBlockBoundary())R.moveToPosition(N,CKEDITOR.POSITION_BEFORE_END);else{if(d(N)&&N.getHtml().match(/(\s|&nbsp;)$/g)){U=null;break}U=R.clone();U.moveToPosition(N,CKEDITOR.POSITION_BEFORE_END)}N=N.getLast(g)}U&&R.moveToRange(U)}o.select();h(k)}}}(),l=function(){function a(b){b=new CKEDITOR.dom.walker(b);b.guard=function(a,b){if(b)return false;if(a.type==CKEDITOR.NODE_ELEMENT)return a.is(CKEDITOR.dtd.$tableContent)};b.evaluator=function(a){return a.type==CKEDITOR.NODE_ELEMENT};return b}function b(a,c,d){c=a.getDocument().createElement(c);a.append(c,d);return c}function c(a){var b=a.count(),d;for(b;b-->0;){d=a.getItem(b);if(!CKEDITOR.tools.trim(d.getHtml())){d.appendBogus();CKEDITOR.env.ie&&(CKEDITOR.env.version<9&&d.getChildCount())&&d.getFirst().remove()}}}return function(d){var f=d.startContainer,g=f.getAscendant("table",1),e=false;c(g.getElementsByTag("td"));c(g.getElementsByTag("th"));g=d.clone();g.setStart(f,0);g=a(g).lastBackward();if(!g){g=d.clone();g.setEndAt(f,CKEDITOR.POSITION_BEFORE_END);g=a(g).lastForward();e=true}g||(g=f);if(g.is("table")){d.setStartAt(g,CKEDITOR.POSITION_BEFORE_START);d.collapse(true);g.remove()}else{g.is({tbody:1,thead:1,tfoot:1})&&(g=b(g,"tr",e));g.is("tr")&&(g=b(g,g.getParent().is("thead")?"th":"td",e));(f=g.getBogus())&&f.remove();d.moveToPosition(g,e?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END)}}}()}(),function(){function a(){var a=this._.fakeSelection,b;if(a){b=this.getSelection(1);if(!b||!b.isHidden()){a.reset();a=0}}if(!a){a=b||this.getSelection(1);if(!a||a.getType()==CKEDITOR.SELECTION_NONE)return}this.fire("selectionCheck",a);b=this.elementPath();if(!b.compare(this._.selectionPreviousPath)){if(CKEDITOR.env.webkit)this._.previousActive=this.document.getActive();this._.selectionPreviousPath=b;this.fire("selectionChange",{selection:a,path:b})}}function e(){m=true;if(!q){b.call(this);q=CKEDITOR.tools.setTimeout(b,200,this)}}function b(){q=null;if(m){CKEDITOR.tools.setTimeout(a,0,this);m=false}}function g(a){return l(a)||a.type==CKEDITOR.NODE_ELEMENT&&!a.is(CKEDITOR.dtd.$empty)?true:false}function c(a){function b(c,d){return!c||c.type==CKEDITOR.NODE_TEXT?false:a.clone()["moveToElementEdit"+(d?"End":"Start")](c)}if(!(a.root instanceof CKEDITOR.editable))return false;var c=a.startContainer,d=a.getPreviousNode(g,null,c),f=a.getNextNode(g,null,c);return b(d)||b(f,1)||!d&&!f&&!(c.type==CKEDITOR.NODE_ELEMENT&&c.isBlockBoundary()&&c.getBogus())?true:false}function d(a){return a.getCustomData("cke-fillingChar")}function j(a,b){var c=a&&a.removeCustomData("cke-fillingChar");if(c){if(b!==false){var d,g=a.getDocument().getSelection().getNative(),e=g&&g.type!="None"&&g.getRangeAt(0);if(c.getLength()>1&&e&&e.intersectsNode(c.$)){d=h(g);e=g.focusNode==c.$&&g.focusOffset>0;g.anchorNode==c.$&&g.anchorOffset>0&&d[0].offset--;e&&d[1].offset--}}c.setText(f(c.getText()));d&&i(a.getDocument().$,d)}}function f(a){return a.replace(/\u200B( )?/g,function(a){return a[1]?" ":""})}function h(a){return[{node:a.anchorNode,offset:a.anchorOffset},{node:a.focusNode,offset:a.focusOffset}]}function i(a,b){var c=a.getSelection(),d=a.createRange();d.setStart(b[0].node,b[0].offset);d.collapse(true);c.removeAllRanges();c.addRange(d);c.extend(b[1].node,b[1].offset)}function k(a){var b=CKEDITOR.dom.element.createFromHtml('<div data-cke-hidden-sel="1" data-cke-temp="1" style="'+
(CKEDITOR.env.ie?"display:none":"position:fixed;top:0;left:-1000px")+'">&nbsp;</div>',a.document);a.fire("lockSnapshot");a.editable().append(b);var c=a.getSelection(1),d=a.createRange(),f=c.root.on("selectionchange",function(a){a.cancel()},null,null,0);d.setStartAt(b,CKEDITOR.POSITION_AFTER_START);d.setEndAt(b,CKEDITOR.POSITION_BEFORE_END);c.selectRanges([d]);f.removeListener();a.fire("unlockSnapshot");a._.hiddenSelectionContainer=b}function n(a){var b={37:1,39:1,8:1,46:1};return function(c){var d=c.data.getKeystroke();if(b[d]){var f=a.getSelection().getRanges(),g=f[0];if(f.length==1&&g.collapsed)if((d=g[d<38?"getPreviousEditableNode":"getNextEditableNode"]())&&d.type==CKEDITOR.NODE_ELEMENT&&d.getAttribute("contenteditable")=="false"){a.getSelection().fake(d);c.data.preventDefault();c.cancel()}}}}function o(a){for(var b=0;b<a.length;b++){var c=a[b];c.getCommonAncestor().isReadOnly()&&a.splice(b,1);if(!c.collapsed){if(c.startContainer.isReadOnly())for(var d=c.startContainer,f;d;){if((f=d.type==CKEDITOR.NODE_ELEMENT)&&d.is("body")||!d.isReadOnly())break;f&&d.getAttribute("contentEditable")=="false"&&c.setStartAfter(d);d=d.getParent()}d=c.startContainer;f=c.endContainer;var g=c.startOffset,e=c.endOffset,h=c.clone();d&&d.type==CKEDITOR.NODE_TEXT&&(g>=d.getLength()?h.setStartAfter(d):h.setStartBefore(d));f&&f.type==CKEDITOR.NODE_TEXT&&(e?h.setEndAfter(f):h.setEndBefore(f));d=new CKEDITOR.dom.walker(h);d.evaluator=function(d){if(d.type==CKEDITOR.NODE_ELEMENT&&d.isReadOnly()){var f=c.clone();c.setEndBefore(d);c.collapsed&&a.splice(b--,1);if(!(d.getPosition(h.endContainer)&CKEDITOR.POSITION_CONTAINS)){f.setStartAfter(d);f.collapsed||a.splice(b+1,0,f)}return true}return false};d.next()}}return a}var q,m,l=CKEDITOR.dom.walker.invisible(1),p=function(){function a(b){return function(a){var c=a.editor.createRange();c.moveToClosestEditablePosition(a.selected,b)&&a.editor.getSelection().selectRanges([c]);return false}}function b(a){return function(b){var c=b.editor,d=c.createRange(),f;if(!(f=d.moveToClosestEditablePosition(b.selected,a)))f=d.moveToClosestEditablePosition(b.selected,!a);f&&c.getSelection().selectRanges([d]);c.fire("saveSnapshot");b.selected.remove();if(!f){d.moveToElementEditablePosition(c.editable());c.getSelection().selectRanges([d])}c.fire("saveSnapshot");return false}}var c=a(),d=a(1);return{37:c,38:c,39:d,40:d,8:b(),46:b(1)}}();CKEDITOR.on("instanceCreated",function(b){function c(){var a=d.getSelection();a&&a.removeAllRanges()}var d=b.editor;d.on("contentDom",function(){function b(){p=new CKEDITOR.dom.selection(d.getSelection());p.lock()}function c(){g.removeListener("mouseup",c);k.removeListener("mouseup",c);var a=CKEDITOR.document.$.selection,b=a.createRange();a.type!="None"&&b.parentElement().ownerDocument==f.$&&b.select()}var f=d.document,g=CKEDITOR.document,h=d.editable(),i=f.getBody(),k=f.getDocumentElement(),m=h.isInline(),C,p;CKEDITOR.env.gecko&&h.attachListener(h,"focus",function(a){a.removeListener();if(C!==0)if((a=d.getSelection().getNative())&&a.isCollapsed&&a.anchorNode==h.$){a=d.createRange();a.moveToElementEditStart(h);a.select()}},null,null,-2);h.attachListener(h,CKEDITOR.env.webkit?"DOMFocusIn":"focus",function(){C&&CKEDITOR.env.webkit&&(C=d._.previousActive&&d._.previousActive.equals(f.getActive()));d.unlockSelection(C);C=0},null,null,-1);h.attachListener(h,"mousedown",function(){C=0});if(CKEDITOR.env.ie||m){t?h.attachListener(h,"beforedeactivate",b,null,null,-1):h.attachListener(d,"selectionCheck",b,null,null,-1);h.attachListener(h,CKEDITOR.env.webkit?"DOMFocusOut":"blur",function(){d.lockSelection(p);C=1},null,null,-1);h.attachListener(h,"mousedown",function(){C=0})}if(CKEDITOR.env.ie&&!m){var s;h.attachListener(h,"mousedown",function(a){if(a.data.$.button==2){a=d.document.getSelection();if(!a||a.getType()==CKEDITOR.SELECTION_NONE)s=d.window.getScrollPosition()}});h.attachListener(h,"mouseup",function(a){if(a.data.$.button==2&&s){d.document.$.documentElement.scrollLeft=s.x;d.document.$.documentElement.scrollTop=s.y}s=null});if(f.$.compatMode!="BackCompat"){if(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)k.on("mousedown",function(a){function b(a){a=a.data.$;if(d){var c=i.$.createTextRange();try{c.moveToPoint(a.clientX,a.clientY)}catch(f){}d.setEndPoint(e.compareEndPoints("StartToStart",c)<0?"EndToEnd":"StartToStart",c);d.select()}}function c(){k.removeListener("mousemove",b);g.removeListener("mouseup",c);k.removeListener("mouseup",c);d.select()}a=a.data;if(a.getTarget().is("html")&&a.$.y<k.$.clientHeight&&a.$.x<k.$.clientWidth){var d=i.$.createTextRange();try{d.moveToPoint(a.$.clientX,a.$.clientY)}catch(f){}var e=d.duplicate();k.on("mousemove",b);g.on("mouseup",c);k.on("mouseup",c)}});if(CKEDITOR.env.version>7&&CKEDITOR.env.version<11)k.on("mousedown",function(a){if(a.data.getTarget().is("html")){g.on("mouseup",c);k.on("mouseup",c)}})}}h.attachListener(h,"selectionchange",a,d);h.attachListener(h,"keyup",e,d);h.attachListener(h,CKEDITOR.env.webkit?"DOMFocusIn":"focus",function(){d.forceNextSelectionCheck();d.selectionChange(1)});if(m&&(CKEDITOR.env.webkit||CKEDITOR.env.gecko)){var l;h.attachListener(h,"mousedown",function(){l=1});h.attachListener(f.getDocumentElement(),"mouseup",function(){l&&e.call(d);l=0})}else h.attachListener(CKEDITOR.env.ie?h:f.getDocumentElement(),"mouseup",e,d);CKEDITOR.env.webkit&&h.attachListener(f,"keydown",function(a){switch(a.data.getKey()){case 13:case 33:case 34:case 35:case 36:case 37:case 39:case 8:case 45:case 46:j(h)}},null,null,-1);h.attachListener(h,"keydown",n(d),null,null,-1)});d.on("setData",function(){d.unlockSelection();CKEDITOR.env.webkit&&c()});d.on("contentDomUnload",function(){d.unlockSelection()});if(CKEDITOR.env.ie9Compat)d.on("beforeDestroy",c,null,null,9);d.on("dataReady",function(){delete d._.fakeSelection;delete d._.hiddenSelectionContainer;d.selectionChange(1)});d.on("loadSnapshot",function(){var a=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT),b=d.editable().getLast(a);if(b&&b.hasAttribute("data-cke-hidden-sel")){b.remove();if(CKEDITOR.env.gecko)(a=d.editable().getFirst(a))&&(a.is("br")&&a.getAttribute("_moz_editor_bogus_node"))&&a.remove()}},null,null,100);d.on("key",function(a){if(d.mode=="wysiwyg"){var b=d.getSelection();if(b.isFake){var c=p[a.data.keyCode];if(c)return c({editor:d,selected:b.getSelectedElement(),selection:b,keyEvent:a})}}})});CKEDITOR.on("instanceReady",function(a){function b(){var a=g.editable();if(a)if(a=d(a)){var c=g.document.$.getSelection();if(c.type!="None"&&(c.anchorNode==a.$||c.focusNode==a.$))k=h(c);e=a.getText();a.setText(f(e))}}function c(){var a=g.editable();if(a)if(a=d(a)){a.setText(e);if(k){i(g.document.$,k);k=null}}}var g=a.editor,e,k;if(CKEDITOR.env.webkit){g.on("selectionChange",function(){var a=g.editable(),b=d(a);b&&(b.getCustomData("ready")?j(a):b.setCustomData("ready",1))},null,null,-1);g.on("beforeSetMode",function(){j(g.editable())},null,null,-1);g.on("beforeUndoImage",b);g.on("afterUndoImage",c);g.on("beforeGetData",b,null,null,0);g.on("getData",c)}});CKEDITOR.editor.prototype.selectionChange=function(b){(b?a:e).call(this)};CKEDITOR.editor.prototype.getSelection=function(a){if((this._.savedSelection||this._.fakeSelection)&&!a)return this._.savedSelection||this._.fakeSelection;return(a=this.editable())&&this.mode=="wysiwyg"?new CKEDITOR.dom.selection(a):null};CKEDITOR.editor.prototype.lockSelection=function(a){a=a||this.getSelection(1);if(a.getType()!=CKEDITOR.SELECTION_NONE){!a.isLocked&&a.lock();this._.savedSelection=a;return true}return false};CKEDITOR.editor.prototype.unlockSelection=function(a){var b=this._.savedSelection;if(b){b.unlock(a);delete this._.savedSelection;return true}return false};CKEDITOR.editor.prototype.forceNextSelectionCheck=function(){delete this._.selectionPreviousPath};CKEDITOR.dom.document.prototype.getSelection=function(){return new CKEDITOR.dom.selection(this)};CKEDITOR.dom.range.prototype.select=function(){var a=this.root instanceof CKEDITOR.editable?this.root.editor.getSelection():new CKEDITOR.dom.selection(this.root);a.selectRanges([this]);return a};CKEDITOR.SELECTION_NONE=1;CKEDITOR.SELECTION_TEXT=2;CKEDITOR.SELECTION_ELEMENT=3;var t=typeof window.getSelection!="function",s=1;CKEDITOR.dom.selection=function(a){if(a instanceof CKEDITOR.dom.selection)var b=a,a=a.root;var c=a instanceof CKEDITOR.dom.element;this.rev=b?b.rev:s++;this.document=a instanceof CKEDITOR.dom.document?a:a.getDocument();this.root=c?a:this.document.getBody();this.isLocked=0;this._={cache:{}};if(b){CKEDITOR.tools.extend(this._.cache,b._.cache);this.isFake=b.isFake;this.isLocked=b.isLocked;return this}var a=this.getNative(),d,f;if(a)if(a.getRangeAt)d=(f=a.rangeCount&&a.getRangeAt(0))&&new CKEDITOR.dom.node(f.commonAncestorContainer);else{try{f=a.createRange()}catch(g){}d=f&&CKEDITOR.dom.element.get(f.item&&f.item(0)||f.parentElement())}if(!d||!(d.type==CKEDITOR.NODE_ELEMENT||d.type==CKEDITOR.NODE_TEXT)||!this.root.equals(d)&&!this.root.contains(d)){this._.cache.type=CKEDITOR.SELECTION_NONE;this._.cache.startElement=null;this._.cache.selectedElement=null;this._.cache.selectedText="";this._.cache.ranges=new CKEDITOR.dom.rangeList}return this};var u={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1};CKEDITOR.dom.selection.prototype={getNative:function(){return this._.cache.nativeSel!==void 0?this._.cache.nativeSel:this._.cache.nativeSel=t?this.document.$.selection:this.document.getWindow().$.getSelection()},getType:t?function(){var a=this._.cache;if(a.type)return a.type;var b=CKEDITOR.SELECTION_NONE;try{var c=this.getNative(),d=c.type;if(d=="Text")b=CKEDITOR.SELECTION_TEXT;if(d=="Control")b=CKEDITOR.SELECTION_ELEMENT;if(c.createRange().parentElement())b=CKEDITOR.SELECTION_TEXT}catch(f){}return a.type=b}:function(){var a=this._.cache;if(a.type)return a.type;var b=CKEDITOR.SELECTION_TEXT,c=this.getNative();if(!c||!c.rangeCount)b=CKEDITOR.SELECTION_NONE;else if(c.rangeCount==1){var c=c.getRangeAt(0),d=c.startContainer;if(d==c.endContainer&&d.nodeType==1&&c.endOffset-c.startOffset==1&&u[d.childNodes[c.startOffset].nodeName.toLowerCase()])b=CKEDITOR.SELECTION_ELEMENT}return a.type=b},getRanges:function(){var a=t?function(){function a(b){return(new CKEDITOR.dom.node(b)).getIndex()}var b=function(b,c){b=b.duplicate();b.collapse(c);var d=b.parentElement();if(!d.hasChildNodes())return{container:d,offset:0};for(var f=d.children,g,e,h=b.duplicate(),j=0,i=f.length-1,k=-1,m,p;j<=i;){k=Math.floor((j+i)/2);g=f[k];h.moveToElementText(g);m=h.compareEndPoints("StartToStart",b);if(m>0)i=k-1;else if(m<0)j=k+1;else return{container:d,offset:a(g)}}if(k==-1||k==f.length-1&&m<0){h.moveToElementText(d);h.setEndPoint("StartToStart",b);h=h.text.replace(/(\r\n|\r)/g,"\n").length;f=d.childNodes;if(!h){g=f[f.length-1];return g.nodeType!=CKEDITOR.NODE_TEXT?{container:d,offset:f.length}:{container:g,offset:g.nodeValue.length}}for(d=f.length;h>0&&d>0;){e=f[--d];if(e.nodeType==CKEDITOR.NODE_TEXT){p=e;h=h-e.nodeValue.length}}return{container:p,offset:-h}}h.collapse(m>0?true:false);h.setEndPoint(m>0?"StartToStart":"EndToStart",b);h=h.text.replace(/(\r\n|\r)/g,"\n").length;if(!h)return{container:d,offset:a(g)+(m>0?0:1)};for(;h>0;)try{e=g[m>0?"previousSibling":"nextSibling"];if(e.nodeType==CKEDITOR.NODE_TEXT){h=h-e.nodeValue.length;p=e}g=e}catch(t){return{container:d,offset:a(g)}}return{container:p,offset:m>0?-h:p.nodeValue.length+h}};return function(){var a=this.getNative(),c=a&&a.createRange(),d=this.getType();if(!a)return[];if(d==CKEDITOR.SELECTION_TEXT){a=new CKEDITOR.dom.range(this.root);d=b(c,true);a.setStart(new CKEDITOR.dom.node(d.container),d.offset);d=b(c);a.setEnd(new CKEDITOR.dom.node(d.container),d.offset);a.endContainer.getPosition(a.startContainer)&CKEDITOR.POSITION_PRECEDING&&a.endOffset<=a.startContainer.getIndex()&&a.collapse();return[a]}if(d==CKEDITOR.SELECTION_ELEMENT){for(var d=[],f=0;f<c.length;f++){for(var g=c.item(f),e=g.parentNode,h=0,a=new CKEDITOR.dom.range(this.root);h<e.childNodes.length&&e.childNodes[h]!=g;h++);a.setStart(new CKEDITOR.dom.node(e),h);a.setEnd(new CKEDITOR.dom.node(e),h+1);d.push(a)}return d}return[]}}():function(){var a=[],b,c=this.getNative();if(!c)return a;for(var d=0;d<c.rangeCount;d++){var f=c.getRangeAt(d);b=new CKEDITOR.dom.range(this.root);b.setStart(new CKEDITOR.dom.node(f.startContainer),f.startOffset);b.setEnd(new CKEDITOR.dom.node(f.endContainer),f.endOffset);a.push(b)}return a};return function(b){var c=this._.cache,d=c.ranges;if(!d)c.ranges=d=new CKEDITOR.dom.rangeList(a.call(this));return!b?d:o(new CKEDITOR.dom.rangeList(d.slice()))}}(),getStartElement:function(){var a=this._.cache;if(a.startElement!==void 0)return a.startElement;var b;switch(this.getType()){case CKEDITOR.SELECTION_ELEMENT:return this.getSelectedElement();case CKEDITOR.SELECTION_TEXT:var c=this.getRanges()[0];if(c){if(c.collapsed){b=c.startContainer;b.type!=CKEDITOR.NODE_ELEMENT&&(b=b.getParent())}else{for(c.optimize();;){b=c.startContainer;if(c.startOffset==(b.getChildCount?b.getChildCount():b.getLength())&&!b.isBlockBoundary())c.setStartAfter(b);else break}b=c.startContainer;if(b.type!=CKEDITOR.NODE_ELEMENT)return b.getParent();b=b.getChild(c.startOffset);if(!b||b.type!=CKEDITOR.NODE_ELEMENT)b=c.startContainer;else for(c=b.getFirst();c&&c.type==CKEDITOR.NODE_ELEMENT;){b=c;c=c.getFirst()}}b=b.$}}return a.startElement=b?new CKEDITOR.dom.element(b):null},getSelectedElement:function(){var a=this._.cache;if(a.selectedElement!==void 0)return a.selectedElement;var b=this,c=CKEDITOR.tools.tryThese(function(){return b.getNative().createRange().item(0)},function(){for(var a=b.getRanges()[0].clone(),c,d,f=2;f&&(!(c=a.getEnclosedNode())||!(c.type==CKEDITOR.NODE_ELEMENT&&u[c.getName()]&&(d=c)));f--)a.shrink(CKEDITOR.SHRINK_ELEMENT);return d&&d.$});return a.selectedElement=c?new CKEDITOR.dom.element(c):null},getSelectedText:function(){var a=this._.cache;if(a.selectedText!==void 0)return a.selectedText;var b=this.getNative(),b=t?b.type=="Control"?"":b.createRange().text:b.toString();return a.selectedText=b},lock:function(){this.getRanges();this.getStartElement();this.getSelectedElement();this.getSelectedText();this._.cache.nativeSel=null;this.isLocked=1},unlock:function(a){if(this.isLocked){if(a)var b=this.getSelectedElement(),c=!b&&this.getRanges(),d=this.isFake;this.isLocked=0;this.reset();if(a)(a=b||c[0]&&c[0].getCommonAncestor())&&a.getAscendant("body",1)&&(d?this.fake(b):b?this.selectElement(b):this.selectRanges(c))}},reset:function(){this._.cache={};this.isFake=0;var a=this.root.editor;if(a&&a._.fakeSelection&&this.rev==a._.fakeSelection.rev){delete a._.fakeSelection;var b=a._.hiddenSelectionContainer;if(b){var c=a.checkDirty();a.fire("lockSnapshot");b.remove();a.fire("unlockSnapshot");!c&&a.resetDirty()}delete a._.hiddenSelectionContainer}this.rev=s++},selectElement:function(a){var b=new CKEDITOR.dom.range(this.root);b.setStartBefore(a);b.setEndAfter(a);this.selectRanges([b])},selectRanges:function(a){var b=this.root.editor,b=b&&b._.hiddenSelectionContainer;this.reset();if(b)for(var b=this.root,d,f=0;f<a.length;++f){d=a[f];if(d.endContainer.equals(b))d.endOffset=Math.min(d.endOffset,b.getChildCount())}if(a.length)if(this.isLocked){var g=CKEDITOR.document.getActive();this.unlock();this.selectRanges(a);this.lock();g&&!g.equals(this.root)&&g.focus()}else{var e;a:{var h,i;if(a.length==1&&!(i=a[0]).collapsed&&(e=i.getEnclosedNode())&&e.type==CKEDITOR.NODE_ELEMENT){i=i.clone();i.shrink(CKEDITOR.SHRINK_ELEMENT,true);if((h=i.getEnclosedNode())&&h.type==CKEDITOR.NODE_ELEMENT)e=h;if(e.getAttribute("contenteditable")=="false")break a}e=void 0}if(e)this.fake(e);else{if(t){i=CKEDITOR.dom.walker.whitespaces(true);h=/\ufeff|\u00a0/;b={table:1,tbody:1,tr:1};if(a.length>1){e=a[a.length-1];a[0].setEnd(e.endContainer,e.endOffset)}e=a[0];var a=e.collapsed,k,m,p;if((d=e.getEnclosedNode())&&d.type==CKEDITOR.NODE_ELEMENT&&d.getName()in u&&(!d.is("a")||!d.getText()))try{p=d.$.createControlRange();p.addElement(d.$);p.select();return}catch(C){}if(e.startContainer.type==CKEDITOR.NODE_ELEMENT&&e.startContainer.getName()in b||e.endContainer.type==CKEDITOR.NODE_ELEMENT&&e.endContainer.getName()in b){e.shrink(CKEDITOR.NODE_ELEMENT,true);a=e.collapsed}p=e.createBookmark();b=p.startNode;if(!a)g=p.endNode;p=e.document.$.body.createTextRange();p.moveToElementText(b.$);p.moveStart("character",1);if(g){h=e.document.$.body.createTextRange();h.moveToElementText(g.$);p.setEndPoint("EndToEnd",h);p.moveEnd("character",-1)}else{k=b.getNext(i);m=b.hasAscendant("pre");k=!(k&&k.getText&&k.getText().match(h))&&(m||!b.hasPrevious()||b.getPrevious().is&&b.getPrevious().is("br"));m=e.document.createElement("span");m.setHtml("&#65279;");m.insertBefore(b);k&&e.document.createText("﻿").insertBefore(b)}e.setStartBefore(b);b.remove();if(a){if(k){p.moveStart("character",-1);p.select();e.document.$.selection.clear()}else p.select();e.moveToPosition(m,CKEDITOR.POSITION_BEFORE_START);m.remove()}else{e.setEndBefore(g);g.remove();p.select()}}else{g=this.getNative();if(!g)return;this.removeAllRanges();for(p=0;p<a.length;p++){if(p<a.length-1){k=a[p];m=a[p+1];h=k.clone();h.setStart(k.endContainer,k.endOffset);h.setEnd(m.startContainer,m.startOffset);if(!h.collapsed){h.shrink(CKEDITOR.NODE_ELEMENT,true);e=h.getCommonAncestor();h=h.getEnclosedNode();if(e.isReadOnly()||h&&h.isReadOnly()){m.setStart(k.startContainer,k.startOffset);a.splice(p--,1);continue}}}e=a[p];m=this.document.$.createRange();if(e.collapsed&&CKEDITOR.env.webkit&&c(e)){k=this.root;j(k,false);h=k.getDocument().createText(" ​ ");k.setCustomData("cke-fillingChar",h);e.insertNode(h);if((k=h.getNext())&&!h.getPrevious()&&k.type==CKEDITOR.NODE_ELEMENT&&k.getName()=="br"){j(this.root);e.moveToPosition(k,CKEDITOR.POSITION_BEFORE_START)}else e.moveToPosition(h,CKEDITOR.POSITION_AFTER_END)}m.setStart(e.startContainer.$,e.startOffset);try{m.setEnd(e.endContainer.$,e.endOffset)}catch(n){if(n.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")>=0){e.collapse(1);m.setEnd(e.endContainer.$,e.endOffset)}else throw n;}g.addRange(m)}}this.reset();this.root.fire("selectionchange")}}},fake:function(a){var b=this.root.editor;this.reset();k(b);var c=this._.cache,d=new CKEDITOR.dom.range(this.root);d.setStartBefore(a);d.setEndAfter(a);c.ranges=new CKEDITOR.dom.rangeList(d);c.selectedElement=c.startElement=a;c.type=CKEDITOR.SELECTION_ELEMENT;c.selectedText=c.nativeSel=null;this.isFake=1;this.rev=s++;b._.fakeSelection=this;this.root.fire("selectionchange")},isHidden:function(){var a=this.getCommonAncestor();a&&a.type==CKEDITOR.NODE_TEXT&&(a=a.getParent());return!(!a||!a.data("cke-hidden-sel"))},createBookmarks:function(a){a=this.getRanges().createBookmarks(a);this.isFake&&(a.isFake=1);return a},createBookmarks2:function(a){a=this.getRanges().createBookmarks2(a);this.isFake&&(a.isFake=1);return a},selectBookmarks:function(a){for(var b=[],c=0;c<a.length;c++){var d=new CKEDITOR.dom.range(this.root);d.moveToBookmark(a[c]);b.push(d)}a.isFake?this.fake(b[0].getEnclosedNode()):this.selectRanges(b);return this},getCommonAncestor:function(){var a=this.getRanges();return!a.length?null:a[0].startContainer.getCommonAncestor(a[a.length-1].endContainer)},scrollIntoView:function(){this.type!=CKEDITOR.SELECTION_NONE&&this.getRanges()[0].scrollIntoView()},removeAllRanges:function(){if(this.getType()!=CKEDITOR.SELECTION_NONE){var a=this.getNative();try{a&&a[t?"empty":"removeAllRanges"]()}catch(b){}this.reset()}}}}(),"use strict",CKEDITOR.STYLE_BLOCK=1,CKEDITOR.STYLE_INLINE=2,CKEDITOR.STYLE_OBJECT=3,function(){function a(a,b){for(var c,d;a=a.getParent();){if(a.equals(b))break;if(a.getAttribute("data-nostyle"))c=a;else if(!d){var f=a.getAttribute("contentEditable");f=="false"?c=a:f=="true"&&(d=1)}}return c}function e(b){var c=b.document;if(b.collapsed){c=p(this,c);b.insertNode(c);b.moveToPosition(c,CKEDITOR.POSITION_BEFORE_END)}else{var d=this.element,f=this._.definition,h,i=f.ignoreReadonly,j=i||f.includeReadonly;j==null&&(j=b.root.getCustomData("cke_includeReadonly"));var k=CKEDITOR.dtd[d];if(!k){h=true;k=CKEDITOR.dtd.span}b.enlarge(CKEDITOR.ENLARGE_INLINE,1);b.trim();var m=b.createBookmark(),t=m.startNode,n=m.endNode,s=t,l;if(!i){var o=b.getCommonAncestor(),i=a(t,o),o=a(n,o);i&&(s=i.getNextSourceNode(true));o&&(n=o)}for(s.getPosition(n)==CKEDITOR.POSITION_FOLLOWING&&(s=0);s;){i=false;if(s.equals(n)){s=null;i=true}else{var u=s.type==CKEDITOR.NODE_ELEMENT?s.getName():null,o=u&&s.getAttribute("contentEditable")=="false",w=u&&s.getAttribute("data-nostyle");if(u&&s.data("cke-bookmark")){s=s.getNextSourceNode(true);continue}if(o&&j&&CKEDITOR.dtd.$block[u])for(var x=s,r=g(x),v=void 0,z=r.length,y=0,x=z&&new CKEDITOR.dom.range(x.getDocument());y<z;++y){var v=r[y],A=CKEDITOR.filter.instances[v.data("cke-filter")];if(A?A.check(this):1){x.selectNodeContents(v);e.call(this,x)}}r=u?!k[u]||w?0:o&&!j?0:(s.getPosition(n)|G)==G&&(!f.childRule||f.childRule(s)):1;if(r)if((r=s.getParent())&&((r.getDtd()||CKEDITOR.dtd.span)[d]||h)&&(!f.parentRule||f.parentRule(r))){if(!l&&(!u||!CKEDITOR.dtd.$removeEmpty[u]||(s.getPosition(n)|G)==G)){l=b.clone();l.setStartBefore(s)}u=s.type;if(u==CKEDITOR.NODE_TEXT||o||u==CKEDITOR.NODE_ELEMENT&&!s.getChildCount()){for(var u=s,aa;(i=!u.getNext(B))&&(aa=u.getParent(),k[aa.getName()])&&(aa.getPosition(t)|D)==D&&(!f.childRule||f.childRule(aa));)u=aa;l.setEndAfter(u)}}else i=true;else i=true;s=s.getNextSourceNode(w||o)}if(i&&l&&!l.collapsed){for(var i=p(this,c),o=i.hasAttributes(),w=l.getCommonAncestor(),u={},r={},v={},z={},U,$,ca;i&&w;){if(w.getName()==d){for(U in f.attributes)if(!z[U]&&(ca=w.getAttribute($)))i.getAttribute(U)==ca?r[U]=1:z[U]=1;for($ in f.styles)if(!v[$]&&(ca=w.getStyle($)))i.getStyle($)==ca?u[$]=1:v[$]=1}w=w.getParent()}for(U in r)i.removeAttribute(U);for($ in u)i.removeStyle($);o&&!i.hasAttributes()&&(i=null);if(i){l.extractContents().appendTo(i);l.insertNode(i);q.call(this,i);i.mergeSiblings();CKEDITOR.env.ie||i.$.normalize()}else{i=new CKEDITOR.dom.element("span");l.extractContents().appendTo(i);l.insertNode(i);q.call(this,i);i.remove(true)}l=null}}b.moveToBookmark(m);b.shrink(CKEDITOR.SHRINK_TEXT);b.shrink(CKEDITOR.NODE_ELEMENT,true)}}function b(a){function b(){for(var a=new CKEDITOR.dom.elementPath(d.getParent()),c=new CKEDITOR.dom.elementPath(j.getParent()),f=null,g=null,e=0;e<a.elements.length;e++){var h=a.elements[e];if(h==a.block||h==a.blockLimit)break;k.checkElementRemovable(h,true)&&(f=h)}for(e=0;e<c.elements.length;e++){h=c.elements[e];if(h==c.block||h==c.blockLimit)break;k.checkElementRemovable(h,true)&&(g=h)}g&&j.breakParent(g);f&&d.breakParent(f)}a.enlarge(CKEDITOR.ENLARGE_INLINE,1);var c=a.createBookmark(),d=c.startNode;if(a.collapsed){for(var f=new CKEDITOR.dom.elementPath(d.getParent(),a.root),g,e=0,h;e<f.elements.length&&(h=f.elements[e]);e++){if(h==f.block||h==f.blockLimit)break;if(this.checkElementRemovable(h)){var i;if(a.collapsed&&(a.checkBoundaryOfElement(h,CKEDITOR.END)||(i=a.checkBoundaryOfElement(h,CKEDITOR.START)))){g=h;g.match=i?"start":"end"}else{h.mergeSiblings();h.is(this.element)?o.call(this,h):m(h,u(this)[h.getName()])}}}if(g){h=d;for(e=0;;e++){i=f.elements[e];if(i.equals(g))break;else if(i.match)continue;else i=i.clone();i.append(h);h=i}h[g.match=="start"?"insertBefore":"insertAfter"](g)}}else{var j=c.endNode,k=this;b();for(f=d;!f.equals(j);){g=f.getNextSourceNode();if(f.type==CKEDITOR.NODE_ELEMENT&&this.checkElementRemovable(f)){f.getName()==this.element?o.call(this,f):m(f,u(this)[f.getName()]);if(g.type==CKEDITOR.NODE_ELEMENT&&g.contains(d)){b();g=d.getNext()}}f=g}}a.moveToBookmark(c);a.shrink(CKEDITOR.NODE_ELEMENT,true)}function g(a){var b=[];a.forEach(function(a){if(a.getAttribute("contenteditable")=="true"){b.push(a);return false}},CKEDITOR.NODE_ELEMENT,true);return b}function c(a){var b=a.getEnclosedNode()||a.getCommonAncestor(false,true);(a=(new CKEDITOR.dom.elementPath(b,a.root)).contains(this.element,1))&&!a.isReadOnly()&&t(a,this)}function d(a){var b=a.getCommonAncestor(true,true);if(a=(new CKEDITOR.dom.elementPath(b,a.root)).contains(this.element,1)){var b=this._.definition,c=b.attributes;if(c)for(var d in c)a.removeAttribute(d,c[d]);if(b.styles)for(var f in b.styles)b.styles.hasOwnProperty(f)&&a.removeStyle(f)}}function j(a){var b=a.createBookmark(true),c=a.createIterator();c.enforceRealBlocks=true;if(this._.enterMode)c.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR;for(var d,f=a.document,g;d=c.getNextParagraph();)if(!d.isReadOnly()&&(c.activeFilter?c.activeFilter.check(this):1)){g=p(this,f,d);h(d,g)}a.moveToBookmark(b)}function f(a){var b=a.createBookmark(1),c=a.createIterator();c.enforceRealBlocks=true;c.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR;for(var d,f;d=c.getNextParagraph();)if(this.checkElementRemovable(d))if(d.is("pre")){(f=this._.enterMode==CKEDITOR.ENTER_BR?null:a.document.createElement(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))&&d.copyAttributes(f);h(d,f)}else o.call(this,d);a.moveToBookmark(b)}function h(a,b){var c=!b;if(c){b=a.getDocument().createElement("div");a.copyAttributes(b)}var d=b&&b.is("pre"),f=a.is("pre"),g=!d&&f;if(d&&!f){f=b;(g=a.getBogus())&&g.remove();g=a.getHtml();g=k(g,/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"");g=g.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1");g=g.replace(/([ \t\n\r]+|&nbsp;)/g," ");g=g.replace(/<br\b[^>]*>/gi,"\n");if(CKEDITOR.env.ie){var e=a.getDocument().createElement("div");e.append(f);f.$.outerHTML="<pre>"+g+"</pre>";f.copyAttributes(e.getFirst());f=e.getFirst().remove()}else f.setHtml(g);b=f}else g?b=n(c?[a.getHtml()]:i(a),b):a.moveChildren(b);b.replace(a);if(d){var c=b,h;if((h=c.getPrevious(A))&&h.type==CKEDITOR.NODE_ELEMENT&&h.is("pre")){d=k(h.getHtml(),/\n$/,"")+"\n\n"+k(c.getHtml(),/^\n/,"");CKEDITOR.env.ie?c.$.outerHTML="<pre>"+d+"</pre>":c.setHtml(d);h.remove()}}else c&&l(b)}function i(a){var b=[];k(a.getOuterHtml(),/(\S\s*)\n(?:\s|(<span[^>]+data-cke-bookmark.*?\/span>))*\n(?!$)/gi,function(a,b,c){return b+"</pre>"+c+"<pre>"}).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(a,c){b.push(c)});return b}function k(a,b,c){var d="",f="",a=a.replace(/(^<span[^>]+data-cke-bookmark.*?\/span>)|(<span[^>]+data-cke-bookmark.*?\/span>$)/gi,function(a,b,c){b&&(d=b);c&&(f=c);return""});return d+a.replace(b,c)+f}function n(a,b){var c;a.length>1&&(c=new CKEDITOR.dom.documentFragment(b.getDocument()));for(var d=0;d<a.length;d++){var f=a[d],f=f.replace(/(\r\n|\r)/g,"\n"),f=k(f,/^[ \t]*\n/,""),f=k(f,/\n$/,""),f=k(f,/^[ \t]+|[ \t]+$/g,function(a,b){return a.length==1?"&nbsp;":b?" "+CKEDITOR.tools.repeat("&nbsp;",a.length-1):CKEDITOR.tools.repeat("&nbsp;",a.length-1)+" "}),f=f.replace(/\n/g,"<br>"),f=f.replace(/[ \t]{2,}/g,function(a){return CKEDITOR.tools.repeat("&nbsp;",a.length-1)+" "});if(c){var g=b.clone();g.setHtml(f);c.append(g)}else b.setHtml(f)}return c||b}function o(a,b){var c=this._.definition,d=c.attributes,c=c.styles,f=u(this)[a.getName()],g=CKEDITOR.tools.isEmpty(d)&&CKEDITOR.tools.isEmpty(c),e;for(e in d)if(!((e=="class"||this._.definition.fullMatch)&&a.getAttribute(e)!=w(e,d[e]))&&!(b&&e.slice(0,5)=="data-")){g=a.hasAttribute(e);a.removeAttribute(e)}for(var h in c)if(!(this._.definition.fullMatch&&a.getStyle(h)!=w(h,c[h],true))){g=g||!!a.getStyle(h);a.removeStyle(h)}m(a,f,v[a.getName()]);g&&(this._.definition.alwaysRemoveElement?l(a,1):!CKEDITOR.dtd.$block[a.getName()]||this._.enterMode==CKEDITOR.ENTER_BR&&!a.hasAttributes()?l(a):a.renameNode(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))}function q(a){for(var b=u(this),c=a.getElementsByTag(this.element),d,f=c.count();--f>=0;){d=c.getItem(f);d.isReadOnly()||o.call(this,d,true)}for(var g in b)if(g!=this.element){c=a.getElementsByTag(g);for(f=c.count()-1;f>=0;f--){d=c.getItem(f);d.isReadOnly()||m(d,b[g])}}}function m(a,b,c){if(b=b&&b.attributes)for(var d=0;d<b.length;d++){var f=b[d][0],g;if(g=a.getAttribute(f)){var e=b[d][1];(e===null||e.test&&e.test(g)||typeof e=="string"&&g==e)&&a.removeAttribute(f)}}c||l(a)}function l(a,b){if(!a.hasAttributes()||b)if(CKEDITOR.dtd.$block[a.getName()]){var c=a.getPrevious(A),d=a.getNext(A);c&&(c.type==CKEDITOR.NODE_TEXT||!c.isBlockBoundary({br:1}))&&a.append("br",1);d&&(d.type==CKEDITOR.NODE_TEXT||!d.isBlockBoundary({br:1}))&&a.append("br");a.remove(true)}else{c=a.getFirst();d=a.getLast();a.remove(true);if(c){c.type==CKEDITOR.NODE_ELEMENT&&c.mergeSiblings();d&&(!c.equals(d)&&d.type==CKEDITOR.NODE_ELEMENT)&&d.mergeSiblings()}}}function p(a,b,c){var d;d=a.element;d=="*"&&(d="span");d=new CKEDITOR.dom.element(d,b);c&&c.copyAttributes(d);d=t(d,a);b.getCustomData("doc_processing_style")&&d.hasAttribute("id")?d.removeAttribute("id"):b.setCustomData("doc_processing_style",1);return d}function t(a,b){var c=b._.definition,d=c.attributes,c=CKEDITOR.style.getStyleText(c);if(d)for(var f in d)a.setAttribute(f,d[f]);c&&a.setAttribute("style",c);return a}function s(a,b){for(var c in a)a[c]=a[c].replace(z,function(a,c){return b[c]})}function u(a){if(a._.overrides)return a._.overrides;var b=a._.overrides={},c=a._.definition.overrides;if(c){CKEDITOR.tools.isArray(c)||(c=[c]);for(var d=0;d<c.length;d++){var f=c[d],g,e;if(typeof f=="string")g=f.toLowerCase();else{g=f.element?f.element.toLowerCase():a.element;e=f.attributes}f=b[g]||(b[g]={});if(e){var f=f.attributes=f.attributes||[],h;for(h in e)f.push([h.toLowerCase(),e[h]])}}}return b}function w(a,b,c){var d=new CKEDITOR.dom.element("span");d[c?"setStyle":"setAttribute"](a,b);return d[c?"getStyle":"getAttribute"](a)}function x(a,b,c){for(var d=a.document,f=a.getRanges(),b=b?this.removeFromRange:this.applyToRange,g,e=f.createIterator();g=e.getNextRange();)b.call(this,g,c);a.selectRanges(f);d.removeCustomData("doc_processing_style")}var v={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,section:1,header:1,footer:1,nav:1,article:1,aside:1,figure:1,dialog:1,hgroup:1,time:1,meter:1,menu:1,command:1,keygen:1,output:1,progress:1,details:1,datagrid:1,datalist:1},r={a:1,blockquote:1,embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1,audio:1,video:1},y=/\s*(?:;\s*|$)/,z=/#\((.+?)\)/g,B=CKEDITOR.dom.walker.bookmark(0,1),A=CKEDITOR.dom.walker.whitespaces(1);CKEDITOR.style=function(a,b){if(typeof a.type=="string")return new CKEDITOR.style.customHandlers[a.type](a);var c=a.attributes;if(c&&c.style){a.styles=CKEDITOR.tools.extend({},a.styles,CKEDITOR.tools.parseCssText(c.style));delete c.style}if(b){a=CKEDITOR.tools.clone(a);s(a.attributes,b);s(a.styles,b)}c=this.element=a.element?typeof a.element=="string"?a.element.toLowerCase():a.element:"*";this.type=a.type||(v[c]?CKEDITOR.STYLE_BLOCK:r[c]?CKEDITOR.STYLE_OBJECT:CKEDITOR.STYLE_INLINE);if(typeof this.element=="object")this.type=CKEDITOR.STYLE_OBJECT;this._={definition:a}};CKEDITOR.style.prototype={apply:function(a){if(a instanceof CKEDITOR.dom.document)return x.call(this,a.getSelection());if(this.checkApplicable(a.elementPath(),a)){var b=this._.enterMode;if(!b)this._.enterMode=a.activeEnterMode;x.call(this,a.getSelection(),0,a);this._.enterMode=b}},remove:function(a){if(a instanceof CKEDITOR.dom.document)return x.call(this,a.getSelection(),1);if(this.checkApplicable(a.elementPath(),a)){var b=this._.enterMode;if(!b)this._.enterMode=a.activeEnterMode;x.call(this,a.getSelection(),1,a);this._.enterMode=b}},applyToRange:function(a){this.applyToRange=this.type==CKEDITOR.STYLE_INLINE?e:this.type==CKEDITOR.STYLE_BLOCK?j:this.type==CKEDITOR.STYLE_OBJECT?c:null;return this.applyToRange(a)},removeFromRange:function(a){this.removeFromRange=this.type==CKEDITOR.STYLE_INLINE?b:this.type==CKEDITOR.STYLE_BLOCK?f:this.type==CKEDITOR.STYLE_OBJECT?d:null;return this.removeFromRange(a)},applyToObject:function(a){t(a,this)},checkActive:function(a,b){switch(this.type){case CKEDITOR.STYLE_BLOCK:return this.checkElementRemovable(a.block||a.blockLimit,true,b);case CKEDITOR.STYLE_OBJECT:case CKEDITOR.STYLE_INLINE:for(var c=a.elements,d=0,f;d<c.length;d++){f=c[d];if(!(this.type==CKEDITOR.STYLE_INLINE&&(f==a.block||f==a.blockLimit))){if(this.type==CKEDITOR.STYLE_OBJECT){var g=f.getName();if(!(typeof this.element=="string"?g==this.element:g in this.element))continue}if(this.checkElementRemovable(f,true,b))return true}}}return false},checkApplicable:function(a,b,c){b&&b instanceof CKEDITOR.filter&&(c=b);if(c&&!c.check(this))return false;switch(this.type){case CKEDITOR.STYLE_OBJECT:return!!a.contains(this.element);case CKEDITOR.STYLE_BLOCK:return!!a.blockLimit.getDtd()[this.element]}return true},checkElementMatch:function(a,b){var c=this._.definition;if(!a||!c.ignoreReadonly&&a.isReadOnly())return false;var d=a.getName();if(typeof this.element=="string"?d==this.element:d in this.element){if(!b&&!a.hasAttributes())return true;if(d=c._AC)c=d;else{var d={},f=0,g=c.attributes;if(g)for(var e in g){f++;d[e]=g[e]}if(e=CKEDITOR.style.getStyleText(c)){d.style||f++;d.style=e}d._length=f;c=c._AC=d}if(c._length){for(var h in c)if(h!="_length"){f=a.getAttribute(h)||"";if(h=="style")a:{d=c[h];typeof d=="string"&&(d=CKEDITOR.tools.parseCssText(d));typeof f=="string"&&(f=CKEDITOR.tools.parseCssText(f,true));e=void 0;for(e in d)if(!(e in f&&(f[e]==d[e]||d[e]=="inherit"||f[e]=="inherit"))){d=false;break a}d=true}else d=c[h]==f;if(d){if(!b)return true}else if(b)return false}if(b)return true}else return true}return false},checkElementRemovable:function(a,b,c){if(this.checkElementMatch(a,b,c))return true;if(b=u(this)[a.getName()]){var d;if(!(b=b.attributes))return true;for(c=0;c<b.length;c++){d=b[c][0];if(d=a.getAttribute(d)){var f=b[c][1];if(f===null)return true;if(typeof f=="string"){if(d==f)return true}else if(f.test(d))return true}}}return false},buildPreview:function(a){var b=this._.definition,c=[],d=b.element;d=="bdo"&&(d="span");var c=["<",d],f=b.attributes;if(f)for(var g in f)c.push(" ",g,'="',f[g],'"');(f=CKEDITOR.style.getStyleText(b))&&c.push(' style="',f,'"');c.push(">",a||b.name,"</",d,">");return c.join("")},getDefinition:function(){return this._.definition}};CKEDITOR.style.getStyleText=function(a){var b=a._ST;if(b)return b;var b=a.styles,c=a.attributes&&a.attributes.style||"",d="";c.length&&(c=c.replace(y,";"));for(var f in b){var g=b[f],e=(f+":"+g).replace(y,";");g=="inherit"?d=d+e:c=c+e}c.length&&(c=CKEDITOR.tools.normalizeCssText(c,true));return a._ST=c+d};CKEDITOR.style.customHandlers={};CKEDITOR.style.addCustomHandler=function(a){var b=function(a){this._={definition:a};this.setup&&this.setup(a)};b.prototype=CKEDITOR.tools.extend(CKEDITOR.tools.prototypedCopy(CKEDITOR.style.prototype),{assignedTo:CKEDITOR.STYLE_OBJECT},a,true);return this.customHandlers[a.type]=b};var G=CKEDITOR.POSITION_PRECEDING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED,D=CKEDITOR.POSITION_FOLLOWING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED}(),CKEDITOR.styleCommand=function(a,e){this.requiredContent=this.allowedContent=this.style=a;CKEDITOR.tools.extend(this,e,true)},CKEDITOR.styleCommand.prototype.exec=function(a){a.focus();this.state==CKEDITOR.TRISTATE_OFF?a.applyStyle(this.style):this.state==CKEDITOR.TRISTATE_ON&&a.removeStyle(this.style)},CKEDITOR.stylesSet=new CKEDITOR.resourceManager("","stylesSet"),CKEDITOR.addStylesSet=CKEDITOR.tools.bind(CKEDITOR.stylesSet.add,CKEDITOR.stylesSet),CKEDITOR.loadStylesSet=function(a,e,b){CKEDITOR.stylesSet.addExternal(a,e,"");CKEDITOR.stylesSet.load(a,b)},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{attachStyleStateChange:function(a,e){var b=this._.styleStateChangeCallbacks;if(!b){b=this._.styleStateChangeCallbacks=[];this.on("selectionChange",function(a){for(var c=0;c<b.length;c++){var d=b[c],e=d.style.checkActive(a.data.path,this)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF;d.fn.call(this,e)}})}b.push({style:a,fn:e})},applyStyle:function(a){a.apply(this)},removeStyle:function(a){a.remove(this)},getStylesSet:function(a){if(this._.stylesDefinitions)a(this._.stylesDefinitions);else{var e=this,b=e.config.stylesCombo_stylesSet||e.config.stylesSet;if(b===false)a(null);else if(b instanceof Array){e._.stylesDefinitions=b;a(b)}else{b||(b="default");var b=b.split(":"),g=b[0];CKEDITOR.stylesSet.addExternal(g,b[1]?b.slice(1).join(":"):CKEDITOR.getUrl("styles.js"),"");CKEDITOR.stylesSet.load(g,function(b){e._.stylesDefinitions=b[g];a(e._.stylesDefinitions)})}}}}),CKEDITOR.dom.comment=function(a,e){typeof a=="string"&&(a=(e?e.$:document).createComment(a));CKEDITOR.dom.domObject.call(this,a)},CKEDITOR.dom.comment.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.comment.prototype,{type:CKEDITOR.NODE_COMMENT,getOuterHtml:function(){return"<\!--"+this.$.nodeValue+"--\>"}}),"use strict",function(){var a={},e={},b;for(b in CKEDITOR.dtd.$blockLimit)b in CKEDITOR.dtd.$list||(a[b]=1);for(b in CKEDITOR.dtd.$block)b in CKEDITOR.dtd.$blockLimit||b in CKEDITOR.dtd.$empty||(e[b]=1);CKEDITOR.dom.elementPath=function(b,c){var d=null,j=null,f=[],h=b,i,c=c||b.getDocument().getBody();do if(h.type==CKEDITOR.NODE_ELEMENT){f.push(h);if(!this.lastElement){this.lastElement=h;if(h.is(CKEDITOR.dtd.$object)||h.getAttribute("contenteditable")=="false")continue}if(h.equals(c))break;if(!j){i=h.getName();h.getAttribute("contenteditable")=="true"?j=h:!d&&e[i]&&(d=h);if(a[i]){var k;if(k=!d){if(i=i=="div"){a:{i=h.getChildren();k=0;for(var n=i.count();k<n;k++){var o=i.getItem(k);if(o.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$block[o.getName()]){i=true;break a}}i=false}i=!i}k=i}k?d=h:j=h}}}while(h=h.getParent());j||(j=c);this.block=d;this.blockLimit=j;this.root=c;this.elements=f}}(),CKEDITOR.dom.elementPath.prototype={compare:function(a){var e=this.elements,a=a&&a.elements;if(!a||e.length!=a.length)return false;for(var b=0;b<e.length;b++)if(!e[b].equals(a[b]))return false;return true},contains:function(a,e,b){var g;typeof a=="string"&&(g=function(b){return b.getName()==a});a instanceof CKEDITOR.dom.element?g=function(b){return b.equals(a)}:CKEDITOR.tools.isArray(a)?g=function(b){return CKEDITOR.tools.indexOf(a,b.getName())>-1}:typeof a=="function"?g=a:typeof a=="object"&&(g=function(b){return b.getName()in a});var c=this.elements,d=c.length;e&&d--;if(b){c=Array.prototype.slice.call(c,0);c.reverse()}for(e=0;e<d;e++)if(g(c[e]))return c[e];return null},isContextFor:function(a){var e;if(a in CKEDITOR.dtd.$block){e=this.contains(CKEDITOR.dtd.$intermediate)||this.root.equals(this.block)&&this.block||this.blockLimit;return!!e.getDtd()[a]}return true},direction:function(){return(this.block||this.blockLimit||this.root).getDirection(1)}},CKEDITOR.dom.text=function(a,e){typeof a=="string"&&(a=(e?e.$:document).createTextNode(a));this.$=a},CKEDITOR.dom.text.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.text.prototype,{type:CKEDITOR.NODE_TEXT,getLength:function(){return this.$.nodeValue.length},getText:function(){return this.$.nodeValue},setText:function(a){this.$.nodeValue=a},split:function(a){var e=this.$.parentNode,b=e.childNodes.length,g=this.getLength(),c=this.getDocument(),d=new CKEDITOR.dom.text(this.$.splitText(a),c);if(e.childNodes.length==b)if(a>=g){d=c.createText("");d.insertAfter(this)}else{a=c.createText("");a.insertAfter(d);a.remove()}return d},substring:function(a,e){return typeof e!="number"?this.$.nodeValue.substr(a):this.$.nodeValue.substring(a,e)}}),function(){function a(a,g,c){var d=a.serializable,e=g[c?"endContainer":"startContainer"],f=c?"endOffset":"startOffset",h=d?g.document.getById(a.startNode):a.startNode,a=d?g.document.getById(a.endNode):a.endNode;if(e.equals(h.getPrevious())){g.startOffset=g.startOffset-e.getLength()-a.getPrevious().getLength();e=a.getNext()}else if(e.equals(a.getPrevious())){g.startOffset=g.startOffset-e.getLength();e=a.getNext()}e.equals(h.getParent())&&g[f]++;e.equals(a.getParent())&&g[f]++;g[c?"endContainer":"startContainer"]=e;return g}CKEDITOR.dom.rangeList=function(a){if(a instanceof CKEDITOR.dom.rangeList)return a;a?a instanceof CKEDITOR.dom.range&&(a=[a]):a=[];return CKEDITOR.tools.extend(a,e)};var e={createIterator:function(){var a=this,g=CKEDITOR.dom.walker.bookmark(),c=[],d;return{getNextRange:function(e){d=d===void 0?0:d+1;var f=a[d];if(f&&a.length>1){if(!d)for(var h=a.length-1;h>=0;h--)c.unshift(a[h].createBookmark(true));if(e)for(var i=0;a[d+i+1];){for(var k=f.document,e=0,h=k.getById(c[i].endNode),k=k.getById(c[i+1].startNode);;){h=h.getNextSourceNode(false);if(k.equals(h))e=1;else if(g(h)||h.type==CKEDITOR.NODE_ELEMENT&&h.isBlockBoundary())continue;break}if(!e)break;i++}for(f.moveToBookmark(c.shift());i--;){h=a[++d];h.moveToBookmark(c.shift());f.setEnd(h.endContainer,h.endOffset)}}return f}}},createBookmarks:function(b){for(var g=[],c,d=0;d<this.length;d++){g.push(c=this[d].createBookmark(b,true));for(var e=d+1;e<this.length;e++){this[e]=a(c,this[e]);this[e]=a(c,this[e],true)}}return g},createBookmarks2:function(a){for(var g=[],c=0;c<this.length;c++)g.push(this[c].createBookmark2(a));return g},moveToBookmarks:function(a){for(var g=0;g<this.length;g++)this[g].moveToBookmark(a[g])}}}(),function(){function a(){return CKEDITOR.getUrl(CKEDITOR.skinName.split(",")[1]||"skins/"+CKEDITOR.skinName.split(",")[0]+"/")}function e(b){var c=CKEDITOR.skin["ua_"+b],d=CKEDITOR.env;if(c)for(var c=c.split(",").sort(function(a,b){return a>b?-1:1}),f=0,g;f<c.length;f++){g=c[f];if(d.ie&&(g.replace(/^ie/,"")==d.version||d.quirks&&g=="iequirks"))g="ie";if(d[g]){b=b+("_"+c[f]);break}}return CKEDITOR.getUrl(a()+b+".css")}function b(a,b){if(!d[a]){CKEDITOR.document.appendStyleSheet(e(a));d[a]=1}b&&b()}function g(a){var b=a.getById(j);if(!b){b=a.getHead().append("style");b.setAttribute("id",j);b.setAttribute("type","text/css")}return b}function c(a,b,c){var d,f,g;if(CKEDITOR.env.webkit){b=b.split("}").slice(0,-1);for(f=0;f<b.length;f++)b[f]=b[f].split("{")}for(var e=0;e<a.length;e++)if(CKEDITOR.env.webkit)for(f=0;f<b.length;f++){g=b[f][1];for(d=0;d<c.length;d++)g=g.replace(c[d][0],c[d][1]);a[e].$.sheet.addRule(b[f][0],g)}else{g=b;for(d=0;d<c.length;d++)g=g.replace(c[d][0],c[d][1]);CKEDITOR.env.ie&&CKEDITOR.env.version<11?a[e].$.styleSheet.cssText=a[e].$.styleSheet.cssText+g:a[e].$.innerHTML=a[e].$.innerHTML+g}}var d={};CKEDITOR.skin={path:a,loadPart:function(c,d){CKEDITOR.skin.name!=CKEDITOR.skinName.split(",")[0]?CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(a()+"skin.js"),function(){b(c,d)}):b(c,d)},getPath:function(a){return CKEDITOR.getUrl(e(a))},icons:{},addIcon:function(a,b,c,d){a=a.toLowerCase();this.icons[a]||(this.icons[a]={path:b,offset:c||0,bgsize:d||"16px"})},getIconStyle:function(a,b,c,d,f){var g;if(a){a=a.toLowerCase();b&&(g=this.icons[a+"-rtl"]);g||(g=this.icons[a])}a=c||g&&g.path||"";d=d||g&&g.offset;f=f||g&&g.bgsize||"16px";return a&&"background-image:url("+CKEDITOR.getUrl(a)+");background-position:0 "+d+"px;background-size:"+f+";"}};CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{getUiColor:function(){return this.uiColor},setUiColor:function(a){var b=g(CKEDITOR.document);return(this.setUiColor=function(a){this.uiColor=a;var d=CKEDITOR.skin.chameleon,g="",e="";if(typeof d=="function"){g=d(this,"editor");e=d(this,"panel")}a=[[h,a]];c([b],g,a);c(f,e,a)}).call(this,a)}});var j="cke_ui_color",f=[],h=/\$color/g;CKEDITOR.on("instanceLoaded",function(a){if(!CKEDITOR.env.ie||!CKEDITOR.env.quirks){var b=a.editor,a=function(a){a=(a.data[0]||a.data).element.getElementsByTag("iframe").getItem(0).getFrameDocument();if(!a.getById("cke_ui_color")){a=g(a);f.push(a);var d=b.getUiColor();d&&c([a],CKEDITOR.skin.chameleon(b,"panel"),[[h,d]])}};b.on("panelShow",a);b.on("menuShow",a);b.config.uiColor&&b.setUiColor(b.config.uiColor)}})}(),function(){if(CKEDITOR.env.webkit)CKEDITOR.env.hc=false;else{var a=CKEDITOR.dom.element.createFromHtml('<div style="width:0;height:0;position:absolute;left:-10000px;border:1px solid;border-color:red blue"></div>',CKEDITOR.document);a.appendTo(CKEDITOR.document.getHead());try{var e=a.getComputedStyle("border-top-color"),b=a.getComputedStyle("border-right-color");CKEDITOR.env.hc=!!(e&&e==b)}catch(g){CKEDITOR.env.hc=false}a.remove()}if(CKEDITOR.env.hc)CKEDITOR.env.cssClass=CKEDITOR.env.cssClass+" cke_hc";CKEDITOR.document.appendStyleText(".cke{visibility:hidden;}");CKEDITOR.status="loaded";CKEDITOR.fireOnce("loaded");if(a=CKEDITOR._.pending){delete CKEDITOR._.pending;for(e=0;e<a.length;e++){CKEDITOR.editor.prototype.constructor.apply(a[e][0],a[e][1]);CKEDITOR.add(a[e][0])}}}(),CKEDITOR.skin.name="moono",CKEDITOR.skin.ua_editor="ie,iequirks,ie7,ie8,gecko",CKEDITOR.skin.ua_dialog="ie,iequirks,ie7,ie8",CKEDITOR.skin.chameleon=function(){var a=function(){return function(a,b){for(var d=a.match(/[^#]./g),e=0;e<3;e++){var f=d,h=e,i;i=parseInt(d[e],16);i=("0"+(b<0?0|i*(1+b):0|i+(255-i)*b).toString(16)).slice(-2);f[h]=i}return"#"+d.join("")}}(),e=function(){var a=new CKEDITOR.template("background:#{to};background-image:-webkit-gradient(linear,lefttop,leftbottom,from({from}),to({to}));background-image:-moz-linear-gradient(top,{from},{to});background-image:-webkit-linear-gradient(top,{from},{to});background-image:-o-linear-gradient(top,{from},{to});background-image:-ms-linear-gradient(top,{from},{to});background-image:linear-gradient(top,{from},{to});filter:progid:DXImageTransform.Microsoft.gradient(gradientType=0,startColorstr='{from}',endColorstr='{to}');");return function(b,d){return a.output({from:b,to:d})}}(),b={editor:new CKEDITOR.template("{id}.cke_chrome [border-color:{defaultBorder};] {id} .cke_top [ {defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_bottom [{defaultGradient}border-top-color:{defaultBorder};] {id} .cke_resizer [border-right-color:{ckeResizer}] {id} .cke_dialog_title [{defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_dialog_footer [{defaultGradient}outline-color:{defaultBorder};border-top-color:{defaultBorder};] {id} .cke_dialog_tab [{lightGradient}border-color:{defaultBorder};] {id} .cke_dialog_tab:hover [{mediumGradient}] {id} .cke_dialog_contents [border-top-color:{defaultBorder};] {id} .cke_dialog_tab_selected, {id} .cke_dialog_tab_selected:hover [background:{dialogTabSelected};border-bottom-color:{dialogTabSelectedBorder};] {id} .cke_dialog_body [background:{dialogBody};border-color:{defaultBorder};] {id} .cke_toolgroup [{lightGradient}border-color:{defaultBorder};] {id} a.cke_button_off:hover, {id} a.cke_button_off:focus, {id} a.cke_button_off:active [{mediumGradient}] {id} .cke_button_on [{ckeButtonOn}] {id} .cke_toolbar_separator [background-color: {ckeToolbarSeparator};] {id} .cke_combo_button [border-color:{defaultBorder};{lightGradient}] {id} a.cke_combo_button:hover, {id} a.cke_combo_button:focus, {id} .cke_combo_on a.cke_combo_button [border-color:{defaultBorder};{mediumGradient}] {id} .cke_path_item [color:{elementsPathColor};] {id} a.cke_path_item:hover, {id} a.cke_path_item:focus, {id} a.cke_path_item:active [background-color:{elementsPathBg};] {id}.cke_panel [border-color:{defaultBorder};] "),panel:new CKEDITOR.template(".cke_panel_grouptitle [{lightGradient}border-color:{defaultBorder};] .cke_menubutton_icon [background-color:{menubuttonIcon};] .cke_menubutton:hover .cke_menubutton_icon, .cke_menubutton:focus .cke_menubutton_icon, .cke_menubutton:active .cke_menubutton_icon [background-color:{menubuttonIconHover};] .cke_menuseparator [background-color:{menubuttonIcon};] a:hover.cke_colorbox, a:focus.cke_colorbox, a:active.cke_colorbox [border-color:{defaultBorder};] a:hover.cke_colorauto, a:hover.cke_colormore, a:focus.cke_colorauto, a:focus.cke_colormore, a:active.cke_colorauto, a:active.cke_colormore [background-color:{ckeColorauto};border-color:{defaultBorder};] ")};return function(g,c){var d=g.uiColor,d={id:"."+g.id,defaultBorder:a(d,-0.1),defaultGradient:e(a(d,0.9),d),lightGradient:e(a(d,1),a(d,0.7)),mediumGradient:e(a(d,0.8),a(d,0.5)),ckeButtonOn:e(a(d,0.6),a(d,0.7)),ckeResizer:a(d,-0.4),ckeToolbarSeparator:a(d,0.5),ckeColorauto:a(d,0.8),dialogBody:a(d,0.7),dialogTabSelected:e("#FFFFFF","#FFFFFF"),dialogTabSelectedBorder:"#FFF",elementsPathColor:a(d,-0.6),elementsPathBg:d,menubuttonIcon:a(d,0.5),menubuttonIconHover:a(d,0.3)};return b[c].output(d).replace(/\[/g,"{").replace(/\]/g,"}")}}(),CKEDITOR.plugins.add("dialogui",{onLoad:function(){var a=function(a){this._||(this._={});this._["default"]=this._.initValue=a["default"]||"";this._.required=a.required||false;for(var b=[this._],c=1;c<arguments.length;c++)b.push(arguments[c]);b.push(true);CKEDITOR.tools.extend.apply(CKEDITOR.tools,b);return this._},e={build:function(a,b,c){return new CKEDITOR.ui.dialog.textInput(a,b,c)}},b={build:function(a,b,c){return new CKEDITOR.ui.dialog[b.type](a,b,c)}},g={isChanged:function(){return this.getValue()!=this.getInitValue()},reset:function(a){this.setValue(this.getInitValue(),a)},setInitValue:function(){this._.initValue=this.getValue()},resetInitValue:function(){this._.initValue=this._["default"]},getInitValue:function(){return this._.initValue}},c=CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onChange:function(a,b){if(!this._.domOnChangeRegistered){a.on("load",function(){this.getInputElement().on("change",function(){a.parts.dialog.isVisible()&&this.fire("change",{value:this.getValue()})},this)},this);this._.domOnChangeRegistered=true}this.on("change",b)}},true),d=/^on([A-Z]\w+)/,j=function(a){for(var b in a)(d.test(b)||b=="title"||b=="type")&&delete a[b];return a};CKEDITOR.tools.extend(CKEDITOR.ui.dialog,{labeledElement:function(b,c,d,g){if(!(arguments.length<4)){var e=a.call(this,c);e.labelId=CKEDITOR.tools.getNextId()+"_label";this._.children=[];var j={role:c.role||"presentation"};if(c.includeLabel)j["aria-labelledby"]=e.labelId;CKEDITOR.ui.dialog.uiElement.call(this,b,c,d,"div",null,j,function(){var a=[],d=c.required?" cke_required":"";if(c.labelLayout!="horizontal")a.push('<label class="cke_dialog_ui_labeled_label'+d+'" ',' id="'+e.labelId+'"',e.inputId?' for="'+e.inputId+'"':"",(c.labelStyle?' style="'+c.labelStyle+'"':"")+">",c.label,"</label>",'<div class="cke_dialog_ui_labeled_content"',c.controlStyle?' style="'+c.controlStyle+'"':"",' role="presentation">',g.call(this,b,c),"</div>");else{d={type:"hbox",widths:c.widths,padding:0,children:[{type:"html",html:'<label class="cke_dialog_ui_labeled_label'+
d+'" id="'+e.labelId+'" for="'+e.inputId+'"'+(c.labelStyle?' style="'+c.labelStyle+'"':"")+">"+CKEDITOR.tools.htmlEncode(c.label)+"</span>"},{type:"html",html:'<span class="cke_dialog_ui_labeled_content"'+(c.controlStyle?' style="'+c.controlStyle+'"':"")+">"+g.call(this,b,c)+"</span>"}]};CKEDITOR.dialog._.uiElementBuilders.hbox.build(b,d,a)}return a.join("")})}},textInput:function(b,c,d){if(!(arguments.length<3)){a.call(this,c);var g=this._.inputId=CKEDITOR.tools.getNextId()+"_textInput",e={"class":"cke_dialog_ui_input_"+
c.type,id:g,type:c.type};if(c.validate)this.validate=c.validate;if(c.maxLength)e.maxlength=c.maxLength;if(c.size)e.size=c.size;if(c.inputStyle)e.style=c.inputStyle;var j=this,q=false;b.on("load",function(){j.getInputElement().on("keydown",function(a){a.data.getKeystroke()==13&&(q=true)});j.getInputElement().on("keyup",function(a){if(a.data.getKeystroke()==13&&q){b.getButton("ok")&&setTimeout(function(){b.getButton("ok").click()},0);q=false}},null,null,1E3)});CKEDITOR.ui.dialog.labeledElement.call(this,b,c,d,function(){var a=['<div class="cke_dialog_ui_input_',c.type,'" role="presentation"'];c.width&&a.push('style="width:'+c.width+'" ');a.push("><input ");e["aria-labelledby"]=this._.labelId;this._.required&&(e["aria-required"]=this._.required);for(var b in e)a.push(b+'="'+e[b]+'" ');a.push(" /></div>");return a.join("")})}},textarea:function(b,c,d){if(!(arguments.length<3)){a.call(this,c);var g=this,e=this._.inputId=CKEDITOR.tools.getNextId()+"_textarea",j={};if(c.validate)this.validate=c.validate;j.rows=c.rows||5;j.cols=c.cols||20;j["class"]="cke_dialog_ui_input_textarea "+(c["class"]||"");if(typeof c.inputStyle!="undefined")j.style=c.inputStyle;if(c.dir)j.dir=c.dir;CKEDITOR.ui.dialog.labeledElement.call(this,b,c,d,function(){j["aria-labelledby"]=this._.labelId;this._.required&&(j["aria-required"]=this._.required);var a=['<div class="cke_dialog_ui_input_textarea" role="presentation"><textarea id="',e,'" '],b;for(b in j)a.push(b+'="'+CKEDITOR.tools.htmlEncode(j[b])+'" ');a.push(">",CKEDITOR.tools.htmlEncode(g._["default"]),"</textarea></div>");return a.join("")})}},checkbox:function(b,c,d){if(!(arguments.length<3)){var g=a.call(this,c,{"default":!!c["default"]});if(c.validate)this.validate=c.validate;CKEDITOR.ui.dialog.uiElement.call(this,b,c,d,"span",null,null,function(){var a=CKEDITOR.tools.extend({},c,{id:c.id?c.id+"_checkbox":CKEDITOR.tools.getNextId()+"_checkbox"},true),d=[],e=CKEDITOR.tools.getNextId()+"_label",i={"class":"cke_dialog_ui_checkbox_input",type:"checkbox","aria-labelledby":e};j(a);if(c["default"])i.checked="checked";if(typeof a.inputStyle!="undefined")a.style=a.inputStyle;g.checkbox=new CKEDITOR.ui.dialog.uiElement(b,a,d,"input",null,i);d.push(' <label id="',e,'" for="',i.id,'"'+(c.labelStyle?' style="'+c.labelStyle+'"':"")+">",CKEDITOR.tools.htmlEncode(c.label),"</label>");return d.join("")})}},radio:function(b,c,d){if(!(arguments.length<3)){a.call(this,c);if(!this._["default"])this._["default"]=this._.initValue=c.items[0][1];if(c.validate)this.validate=c.valdiate;var g=[],e=this;c.role="radiogroup";c.includeLabel=true;CKEDITOR.ui.dialog.labeledElement.call(this,b,c,d,function(){for(var a=[],d=[],i=(c.id?c.id:CKEDITOR.tools.getNextId())+"_radio",l=0;l<c.items.length;l++){var p=c.items[l],t=p[2]!==void 0?p[2]:p[0],s=p[1]!==void 0?p[1]:p[0],u=CKEDITOR.tools.getNextId()+"_radio_input",w=u+"_label",u=CKEDITOR.tools.extend({},c,{id:u,title:null,type:null},true),t=CKEDITOR.tools.extend({},u,{title:t},true),x={type:"radio","class":"cke_dialog_ui_radio_input",name:i,value:s,"aria-labelledby":w},v=[];if(e._["default"]==s)x.checked="checked";j(u);j(t);if(typeof u.inputStyle!="undefined")u.style=u.inputStyle;u.keyboardFocusable=true;g.push(new CKEDITOR.ui.dialog.uiElement(b,u,v,"input",null,x));v.push(" ");new CKEDITOR.ui.dialog.uiElement(b,t,v,"label",null,{id:w,"for":x.id},p[0]);a.push(v.join(""))}new CKEDITOR.ui.dialog.hbox(b,g,a,d);return d.join("")});this._.children=g}},button:function(b,c,d){if(arguments.length){typeof c=="function"&&(c=c(b.getParentEditor()));a.call(this,c,{disabled:c.disabled||false});CKEDITOR.event.implementOn(this);var g=this;b.on("load",function(){var a=this.getElement();(function(){a.on("click",function(a){g.click();a.data.preventDefault()});a.on("keydown",function(a){if(a.data.getKeystroke()in{32:1}){g.click();a.data.preventDefault()}})})();a.unselectable()},this);var e=CKEDITOR.tools.extend({},c);delete e.style;var j=CKEDITOR.tools.getNextId()+"_label";CKEDITOR.ui.dialog.uiElement.call(this,b,e,d,"a",null,{style:c.style,href:"javascript:void(0)",title:c.label,hidefocus:"true","class":c["class"],role:"button","aria-labelledby":j},'<span id="'+j+'" class="cke_dialog_ui_button">'+CKEDITOR.tools.htmlEncode(c.label)+"</span>")}},select:function(b,c,d){if(!(arguments.length<3)){var g=a.call(this,c);if(c.validate)this.validate=c.validate;g.inputId=CKEDITOR.tools.getNextId()+"_select";CKEDITOR.ui.dialog.labeledElement.call(this,b,c,d,function(){var a=CKEDITOR.tools.extend({},c,{id:c.id?c.id+"_select":CKEDITOR.tools.getNextId()+"_select"},true),d=[],e=[],i={id:g.inputId,"class":"cke_dialog_ui_input_select","aria-labelledby":this._.labelId};d.push('<div class="cke_dialog_ui_input_',c.type,'" role="presentation"');c.width&&d.push('style="width:'+c.width+'" ');d.push(">");if(c.size!==void 0)i.size=c.size;if(c.multiple!==void 0)i.multiple=c.multiple;j(a);for(var l=0,p;l<c.items.length&&(p=c.items[l]);l++)e.push('<option value="',CKEDITOR.tools.htmlEncode(p[1]!==void 0?p[1]:p[0]).replace(/"/g,"&quot;"),'" /> ',CKEDITOR.tools.htmlEncode(p[0]));if(typeof a.inputStyle!="undefined")a.style=a.inputStyle;g.select=new CKEDITOR.ui.dialog.uiElement(b,a,d,"select",null,i,e.join(""));d.push("</div>");return d.join("")})}},file:function(b,c,d){if(!(arguments.length<3)){c["default"]===void 0&&(c["default"]="");var g=CKEDITOR.tools.extend(a.call(this,c),{definition:c,buttons:[]});if(c.validate)this.validate=c.validate;b.on("load",function(){CKEDITOR.document.getById(g.frameId).getParent().addClass("cke_dialog_ui_input_file")});CKEDITOR.ui.dialog.labeledElement.call(this,b,c,d,function(){g.frameId=CKEDITOR.tools.getNextId()+"_fileInput";var a=['<iframe frameborder="0" allowtransparency="0" class="cke_dialog_ui_input_file" role="presentation" id="',g.frameId,'" title="',c.label,'" src="javascript:void('];a.push(CKEDITOR.env.ie?"(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"})()":"0");a.push(')"></iframe>');return a.join("")})}},fileButton:function(b,c,d){var g=this;if(!(arguments.length<3)){a.call(this,c);if(c.validate)this.validate=c.validate;var e=CKEDITOR.tools.extend({},c),j=e.onClick;e.className=(e.className?e.className+" ":"")+"cke_dialog_ui_button";e.onClick=function(a){var d=c["for"];if(!j||j.call(this,a)!==false){b.getContentElement(d[0],d[1]).submit();this.disable()}};b.on("load",function(){b.getContentElement(c["for"][0],c["for"][1])._.buttons.push(g)});CKEDITOR.ui.dialog.button.call(this,b,e,d)}},html:function(){var a=/^\s*<[\w:]+\s+([^>]*)?>/,b=/^(\s*<[\w:]+(?:\s+[^>]*)?)((?:.|\r|\n)+)$/,c=/\/$/;return function(d,g,e){if(!(arguments.length<3)){var j=[],m=g.html;m.charAt(0)!="<"&&(m="<span>"+m+"</span>");var l=g.focus;if(l){var p=this.focus;this.focus=function(){(typeof l=="function"?l:p).call(this);this.fire("focus")};if(g.isFocusable)this.isFocusable=this.isFocusable;this.keyboardFocusable=true}CKEDITOR.ui.dialog.uiElement.call(this,d,g,j,"span",null,null,"");j=j.join("").match(a);m=m.match(b)||["","",""];if(c.test(m[1])){m[1]=m[1].slice(0,-1);m[2]="/"+m[2]}e.push([m[1]," ",j[1]||"",m[2]].join(""))}}}(),fieldset:function(a,b,c,d,g){var e=g.label;this._={children:b};CKEDITOR.ui.dialog.uiElement.call(this,a,g,d,"fieldset",null,null,function(){var a=[];e&&a.push("<legend"+(g.labelStyle?' style="'+g.labelStyle+'"':"")+">"+e+"</legend>");for(var b=0;b<c.length;b++)a.push(c[b]);return a.join("")})}},true);CKEDITOR.ui.dialog.html.prototype=new CKEDITOR.ui.dialog.uiElement;CKEDITOR.ui.dialog.labeledElement.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setLabel:function(a){var b=CKEDITOR.document.getById(this._.labelId);b.getChildCount()<1?(new CKEDITOR.dom.text(a,CKEDITOR.document)).appendTo(b):b.getChild(0).$.nodeValue=a;return this},getLabel:function(){var a=CKEDITOR.document.getById(this._.labelId);return!a||a.getChildCount()<1?"":a.getChild(0).getText()},eventProcessors:c},true);CKEDITOR.ui.dialog.button.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{click:function(){return!this._.disabled?this.fire("click",{dialog:this._.dialog}):false},enable:function(){this._.disabled=false;var a=this.getElement();a&&a.removeClass("cke_disabled")},disable:function(){this._.disabled=true;this.getElement().addClass("cke_disabled")},isVisible:function(){return this.getElement().getFirst().isVisible()},isEnabled:function(){return!this._.disabled},eventProcessors:CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onClick:function(a,b){this.on("click",function(){b.apply(this,arguments)})}},true),accessKeyUp:function(){this.click()},accessKeyDown:function(){this.focus()},keyboardFocusable:true},true);CKEDITOR.ui.dialog.textInput.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return CKEDITOR.document.getById(this._.inputId)},focus:function(){var a=this.selectParentTab();setTimeout(function(){var b=a.getInputElement();b&&b.$.focus()},0)},select:function(){var a=this.selectParentTab();setTimeout(function(){var b=a.getInputElement();if(b){b.$.focus();b.$.select()}},0)},accessKeyUp:function(){this.select()},setValue:function(a){!a&&(a="");return CKEDITOR.ui.dialog.uiElement.prototype.setValue.apply(this,arguments)},keyboardFocusable:true},g,true);CKEDITOR.ui.dialog.textarea.prototype=new CKEDITOR.ui.dialog.textInput;CKEDITOR.ui.dialog.select.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return this._.select.getElement()},add:function(a,b,c){var d=new CKEDITOR.dom.element("option",this.getDialog().getParentEditor().document),g=this.getInputElement().$;d.$.text=a;d.$.value=b===void 0||b===null?a:b;c===void 0||c===null?CKEDITOR.env.ie?g.add(d.$):g.add(d.$,null):g.add(d.$,c);return this},remove:function(a){this.getInputElement().$.remove(a);return this},clear:function(){for(var a=this.getInputElement().$;a.length>0;)a.remove(0);return this},keyboardFocusable:true},g,true);CKEDITOR.ui.dialog.checkbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getInputElement:function(){return this._.checkbox.getElement()},setValue:function(a,b){this.getInputElement().$.checked=a;!b&&this.fire("change",{value:a})},getValue:function(){return this.getInputElement().$.checked},accessKeyUp:function(){this.setValue(!this.getValue())},eventProcessors:{onChange:function(a,b){if(!CKEDITOR.env.ie||CKEDITOR.env.version>8)return c.onChange.apply(this,arguments);a.on("load",function(){var a=this._.checkbox.getElement();a.on("propertychange",function(b){b=b.data.$;b.propertyName=="checked"&&this.fire("change",{value:a.$.checked})},this)},this);this.on("change",b);return null}},keyboardFocusable:true},g,true);CKEDITOR.ui.dialog.radio.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setValue:function(a,b){for(var c=this._.children,d,g=0;g<c.length&&(d=c[g]);g++)d.getElement().$.checked=d.getValue()==a;!b&&this.fire("change",{value:a})},getValue:function(){for(var a=this._.children,b=0;b<a.length;b++)if(a[b].getElement().$.checked)return a[b].getValue();return null},accessKeyUp:function(){var a=this._.children,b;for(b=0;b<a.length;b++)if(a[b].getElement().$.checked){a[b].getElement().focus();return}a[0].getElement().focus()},eventProcessors:{onChange:function(a,b){if(CKEDITOR.env.ie){a.on("load",function(){for(var a=this._.children,b=this,c=0;c<a.length;c++)a[c].getElement().on("propertychange",function(a){a=a.data.$;a.propertyName=="checked"&&this.$.checked&&b.fire("change",{value:this.getAttribute("value")})})},this);this.on("change",b)}else return c.onChange.apply(this,arguments);return null}}},g,true);CKEDITOR.ui.dialog.file.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,g,{getInputElement:function(){var a=CKEDITOR.document.getById(this._.frameId).getFrameDocument();return a.$.forms.length>0?new CKEDITOR.dom.element(a.$.forms[0].elements[0]):this.getElement()},submit:function(){this.getInputElement().getParent().$.submit();return this},getAction:function(){return this.getInputElement().getParent().$.action},registerEvents:function(a){var b=/^on([A-Z]\w+)/,c,d=function(a,b,c,d){a.on("formLoaded",function(){a.getInputElement().on(c,d,a)})},g;for(g in a)if(c=g.match(b))this.eventProcessors[g]?this.eventProcessors[g].call(this,this._.dialog,a[g]):d(this,this._.dialog,c[1].toLowerCase(),a[g]);return this},reset:function(){function a(){c.$.open();var f="";d.size&&(f=d.size-(CKEDITOR.env.ie?7:0));var t=b.frameId+"_input";c.$.write(['<html dir="'+m+'" lang="'+l+'"><head><title></title></head><body style="margin: 0; overflow: hidden; background: transparent;">','<form enctype="multipart/form-data" method="POST" dir="'+m+'" lang="'+l+'" action="',CKEDITOR.tools.htmlEncode(d.action),'"><label id="',b.labelId,'" for="',t,'" style="display:none">',CKEDITOR.tools.htmlEncode(d.label),'</label><input style="width:100%" id="',t,'" aria-labelledby="',b.labelId,'" type="file" name="',CKEDITOR.tools.htmlEncode(d.id||"cke_upload"),'" size="',CKEDITOR.tools.htmlEncode(f>0?f:""),'" /></form></body></html><script>',CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"","window.parent.CKEDITOR.tools.callFunction("+e+");","window.onbeforeunload = function() {window.parent.CKEDITOR.tools.callFunction("+j+")}","<\/script>"].join(""));c.$.close();for(f=0;f<g.length;f++)g[f].enable()}var b=this._,c=CKEDITOR.document.getById(b.frameId).getFrameDocument(),d=b.definition,g=b.buttons,e=this.formLoadedNumber,j=this.formUnloadNumber,m=b.dialog._.editor.lang.dir,l=b.dialog._.editor.langCode;if(!e){e=this.formLoadedNumber=CKEDITOR.tools.addFunction(function(){this.fire("formLoaded")},this);j=this.formUnloadNumber=CKEDITOR.tools.addFunction(function(){this.getInputElement().clearCustomData()},this);this.getDialog()._.editor.on("destroy",function(){CKEDITOR.tools.removeFunction(e);CKEDITOR.tools.removeFunction(j)})}CKEDITOR.env.gecko?setTimeout(a,500):a()},getValue:function(){return this.getInputElement().$.value||""},setInitValue:function(){this._.initValue=""},eventProcessors:{onChange:function(a,b){if(!this._.domOnChangeRegistered){this.on("formLoaded",function(){this.getInputElement().on("change",function(){this.fire("change",{value:this.getValue()})},this)},this);this._.domOnChangeRegistered=true}this.on("change",b)}},keyboardFocusable:true},true);CKEDITOR.ui.dialog.fileButton.prototype=new CKEDITOR.ui.dialog.button;CKEDITOR.ui.dialog.fieldset.prototype=CKEDITOR.tools.clone(CKEDITOR.ui.dialog.hbox.prototype);CKEDITOR.dialog.addUIElement("text",e);CKEDITOR.dialog.addUIElement("password",e);CKEDITOR.dialog.addUIElement("textarea",b);CKEDITOR.dialog.addUIElement("checkbox",b);CKEDITOR.dialog.addUIElement("radio",b);CKEDITOR.dialog.addUIElement("button",b);CKEDITOR.dialog.addUIElement("select",b);CKEDITOR.dialog.addUIElement("file",b);CKEDITOR.dialog.addUIElement("fileButton",b);CKEDITOR.dialog.addUIElement("html",b);CKEDITOR.dialog.addUIElement("fieldset",{build:function(a,b,c){for(var d=b.children,g,e=[],j=[],m=0;m<d.length&&(g=d[m]);m++){var l=[];e.push(l);j.push(CKEDITOR.dialog._.uiElementBuilders[g.type].build(a,g,l))}return new CKEDITOR.ui.dialog[b.type](a,j,e,c,b)}})}}),CKEDITOR.DIALOG_RESIZE_NONE=0,CKEDITOR.DIALOG_RESIZE_WIDTH=1,CKEDITOR.DIALOG_RESIZE_HEIGHT=2,CKEDITOR.DIALOG_RESIZE_BOTH=3,function(){function a(){for(var a=this._.tabIdList.length,b=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId)+a,c=b-1;c>b-a;c--)if(this._.tabs[this._.tabIdList[c%a]][0].$.offsetHeight)return this._.tabIdList[c%a];return null}function e(){for(var a=this._.tabIdList.length,b=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId),c=b+1;c<b+a;c++)if(this._.tabs[this._.tabIdList[c%a]][0].$.offsetHeight)return this._.tabIdList[c%a];return null}function b(a,b){for(var c=a.$.getElementsByTagName("input"),d=0,f=c.length;d<f;d++){var g=new CKEDITOR.dom.element(c[d]);if(g.getAttribute("type").toLowerCase()=="text")if(b){g.setAttribute("value",g.getCustomData("fake_value")||"");g.removeCustomData("fake_value")}else{g.setCustomData("fake_value",g.getAttribute("value"));g.setAttribute("value","")}}}function g(a,b){var c=this.getInputElement();c&&(a?c.removeAttribute("aria-invalid"):c.setAttribute("aria-invalid",true));a||(this.select?this.select():this.focus());b&&alert(b);this.fire("validated",{valid:a,msg:b})}function c(){var a=this.getInputElement();a&&a.removeAttribute("aria-invalid")}function d(a){var a=CKEDITOR.dom.element.createFromHtml(CKEDITOR.addTemplate("dialog",l).output({id:CKEDITOR.tools.getNextNumber(),editorId:a.id,langDir:a.lang.dir,langCode:a.langCode,editorDialogClass:"cke_editor_"+a.name.replace(/\./g,"\\.")+"_dialog",closeTitle:a.lang.common.close,hidpi:CKEDITOR.env.hidpi?"cke_hidpi":""})),b=a.getChild([0,0,0,0,0]),c=b.getChild(0),d=b.getChild(1);if(CKEDITOR.env.ie&&!CKEDITOR.env.quirks){var f="javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())";CKEDITOR.dom.element.createFromHtml('<iframe frameBorder="0" class="cke_iframe_shim" src="'+
f+'" tabIndex="-1"></iframe>').appendTo(b.getParent())}c.unselectable();d.unselectable();return{element:a,parts:{dialog:a.getChild(0),title:c,close:d,tabs:b.getChild(2),contents:b.getChild([3,0,0,0]),footer:b.getChild([3,0,1,0])}}}function j(a,b,c){this.element=b;this.focusIndex=c;this.tabIndex=0;this.isFocusable=function(){return!b.getAttribute("disabled")&&b.isVisible()};this.focus=function(){a._.currentFocusIndex=this.focusIndex;this.element.focus()};b.on("keydown",function(a){a.data.getKeystroke()in
{32:1,13:1}&&this.fire("click")});b.on("focus",function(){this.fire("mouseover")});b.on("blur",function(){this.fire("mouseout")})}function f(a){function b(){a.layout()}var c=CKEDITOR.document.getWindow();c.on("resize",b);a.on("hide",function(){c.removeListener("resize",b)})}function h(a,b){this._={dialog:a};CKEDITOR.tools.extend(this,b)}function i(a){function b(c){var j=a.getSize(),i=CKEDITOR.document.getWindow().getViewPaneSize(),k=c.data.$.screenX,p=c.data.$.screenY,s=k-d.x,t=p-d.y;d={x:k,y:p};f.x=f.x+s;f.y=f.y+t;a.move(f.x+h[3]<e?-h[3]:f.x-h[1]>i.width-j.width-e?i.width-j.width+(g.lang.dir=="rtl"?0:h[1]):f.x,f.y+h[0]<e?-h[0]:f.y-h[2]>i.height-j.height-e?i.height-j.height+h[2]:f.y,1);c.data.preventDefault()}function c(){CKEDITOR.document.removeListener("mousemove",b);CKEDITOR.document.removeListener("mouseup",c);if(CKEDITOR.env.ie6Compat){var a=r.getChild(0).getFrameDocument();a.removeListener("mousemove",b);a.removeListener("mouseup",c)}}var d=null,f=null,g=a.getParentEditor(),e=g.config.dialog_magnetDistance,h=CKEDITOR.skin.margins||[0,0,0,0];typeof e=="undefined"&&(e=20);a.parts.title.on("mousedown",function(g){d={x:g.data.$.screenX,y:g.data.$.screenY};CKEDITOR.document.on("mousemove",b);CKEDITOR.document.on("mouseup",c);f=a.getPosition();if(CKEDITOR.env.ie6Compat){var e=r.getChild(0).getFrameDocument();e.on("mousemove",b);e.on("mouseup",c)}g.data.preventDefault()},a)}function k(a){var b,c;function d(f){var s=h.lang.dir=="rtl",t=p.width,m=p.height,l=t+(f.data.$.screenX-b)*(s?-1:1)*(a._.moved?1:2),n=m+(f.data.$.screenY-c)*(a._.moved?1:2),u=a._.element.getFirst(),u=s&&u.getComputedStyle("right"),q=a.getPosition();q.y+n>k.height&&(n=k.height-q.y);if((s?u:q.x)+l>k.width)l=k.width-(s?u:q.x);if(e==CKEDITOR.DIALOG_RESIZE_WIDTH||e==CKEDITOR.DIALOG_RESIZE_BOTH)t=Math.max(g.minWidth||0,l-j);if(e==CKEDITOR.DIALOG_RESIZE_HEIGHT||e==CKEDITOR.DIALOG_RESIZE_BOTH)m=Math.max(g.minHeight||0,n-i);a.resize(t,m);a._.moved||a.layout();f.data.preventDefault()}function f(){CKEDITOR.document.removeListener("mouseup",f);CKEDITOR.document.removeListener("mousemove",d);if(s){s.remove();s=null}if(CKEDITOR.env.ie6Compat){var a=r.getChild(0).getFrameDocument();a.removeListener("mouseup",f);a.removeListener("mousemove",d)}}var g=a.definition,e=g.resizable;if(e!=CKEDITOR.DIALOG_RESIZE_NONE){var h=a.getParentEditor(),j,i,k,p,s,t=CKEDITOR.tools.addFunction(function(g){p=a.getSize();var e=a.parts.contents;if(e.$.getElementsByTagName("iframe").length){s=CKEDITOR.dom.element.createFromHtml('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%;"></div>');e.append(s)}i=p.height-a.parts.contents.getSize("height",!(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.quirks));j=p.width-a.parts.contents.getSize("width",1);b=g.screenX;c=g.screenY;k=CKEDITOR.document.getWindow().getViewPaneSize();CKEDITOR.document.on("mousemove",d);CKEDITOR.document.on("mouseup",f);if(CKEDITOR.env.ie6Compat){e=r.getChild(0).getFrameDocument();e.on("mousemove",d);e.on("mouseup",f)}g.preventDefault&&g.preventDefault()});a.on("load",function(){var b="";e==CKEDITOR.DIALOG_RESIZE_WIDTH?b=" cke_resizer_horizontal":e==CKEDITOR.DIALOG_RESIZE_HEIGHT&&(b=" cke_resizer_vertical");b=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+b+" cke_resizer_"+h.lang.dir+'" title="'+CKEDITOR.tools.htmlEncode(h.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+t+', event )">'+(h.lang.dir=="ltr"?"◢":"◣")+"</div>");a.parts.footer.append(b,1)});h.on("destroy",function(){CKEDITOR.tools.removeFunction(t)})}}function n(a){a.data.preventDefault(1)}function o(a){var b=CKEDITOR.document.getWindow(),c=a.config,d=c.dialog_backgroundCoverColor||"white",f=c.dialog_backgroundCoverOpacity,g=c.baseFloatZIndex,c=CKEDITOR.tools.genKey(d,f,g),e=v[c];if(e)e.show();else{g=['<div tabIndex="-1" style="position: ',CKEDITOR.env.ie6Compat?"absolute":"fixed","; z-index: ",g,"; top: 0px; left: 0px; ",!CKEDITOR.env.ie6Compat?"background-color: "+d:"",'" class="cke_dialog_background_cover">'];if(CKEDITOR.env.ie6Compat){d="<html><body style=\\'background-color:"+d+";\\'></body></html>";g.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:');g.push("void((function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.write( '"+d+"' );document.close();")+"})())");g.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;filter: progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>')}g.push("</div>");e=CKEDITOR.dom.element.createFromHtml(g.join(""));e.setOpacity(f!==void 0?f:0.5);e.on("keydown",n);e.on("keypress",n);e.on("keyup",n);e.appendTo(CKEDITOR.document.getBody());v[c]=e}a.focusManager.add(e);r=e;var a=function(){var a=b.getViewPaneSize();e.setStyles({width:a.width+"px",height:a.height+"px"})},h=function(){var a=b.getScrollPosition(),c=CKEDITOR.dialog._.currentTop;e.setStyles({left:a.x+"px",top:a.y+"px"});if(c){do{a=c.getPosition();c.move(a.x,a.y)}while(c=c._.parentDialog)}};x=a;b.on("resize",a);a();(!CKEDITOR.env.mac||!CKEDITOR.env.webkit)&&e.focus();if(CKEDITOR.env.ie6Compat){var j=function(){h();arguments.callee.prevScrollHandler.apply(this,arguments)};b.$.setTimeout(function(){j.prevScrollHandler=window.onscroll||function(){};window.onscroll=j},0);h()}}function q(a){if(r){a.focusManager.remove(r);a=CKEDITOR.document.getWindow();r.hide();a.removeListener("resize",x);CKEDITOR.env.ie6Compat&&a.$.setTimeout(function(){window.onscroll=window.onscroll&&window.onscroll.prevScrollHandler||null},0);x=null}}var m=CKEDITOR.tools.cssLength,l='<div class="cke_reset_all {editorId} {editorDialogClass} {hidpi}" dir="{langDir}" lang="{langCode}" role="dialog" aria-labelledby="cke_dialog_title_{id}"><table class="cke_dialog '+
CKEDITOR.env.cssClass+' cke_{langDir}" style="position:absolute" role="presentation"><tr><td role="presentation"><div class="cke_dialog_body" role="presentation"><div id="cke_dialog_title_{id}" class="cke_dialog_title" role="presentation"></div><a id="cke_dialog_close_button_{id}" class="cke_dialog_close_button" href="javascript:void(0)" title="{closeTitle}" role="button"><span class="cke_label">X</span></a><div id="cke_dialog_tabs_{id}" class="cke_dialog_tabs" role="tablist"></div><table class="cke_dialog_contents" role="presentation"><tr><td id="cke_dialog_contents_{id}" class="cke_dialog_contents_body" role="presentation"></td></tr><tr><td id="cke_dialog_footer_{id}" class="cke_dialog_footer" role="presentation"></td></tr></table></div></td></tr></table></div>';CKEDITOR.dialog=function(b,f){function h(){var a=v._.focusList;a.sort(function(a,b){return a.tabIndex!=b.tabIndex?b.tabIndex-a.tabIndex:a.focusIndex-b.focusIndex});for(var b=a.length,c=0;c<b;c++)a[c].focusIndex=c}function j(a){var b=v._.focusList,a=a||0;if(!(b.length<1)){var c=v._.currentFocusIndex;try{b[c].getInputElement().$.blur()}catch(d){}for(var f=c=(c+a+b.length)%b.length;a&&!b[f].isFocusable();){f=(f+a+b.length)%b.length;if(f==c)break}b[f].focus();b[f].type=="text"&&b[f].select()}}function s(c){if(v==CKEDITOR.dialog._.currentTop){var d=c.data.getKeystroke(),f=b.lang.dir=="rtl";o=x=0;if(d==9||d==CKEDITOR.SHIFT+9){d=d==CKEDITOR.SHIFT+9;if(v._.tabBarMode){d=d?a.call(v):e.call(v);v.selectPage(d);v._.tabs[d][0].focus()}else j(d?-1:1);o=1}else if(d==CKEDITOR.ALT+121&&!v._.tabBarMode&&v.getPageCount()>1){v._.tabBarMode=true;v._.tabs[v._.currentTabId][0].focus();o=1}else if((d==37||d==39)&&v._.tabBarMode){d=d==(f?39:37)?a.call(v):e.call(v);v.selectPage(d);v._.tabs[d][0].focus();o=1}else if((d==13||d==32)&&v._.tabBarMode){this.selectPage(this._.currentTabId);this._.tabBarMode=false;this._.currentFocusIndex=-1;j(1);o=1}else if(d==13){d=c.data.getTarget();if(!d.is("a","button","select","textarea")&&(!d.is("input")||d.$.type!="button")){(d=this.getButton("ok"))&&CKEDITOR.tools.setTimeout(d.click,0,d);o=1}x=1}else if(d==27){(d=this.getButton("cancel"))?CKEDITOR.tools.setTimeout(d.click,0,d):this.fire("cancel",{hide:true}).hide!==false&&this.hide();x=1}else return;t(c)}}function t(a){o?a.data.preventDefault(1):x&&a.data.stopPropagation()}var m=CKEDITOR.dialog._.dialogDefinitions[f],l=CKEDITOR.tools.clone(p),n=b.config.dialog_buttonsOrder||"OS",u=b.lang.dir,q={},o,x;(n=="OS"&&CKEDITOR.env.mac||n=="rtl"&&u=="ltr"||n=="ltr"&&u=="rtl")&&l.buttons.reverse();m=CKEDITOR.tools.extend(m(b),l);m=CKEDITOR.tools.clone(m);m=new w(this,m);l=d(b);this._={editor:b,element:l.element,name:f,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:false,focusList:[],currentFocusIndex:0,hasFocus:false};this.parts=l.parts;CKEDITOR.tools.setTimeout(function(){b.fire("ariaWidget",this.parts.contents)},0,this);l={position:CKEDITOR.env.ie6Compat?"absolute":"fixed",top:0,visibility:"hidden"};l[u=="rtl"?"right":"left"]=0;this.parts.dialog.setStyles(l);CKEDITOR.event.call(this);this.definition=m=CKEDITOR.fire("dialogDefinition",{name:f,definition:m},b).definition;if(!("removeDialogTabs"in b._)&&b.config.removeDialogTabs){l=b.config.removeDialogTabs.split(";");for(u=0;u<l.length;u++){n=l[u].split(":");if(n.length==2){var r=n[0];q[r]||(q[r]=[]);q[r].push(n[1])}}b._.removeDialogTabs=q}if(b._.removeDialogTabs&&(q=b._.removeDialogTabs[f]))for(u=0;u<q.length;u++)m.removeContents(q[u]);if(m.onLoad)this.on("load",m.onLoad);if(m.onShow)this.on("show",m.onShow);if(m.onHide)this.on("hide",m.onHide);if(m.onOk)this.on("ok",function(a){b.fire("saveSnapshot");setTimeout(function(){b.fire("saveSnapshot")},0);if(m.onOk.call(this,a)===false)a.data.hide=false});if(m.onCancel)this.on("cancel",function(a){if(m.onCancel.call(this,a)===false)a.data.hide=false});var v=this,z=function(a){var b=v._.contents,c=false,d;for(d in b)for(var f in b[d])if(c=a.call(this,b[d][f]))return};this.on("ok",function(a){z(function(b){if(b.validate){var c=b.validate(this),d=typeof c=="string"||c===false;if(d){a.data.hide=false;a.stop()}g.call(b,!d,typeof c=="string"?c:void 0);return d}})},this,null,0);this.on("cancel",function(a){z(function(c){if(c.isChanged()){if(!b.config.dialog_noConfirmCancel&&!confirm(b.lang.common.confirmCancel))a.data.hide=false;return true}})},this,null,0);this.parts.close.on("click",function(a){this.fire("cancel",{hide:true}).hide!==false&&this.hide();a.data.preventDefault()},this);this.changeFocus=j;var y=this._.element;b.focusManager.add(y,1);this.on("show",function(){y.on("keydown",s,this);if(CKEDITOR.env.gecko)y.on("keypress",t,this)});this.on("hide",function(){y.removeListener("keydown",s);CKEDITOR.env.gecko&&y.removeListener("keypress",t);z(function(a){c.apply(a)})});this.on("iframeAdded",function(a){(new CKEDITOR.dom.document(a.data.iframe.$.contentWindow.document)).on("keydown",s,this,null,0)});this.on("show",function(){h();if(b.config.dialog_startupFocusTab&&v._.pageCount>1){v._.tabBarMode=true;v._.tabs[v._.currentTabId][0].focus()}else if(!this._.hasFocus){this._.currentFocusIndex=-1;if(m.onFocus){var a=m.onFocus.call(this);a&&a.focus()}else j(1)}},this,null,4294967295);if(CKEDITOR.env.ie6Compat)this.on("load",function(){var a=this.getElement(),b=a.getFirst();b.remove();b.appendTo(a)},this);i(this);k(this);(new CKEDITOR.dom.text(m.title,CKEDITOR.document)).appendTo(this.parts.title);for(u=0;u<m.contents.length;u++)(q=m.contents[u])&&this.addPage(q);this.parts.tabs.on("click",function(a){var b=a.data.getTarget();if(b.hasClass("cke_dialog_tab")){b=b.$.id;this.selectPage(b.substring(4,b.lastIndexOf("_")));if(this._.tabBarMode){this._.tabBarMode=false;this._.currentFocusIndex=-1;j(1)}a.data.preventDefault()}},this);u=[];q=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:"hbox",className:"cke_dialog_footer_buttons",widths:[],children:m.buttons},u).getChild();this.parts.footer.setHtml(u.join(""));for(u=0;u<q.length;u++)this._.buttons[q[u].id]=q[u]};CKEDITOR.dialog.prototype={destroy:function(){this.hide();this._.element.remove()},resize:function(){return function(a,b){if(!this._.contentSize||!(this._.contentSize.width==a&&this._.contentSize.height==b)){CKEDITOR.dialog.fire("resize",{dialog:this,width:a,height:b},this._.editor);this.fire("resize",{width:a,height:b},this._.editor);this.parts.contents.setStyles({width:a+"px",height:b+"px"});if(this._.editor.lang.dir=="rtl"&&this._.position)this._.position.x=CKEDITOR.document.getWindow().getViewPaneSize().width-this._.contentSize.width-parseInt(this._.element.getFirst().getStyle("right"),10);this._.contentSize={width:a,height:b}}}}(),getSize:function(){var a=this._.element.getFirst();return{width:a.$.offsetWidth||0,height:a.$.offsetHeight||0}},move:function(a,b,c){var d=this._.element.getFirst(),f=this._.editor.lang.dir=="rtl",g=d.getComputedStyle("position")=="fixed";CKEDITOR.env.ie&&d.setStyle("zoom","100%");if(!g||!this._.position||!(this._.position.x==a&&this._.position.y==b)){this._.position={x:a,y:b};if(!g){g=CKEDITOR.document.getWindow().getScrollPosition();a=a+g.x;b=b+g.y}if(f){g=this.getSize();a=CKEDITOR.document.getWindow().getViewPaneSize().width-g.width-a}b={top:(b>0?b:0)+"px"};b[f?"right":"left"]=(a>0?a:0)+"px";d.setStyles(b);c&&(this._.moved=1)}},getPosition:function(){return CKEDITOR.tools.extend({},this._.position)},show:function(){var a=this._.element,b=this.definition;!a.getParent()||!a.getParent().equals(CKEDITOR.document.getBody())?a.appendTo(CKEDITOR.document.getBody()):a.setStyle("display","block");this.resize(this._.contentSize&&this._.contentSize.width||b.width||b.minWidth,this._.contentSize&&this._.contentSize.height||b.height||b.minHeight);this.reset();this.selectPage(this.definition.contents[0].id);if(CKEDITOR.dialog._.currentZIndex===null)CKEDITOR.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex;this._.element.getFirst().setStyle("z-index",CKEDITOR.dialog._.currentZIndex=CKEDITOR.dialog._.currentZIndex+10);if(CKEDITOR.dialog._.currentTop===null){CKEDITOR.dialog._.currentTop=this;this._.parentDialog=null;o(this._.editor)}else{this._.parentDialog=CKEDITOR.dialog._.currentTop;this._.parentDialog.getElement().getFirst().$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2);CKEDITOR.dialog._.currentTop=this}a.on("keydown",z);a.on("keyup",B);this._.hasFocus=false;for (var c in b.contents)if(b.contents[c]){var a=b.contents[c],d=this._.tabs[a.id],g=a.requiredContent,e=0;if(d){for(var h in this._.contents[a.id]){var j=this._.contents[a.id][h];if(!(j.type=="hbox"||j.type=="vbox"||!j.getInputElement()))if(j.requiredContent&&!this._.editor.activeFilter.check(j.requiredContent))j.disable();else{j.enable();e++}}!e||g&&!this._.editor.activeFilter.check(g)?d[0].addClass("cke_dialog_tab_disabled"):d[0].removeClass("cke_dialog_tab_disabled")}}CKEDITOR.tools.setTimeout(function(){this.layout();f(this);this.parts.dialog.setStyle("visibility","");this.fireOnce("load",{});CKEDITOR.ui.fire("ready",this);this.fire("show",{});this._.editor.fire("dialogShow",this);this._.parentDialog||this._.editor.focusManager.lock();this.foreach(function(a){a.setInitValue&&a.setInitValue()})},100,this)},layout:function(){var a=this.parts.dialog,b=this.getSize(),c=CKEDITOR.document.getWindow().getViewPaneSize(),d=(c.width-b.width)/2,f=(c.height-b.height)/2;CKEDITOR.env.ie6Compat||(b.height+(f>0?f:0)>c.height||b.width+(d>0?d:0)>c.width?a.setStyle("position","absolute"):a.setStyle("position","fixed"));this.move(this._.moved?this._.position.x:d,this._.moved?this._.position.y:f)},foreach:function(a){for(var b in this._.contents)for(var c in this._.contents[b])a.call(this,this._.contents[b][c]);return this},reset:function(){var a=function(a){a.reset&&a.reset(1)};return function(){this.foreach(a);return this}}(),setupContent:function(){var a=arguments;this.foreach(function(b){b.setup&&b.setup.apply(b,a)})},commitContent:function(){var a=arguments;this.foreach(function(b){CKEDITOR.env.ie&&this._.currentFocusIndex==b.focusIndex&&b.getInputElement().$.blur();b.commit&&b.commit.apply(b,a)})},hide:function(){if(this.parts.dialog.isVisible()){this.fire("hide",{});this._.editor.fire("dialogHide",this);this.selectPage(this._.tabIdList[0]);var a=this._.element;a.setStyle("display","none");this.parts.dialog.setStyle("visibility","hidden");for(G(this);CKEDITOR.dialog._.currentTop!=this;)CKEDITOR.dialog._.currentTop.hide();if(this._.parentDialog){var b=this._.parentDialog.getElement().getFirst();b.setStyle("z-index",parseInt(b.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2))}else q(this._.editor);if(CKEDITOR.dialog._.currentTop=this._.parentDialog)CKEDITOR.dialog._.currentZIndex=CKEDITOR.dialog._.currentZIndex-10;else{CKEDITOR.dialog._.currentZIndex=null;a.removeListener("keydown",z);a.removeListener("keyup",B);var c=this._.editor;c.focus();setTimeout(function(){c.focusManager.unlock();CKEDITOR.env.iOS&&c.window.focus()},0)}delete this._.parentDialog;this.foreach(function(a){a.resetInitValue&&a.resetInitValue()})}},addPage:function(a){if(!a.requiredContent||this._.editor.filter.check(a.requiredContent)){for(var b=[],c=a.label?' title="'+CKEDITOR.tools.htmlEncode(a.label)+'"':"",d=CKEDITOR.dialog._.uiElementBuilders.vbox.build(this,{type:"vbox",className:"cke_dialog_page_contents",children:a.elements,expand:!!a.expand,padding:a.padding,style:a.style||"width: 100%;"},b),f=this._.contents[a.id]={},g=d.getChild(),e=0;d=g.shift();){!d.notAllowed&&(d.type!="hbox"&&d.type!="vbox")&&e++;f[d.id]=d;typeof d.getChild=="function"&&g.push.apply(g,d.getChild())}if(!e)a.hidden=true;b=CKEDITOR.dom.element.createFromHtml(b.join(""));b.setAttribute("role","tabpanel");d=CKEDITOR.env;f="cke_"+a.id+"_"+CKEDITOR.tools.getNextNumber();c=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',this._.pageCount>0?" cke_last":"cke_first",c,a.hidden?' style="display:none"':"",' id="',f,'"',d.gecko&&!d.hc?"":' href="javascript:void(0)"',' tabIndex="-1" hidefocus="true" role="tab">',a.label,"</a>"].join(""));b.setAttribute("aria-labelledby",f);this._.tabs[a.id]=[c,b];this._.tabIdList.push(a.id);!a.hidden&&this._.pageCount++;this._.lastTab=c;this.updateStyle();b.setAttribute("name",a.id);b.appendTo(this.parts.contents);c.unselectable();this.parts.tabs.append(c);if(a.accessKey){A(this,this,"CTRL+"+a.accessKey,J,D);this._.accessKeyMap["CTRL+"+a.accessKey]=a.id}}},selectPage:function(a){if(this._.currentTabId!=a&&!this._.tabs[a][0].hasClass("cke_dialog_tab_disabled")&&this.fire("selectPage",{page:a,currentPage:this._.currentTabId})!==false){for(var c in this._.tabs){var d=this._.tabs[c][0],f=this._.tabs[c][1];if(c!=a){d.removeClass("cke_dialog_tab_selected");f.hide()}f.setAttribute("aria-hidden",c!=a)}var g=this._.tabs[a];g[0].addClass("cke_dialog_tab_selected");if(CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat){b(g[1]);g[1].show();setTimeout(function(){b(g[1],1)},0)}else g[1].show();this._.currentTabId=a;this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,a)}},updateStyle:function(){this.parts.dialog[(this._.pageCount===1?"add":"remove")+"Class"]("cke_single_page")},hidePage:function(b){var c=this._.tabs[b]&&this._.tabs[b][0];if(c&&this._.pageCount!=1&&c.isVisible()){b==this._.currentTabId&&this.selectPage(a.call(this));c.hide();this._.pageCount--;this.updateStyle()}},showPage:function(a){if(a=this._.tabs[a]&&this._.tabs[a][0]){a.show();this._.pageCount++;this.updateStyle()}},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(a,b){var c=this._.contents[a];return c&&c[b]},getValueOf:function(a,b){return this.getContentElement(a,b).getValue()},setValueOf:function(a,b,c){return this.getContentElement(a,b).setValue(c)},getButton:function(a){return this._.buttons[a]},click:function(a){return this._.buttons[a].click()},disableButton:function(a){return this._.buttons[a].disable()},enableButton:function(a){return this._.buttons[a].enable()},getPageCount:function(){return this._.pageCount},getParentEditor:function(){return this._.editor},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement()},addFocusable:function(a,b){if(typeof b=="undefined"){b=this._.focusList.length;this._.focusList.push(new j(this,a,b))}else{this._.focusList.splice(b,0,new j(this,a,b));for(var c=b+1;c<this._.focusList.length;c++)this._.focusList[c].focusIndex++}}};CKEDITOR.tools.extend(CKEDITOR.dialog,{add:function(a,b){if(!this._.dialogDefinitions[a]||typeof b=="function")this._.dialogDefinitions[a]=b},exists:function(a){return!!this._.dialogDefinitions[a]},getCurrent:function(){return CKEDITOR.dialog._.currentTop},isTabEnabled:function(a,b,c){a=a.config.removeDialogTabs;return!(a&&a.match(RegExp("(?:^|;)"+b+":"+c+"(?:$|;)","i")))},okButton:function(){var a=function(a,b){b=b||{};return CKEDITOR.tools.extend({id:"ok",type:"button",label:a.lang.common.ok,"class":"cke_dialog_ui_button_ok",onClick:function(a){a=a.data.dialog;a.fire("ok",{hide:true}).hide!==false&&a.hide()}},b,true)};a.type="button";a.override=function(b){return CKEDITOR.tools.extend(function(c){return a(c,b)},{type:"button"},true)};return a}(),cancelButton:function(){var a=function(a,b){b=b||{};return CKEDITOR.tools.extend({id:"cancel",type:"button",label:a.lang.common.cancel,"class":"cke_dialog_ui_button_cancel",onClick:function(a){a=a.data.dialog;a.fire("cancel",{hide:true}).hide!==false&&a.hide()}},b,true)};a.type="button";a.override=function(b){return CKEDITOR.tools.extend(function(c){return a(c,b)},{type:"button"},true)};return a}(),addUIElement:function(a,b){this._.uiElementBuilders[a]=b}});CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null};CKEDITOR.event.implementOn(CKEDITOR.dialog);CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype);var p={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]},t=function(a,b,c){for(var d=0,f;f=a[d];d++){if(f.id==b)return f;if(c&&f[c])if(f=t(f[c],b,c))return f}return null},s=function(a,b,c,d,f){if(c){for(var g=0,e;e=a[g];g++){if(e.id==c){a.splice(g,0,b);return b}if(d&&e[d])if(e=s(e[d],b,c,d,true))return e}if(f)return null}a.push(b);return b},u=function(a,b,c){for(var d=0,f;f=a[d];d++){if(f.id==b)return a.splice(d,1);if(c&&f[c])if(f=u(f[c],b,c))return f}return null},w=function(a,b){this.dialog=a;for(var c=b.contents,d=0,f;f=c[d];d++)c[d]=f&&new h(a,f);CKEDITOR.tools.extend(this,b)};w.prototype={getContents:function(a){return t(this.contents,a)},getButton:function(a){return t(this.buttons,a)},addContents:function(a,b){return s(this.contents,a,b)},addButton:function(a,b){return s(this.buttons,a,b)},removeContents:function(a){u(this.contents,a)},removeButton:function(a){u(this.buttons,a)}};h.prototype={get:function(a){return t(this.elements,a,"children")},add:function(a,b){return s(this.elements,a,b,"children")},remove:function(a){u(this.elements,a,"children")}};var x,v={},r,y={},z=function(a){var b=a.data.$.ctrlKey||a.data.$.metaKey,c=a.data.$.altKey,d=a.data.$.shiftKey,f=String.fromCharCode(a.data.$.keyCode);if((b=y[(b?"CTRL+":"")+(c?"ALT+":"")+(d?"SHIFT+":"")+
f])&&b.length){b=b[b.length-1];b.keydown&&b.keydown.call(b.uiElement,b.dialog,b.key);a.data.preventDefault()}},B=function(a){var b=a.data.$.ctrlKey||a.data.$.metaKey,c=a.data.$.altKey,d=a.data.$.shiftKey,f=String.fromCharCode(a.data.$.keyCode);if((b=y[(b?"CTRL+":"")+(c?"ALT+":"")+(d?"SHIFT+":"")+f])&&b.length){b=b[b.length-1];if(b.keyup){b.keyup.call(b.uiElement,b.dialog,b.key);a.data.preventDefault()}}},A=function(a,b,c,d,f){(y[c]||(y[c]=[])).push({uiElement:a,dialog:b,key:c,keyup:f||a.accessKeyUp,keydown:d||a.accessKeyDown})},G=function(a){for(var b in y){for(var c=y[b],d=c.length-1;d>=0;d--)(c[d].dialog==a||c[d].uiElement==a)&&c.splice(d,1);c.length===0&&delete y[b]}},D=function(a,b){a._.accessKeyMap[b]&&a.selectPage(a._.accessKeyMap[b])},J=function(){};(function(){CKEDITOR.ui.dialog={uiElement:function(a,b,c,d,f,g,e){if(!(arguments.length<4)){var h=(d.call?d(b):d)||"div",j=["<",h," "],i=(f&&f.call?f(b):f)||{},k=(g&&g.call?g(b):g)||{},p=(e&&e.call?e.call(this,a,b):e)||"",s=this.domId=k.id||CKEDITOR.tools.getNextId()+"_uiElement";if(b.requiredContent&&!a.getParentEditor().filter.check(b.requiredContent)){i.display="none";this.notAllowed=true}k.id=s;var m={};b.type&&(m["cke_dialog_ui_"+b.type]=1);b.className&&(m[b.className]=1);if(b.disabled)m.cke_disabled=1;for(var t=k["class"]&&k["class"].split?k["class"].split(" "):[],s=0;s<t.length;s++)t[s]&&(m[t[s]]=1);t=[];for(s in m)t.push(s);k["class"]=t.join(" ");if(b.title)k.title=b.title;m=(b.style||"").split(";");if(b.align){t=b.align;i["margin-left"]=t=="left"?0:"auto";i["margin-right"]=t=="right"?0:"auto"}for(s in i)m.push(s+":"+i[s]);b.hidden&&m.push("display:none");for(s=m.length-1;s>=0;s--)m[s]===""&&m.splice(s,1);if(m.length>0)k.style=(k.style?k.style+"; ":"")+m.join("; ");for(s in k)j.push(s+'="'+CKEDITOR.tools.htmlEncode(k[s])+'" ');j.push(">",p,"</",h,">");c.push(j.join(""));(this._||(this._={})).dialog=a;if(typeof b.isChanged=="boolean")this.isChanged=function(){return b.isChanged};if(typeof b.isChanged=="function")this.isChanged=b.isChanged;if(typeof b.setValue=="function")this.setValue=CKEDITOR.tools.override(this.setValue,function(a){return function(c){a.call(this,b.setValue.call(this,c))}});if(typeof b.getValue=="function")this.getValue=CKEDITOR.tools.override(this.getValue,function(a){return function(){return b.getValue.call(this,a.call(this))}});CKEDITOR.event.implementOn(this);this.registerEvents(b);this.accessKeyUp&&(this.accessKeyDown&&b.accessKey)&&A(this,a,"CTRL+"+b.accessKey);var l=this;a.on("load",function(){var b=l.getInputElement();if(b){var c=l.type in{checkbox:1,ratio:1}&&CKEDITOR.env.ie&&CKEDITOR.env.version<8?"cke_dialog_ui_focused":"";b.on("focus",function(){a._.tabBarMode=false;a._.hasFocus=true;l.fire("focus");c&&this.addClass(c)});b.on("blur",function(){l.fire("blur");c&&this.removeClass(c)})}});CKEDITOR.tools.extend(this,b);if(this.keyboardFocusable){this.tabIndex=b.tabIndex||0;this.focusIndex=a._.focusList.push(this)-1;this.on("focus",function(){a._.currentFocusIndex=l.focusIndex})}}},hbox:function(a,b,c,d,f){if(!(arguments.length<4)){this._||(this._={});var g=this._.children=b,e=f&&f.widths||null,h=f&&f.height||null,j,i={role:"presentation"};f&&f.align&&(i.align=f.align);CKEDITOR.ui.dialog.uiElement.call(this,a,f||{type:"hbox"},d,"table",{},i,function(){var a=['<tbody><tr class="cke_dialog_ui_hbox">'];for(j=0;j<c.length;j++){var b="cke_dialog_ui_hbox_child",d=[];j===0&&(b="cke_dialog_ui_hbox_first");j==c.length-1&&(b="cke_dialog_ui_hbox_last");a.push('<td class="',b,'" role="presentation" ');e?e[j]&&d.push("width:"+m(e[j])):d.push("width:"+Math.floor(100/c.length)+"%");h&&d.push("height:"+m(h));f&&f.padding!==void 0&&d.push("padding:"+m(f.padding));CKEDITOR.env.ie&&(CKEDITOR.env.quirks&&g[j].align)&&d.push("text-align:"+g[j].align);d.length>0&&a.push('style="'+d.join("; ")+'" ');a.push(">",c[j],"</td>")}a.push("</tr></tbody>");return a.join("")})}},vbox:function(a,b,c,d,f){if(!(arguments.length<3)){this._||(this._={});var g=this._.children=b,e=f&&f.width||null,h=f&&f.heights||null;CKEDITOR.ui.dialog.uiElement.call(this,a,f||{type:"vbox"},d,"div",null,{role:"presentation"},function(){var b=['<table role="presentation" cellspacing="0" border="0" '];b.push('style="');f&&f.expand&&b.push("height:100%;");b.push("width:"+m(e||"100%"),";");CKEDITOR.env.webkit&&b.push("float:none;");b.push('"');b.push('align="',CKEDITOR.tools.htmlEncode(f&&f.align||(a.getParentEditor().lang.dir=="ltr"?"left":"right")),'" ');b.push("><tbody>");for(var d=0;d<c.length;d++){var j=[];b.push('<tr><td role="presentation" ');e&&j.push("width:"+
m(e||"100%"));h?j.push("height:"+m(h[d])):f&&f.expand&&j.push("height:"+Math.floor(100/c.length)+"%");f&&f.padding!==void 0&&j.push("padding:"+m(f.padding));CKEDITOR.env.ie&&(CKEDITOR.env.quirks&&g[d].align)&&j.push("text-align:"+g[d].align);j.length>0&&b.push('style="',j.join("; "),'" ');b.push(' class="cke_dialog_ui_vbox_child">',c[d],"</td></tr>")}b.push("</tbody></table>");return b.join("")})}}}})();CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(a,b){this.getInputElement().setValue(a);!b&&this.fire("change",{value:a});return this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return false},selectParentTab:function(){for(var a=this.getInputElement();(a=a.getParent())&&a.$.className.search("cke_dialog_page_contents")==-1;);if(!a)return this;a=a.getAttribute("name");this._.dialog._.currentTabId!=a&&this._.dialog.selectPage(a);return this},focus:function(){this.selectParentTab().getInputElement().focus();return this},registerEvents:function(a){var b=/^on([A-Z]\w+)/,c,d=function(a,b,c,d){b.on("load",function(){a.getInputElement().on(c,d,a)})},f;for(f in a)if(c=f.match(b))this.eventProcessors[f]?this.eventProcessors[f].call(this,this._.dialog,a[f]):d(this,this._.dialog,c[1].toLowerCase(),a[f]);return this},eventProcessors:{onLoad:function(a,b){a.on("load",b,this)},onShow:function(a,b){a.on("show",b,this)},onHide:function(a,b){a.on("hide",b,this)}},accessKeyDown:function(){this.focus()},accessKeyUp:function(){},disable:function(){var a=this.getElement();this.getInputElement().setAttribute("disabled","true");a.addClass("cke_disabled")},enable:function(){var a=this.getElement();this.getInputElement().removeAttribute("disabled");a.removeClass("cke_disabled")},isEnabled:function(){return!this.getElement().hasClass("cke_disabled")},isVisible:function(){return this.getInputElement().isVisible()},isFocusable:function(){return!this.isEnabled()||!this.isVisible()?false:true}};CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getChild:function(a){if(arguments.length<1)return this._.children.concat();a.splice||(a=[a]);return a.length<2?this._.children[a[0]]:this._.children[a[0]]&&this._.children[a[0]].getChild?this._.children[a[0]].getChild(a.slice(1,a.length)):null}},true);CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox;(function(){var a={build:function(a,b,c){for(var d=b.children,f,g=[],e=[],h=0;h<d.length&&(f=d[h]);h++){var j=[];g.push(j);e.push(CKEDITOR.dialog._.uiElementBuilders[f.type].build(a,f,j))}return new CKEDITOR.ui.dialog[b.type](a,e,g,c,b)}};CKEDITOR.dialog.addUIElement("hbox",a);CKEDITOR.dialog.addUIElement("vbox",a)})();CKEDITOR.dialogCommand=function(a,b){this.dialogName=a;CKEDITOR.tools.extend(this,b,true)};CKEDITOR.dialogCommand.prototype={exec:function(a){a.openDialog(this.dialogName)},canUndo:false,editorFocus:1};(function(){var a=/^([a]|[^a])+$/,b=/^\d*$/,c=/^\d*(?:\.\d+)?$/,d=/^(((\d*(\.\d+))|(\d*))(px|\%)?)?$/,f=/^(((\d*(\.\d+))|(\d*))(px|em|ex|in|cm|mm|pt|pc|\%)?)?$/i,g=/^(\s*[\w-]+\s*:\s*[^:;]+(?:;|$))*$/;CKEDITOR.VALIDATE_OR=1;CKEDITOR.VALIDATE_AND=2;CKEDITOR.dialog.validate={functions:function(){var a=arguments;return function(){var b=this&&this.getValue?this.getValue():a[0],c,d=CKEDITOR.VALIDATE_AND,f=[],g;for(g=0;g<a.length;g++)if(typeof a[g]=="function")f.push(a[g]);else break;if(g<a.length&&typeof a[g]=="string"){c=a[g];g++}g<a.length&&typeof a[g]=="number"&&(d=a[g]);var e=d==CKEDITOR.VALIDATE_AND?true:false;for(g=0;g<f.length;g++)e=d==CKEDITOR.VALIDATE_AND?e&&f[g](b):e||f[g](b);return!e?c:true}},regex:function(a,b){return function(c){c=this&&this.getValue?this.getValue():c;return!a.test(c)?b:true}},notEmpty:function(b){return this.regex(a,b)},integer:function(a){return this.regex(b,a)},number:function(a){return this.regex(c,a)},cssLength:function(a){return this.functions(function(a){return f.test(CKEDITOR.tools.trim(a))},a)},htmlLength:function(a){return this.functions(function(a){return d.test(CKEDITOR.tools.trim(a))},a)},inlineStyle:function(a){return this.functions(function(a){return g.test(CKEDITOR.tools.trim(a))},a)},equals:function(a,b){return this.functions(function(b){return b==a},b)},notEqual:function(a,b){return this.functions(function(b){return b!=a},b)}};CKEDITOR.on("instanceDestroyed",function(a){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){for(var b;b=CKEDITOR.dialog._.currentTop;)b.hide();for(var c in v)v[c].remove();v={}}var a=a.editor._.storedDialogs,d;for(d in a)a[d].destroy()})})();CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(a,b){var c=null,d=CKEDITOR.dialog._.dialogDefinitions[a];CKEDITOR.dialog._.currentTop===null&&o(this);if(typeof d=="function"){c=this._.storedDialogs||(this._.storedDialogs={});c=c[a]||(c[a]=new CKEDITOR.dialog(this,a));b&&b.call(c,c);c.show()}else{if(d=="failed"){q(this);throw Error('[CKEDITOR.dialog.openDialog] Dialog "'+a+'" failed when loading definition.');}typeof d=="string"&&CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(d),function(){typeof CKEDITOR.dialog._.dialogDefinitions[a]!="function"&&(CKEDITOR.dialog._.dialogDefinitions[a]="failed");this.openDialog(a,b)},this,0,1)}CKEDITOR.skin.loadPart("dialog");return c}})}(),CKEDITOR.plugins.add("dialog",{requires:"dialogui",init:function(a){a.on("doubleclick",function(e){e.data.dialog&&a.openDialog(e.data.dialog)},null,null,999)}}),function(){CKEDITOR.plugins.add("a11yhelp",{requires:"dialog",availableLangs:{af:1,ar:1,bg:1,ca:1,cs:1,cy:1,da:1,de:1,el:1,en:1,"en-gb":1,eo:1,es:1,et:1,fa:1,fi:1,fr:1,"fr-ca":1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,it:1,ja:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,nb:1,nl:1,no:1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,sr:1,"sr-latn":1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,zh:1,"zh-cn":1},init:function(a){var e=this;a.addCommand("a11yHelp",{exec:function(){var b=a.langCode,b=e.availableLangs[b]?b:e.availableLangs[b.replace(/-.*/,"")]?b.replace(/-.*/,""):"en";CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(e.path+"dialogs/lang/"+b+".js"),function(){a.lang.a11yhelp=e.langEntries[b];a.openDialog("a11yHelp")})},modes:{wysiwyg:1,source:1},readOnly:1,canUndo:false});a.setKeystroke(CKEDITOR.ALT+48,"a11yHelp");CKEDITOR.dialog.add("a11yHelp",this.path+"dialogs/a11yhelp.js");a.on("ariaEditorHelpLabel",function(b){b.data.label=a.lang.common.editorHelp})}})}(),CKEDITOR.plugins.add("about",{requires:"dialog",init:function(a){var e=a.addCommand("about",new CKEDITOR.dialogCommand("about"));e.modes={wysiwyg:1,source:1};e.canUndo=false;e.readOnly=1;a.ui.addButton&&a.ui.addButton("About",{label:a.lang.about.title,command:"about",toolbar:"about"});CKEDITOR.dialog.add("about",this.path+"dialogs/about.js")}}),CKEDITOR.plugins.add("basicstyles",{init:function(a){var e=0,b=function(b,c,d,i){if(i){var i=new CKEDITOR.style(i),k=g[d];k.unshift(i);a.attachStyleStateChange(i,function(b){!a.readOnly&&a.getCommand(d).setState(b)});a.addCommand(d,new CKEDITOR.styleCommand(i,{contentForms:k}));a.ui.addButton&&a.ui.addButton(b,{label:c,command:d,toolbar:"basicstyles,"+(e=e+10)})}},g={bold:["strong","b",["span",function(a){a=a.styles["font-weight"];return a=="bold"||+a>=700}]],italic:["em","i",["span",function(a){return a.styles["font-style"]=="italic"}]],underline:["u",["span",function(a){return a.styles["text-decoration"]=="underline"}]],strike:["s","strike",["span",function(a){return a.styles["text-decoration"]=="line-through"}]],subscript:["sub"],superscript:["sup"]},c=a.config,d=a.lang.basicstyles;b("Bold",d.bold,"bold",c.coreStyles_bold);b("Italic",d.italic,"italic",c.coreStyles_italic);b("Underline",d.underline,"underline",c.coreStyles_underline);b("Strike",d.strike,"strike",c.coreStyles_strike);b("Subscript",d.subscript,"subscript",c.coreStyles_subscript);b("Superscript",d.superscript,"superscript",c.coreStyles_superscript);a.setKeystroke([[CKEDITOR.CTRL+66,"bold"],[CKEDITOR.CTRL+73,"italic"],[CKEDITOR.CTRL+85,"underline"]])}}),CKEDITOR.config.coreStyles_bold={element:"strong",overrides:"b"},CKEDITOR.config.coreStyles_italic={element:"em",overrides:"i"},CKEDITOR.config.coreStyles_underline={element:"u"},CKEDITOR.config.coreStyles_strike={element:"s",overrides:"strike"},CKEDITOR.config.coreStyles_subscript={element:"sub"},CKEDITOR.config.coreStyles_superscript={element:"sup"},function(){var a={exec:function(a){var b=a.getCommand("blockquote").state,g=a.getSelection(),c=g&&g.getRanges()[0];if(c){var d=g.createBookmarks();if(CKEDITOR.env.ie){var j=d[0].startNode,f=d[0].endNode,h;if(j&&j.getParent().getName()=="blockquote")for(h=j;h=h.getNext();)if(h.type==CKEDITOR.NODE_ELEMENT&&h.isBlockBoundary()){j.move(h,true);break}if(f&&f.getParent().getName()=="blockquote")for(h=f;h=h.getPrevious();)if(h.type==CKEDITOR.NODE_ELEMENT&&h.isBlockBoundary()){f.move(h);break}}var i=c.createIterator();i.enlargeBr=a.config.enterMode!=CKEDITOR.ENTER_BR;if(b==CKEDITOR.TRISTATE_OFF){for(j=[];b=i.getNextParagraph();)j.push(b);if(j.length<1){b=a.document.createElement(a.config.enterMode==CKEDITOR.ENTER_P?"p":"div");f=d.shift();c.insertNode(b);b.append(new CKEDITOR.dom.text("﻿",a.document));c.moveToBookmark(f);c.selectNodeContents(b);c.collapse(true);f=c.createBookmark();j.push(b);d.unshift(f)}h=j[0].getParent();c=[];for(f=0;f<j.length;f++){b=j[f];h=h.getCommonAncestor(b.getParent())}for(b={table:1,tbody:1,tr:1,ol:1,ul:1};b[h.getName()];)h=h.getParent();for(f=null;j.length>0;){for(b=j.shift();!b.getParent().equals(h);)b=b.getParent();b.equals(f)||c.push(b);f=b}for(;c.length>0;){b=c.shift();if(b.getName()=="blockquote"){for(f=new CKEDITOR.dom.documentFragment(a.document);b.getFirst();){f.append(b.getFirst().remove());j.push(f.getLast())}f.replace(b)}else j.push(b)}c=a.document.createElement("blockquote");for(c.insertBefore(j[0]);j.length>0;){b=j.shift();c.append(b)}}else if(b==CKEDITOR.TRISTATE_ON){f=[];for(h={};b=i.getNextParagraph();){for(j=c=null;b.getParent();){if(b.getParent().getName()=="blockquote"){c=b.getParent();j=b;break}b=b.getParent()}if(c&&j&&!j.getCustomData("blockquote_moveout")){f.push(j);CKEDITOR.dom.element.setMarker(h,j,"blockquote_moveout",true)}}CKEDITOR.dom.element.clearAllMarkers(h);b=[];j=[];for(h={};f.length>0;){i=f.shift();c=i.getParent();if(i.getPrevious())if(i.getNext()){i.breakParent(i.getParent());j.push(i.getNext())}else i.remove().insertAfter(c);else i.remove().insertBefore(c);if(!c.getCustomData("blockquote_processed")){j.push(c);CKEDITOR.dom.element.setMarker(h,c,"blockquote_processed",true)}b.push(i)}CKEDITOR.dom.element.clearAllMarkers(h);for(f=j.length-1;f>=0;f--){c=j[f];a:{h=c;for(var i=0,k=h.getChildCount(),n=void 0;i<k&&(n=h.getChild(i));i++)if(n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary()){h=false;break a}h=true}h&&c.remove()}if(a.config.enterMode==CKEDITOR.ENTER_BR)for(c=true;b.length;){i=b.shift();if(i.getName()=="div"){f=new CKEDITOR.dom.documentFragment(a.document);c&&(i.getPrevious()&&!(i.getPrevious().type==CKEDITOR.NODE_ELEMENT&&i.getPrevious().isBlockBoundary()))&&f.append(a.document.createElement("br"));for(c=i.getNext()&&!(i.getNext().type==CKEDITOR.NODE_ELEMENT&&i.getNext().isBlockBoundary());i.getFirst();)i.getFirst().remove().appendTo(f);c&&f.append(a.document.createElement("br"));f.replace(i);c=false}}}g.selectBookmarks(d);a.focus()}},refresh:function(a,b){this.setState(a.elementPath(b.block||b.blockLimit).contains("blockquote",1)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)},context:"blockquote",allowedContent:"blockquote",requiredContent:"blockquote"};CKEDITOR.plugins.add("blockquote",{init:function(e){if(!e.blockless){e.addCommand("blockquote",a);e.ui.addButton&&e.ui.addButton("Blockquote",{label:e.lang.blockquote.toolbar,command:"blockquote",toolbar:"blocks,10"})}}})}(),"use strict",function(){function a(a){function b(){var c=a.editable();c.on(y,function(a){(!CKEDITOR.env.ie||!x)&&s(a)});CKEDITOR.env.ie&&c.on("paste",function(b){if(!v){g();b.data.preventDefault();s(b);o("paste")||a.openDialog("paste")}});if(CKEDITOR.env.ie){c.on("contextmenu",e,null,null,0);c.on("beforepaste",function(a){a.data&&(!a.data.$.ctrlKey&&!a.data.$.shiftKey)&&e()},null,null,0)}c.on("beforecut",function(){!x&&m(a)});var d;c.attachListener(CKEDITOR.env.ie?c:a.document.getDocumentElement(),"mouseup",function(){d=setTimeout(function(){u()},0)});a.on("destroy",function(){clearTimeout(d)});c.on("keyup",u)}function c(b){return{type:b,canUndo:b=="cut",startDisabled:true,exec:function(){this.type=="cut"&&m();var b;var c=this.type;if(CKEDITOR.env.ie)b=o(c);else try{b=a.document.$.execCommand(c,false,null)}catch(d){b=false}b||alert(a.lang.clipboard[this.type+"Error"]);return b}}}function d(){return{canUndo:false,async:true,exec:function(a,b){var c=function(b,c){b&&q(b.type,b.dataValue,!!c);a.fire("afterCommandExec",{name:"paste",command:d,returnValue:!!b})},d=this;typeof b=="string"?c({type:"auto",dataValue:b},1):a.getClipboardData(c)}}}function g(){v=1;setTimeout(function(){v=0},100)}function e(){x=1;setTimeout(function(){x=0},10)}function o(b){var c=a.document,d=c.getBody(),f=false,g=function(){f=true};d.on(b,g);(CKEDITOR.env.version>7?c.$:c.$.selection.createRange()).execCommand(b);d.removeListener(b,g);return f}function q(b,c,d){b={type:b};if(d&&a.fire("beforePaste",b)===false||!c)return false;b.dataValue=c;return a.fire("paste",b)}function m(){if(CKEDITOR.env.ie&&!CKEDITOR.env.quirks){var b=a.getSelection(),c,d,f;if(b.getType()==CKEDITOR.SELECTION_ELEMENT&&(c=b.getSelectedElement())){d=b.getRanges()[0];f=a.document.createText("");f.insertBefore(c);d.setStartBefore(f);d.setEndAfter(c);b.selectRanges([d]);setTimeout(function(){if(c.getParent()){f.remove();b.selectElement(c)}},0)}}}function l(b,c){var d=a.document,f=a.editable(),g=function(a){a.cancel()},e;if(!d.getById("cke_pastebin")){var h=a.getSelection(),i=h.createBookmarks();CKEDITOR.env.ie&&h.root.fire("selectionchange");var k=new CKEDITOR.dom.element((CKEDITOR.env.webkit||f.is("body"))&&!CKEDITOR.env.ie?"body":"div",d);k.setAttributes({id:"cke_pastebin","data-cke-temp":"1"});var s=0,d=d.getWindow();if(CKEDITOR.env.webkit){f.append(k);k.addClass("cke_editable");if(!f.is("body")){s=f.getComputedStyle("position")!="static"?f:CKEDITOR.dom.element.get(f.$.offsetParent);s=s.getDocumentPosition().y}}else f.getAscendant(CKEDITOR.env.ie?"body":"html",1).append(k);k.setStyles({position:"absolute",top:d.getScrollPosition().y-s+10+"px",width:"1px",height:Math.max(1,d.getViewPaneSize().height-20)+"px",overflow:"hidden",margin:0,padding:0});CKEDITOR.env.safari&&k.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","text"));if(s=k.getParent().isReadOnly()){k.setOpacity(0);k.setAttribute("contenteditable",true)}else k.setStyle(a.config.contentsLangDirection=="ltr"?"left":"right","-1000px");a.on("selectionChange",g,null,null,0);if(CKEDITOR.env.webkit||CKEDITOR.env.gecko)e=f.once("blur",g,null,null,-100);s&&k.focus();s=new CKEDITOR.dom.range(k);s.selectNodeContents(k);var p=s.select();CKEDITOR.env.ie&&(e=f.once("blur",function(){a.lockSelection(p)}));var m=CKEDITOR.document.getWindow().getScrollPosition().y;setTimeout(function(){if(CKEDITOR.env.webkit)CKEDITOR.document.getBody().$.scrollTop=m;e&&e.removeListener();CKEDITOR.env.ie&&f.focus();h.selectBookmarks(i);k.remove();var b;if(CKEDITOR.env.webkit&&(b=k.getFirst())&&b.is&&b.hasClass("Apple-style-span"))k=b;a.removeListener("selectionChange",g);c(k.getHtml())},0)}}function p(){if(CKEDITOR.env.ie){a.focus();g();var b=a.focusManager;b.lock();if(a.editable().fire(y)&&!o("paste")){b.unlock();return false}b.unlock()}else try{if(a.editable().fire(y)&&!a.document.$.execCommand("Paste",false,null))throw 0;}catch(c){return false}return true}function t(b){if(a.mode=="wysiwyg")switch(b.data.keyCode){case CKEDITOR.CTRL+86:case CKEDITOR.SHIFT+45:b=a.editable();g();!CKEDITOR.env.ie&&b.fire("beforepaste");break;case CKEDITOR.CTRL+88:case CKEDITOR.SHIFT+46:a.fire("saveSnapshot");setTimeout(function(){a.fire("saveSnapshot")},50)}}function s(b){var c={type:"auto"},d=a.fire("beforePaste",c);l(b,function(a){a=a.replace(/<span[^>]+data-cke-bookmark[^<]*?<\/span>/ig,"");d&&q(c.type,a,0,1)})}function u(){if(a.mode=="wysiwyg"){var b=w("paste");a.getCommand("cut").setState(w("cut"));a.getCommand("copy").setState(w("copy"));a.getCommand("paste").setState(b);a.fire("pasteState",b)}}function w(b){if(r&&b in{paste:1,cut:1})return CKEDITOR.TRISTATE_DISABLED;if(b=="paste")return CKEDITOR.TRISTATE_OFF;var b=a.getSelection(),c=b.getRanges();return b.getType()==CKEDITOR.SELECTION_NONE||c.length==1&&c[0].collapsed?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_OFF}var x=0,v=0,r=0,y=CKEDITOR.env.ie?"beforepaste":"paste";(function(){a.on("key",t);a.on("contentDom",b);a.on("selectionChange",function(a){r=a.data.selection.getRanges()[0].checkReadOnly();u()});a.contextMenu&&a.contextMenu.addListener(function(a,b){r=b.getRanges()[0].checkReadOnly();return{cut:w("cut"),copy:w("copy"),paste:w("paste")}})})();(function(){function b(c,d,f,g,e){var h=a.lang.clipboard[d];a.addCommand(d,f);a.ui.addButton&&a.ui.addButton(c,{label:h,command:d,toolbar:"clipboard,"+g});a.addMenuItems&&a.addMenuItem(d,{label:h,command:d,group:"clipboard",order:e})}b("Cut","cut",c("cut"),10,1);b("Copy","copy",c("copy"),20,4);b("Paste","paste",d(),30,8)})();a.getClipboardData=function(b,c){function d(a){a.removeListener();a.cancel();c(a.data)}function f(a){a.removeListener();a.cancel();i=true;c({type:h,dataValue:a.data})}function g(){this.customTitle=b&&b.title}var e=false,h="auto",i=false;if(!c){c=b;b=null}a.on("paste",d,null,null,0);a.on("beforePaste",function(a){a.removeListener();e=true;h=a.data.type},null,null,1E3);if(p()===false){a.removeListener("paste",d);if(e&&a.fire("pasteDialog",g)){a.on("pasteDialogCommit",f);a.on("dialogHide",function(a){a.removeListener();a.data.removeListener("pasteDialogCommit",f);setTimeout(function(){i||c(null)},10)})}else c(null)}}}
function e(a){if(CKEDITOR.env.webkit){if(!a.match(/^[^<]*$/g)&&!a.match(/^(<div><br( ?\/)?><\/div>|<div>[^<]*<\/div>)*$/gi))return"html"}else if(CKEDITOR.env.ie){if(!a.match(/^([^<]|<br( ?\/)?>)*$/gi)&&!a.match(/^(<p>([^<]|<br( ?\/)?>)*<\/p>|(\r\n))*$/gi))return"html"}else if(CKEDITOR.env.gecko){if(!a.match(/^([^<]|<br( ?\/)?>)*$/gi))return"html"}else return"html";return"htmlifiedtext"}function b(a,b){function c(a){return CKEDITOR.tools.repeat("</p><p>",~~(a/2))+(a%2==1?"<br>":"")}b=b.replace(/\s+/g," ").replace(/> +</g,"><").replace(/<br ?\/>/gi,"<br>");b=b.replace(/<\/?[A-Z]+>/g,function(a){return a.toLowerCase()});if(b.match(/^[^<]$/))return b;if(CKEDITOR.env.webkit&&b.indexOf("<div>")>-1){b=b.replace(/^(<div>(<br>|)<\/div>)(?!$|(<div>(<br>|)<\/div>))/g,"<br>").replace(/^(<div>(<br>|)<\/div>){2}(?!$)/g,"<div></div>");b.match(/<div>(<br>|)<\/div>/)&&(b="<p>"+b.replace(/(<div>(<br>|)<\/div>)+/g,function(a){return c(a.split("</div><div>").length+1)})+"</p>");b=b.replace(/<\/div><div>/g,"<br>");b=b.replace(/<\/?div>/g,"")}if(CKEDITOR.env.gecko&&a.enterMode!=CKEDITOR.ENTER_BR){CKEDITOR.env.gecko&&(b=b.replace(/^<br><br>$/,"<br>"));b.indexOf("<br><br>")>-1&&(b="<p>"+b.replace(/(<br>){2,}/g,function(a){return c(a.length/4)})+"</p>")}return d(a,b)}function g(){var a=new CKEDITOR.htmlParser.filter,b={blockquote:1,dl:1,fieldset:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ol:1,p:1,table:1,ul:1},c=CKEDITOR.tools.extend({br:0},CKEDITOR.dtd.$inline),d={p:1,br:1,"cke:br":1},g=CKEDITOR.dtd,e=CKEDITOR.tools.extend({area:1,basefont:1,embed:1,iframe:1,map:1,object:1,param:1},CKEDITOR.dtd.$nonBodyContent,CKEDITOR.dtd.$cdata),o=function(a){delete a.name;a.add(new CKEDITOR.htmlParser.text(" "))},q=function(a){for(var b=a,c;(b=b.next)&&b.name&&b.name.match(/^h\d$/);){c=new CKEDITOR.htmlParser.element("cke:br");c.isEmpty=true;for(a.add(c);c=b.children.shift();)a.add(c)}};a.addRules({elements:{h1:q,h2:q,h3:q,h4:q,h5:q,h6:q,img:function(a){var a=CKEDITOR.tools.trim(a.attributes.alt||""),b=" ";a&&!a.match(/(^http|\.(jpe?g|gif|png))/i)&&(b=" ["+a+"] ");return new CKEDITOR.htmlParser.text(b)},td:o,th:o,$:function(a){var j=a.name,p;if(e[j])return false;a.attributes={};if(j=="br")return a;if(b[j])a.name="p";else if(c[j])delete a.name;else if(g[j]){p=new CKEDITOR.htmlParser.element("cke:br");p.isEmpty=true;if(CKEDITOR.dtd.$empty[j])return p;a.add(p,0);p=p.clone();p.isEmpty=true;a.add(p);delete a.name}d[a.name]||delete a.name;return a}}},{applyToAll:true});return a}function c(a,b,c){var b=new CKEDITOR.htmlParser.fragment.fromHtml(b),g=new CKEDITOR.htmlParser.basicWriter;b.writeHtml(g,c);var b=g.getHtml(),b=b.replace(/\s*(<\/?[a-z:]+ ?\/?>)\s*/g,"$1").replace(/(<cke:br \/>){2,}/g,"<cke:br />").replace(/(<cke:br \/>)(<\/?p>|<br \/>)/g,"$2").replace(/(<\/?p>|<br \/>)(<cke:br \/>)/g,"$1").replace(/<(cke:)?br( \/)?>/g,"<br>").replace(/<p><\/p>/g,""),e=0,b=b.replace(/<\/?p>/g,function(a){if(a=="<p>"){if(++e>1)return"</p><p>"}else if(--e>0)return"</p><p>";return a}).replace(/<p><\/p>/g,"");return d(a,b)}function d(a,b){a.enterMode==CKEDITOR.ENTER_BR?b=b.replace(/(<\/p><p>)+/g,function(a){return CKEDITOR.tools.repeat("<br>",a.length/7*2)}).replace(/<\/?p>/g,""):a.enterMode==CKEDITOR.ENTER_DIV&&(b=b.replace(/<(\/)?p>/g,"<$1div>"));return b}CKEDITOR.plugins.add("clipboard",{requires:"dialog",init:function(d){var f;a(d);CKEDITOR.dialog.add("paste",CKEDITOR.getUrl(this.path+"dialogs/paste.js"));d.on("paste",function(a){var b=a.data.dataValue,c=CKEDITOR.dtd.$block;if(b.indexOf("Apple-")>-1){b=b.replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," ");a.data.type!="html"&&(b=b.replace(/<span class="Apple-tab-span"[^>]*>([^<]*)<\/span>/gi,function(a,b){return b.replace(/\t/g,"&nbsp;&nbsp; &nbsp;")}));if(b.indexOf('<br class="Apple-interchange-newline">')>-1){a.data.startsWithEOL=1;a.data.preSniffing="html";b=b.replace(/<br class="Apple-interchange-newline">/,"")}b=b.replace(/(<[^>]+) class="Apple-[^"]*"/gi,"$1")}if(b.match(/^<[^<]+cke_(editable|contents)/i)){var d,f,g=new CKEDITOR.dom.element("div");for(g.setHtml(b);g.getChildCount()==1&&(d=g.getFirst())&&d.type==CKEDITOR.NODE_ELEMENT&&(d.hasClass("cke_editable")||d.hasClass("cke_contents"));)g=f=d;f&&(b=f.getHtml().replace(/<br>$/i,""))}CKEDITOR.env.ie?b=b.replace(/^&nbsp;(?: |\r\n)?<(\w+)/g,function(b,d){if(d.toLowerCase()in c){a.data.preSniffing="html";return"<"+d}return b}):CKEDITOR.env.webkit?b=b.replace(/<\/(\w+)><div><br><\/div>$/,function(b,d){if(d in c){a.data.endsWithEOL=1;return"</"+d+">"}return b}):CKEDITOR.env.gecko&&(b=b.replace(/(\s)<br>$/,"$1"));a.data.dataValue=b},null,null,3);d.on("paste",function(a){var a=a.data,i=a.type,k=a.dataValue,n,o=d.config.clipboard_defaultContentType||"html";n=i=="html"||a.preSniffing=="html"?"html":e(k);n=="htmlifiedtext"?k=b(d.config,k):i=="text"&&n=="html"&&(k=c(d.config,k,f||(f=g(d))));a.startsWithEOL&&(k='<br data-cke-eol="1">'+k);a.endsWithEOL&&(k=k+'<br data-cke-eol="1">');i=="auto"&&(i=n=="html"||o=="html"?"html":"text");a.type=i;a.dataValue=k;delete a.preSniffing;delete a.startsWithEOL;delete a.endsWithEOL},null,null,6);d.on("paste",function(a){a=a.data;d.insertHtml(a.dataValue,a.type);setTimeout(function(){d.fire("afterPaste")},0)},null,null,1E3);d.on("pasteDialog",function(a){setTimeout(function(){d.openDialog("paste",a.data)},0)})}})}(),function(){CKEDITOR.plugins.add("panel",{beforeInit:function(a){a.ui.addHandler(CKEDITOR.UI_PANEL,CKEDITOR.ui.panel.handler)}});CKEDITOR.UI_PANEL="panel";CKEDITOR.ui.panel=function(a,b){b&&CKEDITOR.tools.extend(this,b);CKEDITOR.tools.extend(this,{className:"",css:[]});this.id=CKEDITOR.tools.getNextId();this.document=a;this.isFramed=this.forceIFrame||this.css.length;this._={blocks:{}}};CKEDITOR.ui.panel.handler={create:function(a){return new CKEDITOR.ui.panel(a)}};var a=CKEDITOR.addTemplate("panel",'<div lang="{langCode}" id="{id}" dir={dir} class="cke cke_reset_all {editorId} cke_panel cke_panel {cls} cke_{dir}" style="z-index:{z-index}" role="presentation">{frame}</div>'),e=CKEDITOR.addTemplate("panel-frame",'<iframe id="{id}" class="cke_panel_frame" role="presentation" frameborder="0" src="{src}"></iframe>'),b=CKEDITOR.addTemplate("panel-frame-inner",'<!DOCTYPE html><html class="cke_panel_container {env}" dir="{dir}" lang="{langCode}"><head>{css}</head><body class="cke_{dir}" style="margin:0;padding:0" onload="{onload}"></body></html>');CKEDITOR.ui.panel.prototype={render:function(g,c){this.getHolderElement=function(){var a=this._.holder;if(!a){if(this.isFramed){var a=this.document.getById(this.id+"_frame"),c=a.getParent(),a=a.getFrameDocument();CKEDITOR.env.iOS&&c.setStyles({overflow:"scroll","-webkit-overflow-scrolling":"touch"});c=CKEDITOR.tools.addFunction(CKEDITOR.tools.bind(function(){this.isLoaded=true;if(this.onLoad)this.onLoad()},this));a.write(b.output(CKEDITOR.tools.extend({css:CKEDITOR.tools.buildStyleHtml(this.css),onload:"window.parent.CKEDITOR.tools.callFunction("+c+");"},d)));a.getWindow().$.CKEDITOR=CKEDITOR;a.on("keydown",function(a){var b=a.data.getKeystroke(),c=this.document.getById(this.id).getAttribute("dir");this._.onKeyDown&&this._.onKeyDown(b)===false?a.data.preventDefault():(b==27||b==(c=="rtl"?39:37))&&this.onEscape&&this.onEscape(b)===false&&a.data.preventDefault()},this);a=a.getBody();a.unselectable();CKEDITOR.env.air&&CKEDITOR.tools.callFunction(c)}else a=this.document.getById(this.id);this._.holder=a}return a};var d={editorId:g.id,id:this.id,langCode:g.langCode,dir:g.lang.dir,cls:this.className,frame:"",env:CKEDITOR.env.cssClass,"z-index":g.config.baseFloatZIndex+1};if(this.isFramed){var j=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie?"javascript:void(function(){"+encodeURIComponent("document.open();("+
CKEDITOR.tools.fixDomain+")();document.close();")+"}())":"";d.frame=e.output({id:this.id+"_frame",src:j})}j=a.output(d);c&&c.push(j);return j},addBlock:function(a,b){b=this._.blocks[a]=b instanceof CKEDITOR.ui.panel.block?b:new CKEDITOR.ui.panel.block(this.getHolderElement(),b);this._.currentBlock||this.showBlock(a);return b},getBlock:function(a){return this._.blocks[a]},showBlock:function(a){var a=this._.blocks[a],b=this._.currentBlock,d=!this.forceIFrame||CKEDITOR.env.ie?this._.holder:this.document.getById(this.id+"_frame");b&&b.hide();this._.currentBlock=a;CKEDITOR.fire("ariaWidget",d);a._.focusIndex=-1;this._.onKeyDown=a.onKeyDown&&CKEDITOR.tools.bind(a.onKeyDown,a);a.show();return a},destroy:function(){this.element&&this.element.remove()}};CKEDITOR.ui.panel.block=CKEDITOR.tools.createClass({$:function(a,b){this.element=a.append(a.getDocument().createElement("div",{attributes:{tabindex:-1,"class":"cke_panel_block"},styles:{display:"none"}}));b&&CKEDITOR.tools.extend(this,b);this.element.setAttributes({role:this.attributes.role||"presentation","aria-label":this.attributes["aria-label"],title:this.attributes.title||this.attributes["aria-label"]});this.keys={};this._.focusIndex=-1;this.element.disableContextMenu()},_:{markItem:function(a){if(a!=-1){a=this.element.getElementsByTag("a").getItem(this._.focusIndex=a);CKEDITOR.env.webkit&&a.getDocument().getWindow().focus();a.focus();this.onMark&&this.onMark(a)}}},proto:{show:function(){this.element.setStyle("display","")},hide:function(){(!this.onHide||this.onHide.call(this)!==true)&&this.element.setStyle("display","none")},onKeyDown:function(a,b){var d=this.keys[a];switch(d){case"next":for(var e=this._.focusIndex,d=this.element.getElementsByTag("a"),f;f=d.getItem(++e);)if(f.getAttribute("_cke_focus")&&f.$.offsetWidth){this._.focusIndex=e;f.focus();break}if(!f&&!b){this._.focusIndex=-1;return this.onKeyDown(a,1)}return false;case"prev":e=this._.focusIndex;for(d=this.element.getElementsByTag("a");e>0&&(f=d.getItem(--e));){if(f.getAttribute("_cke_focus")&&f.$.offsetWidth){this._.focusIndex=e;f.focus();break}f=null}if(!f&&!b){this._.focusIndex=d.count();return this.onKeyDown(a,1)}return false;case"click":case"mouseup":e=this._.focusIndex;(f=e>=0&&this.element.getElementsByTag("a").getItem(e))&&(f.$[d]?f.$[d]():f.$["on"+d]());return false}return true}}})}(),CKEDITOR.plugins.add("floatpanel",{requires:"panel"}),function(){function a(a,g,c,d,j){var j=CKEDITOR.tools.genKey(g.getUniqueId(),c.getUniqueId(),a.lang.dir,a.uiColor||"",d.css||"",j||""),f=e[j];if(!f){f=e[j]=new CKEDITOR.ui.panel(g,d);f.element=c.append(CKEDITOR.dom.element.createFromHtml(f.render(a),g));f.element.setStyles({display:"none",position:"absolute"})}return f}var e={};CKEDITOR.ui.floatPanel=CKEDITOR.tools.createClass({$:function(b,g,c,d){function e(){k.hide()}c.forceIFrame=1;c.toolbarRelated&&b.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&(g=CKEDITOR.document.getById("cke_"+b.name));var f=g.getDocument(),d=a(b,f,g,c,d||0),h=d.element,i=h.getFirst(),k=this;h.disableContextMenu();this.element=h;this._={editor:b,panel:d,parentElement:g,definition:c,document:f,iframe:i,children:[],dir:b.lang.dir};b.on("mode",e);b.on("resize",e);if(!CKEDITOR.env.iOS)f.getWindow().on("resize",e)},proto:{addBlock:function(a,g){return this._.panel.addBlock(a,g)},addListBlock:function(a,g){return this._.panel.addListBlock(a,g)},getBlock:function(a){return this._.panel.getBlock(a)},showBlock:function(a,g,c,d,e,f){var h=this._.panel,i=h.showBlock(a);this.allowBlur(false);a=this._.editor.editable();this._.returnFocus=a.hasFocus?a:new CKEDITOR.dom.element(CKEDITOR.document.$.activeElement);this._.hideTimeout=0;var k=this.element,a=this._.iframe,a=CKEDITOR.env.ie?a:new CKEDITOR.dom.window(a.$.contentWindow),n=k.getDocument(),o=this._.parentElement.getPositionedAncestor(),q=g.getDocumentPosition(n),n=o?o.getDocumentPosition(n):{x:0,y:0},m=this._.dir=="rtl",l=q.x+(d||0)-n.x,p=q.y+(e||0)-n.y;if(m&&(c==1||c==4))l=l+g.$.offsetWidth;else if(!m&&(c==2||c==3))l=l+(g.$.offsetWidth-1);if(c==3||c==4)p=p+(g.$.offsetHeight-1);this._.panel._.offsetParentId=g.getId();k.setStyles({top:p+"px",left:0,display:""});k.setOpacity(0);k.getFirst().removeStyle("width");this._.editor.focusManager.add(a);if(!this._.blurSet){CKEDITOR.event.useCapture=true;a.on("blur",function(a){function b(){delete this._.returnFocus;this.hide()}if(this.allowBlur()&&a.data.getPhase()==CKEDITOR.EVENT_PHASE_AT_TARGET&&this.visible&&!this._.activeChild)if(CKEDITOR.env.iOS){if(!this._.hideTimeout)this._.hideTimeout=CKEDITOR.tools.setTimeout(b,0,this)}else b.call(this)},this);a.on("focus",function(){this._.focused=true;this.hideChild();this.allowBlur(true)},this);if(CKEDITOR.env.iOS){a.on("touchstart",function(){clearTimeout(this._.hideTimeout)},this);a.on("touchend",function(){this._.hideTimeout=0;this.focus()},this)}CKEDITOR.event.useCapture=false;this._.blurSet=1}h.onEscape=CKEDITOR.tools.bind(function(a){if(this.onEscape&&this.onEscape(a)===false)return false},this);CKEDITOR.tools.setTimeout(function(){var a=CKEDITOR.tools.bind(function(){k.removeStyle("width");if(i.autoSize){var a=i.element.getDocument(),a=(CKEDITOR.env.webkit?i.element:a.getBody()).$.scrollWidth;CKEDITOR.env.ie&&(CKEDITOR.env.quirks&&a>0)&&(a=a+((k.$.offsetWidth||0)-(k.$.clientWidth||0)+3));k.setStyle("width",a+10+"px");a=i.element.$.scrollHeight;CKEDITOR.env.ie&&(CKEDITOR.env.quirks&&a>0)&&(a=a+((k.$.offsetHeight||0)-(k.$.clientHeight||0)+3));k.setStyle("height",a+"px");h._.currentBlock.element.setStyle("display","none").removeStyle("display")}else k.removeStyle("height");m&&(l=l-k.$.offsetWidth);k.setStyle("left",l+"px");var b=h.element.getWindow(),a=k.$.getBoundingClientRect(),b=b.getViewPaneSize(),c=a.width||a.right-a.left,d=a.height||a.bottom-a.top,g=m?a.right:b.width-a.left,e=m?b.width-a.right:a.left;m?g<c&&(l=e>c?l+c:b.width>c?l-a.left:l-a.right+b.width):g<c&&(l=e>c?l-c:b.width>c?l-a.right+b.width:l-a.left);c=a.top;b.height-a.top<d&&(p=c>d?p-d:b.height>d?p-a.bottom+b.height:p-a.top);if(CKEDITOR.env.ie){b=a=new CKEDITOR.dom.element(k.$.offsetParent);b.getName()=="html"&&(b=b.getDocument().getBody());b.getComputedStyle("direction")=="rtl"&&(l=CKEDITOR.env.ie8Compat?l-k.getDocument().getDocumentElement().$.scrollLeft*2:l-(a.$.scrollWidth-a.$.clientWidth))}var a=k.getFirst(),j;(j=a.getCustomData("activePanel"))&&j.onHide&&j.onHide.call(this,1);a.setCustomData("activePanel",this);k.setStyles({top:p+"px",left:l+"px"});k.setOpacity(1);f&&f()},this);h.isLoaded?a():h.onLoad=a;CKEDITOR.tools.setTimeout(function(){var a=CKEDITOR.env.webkit&&CKEDITOR.document.getWindow().getScrollPosition().y;this.focus();i.element.focus();if(CKEDITOR.env.webkit)CKEDITOR.document.getBody().$.scrollTop=a;this.allowBlur(true);this._.editor.fire("panelShow",this)},0,this)},CKEDITOR.env.air?200:0,this);this.visible=1;this.onShow&&this.onShow.call(this)},focus:function(){if(CKEDITOR.env.webkit){var a=CKEDITOR.document.getActive();a&&!a.equals(this._.iframe)&&a.$.blur()}(this._.lastFocused||this._.iframe.getFrameDocument().getWindow()).focus()},blur:function(){var a=this._.iframe.getFrameDocument().getActive();a&&a.is("a")&&(this._.lastFocused=a)},hide:function(a){if(this.visible&&(!this.onHide||this.onHide.call(this)!==true)){this.hideChild();CKEDITOR.env.gecko&&this._.iframe.getFrameDocument().$.activeElement.blur();this.element.setStyle("display","none");this.visible=0;this.element.getFirst().removeCustomData("activePanel");if(a=a&&this._.returnFocus){CKEDITOR.env.webkit&&a.type&&a.getWindow().$.focus();a.focus()}delete this._.lastFocused;this._.editor.fire("panelHide",this)}},allowBlur:function(a){var g=this._.panel;if(a!==void 0)g.allowBlur=a;return g.allowBlur},showAsChild:function(a,g,c,d,e,f){if(!(this._.activeChild==a&&a._.panel._.offsetParentId==c.getId())){this.hideChild();a.onHide=CKEDITOR.tools.bind(function(){CKEDITOR.tools.setTimeout(function(){this._.focused||this.hide()},0,this)},this);this._.activeChild=a;this._.focused=false;a.showBlock(g,c,d,e,f);this.blur();(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)&&setTimeout(function(){a.element.getChild(0).$.style.cssText+=""},100)}},hideChild:function(a){var g=this._.activeChild;if(g){delete g.onHide;delete this._.activeChild;g.hide();a&&this.focus()}}}});CKEDITOR.on("instanceDestroyed",function(){var a=CKEDITOR.tools.isEmpty(CKEDITOR.instances),g;for(g in e){var c=e[g];a?c.destroy():c.element.hide()}a&&(e={})})}(),CKEDITOR.plugins.add("menu",{requires:"floatpanel",beforeInit:function(a){for(var e=a.config.menu_groups.split(","),b=a._.menuGroups={},g=a._.menuItems={},c=0;c<e.length;c++)b[e[c]]=c+1;a.addMenuGroup=function(a,c){b[a]=c||100};a.addMenuItem=function(a,c){b[c.group]&&(g[a]=new CKEDITOR.menuItem(this,a,c))};a.addMenuItems=function(a){for(var b in a)this.addMenuItem(b,a[b])};a.getMenuItem=function(a){return g[a]};a.removeMenuItem=function(a){delete g[a]}}}),function(){function a(a){a.sort(function(a,b){return a.group<b.group?-1:a.group>b.group?1:a.order<b.order?-1:a.order>b.order?1:0})}var e='<span class="cke_menuitem"><a id="{id}" class="cke_menubutton cke_menubutton__{name} cke_menubutton_{state} {cls}" href="{href}" title="{title}" tabindex="-1"_cke_focus=1 hidefocus="true" role="{role}" aria-haspopup="{hasPopup}" aria-disabled="{disabled}" {ariaChecked}';CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(e=e+' onkeypress="return false;"');CKEDITOR.env.gecko&&(e=e+' onblur="this.style.cssText = this.style.cssText;"');var e=e+(' onmouseover="CKEDITOR.tools.callFunction({hoverFn},{index});" onmouseout="CKEDITOR.tools.callFunction({moveOutFn},{index});" '+(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction({clickFn},{index}); return false;">'),b=CKEDITOR.addTemplate("menuItem",e+'<span class="cke_menubutton_inner"><span class="cke_menubutton_icon"><span class="cke_button_icon cke_button__{iconName}_icon" style="{iconStyle}"></span></span><span class="cke_menubutton_label">{label}</span>{arrowHtml}</span></a></span>'),g=CKEDITOR.addTemplate("menuArrow",'<span class="cke_menuarrow"><span>{label}</span></span>');CKEDITOR.menu=CKEDITOR.tools.createClass({$:function(a,b){b=this._.definition=b||{};this.id=CKEDITOR.tools.getNextId();this.editor=a;this.items=[];this._.listeners=[];this._.level=b.level||1;var g=CKEDITOR.tools.extend({},b.panel,{css:[CKEDITOR.skin.getPath("editor")],level:this._.level-1,block:{}}),f=g.block.attributes=g.attributes||{};!f.role&&(f.role="menu");this._.panelDefinition=g},_:{onShow:function(){var a=this.editor.getSelection(),b=a&&a.getStartElement(),g=this.editor.elementPath(),f=this._.listeners;this.removeAll();for(var e=0;e<f.length;e++){var i=f[e](b,a,g);if(i)for(var k in i){var n=this.editor.getMenuItem(k);if(n&&(!n.command||this.editor.getCommand(n.command).state)){n.state=i[k];this.add(n)}}}},onClick:function(a){this.hide();if(a.onClick)a.onClick();else a.command&&this.editor.execCommand(a.command)},onEscape:function(a){var b=this.parent;b?b._.panel.hideChild(1):a==27&&this.hide(1);return false},onHide:function(){this.onHide&&this.onHide()},showSubMenu:function(a){var b=this._.subMenu,g=this.items[a];if(g=g.getItems&&g.getItems()){if(b)b.removeAll();else{b=this._.subMenu=new CKEDITOR.menu(this.editor,CKEDITOR.tools.extend({},this._.definition,{level:this._.level+1},true));b.parent=this;b._.onClick=CKEDITOR.tools.bind(this._.onClick,this)}for(var f in g){var e=this.editor.getMenuItem(f);if(e){e.state=g[f];b.add(e)}}var i=this._.panel.getBlock(this.id).element.getDocument().getById(this.id+
(""+a));setTimeout(function(){b.show(i,2)},0)}else this._.panel.hideChild(1)}},proto:{add:function(a){if(!a.order)a.order=this.items.length;this.items.push(a)},removeAll:function(){this.items=[]},show:function(b,d,g,f){if(!this.parent){this._.onShow();if(!this.items.length)return}var d=d||(this.editor.lang.dir=="rtl"?2:1),e=this.items,i=this.editor,k=this._.panel,n=this._.element;if(!k){k=this._.panel=new CKEDITOR.ui.floatPanel(this.editor,CKEDITOR.document.getBody(),this._.panelDefinition,this._.level);k.onEscape=CKEDITOR.tools.bind(function(a){if(this._.onEscape(a)===false)return false},this);k.onShow=function(){k._.panel.getHolderElement().getParent().addClass("cke cke_reset_all")};k.onHide=CKEDITOR.tools.bind(function(){this._.onHide&&this._.onHide()},this);n=k.addBlock(this.id,this._.panelDefinition.block);n.autoSize=true;var o=n.keys;o[40]="next";o[9]="next";o[38]="prev";o[CKEDITOR.SHIFT+9]="prev";o[i.lang.dir=="rtl"?37:39]=CKEDITOR.env.ie?"mouseup":"click";o[32]=CKEDITOR.env.ie?"mouseup":"click";CKEDITOR.env.ie&&(o[13]="mouseup");n=this._.element=n.element;o=n.getDocument();o.getBody().setStyle("overflow","hidden");o.getElementsByTag("html").getItem(0).setStyle("overflow","hidden");this._.itemOverFn=CKEDITOR.tools.addFunction(function(a){clearTimeout(this._.showSubTimeout);this._.showSubTimeout=CKEDITOR.tools.setTimeout(this._.showSubMenu,i.config.menu_subMenuDelay||400,this,[a])},this);this._.itemOutFn=CKEDITOR.tools.addFunction(function(){clearTimeout(this._.showSubTimeout)},this);this._.itemClickFn=CKEDITOR.tools.addFunction(function(a){var b=this.items[a];if(b.state==CKEDITOR.TRISTATE_DISABLED)this.hide(1);else if(b.getItems)this._.showSubMenu(a);else this._.onClick(b)},this)}a(e);for(var o=i.elementPath(),o=['<div class="cke_menu'+(o&&o.direction()!=i.lang.dir?" cke_mixed_dir_content":"")+'" role="presentation">'],q=e.length,m=q&&e[0].group,l=0;l<q;l++){var p=e[l];if(m!=p.group){o.push('<div class="cke_menuseparator" role="separator"></div>');m=p.group}p.render(this,l,o)}o.push("</div>");n.setHtml(o.join(""));CKEDITOR.ui.fire("ready",this);this.parent?this.parent._.panel.showAsChild(k,this.id,b,d,g,f):k.showBlock(this.id,b,d,g,f);i.fire("menuShow",[k])},addListener:function(a){this._.listeners.push(a)},hide:function(a){this._.onHide&&this._.onHide();this._.panel&&this._.panel.hide(a)}}});CKEDITOR.menuItem=CKEDITOR.tools.createClass({$:function(a,b,g){CKEDITOR.tools.extend(this,g,{order:0,className:"cke_menubutton__"+b});this.group=a._.menuGroups[this.group];this.editor=a;this.name=b},proto:{render:function(a,d,e){var f=a.id+(""+d),h=typeof this.state=="undefined"?CKEDITOR.TRISTATE_OFF:this.state,i="",k=h==CKEDITOR.TRISTATE_ON?"on":h==CKEDITOR.TRISTATE_DISABLED?"disabled":"off";this.role in{menuitemcheckbox:1,menuitemradio:1}&&(i=' aria-checked="'+(h==CKEDITOR.TRISTATE_ON?"true":"false")+'"');var n=this.getItems,o="&#"+(this.editor.lang.dir=="rtl"?"9668":"9658")+";",q=this.name;if(this.icon&&!/\./.test(this.icon))q=this.icon;a={id:f,name:this.name,iconName:q,label:this.label,cls:this.className||"",state:k,hasPopup:n?"true":"false",disabled:h==CKEDITOR.TRISTATE_DISABLED,title:this.label,href:"javascript:void('"+(this.label||"").replace("'")+"')",hoverFn:a._.itemOverFn,moveOutFn:a._.itemOutFn,clickFn:a._.itemClickFn,index:d,iconStyle:CKEDITOR.skin.getIconStyle(q,this.editor.lang.dir=="rtl",q==this.icon?null:this.icon,this.iconOffset),arrowHtml:n?g.output({label:o}):"",role:this.role?this.role:"menuitem",ariaChecked:i};b.output(a,e)}}})}(),CKEDITOR.config.menu_groups="clipboard,form,tablecell,tablecellproperties,tablerow,tablecolumn,table,anchor,link,image,flash,checkbox,radio,textfield,hiddenfield,imagebutton,button,select,textarea,div",CKEDITOR.plugins.add("contextmenu",{requires:"menu",onLoad:functio n(){CKEDITOR.plugins.contextMenu=CKEDITOR.tools.createClass({base:CKEDITOR.menu,$:function(a){this.base.call(this,a,{panel:{className:"cke_menu_panel",attributes:{"aria-label":a.lang.contextmenu.options}}})},proto:{addTarget:function(a,e){a.on("contextmenu",function(a){var a=a.data,d=CKEDITOR.env.webkit?b:CKEDITOR.env.mac?a.$.metaKey:a.$.ctrlKey;if(!e||!d){a.preventDefault();if(CKEDITOR.env.mac&&CKEDITOR.env.webkit){var d=this.editor,g=(new CKEDITOR.dom.elementPath(a.getTarget(),d.editable())).contains(function(a){return a.hasAttribute("contenteditable")},true);g&&g.getAttribute("contenteditable")=="false"&&d.getSelection().fake(g)}var g=a.getTarget().getDocument(),f=a.getTarget().getDocument().getDocumentElement(),d=!g.equals(CKEDITOR.document),g=g.getWindow().getScrollPosition(),h=d?a.$.clientX:a.$.pageX||g.x+a.$.clientX,i=d?a.$.clientY:a.$.pageY||g.y+a.$.clientY;CKEDITOR.tools.setTimeout(function(){this.open(f,null,h,i)},CKEDITOR.env.ie?200:0,this)}},this);if(CKEDITOR.env.webkit){var b,g=function(){b=0};a.on("keydown",function(a){b=CKEDITOR.env.mac?a.data.$.metaKey:a.data.$.ctrlKey});a.on("keyup",g);a.on("contextmenu",g)}},open:function(a,e,b,g){this.editor.focus();a=a||CKEDITOR.document.getDocumentElement();this.editor.selectionChange(1);this.show(a,e,b,g)}}})},beforeInit:function(a){var e=a.contextMenu=new CKEDITOR.plugins.contextMenu(a);a.on("contentDom",function(){e.addTarget(a.editable(),a.config.browserContextMenuOnCtrl!==false)});a.addCommand("contextMenu",{exec:function(){a.contextMenu.open(a.document.getBody())}});a.setKeystroke(CKEDITOR.SHIFT+121,"contextMenu");a.setKeystroke(CKEDITOR.CTRL+CKEDITOR.SHIFT+121,"contextMenu")}}),function(){var a;function e(d,g){function f(a){a=n.list[a];if(a.equals(d.editable())||a.getAttribute("contenteditable")=="true"){var b=d.createRange();b.selectNodeContents(a);b.select()}else d.getSelection().selectElement(a);d.focus()}function e(){k&&k.setHtml(b);delete n.list}var i=d.ui.spaceId("path"),k,n=d._.elementsPath,o=n.idBase;g.html=g.html+('<span id="'+i+'_label" class="cke_voice_label">'+d.lang.elementspath.eleLabel+'</span><span id="'+i+'" class="cke_path" role="group" aria-labelledby="'+i+'_label">'+b+"</span>");d.on("uiReady",function(){var a=d.ui.space("path");a&&d.focusManager.add(a,1)});n.onClick=f;var q=CKEDITOR.tools.addFunction(f),m=CKEDITOR.tools.addFunction(function(a,b){var c=n.idBase,g,b=new CKEDITOR.dom.event(b);g=d.lang.dir=="rtl";switch(b.getKeystroke()){case g?39:37:case 9:(g=CKEDITOR.document.getById(c+(a+1)))||(g=CKEDITOR.document.getById(c+"0"));g.focus();return false;case g?37:39:case CKEDITOR.SHIFT+9:(g=CKEDITOR.document.getById(c+(a-1)))||(g=CKEDITOR.document.getById(c+(n.list.length-1)));g.focus();return false;case 27:d.focus();return false;case 13:case 32:f(a);return false}return true});d.on("selectionChange",function(){for(var a=[],f=n.list=[],g=[],e=n.filters,h=true,j=d.elementPath().elements,x,v=j.length;v--;){var r=j[v],y=0;x=r.data("cke-display-name")?r.data("cke-display-name"):r.data("cke-real-element-type")?r.data("cke-real-element-type"):r.getName();h=r.hasAttribute("contenteditable")?r.getAttribute("contenteditable")=="true":h;!h&&!r.hasAttribute("contenteditable")&&(y=1);for(var z=0;z<e.length;z++){var B=e[z](r,x);if(B===false){y=1;break}x=B||x}if(!y){f.unshift(r);g.unshift(x)}}f=f.length;for(e=0;e<f;e++){x=g[e];h=d.lang.elementspath.eleTitle.replace(/%1/,x);x=c.output({id:o+e,label:h,text:x,jsTitle:"javascript:void('"+x+"')",index:e,keyDownFn:m,clickFn:q});a.unshift(x)}k||(k=CKEDITOR.document.getById(i));g=k;g.setHtml(a.join("")+b);d.fire("elementsPathUpdate",{space:g})});d.on("readOnly",e);d.on("contentDomUnload",e);d.addCommand("elementsPathFocus",a);d.setKeystroke(CKEDITOR.ALT+122,"elementsPathFocus")}a={editorFocus:false,readOnly:1,exec:function(a){(a=CKEDITOR.document.getById(a._.elementsPath.idBase+"0"))&&a.focus(CKEDITOR.env.ie||CKEDITOR.env.air)}};var b='<span class="cke_path_empty">&nbsp;</span>',g="";CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(g=g+' onkeypress="return false;"');CKEDITOR.env.gecko&&(g=g+' onblur="this.style.cssText = this.style.cssText;"');var c=CKEDITOR.addTemplate("pathItem",'<a id="{id}" href="{jsTitle}" tabindex="-1" class="cke_path_item" title="{label}"'+g+' hidefocus="true"  onkeydown="return CKEDITOR.tools.callFunction({keyDownFn},{index}, event );" onclick="CKEDITOR.tools.callFunction({clickFn},{index}); return false;" role="button" aria-label="{label}">{text}</a>');CKEDITOR.plugins.add("elementspath",{init:function(a){a._.elementsPath={idBase:"cke_elementspath_"+
CKEDITOR.tools.getNextNumber()+"_",filters:[]};a.on("uiSpace",function(b){b.data.space=="bottom"&&e(a,b.data)})}})}(),function(){function a(a,c){var d,j;c.on("refresh",function(a){var c=[e],d;for(d in a.data.states)c.push(a.data.states[d]);this.setState(CKEDITOR.tools.search(c,b)?b:e)},c,null,100);c.on("exec",function(b){d=a.getSelection();j=d.createBookmarks(1);if(!b.data)b.data={};b.data.done=false},c,null,0);c.on("exec",function(){a.forceNextSelectionCheck();d.selectBookmarks(j)},c,null,100)}var e=CKEDITOR.TRISTATE_DISABLED,b=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indent",{init:function(b){var c=CKEDITOR.plugins.indent.genericDefinition;a(b,b.addCommand("indent",new c(true)));a(b,b.addCommand("outdent",new c));if(b.ui.addButton){b.ui.addButton("Indent",{label:b.lang.indent.indent,command:"indent",directional:true,toolbar:"indent,20"});b.ui.addButton("Outdent",{label:b.lang.indent.outdent,command:"outdent",directional:true,toolbar:"indent,10"})}b.on("dirChanged",function(a){var c=b.createRange(),f=a.data.node;c.setStartBefore(f);c.setEndAfter(f);for(var e=new CKEDITOR.dom.walker(c),i;i=e.next();)if(i.type==CKEDITOR.NODE_ELEMENT)if(!i.equals(f)&&i.getDirection()){c.setStartAfter(i);e=new CKEDITOR.dom.walker(c)}else{var k=b.config.indentClasses;if(k)for(var n=a.data.dir=="ltr"?["_rtl",""]:["","_rtl"],o=0;o<k.length;o++)if(i.hasClass(k[o]+n[0])){i.removeClass(k[o]+n[0]);i.addClass(k[o]+n[1])}k=i.getStyle("margin-right");n=i.getStyle("margin-left");k?i.setStyle("margin-left",k):i.removeStyle("margin-left");n?i.setStyle("margin-right",n):i.removeStyle("margin-right")}})}});CKEDITOR.plugins.indent={genericDefinition:function(a){this.isIndent=!!a;this.startDisabled=!this.isIndent},specificDefinition:function(a,b,d){this.name=b;this.editor=a;this.jobs={};this.enterBr=a.config.enterMode==CKEDITOR.ENTER_BR;this.isIndent=!!d;this.relatedGlobal=d?"indent":"outdent";this.indentKey=d?9:CKEDITOR.SHIFT+9;this.database={}},registerCommands:function(a,b){a.on("pluginsLoaded",function(){for(var a in b)(function(a,b){var c=a.getCommand(b.relatedGlobal),d;for(d in b.jobs){c.on("exec",function(c){if(!c.data.done){a.fire("lockSnapshot");if(b.execJob(a,d))c.data.done=true;a.fire("unlockSnapshot");CKEDITOR.dom.element.clearAllMarkers(b.database)}},this,null,d);c.on("refresh",function(c){if(!c.data.states)c.data.states={};c.data.states[b.name+"@"+d]=b.refreshJob(a,d,c.data.path)},this,null,d)}a.addFeature(b)})(this,b[a])})}};CKEDITOR.plugins.indent.genericDefinition.prototype={context:"p",exec:function(){}};CKEDITOR.plugins.indent.specificDefinition.prototype={execJob:function(a,b){var d=this.jobs[b];if(d.state!=e)return d.exec.call(this,a)},refreshJob:function(a,b,d){b=this.jobs[b];b.state=a.activeFilter.checkFeature(this)?b.refresh.call(this,a,d):e;return b.state},getContext:function(a){return a.contains(this.context)}}}(),function(){function a(a){function c(e){for(var h=q.startContainer,m=q.endContainer;h&&!h.getParent().equals(e);)h=h.getParent();for(;m&&!m.getParent().equals(e);)m=m.getParent();if(!h||!m)return false;for(var l=h,h=[],o=false;!o;){l.equals(m)&&(o=true);h.push(l);l=l.getNext()}if(h.length<1)return false;l=e.getParents(true);for(m=0;m<l.length;m++)if(l[m].getName&&j[l[m].getName()]){e=l[m];break}for(var l=d.isIndent?1:-1,m=h[0],h=h[h.length-1],o=CKEDITOR.plugins.list.listToArray(e,g),x=o[h.getCustomData("listarray_index")].indent,m=m.getCustomData("listarray_index");m<=h.getCustomData("listarray_index");m++){o[m].indent=o[m].indent+l;if(l>0){var v=o[m].parent;o[m].parent=new CKEDITOR.dom.element(v.getName(),v.getDocument())}}for(m=h.getCustomData("listarray_index")+
1;m<o.length&&o[m].indent>x;m++)o[m].indent=o[m].indent+l;h=CKEDITOR.plugins.list.arrayToList(o,g,null,a.config.enterMode,e.getDirection());if(!d.isIndent){var r;if((r=e.getParent())&&r.is("li"))for(var l=h.listNode.getChildren(),y=[],z,m=l.count()-1;m>=0;m--)(z=l.getItem(m))&&(z.is&&z.is("li"))&&y.push(z)}h&&h.listNode.replace(e);if(y&&y.length)for(m=0;m<y.length;m++){for(z=e=y[m];(z=z.getNext())&&z.is&&z.getName()in j;){CKEDITOR.env.needsNbspFiller&&!e.getFirst(b)&&e.append(q.document.createText(" "));e.append(z)}e.insertAfter(r)}h&&a.fire("contentDomInvalidated");return true}for(var d=this,g=this.database,j=this.context,o=a.getSelection(),o=(o&&o.getRanges()).createIterator(),q;q=o.getNextRange();){for(var m=q.getCommonAncestor();m&&!(m.type==CKEDITOR.NODE_ELEMENT&&j[m.getName()]);)m=m.getParent();m||(m=q.startPath().contains(j))&&q.setEndAt(m,CKEDITOR.POSITION_BEFORE_END);if(!m){var l=q.getEnclosedNode();if(l&&l.type==CKEDITOR.NODE_ELEMENT&&l.getName()in j){q.setStartAt(l,CKEDITOR.POSITION_AFTER_START);q.setEndAt(l,CKEDITOR.POSITION_BEFORE_END);m=l}}if(m&&q.startContainer.type==CKEDITOR.NODE_ELEMENT&&q.startContainer.getName()in j){l=new CKEDITOR.dom.walker(q);l.evaluator=e;q.startContainer=l.next()}if(m&&q.endContainer.type==CKEDITOR.NODE_ELEMENT&&q.endContainer.getName()in j){l=new CKEDITOR.dom.walker(q);l.evaluator=e;q.endContainer=l.previous()}if(m)return c(m)}return 0}function e(a){return a.type==CKEDITOR.NODE_ELEMENT&&a.is("li")}function b(a){return g(a)&&c(a)}var g=CKEDITOR.dom.walker.whitespaces(true),c=CKEDITOR.dom.walker.bookmark(false,true),d=CKEDITOR.TRISTATE_DISABLED,j=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indentlist",{requires:"indent",init:function(b){function c(b){e.specificDefinition.apply(this,arguments);this.requiredContent=["ul","ol"];b.on("key",function(a){if(b.mode=="wysiwyg"&&a.data.keyCode==this.indentKey){var c=this.getContext(b.elementPath());if(c&&(!this.isIndent||!CKEDITOR.plugins.indentList.firstItemInPath(this.context,b.elementPath(),c))){b.execCommand(this.relatedGlobal);a.cancel()}}},this);this.jobs[this.isIndent?10:30]={refresh:this.isIndent?function(a,b){var c=this.getContext(b),f=CKEDITOR.plugins.indentList.firstItemInPath(this.context,b,c);return!c||!this.isIndent||f?d:j}:function(a,b){return!this.getContext(b)||this.isIndent?d:j},exec:CKEDITOR.tools.bind(a,this)}}var e=CKEDITOR.plugins.indent;e.registerCommands(b,{indentlist:new c(b,"indentlist",true),outdentlist:new c(b,"outdentlist")});CKEDITOR.tools.extend(c.prototype,e.specificDefinition.prototype,{context:{ol:1,ul:1}})}});CKEDITOR.plugins.indentList={};CKEDITOR.plugins.indentList.firstItemInPath=function(a,b,c){var d=b.contains(e);c||(c=b.contains(a));return c&&d&&d.equals(c.getFirst(e))}}(),function(){function a(a,b,c){function d(c){if((j=i[c?"getFirst":"getLast"]())&&(!j.is||!j.isBlockBoundary())&&(k=b.root[c?"getPrevious":"getNext"](CKEDITOR.dom.walker.invisible(true)))&&(!k.is||!k.isBlockBoundary({br:1})))a.document.createElement("br")[c?"insertBefore":"insertAfter"](j)}for(var f=CKEDITOR.plugins.list.listToArray(b.root,c),e=[],g=0;g<b.contents.length;g++){var h=b.contents[g];if((h=h.getAscendant("li",true))&&!h.getCustomData("list_item_processed")){e.push(h);CKEDITOR.dom.element.setMarker(c,h,"list_item_processed",true)}}h=null;for(g=0;g<e.length;g++){h=e[g].getCustomData("listarray_index");f[h].indent=-1}for(g=h+1;g<f.length;g++)if(f[g].indent>f[g-1].indent+1){e=f[g-1].indent+1-f[g].indent;for(h=f[g].indent;f[g]&&f[g].indent>=h;){f[g].indent=f[g].indent+e;g++}g--}var i=CKEDITOR.plugins.list.arrayToList(f,c,null,a.config.enterMode,b.root.getAttribute("dir")).listNode,j,k;d(true);d();i.replace(b.root);a.fire("contentDomInvalidated")}function e(a,b){this.name=a;this.context=this.type=b;this.allowedContent=b+" li";this.requiredContent=b}function b(a,b,c,d){for(var f,g;f=a[d?"getLast":"getFirst"](q);){(g=f.getDirection(1))!==b.getDirection(1)&&f.setAttribute("dir",g);f.remove();c?f[d?"insertBefore":"insertAfter"](c):b.append(f,d)}}function g(a){function c(d){var f=a[d?"getPrevious":"getNext"](k);if(f&&f.type==CKEDITOR.NODE_ELEMENT&&f.is(a.getName())){b(a,f,null,!d);a.remove();a=f}}c();c(1)}function c(a){return a.type==CKEDITOR.NODE_ELEMENT&&(a.getName()in CKEDITOR.dtd.$block||a.getName()in CKEDITOR.dtd.$listItem)&&CKEDITOR.dtd[a.getName()]["#"]}function d(a,c,d){a.fire("saveSnapshot");d.enlarge(CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS);var f=d.extractContents();c.trim(false,true);var e=c.createBookmark(),h=new CKEDITOR.dom.elementPath(c.startContainer),i=h.block,h=h.lastElement.getAscendant("li",1)||i,q=new CKEDITOR.dom.elementPath(d.startContainer),o=q.contains(CKEDITOR.dtd.$listItem),q=q.contains(CKEDITOR.dtd.$list);if(i)(i=i.getBogus())&&i.remove();else if(q)(i=q.getPrevious(k))&&n(i)&&i.remove();(i=f.getLast())&&(i.type==CKEDITOR.NODE_ELEMENT&&i.is("br"))&&i.remove();(i=c.startContainer.getChild(c.startOffset))?f.insertBefore(i):c.startContainer.append(f);if(o)if(f=j(o))if(h.contains(o)){b(f,o.getParent(),o);f.remove()}else h.append(f);for(;d.checkStartOfBlock()&&d.checkEndOfBlock();){q=d.startPath();f=q.block;if(!f)break;if(f.is("li")){h=f.getParent();f.equals(h.getLast(k))&&f.equals(h.getFirst(k))&&(f=h)}d.moveToPosition(f,CKEDITOR.POSITION_BEFORE_START);f.remove()}d=d.clone();f=a.editable();d.setEndAt(f,CKEDITOR.POSITION_BEFORE_END);d=new CKEDITOR.dom.walker(d);d.evaluator=function(a){return k(a)&&!n(a)};(d=d.next())&&(d.type==CKEDITOR.NODE_ELEMENT&&d.getName()in CKEDITOR.dtd.$list)&&g(d);c.moveToBookmark(e);c.select();a.fire("saveSnapshot")}function j(a){return(a=a.getLast(k))&&a.type==CKEDITOR.NODE_ELEMENT&&a.getName()in f?a:null}var f={ol:1,ul:1},h=CKEDITOR.dom.walker.whitespaces(),i=CKEDITOR.dom.walker.bookmark(),k=function(a){return!(h(a)||i(a))},n=CKEDITOR.dom.walker.bogus();CKEDITOR.plugins.list={listToArray:function(a,b,c,d,g){if(!f[a.getName()])return[];d||(d=0);c||(c=[]);for(var e=0,h=a.getChildCount();e<h;e++){var i=a.getChild(e);i.type==CKEDITOR.NODE_ELEMENT&&i.getName()in CKEDITOR.dtd.$list&&CKEDITOR.plugins.list.listToArray(i,b,c,d+1);if(i.$.nodeName.toLowerCase()=="li"){var j={parent:a,indent:d,element:i,contents:[]};if(g)j.grandparent=g;else{j.grandparent=a.getParent();if(j.grandparent&&j.grandparent.$.nodeName.toLowerCase()=="li")j.grandparent=j.grandparent.getParent()}b&&CKEDITOR.dom.element.setMarker(b,i,"listarray_index",c.length);c.push(j);for(var k=0,n=i.getChildCount(),q;k<n;k++){q=i.getChild(k);q.type==CKEDITOR.NODE_ELEMENT&&f[q.getName()]?CKEDITOR.plugins.list.listToArray(q,b,c,d+1,j.grandparent):j.contents.push(q)}}}return c},arrayToList:function(a,b,c,d,g){c||(c=0);if(!a||a.length<c+1)return null;for(var e,h=a[c].parent.getDocument(),j=new CKEDITOR.dom.documentFragment(h),n=null,q=c,o=Math.max(a[c].indent,0),z=null,B,A,G=d==CKEDITOR.ENTER_P?"p":"div";;){var D=a[q];e=D.grandparent;B=D.element.getDirection(1);if(D.indent==o){if(!n||a[q].parent.getName()!=n.getName()){n=a[q].parent.clone(false,1);g&&n.setAttribute("dir",g);j.append(n)}z=n.append(D.element.clone(0,1));B!=n.getDirection(1)&&z.setAttribute("dir",B);for(e=0;e<D.contents.length;e++)z.append(D.contents[e].clone(1,1));q++}else if(D.indent==Math.max(o,0)+1){D=a[q-1].element.getDirection(1);q=CKEDITOR.plugins.list.arrayToList(a,null,q,d,D!=B?B:null);!z.getChildCount()&&(CKEDITOR.env.needsNbspFiller&&h.$.documentMode<=7)&&z.append(h.createText(" "));z.append(q.listNode);q=q.nextIndex}else if(D.indent==-1&&!c&&e){if(f[e.getName()]){z=D.element.clone(false,true);B!=e.getDirection(1)&&z.setAttribute("dir",B)}else z=new CKEDITOR.dom.documentFragment(h);var n=e.getDirection(1)!=B,J=D.element,C=J.getAttribute("class"),F=J.getAttribute("style"),E=z.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&(d!=CKEDITOR.ENTER_BR||n||F||C),I,L=D.contents.length,H;for(e=0;e<L;e++){I=D.contents[e];if(i(I)&&L>1)E?H=I.clone(1,1):z.append(I.clone(1,1));else if(I.type==CKEDITOR.NODE_ELEMENT&&I.isBlockBoundary()){n&&!I.getDirection()&&I.setAttribute("dir",B);A=I;var Q=J.getAttribute("style");Q&&A.setAttribute("style",Q.replace(/([^;])$/,"$1;")+(A.getAttribute("style")||""));C&&I.addClass(C);A=null;if(H){z.append(H);H=null}z.append(I.clone(1,1))}else if(E){if(!A){A=h.createElement(G);z.append(A);n&&A.setAttribute("dir",B)}F&&A.setAttribute("style",F);C&&A.setAttribute("class",C);if(H){A.append(H);H=null}A.append(I.clone(1,1))}else z.append(I.clone(1,1))}if(H){(A||z).append(H);H=null}if(z.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&q!=a.length-1){if(CKEDITOR.env.needsBrFiller)(B=z.getLast())&&(B.type==CKEDITOR.NODE_ELEMENT&&B.is("br"))&&B.remove();B=z.getLast(k);(!B||!(B.type==CKEDITOR.NODE_ELEMENT&&B.is(CKEDITOR.dtd.$block)))&&z.append(h.createElement("br"))}B=z.$.nodeName.toLowerCase();(B=="div"||B=="p")&&z.appendBogus();j.append(z);n=null;q++}else return null;A=null;if(a.length<=q||Math.max(a[q].indent,0)<o)break}if(b)for(a=j.getFirst();a;){if(a.type==CKEDITOR.NODE_ELEMENT){CKEDITOR.dom.element.clearMarkers(b,a);if(a.getName()in CKEDITOR.dtd.$listItem){c=a;h=g=d=void 0;if(d=c.getDirection()){for(g=c.getParent();g&&!(h=g.getDirection());)g=g.getParent();d==h&&c.removeAttribute("dir")}}}a=a.getNextSourceNode()}return{listNode:j,nextIndex:q}}};var o=/^h[1-6]$/,q=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT);e.prototype={exec:function(b){this.refresh(b,b.elementPath());var c=b.config,d=b.getSelection(),e=d&&d.getRanges();if(this.state==CKEDITOR.TRISTATE_OFF){var h=b.editable();if(h.getFirst(k)){var i=e.length==1&&e[0];(c=i&&i.getEnclosedNode())&&(c.is&&this.type==c.getName())&&this.setState(CKEDITOR.TRISTATE_ON)}else{c.enterMode==CKEDITOR.ENTER_BR?h.appendBogus():e[0].fixBlock(1,c.enterMode==CKEDITOR.ENTER_P?"p":"div");d.selectRanges(e)}}for(var c=d.createBookmarks(true),h=[],j={},e=e.createIterator(),n=0;(i=e.getNextRange())&&++n;){var q=i.getBoundaryNodes(),r=q.startNode,y=q.endNode;r.type==CKEDITOR.NODE_ELEMENT&&r.getName()=="td"&&i.setStartAt(q.startNode,CKEDITOR.POSITION_AFTER_START);y.type==CKEDITOR.NODE_ELEMENT&&y.getName()=="td"&&i.setEndAt(q.endNode,CKEDITOR.POSITION_BEFORE_END);i=i.createIterator();for(i.forceBrBreak=this.state==CKEDITOR.TRISTATE_OFF;q=i.getNextParagraph();)if(!q.getCustomData("list_block")){CKEDITOR.dom.element.setMarker(j,q,"list_block",1);for(var z=b.elementPath(q),r=z.elements,y=0,z=z.blockLimit,B,A=r.length-1;A>=0&&(B=r[A]);A--)if(f[B.getName()]&&z.contains(B)){z.removeCustomData("list_group_object_"+n);if(r=B.getCustomData("list_group_object"))r.contents.push(q);else{r={root:B,contents:[q]};h.push(r);CKEDITOR.dom.element.setMarker(j,B,"list_group_object",r)}y=1;break}if(!y){y=z;if(y.getCustomData("list_group_object_"+n))y.getCustomData("list_group_object_"+n).contents.push(q);else{r={root:y,contents:[q]};CKEDITOR.dom.element.setMarker(j,y,"list_group_object_"+
n,r);h.push(r)}}}}for(B=[];h.length>0;){r=h.shift();if(this.state==CKEDITOR.TRISTATE_OFF)if(f[r.root.getName()]){e=b;n=r;r=j;i=B;y=CKEDITOR.plugins.list.listToArray(n.root,r);z=[];for(q=0;q<n.contents.length;q++){A=n.contents[q];if((A=A.getAscendant("li",true))&&!A.getCustomData("list_item_processed")){z.push(A);CKEDITOR.dom.element.setMarker(r,A,"list_item_processed",true)}}for(var A=n.root.getDocument(),G=void 0,D=void 0,q=0;q<z.length;q++){var J=z[q].getCustomData("listarray_index"),G=y[J].parent;if(!G.is(this.type)){D=A.createElement(this.type);G.copyAttributes(D,{start:1,type:1});D.removeStyle("list-style-type");y[J].parent=D}}r=CKEDITOR.plugins.list.arrayToList(y,r,null,e.config.enterMode);y=void 0;z=r.listNode.getChildCount();for(q=0;q<z&&(y=r.listNode.getChild(q));q++)y.getName()==this.type&&i.push(y);r.listNode.replace(n.root);e.fire("contentDomInvalidated")}else{y=b;q=r;i=B;z=q.contents;e=q.root.getDocument();n=[];if(z.length==1&&z[0].equals(q.root)){r=e.createElement("div");z[0].moveChildren&&z[0].moveChildren(r);z[0].append(r);z[0]=r}q=q.contents[0].getParent();for(A=0;A<z.length;A++)q=q.getCommonAncestor(z[A].getParent());G=y.config.useComputedState;y=r=void 0;G=G===void 0||G;for(A=0;A<z.length;A++)for(D=z[A];J=D.getParent();){if(J.equals(q)){n.push(D);!y&&D.getDirection()&&(y=1);D=D.getDirection(G);r!==null&&(r=r&&r!=D?null:D);break}D=J}if(!(n.length<1)){z=n[n.length-1].getNext();A=e.createElement(this.type);i.push(A);for(G=i=void 0;n.length;){i=n.shift();G=e.createElement("li");if(i.is("pre")||o.test(i.getName())||i.getAttribute("contenteditable")=="false")i.appendTo(G);else{i.copyAttributes(G);if(r&&i.getDirection()){G.removeStyle("direction");G.removeAttribute("dir")}i.moveChildren(G);i.remove()}G.appendTo(A)}r&&y&&A.setAttribute("dir",r);z?A.insertBefore(z):A.appendTo(q)}}else this.state==CKEDITOR.TRISTATE_ON&&f[r.root.getName()]&&a.call(this,b,r,j)}for(A=0;A<B.length;A++)g(B[A]);CKEDITOR.dom.element.clearAllMarkers(j);d.selectBookmarks(c);b.focus()},refresh:function(a,b){var c=b.contains(f,1),d=b.blockLimit||b.root;c&&d.contains(c)?this.setState(c.is(this.type)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_OFF)}};CKEDITOR.plugins.add("list",{requires:"indentlist",init:function(a){if(!a.blockless){a.addCommand("numberedlist",new e("numberedlist","ol"));a.addCommand("bulletedlist",new e("bulletedlist","ul"));if(a.ui.addButton){a.ui.addButton("NumberedList",{label:a.lang.list.numberedlist,command:"numberedlist",directional:true,toolbar:"list,10"});a.ui.addButton("BulletedList",{label:a.lang.list.bulletedlist,command:"bulletedlist",directional:true,toolbar:"list,20"})}a.on("key",function(b){var e=b.data.domEvent.getKey(),g;if(a.mode=="wysiwyg"&&e in{8:1,46:1}){var h=a.getSelection().getRanges()[0],i=h&&h.startPath();if(h&&h.collapsed){var q=e==8,o=a.editable(),v=new CKEDITOR.dom.walker(h.clone());v.evaluator=function(a){return k(a)&&!n(a)};v.guard=function(a,b){return!(b&&a.type==CKEDITOR.NODE_ELEMENT&&a.is("table"))};e=h.clone();if(q){var r;if((r=i.contains(f))&&h.checkBoundaryOfElement(r,CKEDITOR.START)&&(r=r.getParent())&&r.is("li")&&(r=j(r))){g=r;r=r.getPrevious(k);e.moveToPosition(r&&n(r)?r:g,CKEDITOR.POSITION_BEFORE_START)}else{v.range.setStartAt(o,CKEDITOR.POSITION_AFTER_START);v.range.setEnd(h.startContainer,h.startOffset);if((r=v.previous())&&r.type==CKEDITOR.NODE_ELEMENT&&(r.getName()in f||r.is("li"))){if(!r.is("li")){v.range.selectNodeContents(r);v.reset();v.evaluator=c;r=v.previous()}g=r;e.moveToElementEditEnd(g)}}if(g){d(a,e,h);b.cancel()}else if((e=i.contains(f))&&h.checkBoundaryOfElement(e,CKEDITOR.START)){g=e.getFirst(k);if(h.checkBoundaryOfElement(g,CKEDITOR.START)){r=e.getPrevious(k);if(j(g)){if(r){h.moveToElementEditEnd(r);h.select()}}else a.execCommand("outdent");b.cancel()}}}else if(g=i.contains("li")){v.range.setEndAt(o,CKEDITOR.POSITION_BEFORE_END);g=(i=g.getLast(k))&&c(i)?i:g;o=0;if((r=v.next())&&r.type==CKEDITOR.NODE_ELEMENT&&r.getName()in f&&r.equals(i)){o=1;r=v.next()}else h.checkBoundaryOfElement(g,CKEDITOR.END)&&(o=1);if(o&&r){h=h.clone();h.moveToElementEditStart(r);d(a,e,h);b.cancel()}}else{v.range.setEndAt(o,CKEDITOR.POSITION_BEFORE_END);if((r=v.next())&&r.type==CKEDITOR.NODE_ELEMENT&&r.is(f)){r=r.getFirst(k);if(i.block&&h.checkStartOfBlock()&&h.checkEndOfBlock()){i.block.remove();h.moveToElementEditStart(r);h.select()}else if(j(r)){h.moveToElementEditStart(r);h.select()}else{h=h.clone();h.moveToElementEditStart(r);d(a,e,h)}b.cancel()}}setTimeout(function(){a.selectionChange(1)})}}})}}})}(),function(){function a(a,b,c){c=a.config.forceEnterMode||c;if(a.mode=="wysiwyg"){if(!b)b=a.activeEnterMode;if(!a.elementPath().isContextFor("p")){b=CKEDITOR.ENTER_BR;c=1}a.fire("saveSnapshot");b==CKEDITOR.ENTER_BR?j(a,b,null,c):f(a,b,null,c);a.fire("saveSnapshot")}}function e(a){for(var a=a.getSelection().getRanges(true),b=a.length-1;b>0;b--)a[b].deleteContents();return a[0]}function b(a){var b=a.startContainer.getAscendant(function(a){return a.type==CKEDITOR.NODE_ELEMENT&&a.getAttribute("contenteditable")=="true"},true);if(a.root.equals(b))return a;b=new CKEDITOR.dom.range(b);b.moveToRange(a);return b}CKEDITOR.plugins.add("enterkey",{init:function(b){b.addCommand("enter",{modes:{wysiwyg:1},editorFocus:false,exec:function(b){a(b)}});b.addCommand("shiftEnter",{modes:{wysiwyg:1},editorFocus:false,exec:function(b){a(b,b.activeShiftEnterMode,1)}});b.setKeystroke([[13,"enter"],[CKEDITOR.SHIFT+13,"shiftEnter"]])}});var g=CKEDITOR.dom.walker.whitespaces(),c=CKEDITOR.dom.walker.bookmark();CKEDITOR.plugins.enterkey={enterBlock:function(a,d,f,o){if(f=f||e(a)){var f=b(f),q=f.document,m=f.checkStartOfBlock(),l=f.checkEndOfBlock(),p=a.elementPath(f.startContainer),t=p.block,s=d==CKEDITOR.ENTER_DIV?"div":"p",u;if(m&&l){if(t&&(t.is("li")||t.getParent().is("li"))){t.is("li")||(t=t.getParent());f=t.getParent();u=f.getParent();var o=!t.hasPrevious(),w=!t.hasNext(),s=a.getSelection(),x=s.createBookmarks(),m=t.getDirection(1),l=t.getAttribute("class"),v=t.getAttribute("style"),r=u.getDirection(1)!=m,a=a.enterMode!=CKEDITOR.ENTER_BR||r||v||l;if(u.is("li"))if(o||w)t[o?"insertBefore":"insertAfter"](u);else t.breakParent(u);else{if(a){if(p.block.is("li")){u=q.createElement(d==CKEDITOR.ENTER_P?"p":"div");r&&u.setAttribute("dir",m);v&&u.setAttribute("style",v);l&&u.setAttribute("class",l);t.moveChildren(u)}else u=p.block;if(o||w)u[o?"insertBefore":"insertAfter"](f);else{t.breakParent(f);u.insertAfter(f)}}else{t.appendBogus(true);if(o||w)for(;q=t[o?"getFirst":"getLast"]();)q[o?"insertBefore":"insertAfter"](f);else for(t.breakParent(f);q=t.getLast();)q.insertAfter(f)}t.remove()}s.selectBookmarks(x);return}if(t&&t.getParent().is("blockquote")){t.breakParent(t.getParent());t.getPrevious().getFirst(CKEDITOR.dom.walker.invisible(1))||t.getPrevious().remove();t.getNext().getFirst(CKEDITOR.dom.walker.invisible(1))||t.getNext().remove();f.moveToElementEditStart(t);f.select();return}}else if(t&&t.is("pre")&&!l){j(a,d,f,o);return}if(m=f.splitBlock(s)){d=m.previousBlock;t=m.nextBlock;p=m.wasStartOfBlock;a=m.wasEndOfBlock;if(t){x=t.getParent();if(x.is("li")){t.breakParent(x);t.move(t.getNext(),1)}}else if(d&&(x=d.getParent())&&x.is("li")){d.breakParent(x);x=d.getNext();f.moveToElementEditStart(x);d.move(d.getPrevious())}if(!p&&!a){if(t.is("li")){u=f.clone();u.selectNodeContents(t);u=new CKEDITOR.dom.walker(u);u.evaluator=function(a){return!(c(a)||g(a)||a.type==CKEDITOR.NODE_ELEMENT&&a.getName()in CKEDITOR.dtd.$inline&&!(a.getName()in CKEDITOR.dtd.$empty))};(x=u.next())&&(x.type==CKEDITOR.NODE_ELEMENT&&x.is("ul","ol"))&&(CKEDITOR.env.needsBrFiller?q.createElement("br"):q.createText(" ")).insertBefore(x)}t&&f.moveToElementEditStart(t)}else{if(d){if(d.is("li")||!h.test(d.getName())&&!d.is("pre"))u=d.clone()}else t&&(u=t.clone());if(u)o&&!u.is("li")&&u.renameNode(s);else if(x&&x.is("li"))u=x;else{u=q.createElement(s);d&&(w=d.getDirection())&&u.setAttribute("dir",w)}if(q=m.elementPath){o=0;for(s=q.elements.length;o<s;o++){x=q.elements[o];if(x.equals(q.block)||x.equals(q.blockLimit))break;if(CKEDITOR.dtd.$removeEmpty[x.getName()]){x=x.clone();u.moveChildren(x);u.append(x)}}}u.appendBogus();u.getParent()||f.insertNode(u);u.is("li")&&u.removeAttribute("value");if(CKEDITOR.env.ie&&p&&(!a||!d.getChildCount())){f.moveToElementEditStart(a?d:u);f.select()}f.moveToElementEditStart(p&&!a?t:u)}f.select();f.scrollIntoView()}}},enterBr:function(a,b,c,d){if(c=c||e(a)){var g=c.document,j=c.checkEndOfBlock(),l=new CKEDITOR.dom.elementPath(a.getSelection().getStartElement()),p=l.block,t=p&&l.block.getName();if(!d&&t=="li")f(a,b,c,d);else{if(!d&&j&&h.test(t))if(j=p.getDirection()){g=g.createElement("div");g.setAttribute("dir",j);g.insertAfter(p);c.setStart(g,0)}else{g.createElement("br").insertAfter(p);CKEDITOR.env.gecko&&g.createText("").insertAfter(p);c.setStartAt(p.getNext(),CKEDITOR.env.ie?CKEDITOR.POSITION_BEFORE_START:CKEDITOR.POSITION_AFTER_START)}else{a=t=="pre"&&CKEDITOR.env.ie&&CKEDITOR.env.version<8?g.createText("\r"):g.createElement("br");c.deleteContents();c.insertNode(a);if(CKEDITOR.env.needsBrFiller){g.createText("﻿").insertAfter(a);j&&(p||l.blockLimit).appendBogus();a.getNext().$.nodeValue="";c.setStartAt(a.getNext(),CKEDITOR.POSITION_AFTER_START)}else c.setStartAt(a,CKEDITOR.POSITION_AFTER_END)}c.collapse(true);c.select();c.scrollIntoView()}}}};var d=CKEDITOR.plugins.enterkey,j=d.enterBr,f=d.enterBlock,h=/^h[1-6]$/}(),function(){function a(a,b){var g={},c=[],d={nbsp:" ",shy:"­",gt:">",lt:"<",amp:"&",apos:"'",quot:'"'},a=a.replace(/\b(nbsp|shy|gt|lt|amp|apos|quot)(?:,|$)/g,function(a,f){var e=b?"&"+f+";":d[f];g[e]=b?d[f]:"&"+f+";";c.push(e);return""});if(!b&&a){var a=a.split(","),j=document.createElement("div"),f;j.innerHTML="&"+a.join(";&")+";";f=j.innerHTML;j=null;for(j=0;j<f.length;j++){var h=f.charAt(j);g[h]="&"+a[j]+";";c.push(h)}}g.regex=c.join(b?"|":"");return g}CKEDITOR.plugins.add("entities",{afterInit:function(e){function b(a){return h[a]}function g(a){return c.entities_processNumerical=="force"||!j[a]?"&#"+a.charCodeAt(0)+";":j[a]}var c=e.config;if(e=(e=e.dataProcessor)&&e.htmlFilter){var d=[];c.basicEntities!==false&&d.push("nbsp,gt,lt,amp");if(c.entities){d.length&&d.push("quot,iexcl,cent,pound,curren,yen,brvbar,sect,uml,copy,ordf,laquo,not,shy,reg,macr,deg,plusmn,sup2,sup3,acute,micro,para,middot,cedil,sup1,ordm,raquo,frac14,frac12,frac34,iquest,times,divide,fnof,bull,hellip,prime,Prime,oline,frasl,weierp,image,real,trade,alefsym,larr,uarr,rarr,darr,harr,crarr,lArr,uArr,rArr,dArr,hArr,forall,part,exist,empty,nabla,isin,notin,ni,prod,sum,minus,lowast,radic,prop,infin,ang,and,or,cap,cup,int,there4,sim,cong,asymp,ne,equiv,le,ge,sub,sup,nsub,sube,supe,oplus,otimes,perp,sdot,lceil,rceil,lfloor,rfloor,lang,rang,loz,spades,clubs,hearts,diams,circ,tilde,ensp,emsp,thinsp,zwnj,zwj,lrm,rlm,ndash,mdash,lsquo,rsquo,sbquo,ldquo,rdquo,bdquo,dagger,Dagger,permil,lsaquo,rsaquo,euro");c.entities_latin&&d.push("Agrave,Aacute,Acirc,Atilde,Auml,Aring,AElig,Ccedil,Egrave,Eacute,Ecirc,Euml,Igrave,Iacute,Icirc,Iuml,ETH,Ntilde,Ograve,Oacute,Ocirc,Otilde,Ouml,Osla sh,Ugrave,Uacute,Ucirc,Uuml,Yacute,THORN,szlig,agrave,aacute,acirc,atilde,auml,aring,aelig,ccedil,egrave,eacute,ecirc,euml,igrave,iacute,icirc,iuml,eth,ntilde,ograve,oacute,ocirc,otilde,ouml,oslash,ugrave,uacute,ucirc,uuml,yacute,thorn,yuml,OElig,oelig,Scaron,scaron,Yuml");c.entities_greek&&d.push("Alpha,Beta,Gamma,Delta,Epsilon,Zeta,Eta,Theta,Iota,Kappa,Lambda,Mu,Nu,Xi,Omicron,Pi,Rho,Sigma,Tau,Upsilon,Phi,Chi,Psi,Omega,alpha,beta,gamma,delta,epsilon,zeta,eta,theta,iota,kappa,lambda,mu,nu,xi,omicron,pi,rho,sigmaf,sigma,tau,upsilon,phi,chi,psi,omega,thetasym,upsih,piv");c.entities_additional&&d.push(c.entities_additional)}var j=a(d.join(",")),f=j.regex?"["+j.regex+"]":"a^";delete j.regex;c.entities&&c.entities_processNumerical&&(f="[^ -~]|"+f);var f=RegExp(f,"g"),h=a("nbsp,gt,lt,amp,shy",true),i=RegExp(h.regex,"g");e.addRules({text:function(a){return a.replace(i,b).replace(f,g)}},{applyToAll:true,excludeNestedEditable:true})}}})}(),CKEDITOR.config.basicEntities=!0,CKEDITOR.config.entities=!0,CKEDITOR.config.entities_latin=!0,CKEDITOR.config.entities_greek=!0,CKEDITOR.config.entities_additional="#39",CKEDITOR.plugins.add("popup"),CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{popup:function(a,e,b,g){e=e||"80%";b=b||"70%";typeof e=="string"&&(e.length>1&&e.substr(e.length-1,1)=="%")&&(e=parseInt(window.screen.width*parseInt(e,10)/100,10));typeof b=="string"&&(b.length>1&&b.substr(b.length-1,1)=="%")&&(b=parseInt(window.screen.height*parseInt(b,10)/100,10));e<640&&(e=640);b<420&&(b=420);var c=parseInt((window.screen.height-b)/2,10),d=parseInt((window.screen.width-e)/2,10),g=(g||"location=no,menubar=no,toolbar=no,dependent=yes,minimizable=no,modal=yes,alwaysRaised=yes,resizable=yes,scrollbars=yes")+",width="+e+",height="+b+",top="+c+",left="+d,j=window.open("",null,g,true);if(!j)return false;try{if(navigator.userAgent.toLowerCase().indexOf(" chrome/")==-1){j.moveTo(d,c);j.resizeTo(e,b)}j.focus();j.location.href=a}catch(f){window.open(a,null,g,true)}return true}}),function(){function a(a,b){var c=[];if(b)for(var d in b)c.push(d+"="+encodeURIComponent(b[d]));else return a;return a+(a.indexOf("?")!=-1?"&":"?")+c.join("&")}function e(a){a=a+"";return a.charAt(0).toUpperCase()+a.substr(1)}function b(){var b=this.getDialog(),c=b.getParentEditor();c._.filebrowserSe=this;var d=c.config["filebrowser"+e(b.getName())+"WindowWidth"]||c.config.filebrowserWindowWidth||"80%",b=c.config["filebrowser"+e(b.getName())+"WindowHeight"]||c.config.filebrowserWindowHeight||"70%",f=this.filebrowser.params||{};f.CKEditor=c.name;f.CKEditorFuncNum=c._.filebrowserFn;if(!f.langCode)f.langCode=c.langCode;f=a(this.filebrowser.url,f);c.popup(f,d,b,c.config.filebrowserWindowFeatures||c.config.fileBrowserWindowFeatures)}function g(){var a=this.getDialog();a.getParentEditor()._.filebrowserSe=this;return!a.getContentElement(this["for"][0],this["for"][1]).getInputElement().$.value||!a.getContentElement(this["for"][0],this["for"][1]).getAction()?false:true}function c(b,c,d){var f=d.params||{};f.CKEditor=b.name;f.CKEditorFuncNum=b._.filebrowserFn;if(!f.langCode)f.langCode=b.langCode;c.action=a(d.url,f);c.filebrowser=d}function d(a,f,j,n){if(n&&n.length)for(var o,q=n.length;q--;){o=n[q];(o.type=="hbox"||o.type=="vbox"||o.type=="fieldset")&&d(a,f,j,o.children);if(o.filebrowser){if(typeof o.filebrowser=="string")o.filebrowser={action:o.type=="fileButton"?"QuickUpload":"Browse",target:o.filebrowser};if(o.filebrowser.action=="Browse"){var m=o.filebrowser.url;if(m===void 0){m=a.config["filebrowser"+e(f)+"BrowseUrl"];if(m===void 0)m=a.config.filebrowserBrowseUrl}if(m){o.onClick=b;o.filebrowser.url=m;o.hidden=false}}else if(o.filebrowser.action=="QuickUpload"&&o["for"]){m=o.filebrowser.url;if(m===void 0){m=a.config["filebrowser"+e(f)+"UploadUrl"];if(m===void 0)m=a.config.filebrowserUploadUrl}if(m){var l=o.onClick;o.onClick=function(a){var b=a.sender;return l&&l.call(b,a)===false?false:g.call(b,a)};o.filebrowser.url=m;o.hidden=false;c(a,j.getContents(o["for"][0]).get(o["for"][1]),o.filebrowser)}}}}}function j(a,b,c){if(c.indexOf(";")!==-1){for(var c=c.split(";"),d=0;d<c.length;d++)if(j(a,b,c[d]))return true;return false}return(a=a.getContents(b).get(c).filebrowser)&&a.url}function f(a,b){var c=this._.filebrowserSe.getDialog(),d=this._.filebrowserSe["for"],f=this._.filebrowserSe.filebrowser.onSelect;d&&c.getContentElement(d[0],d[1]).reset();if(!(typeof b=="function"&&b.call(this._.filebrowserSe)===false)&&!(f&&f.call(this._.filebrowserSe,a,b)===false)){typeof b=="string"&&b&&alert(b);if(a){d=this._.filebrowserSe;c=d.getDialog();if(d=d.filebrowser.target||null){d=d.split(":");if(f=c.getContentElement(d[0],d[1])){f.setValue(a);c.selectPage(d[0])}}}}}CKEDITOR.plugins.add("filebrowser",{requires:"popup",init:function(a){a._.filebrowserFn=CKEDITOR.tools.addFunction(f,a);a.on("destroy",function(){CKEDITOR.tools.removeFunction(this._.filebrowserFn)})}});CKEDITOR.on("dialogDefinition",function(a){if(a.editor.plugins.filebrowser)for(var b=a.data.definition,c,f=0;f<b.contents.length;++f)if(c=b.contents[f]){d(a.editor,a.data.name,b,c.elements);if(c.hidden&&c.filebrowser)c.hidden=!j(b,c.id,c.filebrowser)}})}(),function(){function a(a){var c=a.config,d=a.fire("uiSpace",{space:"top",html:""}).html,j=function(){function d(a,c,f){h.setStyle(c,b(f));h.setStyle("position",a)}function f(a){var b=k.getDocumentPosition();switch(a){case"top":d("absolute","top",b.y-s-x);break;case"pin":d("fixed","top",r);break;case"bottom":d("absolute","top",b.y+(p.height||p.bottom-p.top)+x)}i=a}var i,k,l,p,t,s,u,w=c.floatSpaceDockedOffsetX||0,x=c.floatSpaceDockedOffsetY||0,v=c.floatSpacePinnedOffsetX||0,r=c.floatSpacePinnedOffsetY||0;return function(c){if(k=a.editable()){c&&c.name=="focus"&&h.show();h.removeStyle("left");h.removeStyle("right");l=h.getClientRect();p=k.getClientRect();t=e.getViewPaneSize();s=l.height;u="pageXOffset"in e.$?e.$.pageXOffset:CKEDITOR.document.$.documentElement.scrollLeft;if(i){s+x<=p.top?f("top"):s+x>t.height-p.bottom?f("pin"):f("bottom");var c=t.width/2,c=p.left>0&&p.right<t.width&&p.width>l.width?a.config.contentsLangDirection=="rtl"?"right":"left":c-p.left>p.right-c?"left":"right",d;if(l.width>t.width){c="left";d=0}else{d=c=="left"?p.left>0?p.left:0:p.right<t.width?t.width-p.right:0;if(d+l.width>t.width){c=c=="left"?"right":"left";d=0}}h.setStyle(c,b((i=="pin"?v:w)+d+(i=="pin"?0:c=="left"?u:-u)))}else{i="pin";f("pin");j(c)}}}}();if(d){var f=new CKEDITOR.template('<div id="cke_{name}" class="cke {id} cke_reset_all cke_chrome cke_editor_{name} cke_float cke_{langDir} '+CKEDITOR.env.cssClass+'" dir="{langDir}" title="'+(CKEDITOR.env.gecko?" ":"")+'" lang="{langCode}" role="application" style="{style}"'+(a.title?' aria-labelledby="cke_{name}_arialbl"':" ")+">"+(a.title?'<span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span>':" ")+'<div class="cke_inner"><div id="{topId}" class="cke_top" role="presentation">{content}</div></div></div>'),h=CKEDITOR.document.getBody().append(CKEDITOR.dom.element.createFromHtml(f.output({content:d,id:a.id,langDir:a.lang.dir,langCode:a.langCode,name:a.name,style:"display:none;z-index:"+(c.baseFloatZIndex-1),topId:a.ui.spaceId("top"),voiceLabel:a.title}))),i=CKEDITOR.tools.eventsBuffer(500,j),k=CKEDITOR.tools.eventsBuffer(100,j);h.unselectable();h.on("mousedown",function(a){a=a.data;a.getTarget().hasAscendant("a",1)||a.preventDefault()});a.on("focus",function(b){j(b);a.on("change",i.input);e.on("scroll",k.input);e.on("resize",k.input)});a.on("blur",function(){h.hide();a.removeListener("change",i.input);e.removeListener("scroll",k.input);e.removeListener("resize",k.input)});a.on("destroy",function(){e.removeListener("scroll",k.input);e.removeListener("resize",k.input);h.clearCustomData();h.remove()});a.focusManager.hasFocus&&h.show();a.focusManager.add(h,1)}}var e=CKEDITOR.document.getWindow(),b=CKEDITOR.tools.cssLength;CKEDITOR.plugins.add("floatingspace",{init:function(b){b.on("loaded",function(){a(this)},null,null,20)}})}(),CKEDITOR.plugins.add("listblock",{requires:"panel",onLoad:function(){var a=CKEDITOR.addTemplate("panel-list",'<ul role="presentation" class="cke_panel_list">{items}</ul>'),e=CKEDITOR.addTemplate("panel-list-item",'<li id="{id}" class="cke_panel_listItem" role=presentation><a id="{id}_option" _cke_focus=1 hidefocus=true title="{title}" href="javascript:void(\'{val}\')"  {onclick}="CKEDITOR.tools.callFunction({clickFn},\'{val}\'); return false;" role="option">{text}</a></li>'),b=CKEDITOR.addTemplate("panel-list-group",'<h1 id="{id}" class="cke_panel_grouptitle" role="presentation" >{label}</h1>'),g=/\'/g;CKEDITOR.ui.panel.prototype.addListBlock=function(a,b){return this.addBlock(a,new CKEDITOR.ui.listBlock(this.getHolderElement(),b))};CKEDITOR.ui.listBlock=CKEDITOR.tools.createClass({base:CKEDITOR.ui.panel.block,$:function(a,b){var b=b||{},e=b.attributes||(b.attributes={});(this.multiSelect=!!b.multiSelect)&&(e["aria-multiselectable"]=true);!e.role&&(e.role="listbox");this.base.apply(this,arguments);this.element.setAttribute("role",e.role);e=this.keys;e[40]="next";e[9]="next";e[38]="prev";e[CKEDITOR.SHIFT+9]="prev";e[32]=CKEDITOR.env.ie?"mouseup":"click";CKEDITOR.env.ie&&(e[13]="mouseup");this._.pendingHtml=[];this._.pendingList=[];this._.items={};this._.groups={}},_:{close:function(){if(this._.started){var b=a.output({items:this._.pendingList.join("")});this._.pendingList=[];this._.pendingHtml.push(b);delete this._.started}},getClick:function(){if(!this._.click)this._.click=CKEDITOR.tools.addFunction(function(a){var b=this.toggle(a);if(this.onClick)this.onClick(a,b)},this);return this._.click}},proto:{add:function(a,b,j){var f=CKEDITOR.tools.getNextId();if(!this._.started){this._.started=1;this._.size=this._.size||0}this._.items[a]=f;var h;h=CKEDITOR.tools.htmlEncodeAttr(a).replace(g,"\\'");a={id:f,val:h,onclick:CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick",clickFn:this._.getClick(),title:CKEDITOR.tools.htmlEncodeAttr(j||a),text:b||a};this._.pendingList.push(e.output(a))},startGroup:function(a){this._.close();var d=CKEDITOR.tools.getNextId();this._.groups[a]=d;this._.pendingHtml.push(b.output({id:d,label:a}))},commit:function(){this._.close();this.element.appendHtml(this._.pendingHtml.join(""));delete this._.size;this._.pendingHtml=[]},toggle:function(a){var b=this.isMarked(a);b?this.unmark(a):this.mark(a);return!b},hideGroup:function(a){var b=(a=this.element.getDocument().getById(this._.groups[a]))&&a.getNext();if(a){a.setStyle("display","none");b&&b.getName()=="ul"&&b.setStyle("display","none")}},hideItem:function(a){this.element.getDocument().getById(this._.items[a]).setStyle("display","none")},showAll:function(){var a=this._.items,b=this._.groups,e=this.element.getDocument(),f;for(f in a)e.getById(a[f]).setStyle("display","");for(var g in b){a=e.getById(b[g]);f=a.getNext();a.setStyle("display","");f&&f.getName()=="ul"&&f.setStyle("display","")}},mark:function(a){this.multiSelect||this.unmarkAll();var a=this._.items[a],b=this.element.getDocument().getById(a);b.addClass("cke_selected");this.element.getDocument().getById(a+"_option").setAttribute("aria-selected",true);this.onMark&&this.onMark(b)},unmark:function(a){var b=this.element.getDocument(),a=this._.items[a],e=b.getById(a);e.removeClass("cke_selected");b.getById(a+"_option").removeAttribute("aria-selected");this.onUnmark&&this.onUnmark(e)},unmarkAll:function(){var a=this._.items,b=this.element.getDocument(),e;for(e in a){var f=a[e];b.getById(f).removeClass("cke_selected");b.getById(f+"_option").removeAttribute("aria-selected")}this.onUnmark&&this.onUnmark()},isMarked:function(a){return this.element.getDocument().getById(this._.items[a]).hasClass("cke_selected")},focus:function(a){this._.focusIndex=-1;var b=this.element.getElementsByTag("a"),e,f=-1;if(a)for(e=this.element.getDocument().getById(this._.items[a]).getFirst();a=b.getItem(++f);){if(a.equals(e)){this._.focusIndex=f;break}}else this.element.focus();e&&setTimeout(function(){e.focus()},0)}}})}}),function(){var a='<a id="{id}" class="cke_button cke_button__{name} cke_button_{state} {cls}"'+
(CKEDITOR.env.gecko&&!CKEDITOR.env.hc?"":" href=\"javascript:void('{titleJs}')\"")+' title="{title}" tabindex="-1" hidefocus="true" role="button" aria-labelledby="{id}_label" aria-haspopup="{hasArrow}" aria-disabled="{ariaDisabled}"';CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(a=a+' onkeypress="return false;"');CKEDITOR.env.gecko&&(a=a+' onblur="this.style.cssText = this.style.cssText;"');var a=a+(' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event);" onfocus="return CKEDITOR.tools.callFunction({focusFn},event);" '+
(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction({clickFn},this);return false;"><span class="cke_button_icon cke_button__{iconName}_icon" style="{style}"'),a=a+'>&nbsp;</span><span id="{id}_label" class="cke_button_label cke_button__{name}_label" aria-hidden="false">{label}</span>{arrowHtml}</a>',e=CKEDITOR.addTemplate("buttonArrow",'<span class="cke_button_arrow">'+(CKEDITOR.env.hc?"&#9660;":"")+"</span>"),b=CKEDITOR.addTemplate("button",a);CKEDITOR.plugins.add("button",{beforeInit:function(a){a.ui.addHandler(CKEDITOR.UI_BUTTON,CKEDITOR.ui.button.handler)}});CKEDITOR.UI_BUTTON="button";CKEDITOR.ui.button=function(a){CKEDITOR.tools.extend(this,a,{title:a.label,click:a.click||function(b){b.execCommand(a.command)}});this._={}};CKEDITOR.ui.button.handler={create:function(a){return new CKEDITOR.ui.button(a)}};CKEDITOR.ui.button.prototype={render:function(a,c){function d(){var b=a.mode;if(b){b=this.modes[b]?l[b]!==void 0?l[b]:CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED;b=a.readOnly&&!this.readOnly?CKEDITOR.TRISTATE_DISABLED:b;this.setState(b);this.refresh&&this.refresh()}}var j=CKEDITOR.env,f=this._.id=CKEDITOR.tools.getNextId(),h="",i=this.command,k;this._.editor=a;var n={id:f,button:this,editor:a,focus:function(){CKEDITOR.document.getById(f).focus()},execute:function(){this.button.click(a)},attach:function(a){this.button.attach(a)}},o=CKEDITOR.tools.addFunction(function(a){if(n.onkey){a=new CKEDITOR.dom.event(a);return n.onkey(n,a.getKeystroke())!==false}}),q=CKEDITOR.tools.addFunction(function(a){var b;n.onfocus&&(b=n.onfocus(n,new CKEDITOR.dom.event(a))!==false);return b}),m=0;n.clickFn=k=CKEDITOR.tools.addFunction(function(){if(m){a.unlockSelection(1);m=0}n.execute();j.iOS&&a.focus()});if(this.modes){var l={};a.on("beforeModeUnload",function(){if(a.mode&&this._.state!=CKEDITOR.TRISTATE_DISABLED)l[a.mode]=this._.state},this);a.on("activeFilterChange",d,this);a.on("mode",d,this);!this.readOnly&&a.on("readOnly",d,this)}else if(i)if(i=a.getCommand(i)){i.on("state",function(){this.setState(i.state)},this);h=h+(i.state==CKEDITOR.TRISTATE_ON?"on":i.state==CKEDITOR.TRISTATE_DISABLED?"disabled":"off")}if(this.directional)a.on("contentDirChanged",function(b){var c=CKEDITOR.document.getById(this._.id),d=c.getFirst(),b=b.data;b!=a.lang.dir?c.addClass("cke_"+b):c.removeClass("cke_ltr").removeClass("cke_rtl");d.setAttribute("style",CKEDITOR.skin.getIconStyle(t,b=="rtl",this.icon,this.iconOffset))},this);i||(h=h+"off");var p=this.name||this.command,t=p;if(this.icon&&!/\./.test(this.icon)){t=this.icon;this.icon=null}h={id:f,name:p,iconName:t,label:this.label,cls:this.className||"",state:h,ariaDisabled:h=="disabled"?"true":"false",title:this.title,titleJs:j.gecko&&!j.hc?"":(this.title||"").replace("'",""),hasArrow:this.hasArrow?"true":"false",keydownFn:o,focusFn:q,clickFn:k,style:CKEDITOR.skin.getIconStyle(t,a.lang.dir=="rtl",this.icon,this.iconOffset),arrowHtml:this.hasArrow?e.output():""};b.output(h,c);if(this.onRender)this.onRender();return n},setState:function(a){if(this._.state==a)return false;this._.state=a;var b=CKEDITOR.document.getById(this._.id);if(b){b.setState(a,"cke_button");a==CKEDITOR.TRISTATE_DISABLED?b.setAttribute("aria-disabled",true):b.removeAttribute("aria-disabled");if(this.hasArrow){a=a==CKEDITOR.TRISTATE_ON?this._.editor.lang.button.selectedLabel.replace(/%1/g,this.label):this.label;CKEDITOR.document.getById(this._.id+"_label").setText(a)}else a==CKEDITOR.TRISTATE_ON?b.setAttribute("aria-pressed",true):b.removeAttribute("aria-pressed");return true}return false},getState:function(){return this._.state},toFeature:function(a){if(this._.feature)return this._.feature;var b=this;!this.allowedContent&&(!this.requiredContent&&this.command)&&(b=a.getCommand(this.command)||b);return this._.feature=b}};CKEDITOR.ui.prototype.addButton=function(a,b){this.add(a,CKEDITOR.UI_BUTTON,b)}}(),CKEDITOR.plugins.add("richcombo",{requires:"floatpanel,listblock,button",beforeInit:function(a){a.ui.addHandler(CKEDITOR.UI_RICHCOMBO,CKEDITOR.ui.richCombo.handler)}}),function(){var a='<span id="{id}" class="cke_combo cke_combo__{name} {cls}" role="presentation"><span id="{id}_label" class="cke_combo_label">{label}</span><a class="cke_combo_button" title="{title}" tabindex="-1"'+(CKEDITOR.env.gecko&&!CKEDITOR.env.hc?"":" href=\"javascript:void('{titleJs}')\"")+' hidefocus="true" role="button" aria-labelledby="{id}_label" aria-haspopup="true"';CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(a=a+' onkeypress="return false;"');CKEDITOR.env.gecko&&(a=a+' onblur="this.style.cssText = this.style.cssText;"');var a=a+(' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event,this);" onfocus="return CKEDITOR.tools.callFunction({focusFn},event);" '+(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction({clickFn},this);return false;"><span id="{id}_text" class="cke_combo_text cke_combo_inlinelabel">{label}</span><span class="cke_combo_open"><span class="cke_combo_arrow">'+(CKEDITOR.env.hc?"&#9660;":CKEDITOR.env.air?"&nbsp;":"")+"</span></span></a></span>"),e=CKEDITOR.addTemplate("combo",a);CKEDITOR.UI_RICHCOMBO="richcombo";CKEDITOR.ui.richCombo=CKEDITOR.tools.createClass({$:function(a){CKEDITOR.tools.extend(this,a,{canGroup:false,title:a.label,modes:{wysiwyg:1},editorFocus:1});a=this.panel||{};delete this.panel;this.id=CKEDITOR.tools.getNextNumber();this.document=a.parent&&a.parent.getDocument()||CKEDITOR.document;a.className="cke_combopanel";a.block={multiSelect:a.multiSelect,attributes:a.attributes};a.toolbarRelated=true;this._={panelDefinition:a,items:{}}},proto:{renderHtml:function(a){var e=[];this.render(a,e);return e.join("")},render:function(a,g){function c(){if(this.getState()!=CKEDITOR.TRISTATE_ON){var c=this.modes[a.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED;if(a.readOnly&&!this.readOnly)c=CKEDITOR.TRISTATE_DISABLED;this.setState(c);this.setValue("");c!=CKEDITOR.TRISTATE_DISABLED&&this.refresh&&this.refresh()}}var d=CKEDITOR.env,j="cke_"+this.id,f=CKEDITOR.tools.addFunction(function(c){if(o){a.unlockSelection(1);o=0}i.execute(c)},this),h=this,i={id:j,combo:this,focus:function(){CKEDITOR.document.getById(j).getChild(1).focus()},execute:function(c){var d=h._;if(d.state!=CKEDITOR.TRISTATE_DISABLED){h.createPanel(a);if(d.on)d.panel.hide();else{h.commit();var f=h.getValue();f?d.list.mark(f):d.list.unmarkAll();d.panel.showBlock(h.id,new CKEDITOR.dom.element(c),4)}}},clickFn:f};a.on("activeFilterChange",c,this);a.on("mode",c,this);a.on("selectionChange",c,this);!this.readOnly&&a.on("readOnly",c,this);var k=CKEDITOR.tools.addFunction(function(c,d){var c=new CKEDITOR.dom.event(c),e=c.getKeystroke();if(e==40)a.once("panelShow",function(a){a.data._.panel._.currentBlock.onKeyDown(40)});switch(e){case 13:case 32:case 40:CKEDITOR.tools.callFunction(f,d);break;default:i.onkey(i,e)}c.preventDefault()}),n=CKEDITOR.tools.addFunction(function(){i.onfocus&&i.onfocus()}),o=0;i.keyDownFn=k;d={id:j,name:this.name||this.command,label:this.label,title:this.title,cls:this.className||"",titleJs:d.gecko&&!d.hc?"":(this.title||"").replace("'",""),keydownFn:k,focusFn:n,clickFn:f};e.output(d,g);if(this.onRender)this.onRender();return i},createPanel:function(a){if(!this._.panel){var e=this._.panelDefinition,c=this._.panelDefinition.block,d=e.parent||CKEDITOR.document.getBody(),j="cke_combopanel__"+this.name,f=new CKEDITOR.ui.floatPanel(a,d,e),h=f.addListBlock(this.id,c),i=this;f.onShow=function(){this.element.addClass(j);i.setState(CKEDITOR.TRISTATE_ON);i._.on=1;i.editorFocus&&!a.focusManager.hasFocus&&a.focus();if(i.onOpen)i.onOpen();a.once("panelShow",function(){h.focus(!h.multiSelect&&i.getValue())})};f.onHide=function(c){this.element.removeClass(j);i.setState(i.modes&&i.modes[a.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED);i._.on=0;if(!c&&i.onClose)i.onClose()};f.onEscape=function(){f.hide(1)};h.onClick=function(a,b){i.onClick&&i.onClick.call(i,a,b);f.hide()};this._.panel=f;this._.list=h;f.getBlock(this.id).onHide=function(){i._.on=0;i.setState(CKEDITOR.TRISTATE_OFF)};this.init&&this.init()}},setValue:function(a,e){this._.value=a;var c=this.document.getById("cke_"+this.id+"_text");if(c){if(!a&&!e){e=this.label;c.addClass("cke_combo_inlinelabel")}else c.removeClass("cke_combo_inlinelabel");c.setText(typeof e!="undefined"?e:a)}},getValue:function(){return this._.value||""},unmarkAll:function(){this._.list.unmarkAll()},mark:function(a){this._.list.mark(a)},hideItem:function(a){this._.list.hideItem(a)},hideGroup:function(a){this._.list.hideGroup(a)},showAll:function(){this._.list.showAll()},add:function(a,e,c){this._.items[a]=c||a;this._.list.add(a,e,c)},startGroup:function(a){this._.list.startGroup(a)},commit:function(){if(!this._.committed){this._.list.commit();this._.committed=1;CKEDITOR.ui.fire("ready",this)}this._.committed=1},setState:function(a){if(this._.state!=a){var e=this.document.getById("cke_"+this.id);e.setState(a,"cke_combo");a==CKEDITOR.TRISTATE_DISABLED?e.setAttribute("aria-disabled",true):e.removeAttribute("aria-disabled");this._.state=a}},getState:function(){return this._.state},enable:function(){this._.state==CKEDITOR.TRISTATE_DISABLED&&this.setState(this._.lastState)},disable:function(){if(this._.state!=CKEDITOR.TRISTATE_DISABLED){this._.lastState=this._.state;this.setState(CKEDITOR.TRISTATE_DISABLED)}}},statics:{handler:{create:function(a){return new CKEDITOR.ui.richCombo(a)}}}});CKEDITOR.ui.prototype.addRichCombo=function(a,e){this.add(a,CKEDITOR.UI_RICHCOMBO,e)}}(),CKEDITOR.plugins.add("format",{requires:"richcombo",init:function(a){if(!a.blockless){for(var e=a.config,b=a.lang.format,g=e.format_tags.split(";"),c={},d=0,j=[],f=0;f<g.length;f++){var h=g[f],i=new CKEDITOR.style(e["format_"+h]);if(!a.filter.customConfig||a.filter.check(i)){d++;c[h]=i;c[h]._.enterMode=a.config.enterMode;j.push(i)}}d!==0&&a.ui.addRichCombo("Format",{label:b.label,title:b.panelTitle,toolbar:"styles,20",allowedContent:j,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(e.contentsCss),multiSelect:false,attributes:{"aria-label":b.panelTitle}},init:function(){this.startGroup(b.panelTitle);for(var a in c){var d=b["tag_"+a];this.add(a,c[a].buildPreview(d),d)}},onClick:function(b){a.focus();a.fire("saveSnapshot");var b=c[b],d=a.elementPath();a[b.checkActive(d,a)?"removeStyle":"applyStyle"](b);setTimeout(function(){a.fire("saveSnapshot")},0)},onRender:function(){a.on("selectionChange",function(b){var d=this.getValue(),b=b.data.path;this.refresh();for(var f in c)if(c[f].checkActive(b,a)){f!=d&&this.setValue(f,a.lang.format["tag_"+f]);return}this.setValue("")},this)},onOpen:function(){this.showAll();for(var b in c)a.activeFilter.check(c[b])||this.hideItem(b)},refresh:function(){var b=a.elementPath();if(b){if(b.isContextFor("p"))for(var d in c)if(a.activeFilter.check(c[d]))return;this.setState(CKEDITOR.TRISTATE_DISABLED)}}})}}}),CKEDITOR.config.format_tags="p;h1;h2;h3;h4;h5;h6;pre;address;div",CKEDITOR.config.format_p={element:"p"},CKEDITOR.config.format_div={element:"div"},CKEDITOR.config.format_pre={element:"pre"},CKEDITOR.config.format_address={element:"address"},CKEDITOR.config.format_h1={element:"h1"},CKEDITOR.config.format_h2={element:"h2"},CKEDITOR.config.format_h3={element:"h3"},CKEDITOR.config.format_h4={element:"h4"},CKEDITOR.config.format_h5={element:"h5"},CKEDITOR.config.format_h6={element:"h6"},function(){var a={canUndo:false,exec:function(a){var b=a.document.createElement("hr");a.insertElement(b)},allowedContent:"hr",requiredContent:"hr"};CKEDITOR.plugins.add("horizontalrule",{init:function(e){if(!e.blockless){e.addCommand("horizontalrule",a);e.ui.addButton&&e.ui.addButton("HorizontalRule",{label:e.lang.horizontalrule.toolbar,command:"horizontalrule",toolbar:"insert,40"})}}})}(),CKEDITOR.plugins.add("htmlwriter",{init:function(a){var e=new CKEDITOR.htmlWriter;e.forceSimpleAmpersand=a.config.forceSimpleAmpersand;e.indentationChars=a.config.dataIndentationChars||"\t";a.dataProcessor.writer=e}}),CKEDITOR.htmlWriter=CKEDITOR.tools.createClass({base:CKEDITOR.htmlParser.basicWriter,$:function(){this.base();this.indentationChars="\t";this.selfClosingEnd=" />";this.lineBreakChars="\n";this.sortAttributes=1;this._.indent=0;this._.indentation="";this._.inPre=0;this._.rules={};var a=CKEDITOR.dtd,e;for(e in CKEDITOR.tools.extend({},a.$nonBodyContent,a.$block,a.$listItem,a.$tableContent))this.setRules(e,{indent:!a[e]["#"],breakBeforeOpen:1,breakBeforeClose:!a[e]["#"],breakAfterClose:1,needsSpace:e in a.$block&&!(e in{li:1,dt:1,dd:1})});this.setRules("br",{breakAfterOpen:1});this.setRules("title",{indent:0,breakAfterOpen:0});this.setRules("style",{indent:0,breakBeforeClose:1});this.setRules("pre",{breakAfterOpen:1,indent:0})},proto:{openTag:function(a){var e=this._.rules[a];this._.afterCloser&&(e&&e.needsSpace&&this._.needsSpace)&&this._.output.push("\n");if(this._.indent)this.indentation();else if(e&&e.breakBeforeOpen){this.lineBreak();this.indentation()}this._.output.push("<",a);this._.afterCloser=0},openTagClose:function(a,e){var b=this._.rules[a];if(e){this._.output.push(this.selfClosingEnd);if(b&&b.breakAfterClose)this._.needsSpace=b.needsSpace}else{this._.output.push(">");if(b&&b.indent)this._.indentation=this._.indentation+this.indentationChars}b&&b.breakAfterOpen&&this.lineBreak();a=="pre"&&(this._.inPre=1)},attribute:function(a,e){if(typeof e=="string"){this.forceSimpleAmpersand&&(e=e.replace(/&amp;/g,"&"));e=CKEDITOR.tools.htmlEncodeAttr(e)}this._.output.push(" ",a,'="',e,'"')},closeTag:function(a){var e=this._.rules[a];if(e&&e.indent)this._.indentation=this._.indentation.substr(this.indentationChars.length);if(this._.indent)this.indentation();else if(e&&e.breakBeforeClose){this.lineBreak();this.indentation()}this._.output.push("</",a,">");a=="pre"&&(this._.inPre=0);if(e&&e.breakAfterClose){this.lineBreak();this._.needsSpace=e.needsSpace}this._.afterCloser=1},text:function(a){if(this._.indent){this.indentation();!this._.inPre&&(a=CKEDITOR.tools.ltrim(a))}this._.output.push(a)},comment:function(a){this._.indent&&this.indentation();this._.output.push("<\!--",a,"--\>")},lineBreak:function(){!this._.inPre&&this._.output.length>0&&this._.output.push(this.lineBreakChars);this._.indent=1},indentation:function(){!this._.inPre&&this._.indentation&&this._.output.push(this._.indentation);this._.indent=0},reset:function(){this._.output=[];this._.indent=0;this._.indentation="";this._.afterCloser=0;this._.inPre=0},setRules:function(a,e){var b=this._.rules[a];b?CKEDITOR.tools.extend(b,e,true):this._.rules[a]=e}}}),function(){function a(a,e){e||(e=a.getSelection().getSelectedElement());if(e&&e.is("img")&&!e.data("cke-realelement")&&!e.isReadOnly())return e}function e(a){var e=a.getStyle("float");if(e=="inherit"||e=="none")e=0;e||(e=a.getAttribute("align"));return e}CKEDITOR.plugins.add("image",{requires:"dialog",init:function(b){if(!b.plugins.image2){CKEDITOR.dialog.add("image",this.path+"dialogs/image.js");var e="img[alt,!src]{border-style,border-width,float,height,margin,margin-bottom,margin-left,margin-right,margin-top,width}";CKEDITOR.dialog.isTabEnabled(b,"image","advanced")&&(e="img[alt,dir,id,lang,longdesc,!src,title]{*}(*)");b.addCommand("image",new CKEDITOR.dialogCommand("image",{allowedContent:e,requiredContent:"img[alt,src]",contentTransformations:[["img{width}: sizeToStyle","img[width]: sizeToAttribute"],["img{float}: alignmentToStyle","img[align]: alignmentToAttribute"]]}));b.ui.addButton&&b.ui.addButton("Image",{label:b.lang.common.image,command:"image",toolbar:"insert,10"});b.on("doubleclick",function(a){var b=a.data.element;if(b.is("img")&&!b.data("cke-realelement")&&!b.isReadOnly())a.data.dialog="image"});b.addMenuItems&&b.addMenuItems({image:{label:b.lang.image.menu,command:"image",group:"image"}});b.contextMenu&&b.contextMenu.addListener(function(c){if(a(b,c))return{image:CKEDITOR.TRISTATE_OFF}})}},afterInit:function(b){function g(c){var d=b.getCommand("justify"+c);if(d){if(c=="left"||c=="right")d.on("exec",function(d){var f=a(b),g;if(f){g=e(f);if(g==c){f.removeStyle("float");c==e(f)&&f.removeAttribute("align")}else f.setStyle("float",c);d.cancel()}});d.on("refresh",function(d){var f=a(b);if(f){f=e(f);this.setState(f==c?CKEDITOR.TRISTATE_ON:c=="right"||c=="left"?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED);d.cancel()}})}}if(!b.plugins.image2){g("left");g("right");g("center");g("block")}}})}(),CKEDITOR.config.image_removeLinkByEmptyURL=!0,function(){function a(a,b){var c=g.exec(a),e=g.exec(b);if(c){if(!c[2]&&e[2]=="px")return e[1];if(c[2]=="px"&&!e[2])return e[1]+"px"}return b}var e=CKEDITOR.htmlParser.cssStyle,b=CKEDITOR.tools.cssLength,g=/^((?:\d*(?:\.\d+))|(?:\d+))(.*)?$/i,c={elements:{$:function(b){var c=b.attributes;if((c=(c=(c=c&&c["data-cke-realelement"])&&new CKEDITOR.htmlParser.fragment.fromHtml(decodeURIComponent(c)))&&c.children[0])&&b.attributes["data-cke-resizable"]){var f=(new e(b)).rules,b=c.attributes,g=f.width,f=f.height;g&&(b.width=a(b.width,g));f&&(b.height=a(b.height,f))}return c}}};CKEDITOR.plugins.add("fakeobjects",{init:function(a){a.filter.allow("img[!data-cke-realelement,src,alt,title](*){*}","fakeobjects")},afterInit:function(a){(a=(a=a.dataProcessor)&&a.htmlFilter)&&a.addRules(c,{applyToAll:true})}});CKEDITOR.editor.prototype.createFakeElement=function(a,c,f,g){var i=this.lang.fakeobjects,i=i[f]||i.unknown,c={"class":c,"data-cke-realelement":encodeURIComponent(a.getOuterHtml()),"data-cke-real-node-type":a.type,alt:i,title:i,align:a.getAttribute("align")||""};if(!CKEDITOR.env.hc)c.src=CKEDITOR.tools.transparentImageData;f&&(c["data-cke-real-element-type"]=f);if(g){c["data-cke-resizable"]=g;f=new e;g=a.getAttribute("width");a=a.getAttribute("height");g&&(f.rules.width=b(g));a&&(f.rules.height=b(a));f.populate(c)}return this.document.createElement("img",{attributes:c})};CKEDITOR.editor.prototype.createFakeParserElement=function(a,c,f,g){var i=this.lang.fakeobjects,i=i[f]||i.unknown,k;k=new CKEDITOR.htmlParser.basicWriter;a.writeHtml(k);k=k.getHtml();c={"class":c,"data-cke-realelement":encodeURIComponent(k),"data-cke-real-node-type":a.type,alt:i,title:i,align:a.attributes.align||""};if(!CKEDITOR.env.hc)c.src=CKEDITOR.tools.transparentImageData;f&&(c["data-cke-real-element-type"]=f);if(g){c["data-cke-resizable"]=g;g=a.attributes;a=new e;f=g.width;g=g.height;f!==void 0&&(a.rules.width=b(f));g!==void 0&&(a.rules.height=b(g));a.populate(c)}return new CKEDITOR.htmlParser.element("img",c)};CKEDITOR.editor.prototype.restoreRealElement=function(b){if(b.data("cke-real-node-type")!=CKEDITOR.NODE_ELEMENT)return null;var c=CKEDITOR.dom.element.createFromHtml(decodeURIComponent(b.data("cke-realelement")),this.document);if(b.data("cke-resizable")){var f=b.getStyle("width"),b=b.getStyle("height");f&&c.setAttribute("width",a(c.getAttribute("width"),f));b&&c.setAttribute("height",a(c.getAttribute("height"),b))}return c}}(),"use strict",function(){function a(a){return a.replace(/'/g,"\\$&")}
function e(a){for(var b,c=a.length,d=[],f=0;f<c;f++){b=a.charCodeAt(f);d.push(b)}return"String.fromCharCode("+d.join(",")+")"}function b(b,c){var d=b.plugins.link,f=d.compiledProtectionFunction.params,e,g;g=[d.compiledProtectionFunction.name,"("];for(var h=0;h<f.length;h++){d=f[h].toLowerCase();e=c[d];h>0&&g.push(",");g.push("'",e?a(encodeURIComponent(c[d])):"","'")}g.push(")");return g.join("")}function g(a){var a=a.config.emailProtection||"",b;if(a&&a!="encode"){b={};a.replace(/^([^(]+)\(([^)]+)\)$/,function(a,c,d){b.name=c;b.params=[];d.replace(/[^,\s]+/g,function(a){b.params.push(a)})})}return b}CKEDITOR.plugins.add("link",{requires:"dialog,fakeobjects",onLoad:function(){function a(b){return c.replace(/%1/g,b=="rtl"?"right":"left").replace(/%2/g,"cke_contents_"+b)}var b="background:url("+CKEDITOR.getUrl(this.path+"images"+(CKEDITOR.env.hidpi?"/hidpi":"")+"/anchor.png")+") no-repeat %1 center;border:1px dotted #00f;background-size:16px;",c=".%2 a.cke_anchor,.%2 a.cke_anchor_empty,.cke_editable.%2 a[name],.cke_editable.%2 a[data-cke-saved-name]{"+
b+"padding-%1:18px;cursor:auto;}.%2 img.cke_anchor{"+b+"width:16px;min-height:15px;height:1.15em;vertical-align:text-bottom;}";CKEDITOR.addCss(a("ltr")+a("rtl"))},init:function(a){var b="a[!href]";CKEDITOR.dialog.isTabEnabled(a,"link","advanced")&&(b=b.replace("]",",accesskey,charset,dir,id,lang,name,rel,tabindex,title,type]{*}(*)"));CKEDITOR.dialog.isTabEnabled(a,"link","target")&&(b=b.replace("]",",target,onclick]"));a.addCommand("link",new CKEDITOR.dialogCommand("link",{allowedContent:b,requiredContent:"a[href]"}));a.addCommand("anchor",new CKEDITOR.dialogCommand("anchor",{allowedContent:"a[!name,id]",requiredContent:"a[name]"}));a.addCommand("unlink",new CKEDITOR.unlinkCommand);a.addCommand("removeAnchor",new CKEDITOR.removeAnchorCommand);a.setKeystroke(CKEDITOR.CTRL+76,"link");if(a.ui.addButton){a.ui.addButton("Link",{label:a.lang.link.toolbar,command:"link",toolbar:"links,10"});a.ui.addButton("Unlink",{label:a.lang.link.unlink,command:"unlink",toolbar:"links,20"});a.ui.addButton("Anchor",{label:a.lang.link.anchor.toolbar,command:"anchor",toolbar:"links,30"})}CKEDITOR.dialog.add("link",this.path+"dialogs/link.js");CKEDITOR.dialog.add("anchor",this.path+"dialogs/anchor.js");a.on("doubleclick",function(b){var c=CKEDITOR.plugins.link.getSelectedLink(a)||b.data.element;if(!c.isReadOnly())if(c.is("a")){b.data.dialog=c.getAttribute("name")&&(!c.getAttribute("href")||!c.getChildCount())?"anchor":"link";b.data.link=c}else if(CKEDITOR.plugins.link.tryRestoreFakeAnchor(a,c))b.data.dialog="anchor"},null,null,0);a.on("doubleclick",function(b){b.data.dialog in{link:1,anchor:1}&&b.data.link&&a.getSelection().selectElement(b.data.link)},null,null,20);a.addMenuItems&&a.addMenuItems({anchor:{label:a.lang.link.anchor.menu,command:"anchor",group:"anchor",order:1},removeAnchor:{label:a.lang.link.anchor.remove,command:"removeAnchor",group:"anchor",order:5},link:{label:a.lang.link.menu,command:"link",group:"link",order:1},unlink:{label:a.lang.link.unlink,command:"unlink",group:"link",order:5}});a.contextMenu&&a.contextMenu.addListener(function(b){if(!b||b.isReadOnly())return null;b=CKEDITOR.plugins.link.tryRestoreFakeAnchor(a,b);if(!b&&!(b=CKEDITOR.plugins.link.getSelectedLink(a)))return null;var c={};b.getAttribute("href")&&b.getChildCount()&&(c={link:CKEDITOR.TRISTATE_OFF,unlink:CKEDITOR.TRISTATE_OFF});if(b&&b.hasAttribute("name"))c.anchor=c.removeAnchor=CKEDITOR.TRISTATE_OFF;return c});this.compiledProtectionFunction=g(a)},afterInit:function(a){a.dataProcessor.dataFilter.addRules({elements:{a:function(b){return!b.attributes.name?null:!b.children.length?a.createFakeParserElement(b,"cke_anchor","anchor"):null}}});var b=a._.elementsPath&&a._.elementsPath.filters;b&&b.push(function(b,c){if(c=="a"&&(CKEDITOR.plugins.link.tryRestoreFakeAnchor(a,b)||b.getAttribute("name")&&(!b.getAttribute("href")||!b.getChildCount())))return"anchor"})}});var c=/^javascript:/,d=/^mailto:([^?]+)(?:\?(.+))?$/,j=/subject=([^;?:@&=$,\/]*)/,f=/body=([^;?:@&=$,\/]*)/,h=/^#(.*)$/,i=/^((?:http|https|ftp|news):\/\/)?(.*)$/,k=/^(_(?:self|top|parent|blank))$/,n=/^javascript:void\(location\.href='mailto:'\+String\.fromCharCode\(([^)]+)\)(?:\+'(.*)')?\)$/,o=/^javascript:([^(]+)\(([^)]+)\)$/,q=/\s*window.open\(\s*this\.href\s*,\s*(?:'([^']*)'|null)\s*,\s*'([^']*)'\s*\)\s*;\s*return\s*false;*\s*/,m=/(?:^|,)([^=]+)=(\d+|yes|no)/gi,l={id:"advId",dir:"advLangDir",accessKey:"advAccessKey",name:"advName",lang:"advLangCode",tabindex:"advTabIndex",title:"advTitle",type:"advContentType","class":"advCSSClasses",charset:"advCharset",style:"advStyles",rel:"advRel"};CKEDITOR.plugins.link={getSelectedLink:function(a){var b=a.getSelection(),c=b.getSelectedElement();if(c&&c.is("a"))return c;if(b=b.getRanges()[0]){b.shrink(CKEDITOR.SHRINK_TEXT);return a.elementPath(b.getCommonAncestor()).contains("a",1)}return null},getEditorAnchors:function(a){for(var b=a.editable(),c=b.isInline()&&!a.plugins.divarea?a.document:b,b=c.getElementsByTag("a"),c=c.getElementsByTag("img"),d=[],f=0,e;e=b.getItem(f++);)if(e.data("cke-saved-name")||e.hasAttribute("name"))d.push({name:e.data("cke-saved-name")||e.getAttribute("name"),id:e.getAttribute("id")});for(f=0;e=c.getItem(f++);)(e=this.tryRestoreFakeAnchor(a,e))&&d.push({name:e.getAttribute("name"),id:e.getAttribute("id")});return d},fakeAnchor:true,tryRestoreFakeAnchor:function(a,b){if(b&&b.data("cke-real-element-type")&&b.data("cke-real-element-type")=="anchor"){var c=a.restoreRealElement(b);if(c.data("cke-saved-name"))return c}},parseLinkAttributes:function(a,b){var e=b&&(b.data("cke-saved-href")||b.getAttribute("href"))||"",g=a.plugins.link.compiledProtectionFunction,w=a.config.emailProtection,x,v={};e.match(c)&&(w=="encode"?e=e.replace(n,function(a,b,c){return"mailto:"+String.fromCharCode.apply(String,b.split(","))+(c&&c.replace(/\\'/g,"'"))}):w&&e.replace(o,function(a,b,c){if(b==g.name){v.type="email";for(var a=v.email={},b=/(^')|('$)/g,c=c.match(/[^,\s]+/g),d=c.length,f,e,h=0;h<d;h++){f=decodeURIComponent;e=c[h].replace(b,"").replace(/\\'/g,"'");e=f(e);f=g.params[h].toLowerCase();a[f]=e}a.address=[a.name,a.domain].join("@")}}));if(!v.type)if(w=e.match(h)){v.type="anchor";v.anchor={};v.anchor.name=v.anchor.id=w[1]}else if(w=e.match(d)){x=e.match(j);e=e.match(f);v.type="email";var r=v.email={};r.address=w[1];x&&(r.subject=decodeURIComponent(x[1]));e&&(r.body=decodeURIComponent(e[1]))}else if(e&&(x=e.match(i))){v.type="url";v.url={};v.url.protocol=x[1];v.url.url=x[2]}if(b){if(e=b.getAttribute("target"))v.target={type:e.match(k)?e:"frame",name:e};else if(e=(e=b.data("cke-pa-onclick")||b.getAttribute("onclick"))&&e.match(q))for(v.target={type:"popup",name:e[1]};w=m.exec(e[2]);)(w[2]=="yes"||w[2]=="1")&&!(w[1]in{height:1,width:1,top:1,left:1})?v.target[w[1]]=true:isFinite(w[2])&&(v.target[w[1]]=w[2]);var e={},y;for(y in l)(w=b.getAttribute(y))&&(e[l[y]]=w);if(y=b.data("cke-saved-name")||e.advName)e.advName=y;if(!CKEDITOR.tools.isEmpty(e))v.advanced=e}return v},getLinkAttributes:function(c,d){var f=c.config.emailProtection||"",g={};switch(d.type){case"url":var f=d.url&&d.url.protocol!==void 0?d.url.protocol:"http://",h=d.url&&CKEDITOR.tools.trim(d.url.url)||"";g["data-cke-saved-href"]=h.indexOf("/")===0?h:f+h;break;case"anchor":f=d.anchor&&d.anchor.id;g["data-cke-saved-href"]="#"+(d.anchor&&d.anchor.name||f||"");break;case"email":var i=d.email,h=i.address;switch(f){case"":case"encode":var j=encodeURIComponent(i.subject||""),k=encodeURIComponent(i.body||""),i=[];j&&i.push("subject="+j);k&&i.push("body="+k);i=i.length?"?"+i.join("&"):"";if(f=="encode"){f=["javascript:void(location.href='mailto:'+",e(h)];i&&f.push("+'",a(i),"'");f.push(")")}else f=["mailto:",h,i];break;default:f=h.split("@",2);i.name=f[0];i.domain=f[1];f=["javascript:",b(c,i)]}g["data-cke-saved-href"]=f.join("")}if(d.target)if(d.target.type=="popup"){for(var f=["window.open(this.href, '",d.target.name||"","', '"],m=["resizable","status","location","toolbar","menubar","fullscreen","scrollbars","dependent"],h=m.length,j=function(a){d.target[a]&&m.push(a+"="+d.target[a])},i=0;i<h;i++)m[i]=m[i]+(d.target[m[i]]?"=yes":"=no");j("width");j("left");j("height");j("top");f.push(m.join(","),"'); return false;");g["data-cke-pa-onclick"]=f.join("")}else if(d.target.type!="notSet"&&d.target.name)g.target=d.target.name;if(d.advanced){for(var q in l)(f=d.advanced[l[q]])&&(g[q]=f);if(g.name)g["data-cke-saved-name"]=g.name}if(g["data-cke-saved-href"])g.href=g["data-cke-saved-href"];q=CKEDITOR.tools.extend({target:1,onclick:1,"data-cke-pa-onclick":1,"data-cke-saved-name":1},l);for(var n in g)delete q[n];return{set:g,removed:CKEDITOR.tools.objectKeys(q)}}};CKEDITOR.unlinkCommand=function(){};CKEDITOR.unlinkCommand.prototype={exec:function(a){var b=new CKEDITOR.style({element:"a",type:CKEDITOR.STYLE_INLINE,alwaysRemoveElement:1});a.removeStyle(b)},refresh:function(a,b){var c=b.lastElement&&b.lastElement.getAscendant("a",true);c&&c.getName()=="a"&&c.getAttribute("href")&&c.getChildCount()?this.setState(CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_DISABLED)},contextSensitive:1,startDisabled:1,requiredContent:"a[href]"};CKEDITOR.removeAnchorCommand=function(){};CKEDITOR.removeAnchorCommand.prototype={exec:function(a){var b=a.getSelection(),c=b.createBookmarks(),d;if(b&&(d=b.getSelectedElement())&&(!d.getChildCount()?CKEDITOR.plugins.link.tryRestoreFakeAnchor(a,d):d.is("a")))d.remove(1);else if(d=CKEDITOR.plugins.link.getSelectedLink(a))if(d.hasAttribute("href")){d.removeAttributes({name:1,"data-cke-saved-name":1});d.removeClass("cke_anchor")}else d.remove(1);b.selectBookmarks(c)},requiredContent:"a[name]"};CKEDITOR.tools.extend(CKEDITOR.config,{linkShowAdvancedTab:true,linkShowTargetTab:true})}(),"use strict",function(){function a(a,b,c){return k(b)&&k(c)&&c.equals(b.getNext(function(a){return!(Y(a)||Z(a)||n(a))}))}function e(a){this.upper=a[0];this.lower=a[1];this.set.apply(this,a.slice(2))}function b(a){var b=a.element;if(b&&k(b))if((b=b.getAscendant(a.triggers,true))&&a.editable.contains(b)){var c=d(b);if(c.getAttribute("contenteditable")=="true")return b;if(c.is(a.triggers))return c}return null}function g(a,b,c){u(a,b);u(a,c);a=b.size.bottom;c=c.size.top;return a&&c?0|(a+c)/2:a||c}function c(a,b,c){return b=b[c?"getPrevious":"getNext"](function(b){return b&&b.type==CKEDITOR.NODE_TEXT&&!Y(b)||k(b)&&!n(b)&&!i(a,b)})}function d(a,b){if(a.data("cke-editable"))return null;for(b||(a=a.getParent());a;){if(a.data("cke-editable"))break;if(a.hasAttribute("contenteditable"))return a;a=a.getParent()}return null}function j(a){var b=a.doc,c=z('<span contenteditable="false" style="'+P+"position:absolute;border-top:1px dashed "+a.boxColor+'"></span>',b),d=CKEDITOR.getUrl(this.path+"images/"+(B.hidpi?"hidpi/":"")+"icon"+(a.rtl?"-rtl":"")+".png");r(c,{attach:function(){this.wrap.getParent()||this.wrap.appendTo(a.editable,true);return this},lineChildren:[r(z('<span title="'+a.editor.lang.magicline.title+'" contenteditable="false">&#8629;</span>',b),{base:P+"height:17px;width:17px;"+(a.rtl?"left":"right")+":17px;background:url("+d+") center no-repeat "+a.boxColor+";cursor:pointer;"+(B.hc?"font-size: 15px;line-height:14px;border:1px solid #fff;text-align:center;":"")+(B.hidpi?"background-size: 9px 10px;":""),looks:["top:-8px;"+CKEDITOR.tools.cssVendorPrefix("border-radius","2px",1),"top:-17px;"+CKEDITOR.tools.cssVendorPrefix("border-radius","2px 2px 0px 0px",1),"top:-1px;"+CKEDITOR.tools.cssVendorPrefix("border-radius","0px 0px 2px 2px",1)]}),r(z(W,b),{base:V+"left:0px;border-left-color:"+a.boxColor+";",looks:["border-width:8px 0 8px 8px;top:-8px","border-width:8px 0 0 8px;top:-8px","border-width:0 0 8px 8px;top:0px"]}),r(z(W,b),{base:V+"right:0px;border-right-color:"+a.boxColor+";",looks:["border-width:8px 8px 8px 0;top:-8px","border-width:8px 8px 0 0;top:-8px","border-width:0 8px 8px 0;top:0px"]})],detach:function(){this.wrap.getParent()&&this.wrap.remove();return this},mouseNear:function(){u(a,this);var b=a.holdDistance,c=this.size;return c&&a.mouse.y>c.top-b&&a.mouse.y<c.bottom+b&&a.mouse.x>c.left-b&&a.mouse.x<c.right+b?true:false},place:function(){var b=a.view,c=a.editable,d=a.trigger,f=d.upper,e=d.lower,g=f||e,h=g.getParent(),i={};this.trigger=d;f&&u(a,f,true);e&&u(a,e,true);u(a,h,true);a.inInlineMode&&w(a,true);if(h.equals(c)){i.left=b.scroll.x;i.right=-b.scroll.x;i.width=""}else{i.left=g.size.left-g.size.margin.left+b.scroll.x-
(a.inInlineMode?b.editable.left+b.editable.border.left:0);i.width=g.size.outerWidth+g.size.margin.left+g.size.margin.right+b.scroll.x;i.right=""}if(f&&e)i.top=f.size.margin.bottom===e.size.margin.top?0|f.size.bottom+f.size.margin.bottom/2:f.size.margin.bottom<e.size.margin.top?f.size.bottom+f.size.margin.bottom:f.size.bottom+f.size.margin.bottom-e.size.margin.top;else if(f){if(!e)i.top=f.size.bottom+f.size.margin.bottom}else i.top=e.size.top-e.size.margin.top;if(d.is(L)||i.top>b.scroll.y-15&&i.top<b.scroll.y+5){i.top=a.inInlineMode?0:b.scroll.y;this.look(L)}else if(d.is(H)||i.top>b.pane.bottom-5&&i.top<b.pane.bottom+15){i.top=a.inInlineMode?b.editable.height+b.editable.padding.top+b.editable.padding.bottom:b.pane.bottom-1;this.look(H)}else{if(a.inInlineMode)i.top=i.top-(b.editable.top+b.editable.border.top);this.look(Q)}if(a.inInlineMode){i.top--;i.top=i.top+b.editable.scroll.top;i.left=i.left+b.editable.scroll.left}for(var j in i)i[j]=CKEDITOR.tools.cssLength(i[j]);this.setStyles(i)},look:function(a){if(this.oldLook!=a){for(var b=this.lineChildren.length,c;b--;)(c=this.lineChildren[b]).setAttribute("style",c.base+c.looks[0|a/2]);this.oldLook=a}},wrap:new y("span",a.doc)});for(b=c.lineChildren.length;b--;)c.lineChildren[b].appendTo(c);c.look(Q);c.appendTo(c.wrap);c.unselectable();c.lineChildren[0].on("mouseup",function(b){c.detach();f(a,function(b){var c=a.line.trigger;b[c.is(J)?"insertBefore":"insertAfter"](c.is(J)?c.lower:c.upper)},true);a.editor.focus();!B.ie&&a.enterMode!=CKEDITOR.ENTER_BR&&a.hotNode.scrollIntoView();b.data.preventDefault(true)});c.on("mousedown",function(a){a.data.preventDefault(true)});a.line=c}function f(a,b,c){var f=new CKEDITOR.dom.range(a.doc),e=a.editor,g;if(B.ie&&a.enterMode==CKEDITOR.ENTER_BR)g=a.doc.createText(O);else{g=(g=d(a.element,true))&&g.data("cke-enter-mode")||a.enterMode;g=new y(D[g],a.doc);g.is("br")||a.doc.createText(O).appendTo(g)}c&&e.fire("saveSnapshot");b(g);f.moveToPosition(g,CKEDITOR.POSITION_AFTER_START);e.getSelection().selectRanges([f]);a.hotNode=g;c&&e.fire("saveSnapshot")}
function h(a,e){return{canUndo:true,modes:{wysiwyg:1},exec:function(){function g(b){var c=B.ie&&B.version<9?" ":O,d=a.hotNode&&a.hotNode.getText()==c&&a.element.equals(a.hotNode)&&a.lastCmdDirection===!!e;f(a,function(c){d&&a.hotNode&&a.hotNode.remove();c[e?"insertAfter":"insertBefore"](b);c.setAttributes({"data-cke-magicline-hot":1,"data-cke-magicline-dir":!!e});a.lastCmdDirection=!!e});!B.ie&&a.enterMode!=CKEDITOR.ENTER_BR&&a.hotNode.scrollIntoView();a.line.detach()}return function(f){var f=f.getSelection().getStartElement(),h,f=f.getAscendant(N,1);if(!m(a,f)&&f&&!f.equals(a.editable)&&!f.contains(a.editable)){if((h=d(f))&&h.getAttribute("contenteditable")=="false")f=h;a.element=f;h=c(a,f,!e);var i;if(k(h)&&h.is(a.triggers)&&h.is(R)&&(!c(a,h,!e)||(i=c(a,h,!e))&&k(i)&&i.is(a.triggers)))g(h);else{i=b(a,f);if(k(i))if(c(a,i,!e))(f=c(a,i,!e))&&(k(f)&&f.is(a.triggers))&&g(i);else g(i)}}}}()}}function i(a,b){if(!b||!(b.type==CKEDITOR.NODE_ELEMENT&&b.$))return false;var c=a.line;return c.wrap.equals(b)||c.wrap.contains(b)}function k(a){return a&&a.type==CKEDITOR.NODE_ELEMENT&&a.$}function n(a){if(!k(a))return false;var b;if(!(b=o(a)))if(k(a)){b={left:1,right:1,center:1};b=!(!b[a.getComputedStyle("float")]&&!b[a.getAttribute("align")])}else b=false;return b}function o(a){return!!{absolute:1,fixed:1}[a.getComputedStyle("position")]}function q(a,b){return k(b)?b.is(a.triggers):null}function m(a,b){if(!b)return false;for(var c=b.getParents(1),d=c.length;d--;)for(var f=a.tabuList.length;f--;)if(c[d].hasAttribute(a.tabuList[f]))return true;return false}
function l(a,b,c){b=b[c?"getLast":"getFirst"](function(b){return a.isRelevant(b)&&!b.is(K)});if(!b)return false;u(a,b);return c?b.size.top>a.mouse.y:b.size.bottom<a.mouse.y}function p(a){var b=a.editable,c=a.mouse,d=a.view,f=a.triggerOffset;w(a);var g=c.y>(a.inInlineMode?d.editable.top+d.editable.height/2:Math.min(d.editable.height,d.pane.height)/2),b=b[g?"getLast":"getFirst"](function(a){return!(Y(a)||Z(a))});if(!b)return null;i(a,b)&&(b=a.line.wrap[g?"getPrevious":"getNext"](function(a){return!(Y(a)||Z(a))}));if(!k(b)||n(b)||!q(a,b))return null;u(a,b);if(!g&&b.size.top>=0&&c.y>0&&c.y<b.size.top+f){a=a.inInlineMode||d.scroll.y===0?L:Q;return new e([null,b,J,E,a])}if(g&&b.size.bottom<=d.pane.height&&c.y>b.size.bottom-f&&c.y<d.pane.height){a=a.inInlineMode||b.size.bottom>d.pane.height-f&&b.size.bottom<d.pane.height?H:Q;return new e([b,null,C,E,a])}return null}function t(a){var d=a.mouse,f=a.view,g=a.triggerOffset,h=b(a);if(!h)return null;u(a,h);var g=Math.min(g,0|h.size.outerHeight/2),i=[],j,m;if(d.y>h.size.top-1&&d.y<h.size.top+g)m=false;else if(d.y>h.size.bottom-g&&d.y<h.size.bottom+1)m=true;else return null;if(n(h)||l(a,h,m)||h.getParent().is(M))return null;var p=c(a,h,!m);if(p){if(p&&p.type==CKEDITOR.NODE_TEXT)return null;if(k(p)){if(n(p)||!q(a,p)||p.getParent().is(M))return null;i=[p,h][m?"reverse":"concat"]().concat([F,E])}}else{if(h.equals(a.editable[m?"getLast":"getFirst"](a.isRelevant))){w(a);m&&d.y>h.size.bottom-g&&d.y<f.pane.height&&h.size.bottom>f.pane.height-g&&h.size.bottom<f.pane.height?j=H:d.y>0&&d.y<h.size.top+g&&(j=L)}else j=Q;i=[null,h][m?"reverse":"concat"]().concat([m?C:J,E,j,h.equals(a.editable[m?"getLast":"getFirst"](a.isRelevant))?m?H:L:Q])}return 0 in i?new e(i):null}function s(a,b,c,d){for(var f=function(){var c=B.ie?b.$.currentStyle:a.win.$.getComputedStyle(b.$,"");return B.ie?function(a){return c[CKEDITOR.tools.cssStyleToDomStyle(a)]}:function(a){return c.getPropertyValue(a)}}(),e=b.getDocumentPosition(),g={},h={},i={},j={},k=X.length;k--;){g[X[k]]=parseInt(f("border-"+
X[k]+"-width"),10)||0;i[X[k]]=parseInt(f("padding-"+X[k]),10)||0;h[X[k]]=parseInt(f("margin-"+X[k]),10)||0}(!c||d)&&x(a,d);j.top=e.y-(c?0:a.view.scroll.y);j.left=e.x-(c?0:a.view.scroll.x);j.outerWidth=b.$.offsetWidth;j.outerHeight=b.$.offsetHeight;j.height=j.outerHeight-(i.top+i.bottom+g.top+g.bottom);j.width=j.outerWidth-(i.left+i.right+g.left+g.right);j.bottom=j.top+j.outerHeight;j.right=j.left+j.outerWidth;if(a.inInlineMode)j.scroll={top:b.$.scrollTop,left:b.$.scrollLeft};return r({border:g,padding:i,margin:h,ignoreScroll:c},j,true)}function u(a,b,c){if(!k(b))return b.size=null;if(b.size){if(b.size.ignoreScroll==c&&b.size.date>new Date-T)return null}else b.size={};return r(b.size,s(a,b,c),{date:+new Date},true)}function w(a,b){a.view.editable=s(a,a.editable,b,true)}function x(a,b){if(!a.view)a.view={};var c=a.view;if(b||!(c&&c.date>new Date-T)){var d=a.win,c=d.getScrollPosition(),d=d.getViewPaneSize();r(a.view,{scroll:{x:c.x,y:c.y,width:a.doc.$.documentElement.scrollWidth-d.width,height:a.doc.$.documentElement.scrollHeight-
d.height},pane:{width:d.width,height:d.height,bottom:d.height+c.y},date:+new Date},true)}}function v(a,b,c,d){for(var f=d,g=d,h=0,i=false,j=false,k=a.view.pane.height,m=a.mouse;m.y+h<k&&m.y-h>0;){i||(i=b(f,d));j||(j=b(g,d));!i&&m.y-h>0&&(f=c(a,{x:m.x,y:m.y-h}));!j&&m.y+h<k&&(g=c(a,{x:m.x,y:m.y+h}));if(i&&j)break;h=h+2}return new e([f,g,null,null])}CKEDITOR.plugins.add("magicline",{init:function(a){var d=a.config,g=d.magicline_triggerOffset||30,l={editor:a,enterMode:d.enterMode,triggerOffset:g,holdDistance:0|g*(d.magicline_holdDistance||0.5),boxColor:d.magicline_color||"#ff0000",rtl:d.contentsLangDirection=="rtl",tabuList:["data-cke-hidden-sel"].concat(d.magicline_tabuList||[]),triggers:d.magicline_everywhere?N:{table:1,hr:1,div:1,ul:1,ol:1,dl:1,form:1,blockquote:1}},q,u,v;l.isRelevant=function(a){return k(a)&&!i(l,a)&&!n(a)};a.on("contentDom",function(){var g=a.editable(),k=a.document,n=a.window;r(l,{editable:g,inInlineMode:g.isInline(),doc:k,win:n,hotNode:null},true);l.boundary=l.inInlineMode?l.editable:l.doc.getDocumentElement();if(!g.is(G.$inline)){l.inInlineMode&&!o(g)&&g.setStyles({position:"relative",top:null,left:null});j.call(this,l);x(l);g.attachListener(a,"beforeUndoImage",function(){l.line.detach()});g.attachListener(a,"beforeGetData",function(){if(l.line.wrap.getParent()){l.line.detach();a.once("getData",function(){l.line.attach()},null,null,1E3)}},null,null,0);g.attachListener(l.inInlineMode?k:k.getWindow().getFrame(),"mouseout",function(b){if(a.mode=="wysiwyg")if(l.inInlineMode){var c=b.data.$.clientX,b=b.data.$.clientY;x(l);w(l,true);var d=l.view.editable,f=l.view.scroll;if(!(c>d.left-f.x&&c<d.right-f.x)||!(b>d.top-f.y&&b<d.bottom-f.y)){clearTimeout(v);v=null;l.line.detach()}}else{clearTimeout(v);v=null;l.line.detach()}});g.attachListener(g,"keyup",function(){l.hiddenMode=0});g.attachListener(g,"keydown",function(b){if(a.mode=="wysiwyg")switch(b.data.getKeystroke()){case 2228240:case 16:l.hiddenMode=1;l.line.detach()}});g.attachListener(l.inInlineMode?g:k,"mousemove",function(b){u=true;if(!(a.mode!="wysiwyg"||a.readOnly||v)){var c={x:b.data.$.clientX,y:b.data.$.clientY};v=setTimeout(function(){l.mouse=c;v=l.trigger=null;x(l);if(u&&!l.hiddenMode&&a.focusManager.hasFocus&&!l.line.mouseNear()&&(l.element=S(l,true))){if((l.trigger=p(l)||t(l)||ba(l))&&!m(l,l.trigger.upper||l.trigger.lower))l.line.attach().place();else{l.trigger=null;l.line.detach()}u=false}},30)}});g.attachListener(n,"scroll",function(){if(a.mode=="wysiwyg"){l.line.detach();if(B.webkit){l.hiddenMode=1;clearTimeout(q);q=setTimeout(function(){if(!l.mouseDown)l.hiddenMode=0},50)}}});g.attachListener(A?k:n,"mousedown",function(){if(a.mode=="wysiwyg"){l.line.detach();l.hiddenMode=1;l.mouseDown=1}});g.attachListener(A?k:n,"mouseup",function(){l.hiddenMode=0;l.mouseDown=0});a.addCommand("accessPreviousSpace",h(l));a.addCommand("accessNextSpace",h(l,true));a.setKeystroke([[d.magicline_keystrokePrevious,"accessPreviousSpace"],[d.magicline_keystrokeNext,"accessNextSpace"]]);a.on("loadSnapshot",function(){var b,c,d,f;for(f in{p:1,br:1,div:1}){b=a.document.getElementsByTag(f);for(d=b.count();d--;)if((c=b.getItem(d)).data("cke-magicline-hot")){l.hotNode=c;l.lastCmdDirection=c.data("cke-magicline-dir")==="true"?true:false;return}}});this.backdoor={accessFocusSpace:f,boxTrigger:e,isLine:i,getAscendantTrigger:b,getNonEmptyNeighbour:c,getSize:s,that:l,triggerEdge:t,triggerEditable:p,triggerExpand:ba}}},this)}});var r=CKEDITOR.tools.extend,y=CKEDITOR.dom.element,z=y.createFromHtml,B=CKEDITOR.env,A=CKEDITOR.env.ie&&CKEDITOR.env.version<9,G=CKEDITOR.dtd,D={},J=128,C=64,F=32,E=16,I=8,L=4,H=2,Q=1,O=" ",M=G.$listItem,K=G.$tableContent,R=r({},G.$nonEditable,G.$empty),N=G.$block,T=100,P="width:0px;height:0px;padding:0px;margin:0px;display:block;z-index:9999;color:#fff;position:absolute;font-size: 0px;line-height:0px;",V=P+"border-color:transparent;display:block;border-style:solid;",W="<span>"+O+"</span>";D[CKEDITOR.ENTER_BR]="br";D[CKEDITOR.ENTER_P]="p";D[CKEDITOR.ENTER_DIV]="div";e.prototype={set:function(a,b,c){this.properties=a+b+
(c||Q);return this},is:function(a){return(this.properties&a)==a}};var S=function(){function a(b,c){var d=b.$.elementFromPoint(c.x,c.y);return d&&d.nodeType?new CKEDITOR.dom.element(d):null}return function(b,c,d){if(!b.mouse)return null;var f=b.doc,e=b.line.wrap,d=d||b.mouse,g=a(f,d);if(c&&i(b,g)){e.hide();g=a(f,d);e.show()}return!g||!(g.type==CKEDITOR.NODE_ELEMENT&&g.$)||B.ie&&B.version<9&&!b.boundary.equals(g)&&!b.boundary.contains(g)?null:g}}(),Y=CKEDITOR.dom.walker.whitespaces(),Z=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_COMMENT),ba=function(){function b(d){var f=d.element,e,h,i;if(!k(f)||f.contains(d.editable)||f.isReadOnly())return null;i=v(d,function(a,b){return!b.equals(a)},function(a,b){return S(a,true,b)},f);e=i.upper;h=i.lower;if(a(d,e,h))return i.set(F,I);if(e&&f.contains(e))for(;!e.getParent().equals(f);)e=e.getParent();else e=f.getFirst(function(a){return c(d,a)});if(h&&f.contains(h))for(;!h.getParent().equals(f);)h=h.getParent();else h=f.getLast(function(a){return c(d,a)});if(!e||!h)return null;u(d,e);u(d,h);if(!(d.mouse.y>e.size.top&&d.mouse.y<h.size.bottom))return null;for(var f=Number.MAX_VALUE,j,m,l,q;h&&!h.equals(e);){if(!(m=e.getNext(d.isRelevant)))break;j=Math.abs(g(d,e,m)-d.mouse.y);if(j<f){f=j;l=e;q=m}e=m;u(d,e)}if(!l||!q||!(d.mouse.y>l.size.top&&d.mouse.y<q.size.bottom))return null;i.upper=l;i.lower=q;return i.set(F,I)}function c(a,b){return!(b&&b.type==CKEDITOR.NODE_TEXT||Z(b)||n(b)||i(a,b)||b.type==CKEDITOR.NODE_ELEMENT&&b.$&&b.is("br"))}return function(c){var d=b(c),f;if(f=d){f=d.upper;var e=d.lower;f=!f||!e||n(e)||n(f)||e.equals(f)||f.equals(e)||e.contains(f)||f.contains(e)?false:q(c,f)&&q(c,e)&&a(c,f,e)?true:false}return f?d:null}}(),X=["top","left","right","bottom"]}(),CKEDITOR.config.magicline_keystrokePrevious=CKEDITOR.CTRL+CKEDITOR.SHIFT+51,CKEDITOR.config.magicline_keystrokeNext=CKEDITOR.CTRL+CKEDITOR.SHIFT+52,function(){function a(a){if(!a||a.type!=CKEDITOR.NODE_ELEMENT||a.getName()!="form")return[];for(var b=[],c=["style","className"],e=0;e<c.length;e++){var g=a.$.elements.namedItem(c[e]);if(g){g=new CKEDITOR.dom.element(g);b.push([g,g.nextSibling]);g.remove()}}return b}function e(a,b){if(a&&!(a.type!=CKEDITOR.NODE_ELEMENT||a.getName()!="form")&&b.length>0)for(var c=b.length-1;c>=0;c--){var e=b[c][0],g=b[c][1];g?e.insertBefore(g):e.appendTo(a)}}function b(b,c){var f=a(b),g={},i=b.$;if(!c){g["class"]=i.className||"";i.className=""}g.inline=i.style.cssText||"";if(!c)i.style.cssText="position: static; overflow: visible";e(f);return g}function g(b,c){var f=a(b),g=b.$;if("class"in c)g.className=c["class"];if("inline"in c)g.style.cssText=c.inline;e(f)}function c(a){if(!a.editable().isInline()){var b=CKEDITOR.instances,c;for(c in b){var e=b[c];if(e.mode=="wysiwyg"&&!e.readOnly){e=e.document.getBody();e.setAttribute("contentEditable",false);e.setAttribute("contentEditable",true)}}if(a.editable().hasFocus){a.toolbox.focus();a.focus()}}}CKEDITOR.plugins.add("maximize",{init:function(a){function e(){var b=i.getViewPaneSize();a.resize(b.width,b.height,null,true)}if(a.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var f=a.lang,h=CKEDITOR.document,i=h.getWindow(),k,n,o,q=CKEDITOR.TRISTATE_OFF;a.addCommand("maximize",{modes:{wysiwyg:!CKEDITOR.env.iOS,source:!CKEDITOR.env.iOS},readOnly:1,editorFocus:false,exec:function(){var m=a.container.getFirst(function(a){return a.type==CKEDITOR.NODE_ELEMENT&&a.hasClass("cke_inner")}),l=a.ui.space("contents");if(a.mode=="wysiwyg"){var p=a.getSelection();k=p&&p.getRanges();n=i.getScrollPosition()}else{var t=a.editable().$;k=!CKEDITOR.env.ie&&[t.selectionStart,t.selectionEnd];n=[t.scrollLeft,t.scrollTop]}if(this.state==CKEDITOR.TRISTATE_OFF){i.on("resize",e);o=i.getScrollPosition();for(p=a.container;p=p.getParent();){p.setCustomData("maximize_saved_styles",b(p));p.setStyle("z-index",a.config.baseFloatZIndex-5)}l.setCustomData("maximize_saved_styles",b(l,true));m.setCustomData("maximize_saved_styles",b(m,true));l={overflow:CKEDITOR.env.webkit?"":"hidden",width:0,height:0};h.getDocumentElement().setStyles(l);!CKEDITOR.env.gecko&&h.getDocumentElement().setStyle("position","fixed");(!CKEDITOR.env.gecko||!CKEDITOR.env.quirks)&&h.getBody().setStyles(l);CKEDITOR.env.ie?setTimeout(function(){i.$.scrollTo(0,0)},0):i.$.scrollTo(0,0);m.setStyle("position",CKEDITOR.env.gecko&&CKEDITOR.env.quirks?"fixed":"absolute");m.$.offsetLeft;m.setStyles({"z-index":a.config.baseFloatZIndex-5,left:"0px",top:"0px"});m.addClass("cke_maximized");e();l=m.getDocumentPosition();m.se tStyles({left:-1*l.x+"px",top:-1*l.y+"px"});CKEDITOR.env.gecko&&c(a)}else if(this.state==CKEDITOR.TRISTATE_ON){i.removeListener("resize",e);l=[l,m];for(p=0;p<l.length;p++){g(l[p],l[p].getCustomData("maximize_saved_styles"));l[p].removeCustomData("maximize_saved_styles")}for(p=a.container;p=p.getParent();){g(p,p.getCustomData("maximize_saved_styles"));p.removeCustomData("maximize_saved_styles")}CKEDITOR.env.ie?setTimeout(function(){i.$.scrollTo(o.x,o.y)},0):i.$.scrollTo(o.x,o.y);m.removeClass("cke_maximized");if(CKEDITOR.env.webkit){m.setStyle("display","inline");setTimeout(function(){m.setStyle("display","block")},0)}a.fire("resize")}this.toggleState();if(p=this.uiItems[0]){l=this.state==CKEDITOR.TRISTATE_OFF?f.maximize.maximize:f.maximize.minimize;p=CKEDITOR.document.getById(p._.id);p.getChild(1).setHtml(l);p.setAttribute("title",l);p.setAttribute("href",'javascript:void("'+l+'");')}if(a.mode=="wysiwyg")if(k){CKEDITOR.env.gecko&&c(a);a.getSelection().selectRanges(k);(t=a.getSelecti on().getStartElement())&&t.scrollIntoView(true)}else i.$.scrollTo(n.x,n.y);else{if(k){t.selectionStart=k[0];t.selectionEnd=k[1]}t.scrollLeft=n[0];t.scrollTop=n[1]}k=n=null;q=this.state;a.fire("maximize",this.state)},canUndo:false});a.ui.addButton&&a.ui.addButton("Maximize",{label:f.maximize.maximize,command:"maximize",toolbar:"tools,10"});a.on("mode",function(){var b=a.getCommand("maximize");b.setState(b.state==CKEDITOR.TRISTATE_DISABLED?CKEDITOR.TRISTATE_DISABLED:q)},null,null,100)}}})}(),function(){function a(a,e,c){var d=CKEDITOR.cleanWord;if(d)c();else{a=CKEDITOR.getUrl(a.config.pasteFromWordCleanupFile||e+"filter/default.js");CKEDITOR.scriptLoader.load(a,c,null,true)}return!d}function e(a){a.data.type="html"}CKEDITOR.plugins.add("pastefromword",{requires:"clipboard",init:function(b){var g=0,c=this.path;b.addCommand("pastefromword",{canUndo:false,async:true,exec:function(a){var b=this;g=1;a.once("beforePaste",e);a.getClipboardData({title:a.lang.pastefromword.title},function(c){c&&a.fire("paste",{type:"html",dataValue:c.dataValue});a.fire("afterCommandExec",{name:"pastefromword",command:b,returnValue:!!c})})}});b.ui.addButton&&b.ui.addButton("PasteFromWord",{label:b.lang.pastefromword.toolbar,command:"pastefromword",toolbar:"clipboard,50"});b.on("pasteState",function(a){b.getCommand("pastefromword").setState(a.data)});b.on("paste",function(d){var e=d.data,f=e.dataValue;if(f&&(g||/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(f))){var h=a(b,c,function(){if(h)b.fire("paste",e);else if(!b.config.pasteFromWordPromptCleanup||g||confirm(b.lang.pastefromword.confirmCleanup))e.dataValue=CKEDITOR.cleanWord(f,b);g=0});h&&d.cancel()}},null,null,3)}})}(),function(){var a={canUndo:false,async:true,exec:function(e){e.getClipboardData({title:e.lang.pastetext.title},function(b){b&&e.fire("paste",{type:"text",dataValue:b.dataValue});e.fire("afterCommandExec",{name:"pastetext",command:a,returnValue:!!b})})}};CKEDITOR.plugins.add("pastetext",{requires:"clipboard",init:function(e){e.addCommand("pastetext",a);e.ui.addButton&&e.ui.addButton("PasteText",{label:e.lang.pastetext.button,command:"pastetext",toolbar:"clipboard,40"});if(e.config.forcePasteAsPlainText)e.on("beforePaste",function(a){if(a.data.type!="html")a.data.type="text"});e.on("pasteState",function(a){e.getCommand("pastetext").setState(a.data)})}})}(),CKEDITOR.plugins.add("removeformat",{init:function(a){a.addCommand("removeFormat",CKEDITOR.plugins.removeformat.commands.removeformat);a.ui.addButton&&a.ui.addButton("RemoveFormat",{label:a.lang.removeformat.toolbar,command:"removeFormat",toolbar:"cleanup,10"})}}),CKEDITOR.plugins.removeformat={commands:{removeformat:{exec :function(a){for(var e=a._.removeFormatRegex||(a._.removeFormatRegex=RegExp("^(?:"+a.config.removeFormatTags.replace(/,/g,"|")+")$","i")),b=a._.removeAttributes||(a._.removeAttributes=a.config.removeFormatAttributes.split(",")),g=CKEDITOR.plugins.removeformat.filter,c=a.getSelection().getRanges(),d=c.createIterator(),j=function(a){return a.type==CKEDITOR.NODE_ELEMENT},f;f=d.getNextRange();){f.collapsed||f.enlarge(CKEDITOR.ENLARGE_ELEMENT);var h=f.createBookmark(),i=h.startNode,k=h.endNode,n=function(b){for(var c=a.elementPath(b),d=c.elements,f=1,h;h=d[f];f++){if(h.equals(c.block)||h.equals(c.blockLimit))break;e.test(h.getName())&&g(a,h)&&b.breakParent(h)}};n(i);if(k){n(k);for(i=i.getNextSourceNode(true,CKEDITOR.NODE_ELEMENT);i;){if(i.equals(k))break;if(i.isReadOnly()){if(i.getPosition(k)&CKEDITOR.POSITION_CONTAINS)break;i=i.getNext(j)}else{n=i.getNextSourceNode(false,CKEDITOR.NODE_ELEMENT);if(!(i.getName()=="img"&&i.data("cke-realelement"))&&g(a,i))if(e.test(i.getName()))i.remove(1);else{i.removeAttributes(b);a.fire("removeFormatCleanup",i)}i=n}}}f.moveToBookmark(h)}a.forceNextSelectionCheck();a.getSelection().selectRanges(c)}}},filter:function(a,e){for(var b=a._.removeFormatFilters||[],g=0;g<b.length;g++)if(b[g](e)===false)return false;return true}},CKEDITOR.editor.prototype.addRemoveFormatFilter=function(a){if(!this._.removeFormatFilters)this._.removeFormatFilters=[];this._.removeFormatFilters.push(a)},CKEDITOR.config.removeFormatTags="b,big,cite,code,del,dfn,em,font,i,ins,kbd,q,s,samp,small,span,strike,strong,sub,sup,tt,u,var",CKEDITOR.config.removeFormatAttributes="class,style,lang,width,height,align,hspace,valign",CKEDITOR.plugins.add("resize",{init:function(a){var e,b,g,c;function d(d){var h=e,j=b,k=h+(d.data.$.screenX-g)*(i=="rtl"?-1:1),d=j+(d.data.$.screenY-c);n&&(h=Math.max(f.resize_minWidth,Math.min(k,f.resize_maxWidth)));o&&(j=Math.max(f.resize_minHeight,Math.min(d,f.resize_maxHeight)));a.resize(n?h:null,j)}function j(){CKEDITOR.document.removeListener("mousemove",d);CKEDITOR.document.removeListener("mouseup",j);if(a.document){a.document.removeListener("mousemove",d);a.document.removeListener("mouseup",j)}}var f=a.config,h=a.ui.spaceId("resizer"),i=a.element?a.element.getDirection(1):"ltr";!f.resize_dir&&(f.resize_dir="vertical");f.resize_maxWidth===void 0&&(f.resize_maxWidth=3E3);f.resize_maxHeight===void 0&&(f.resize_maxHeight=3E3);f.resize_minWidth===void 0&&(f.resize_minWidth=750);f.resize_minHeight===void 0&&(f.resize_minHeight=250);if(f.resize_enabled!==false){var k=null,n=(f.resize_dir=="both"||f.resize_dir=="horizontal")&&f.resize_minWidth!=f.resize_maxWidth,o=(f.resize_dir=="both"||f.resize_dir=="vertical")&&f.resize_minHeight!=f.resize_maxHeight,q=CKEDITOR.tools.addFunction(function(h){k||(k=a.getResizable());e=k.$.offsetWidth||0;b=k.$.offsetHeight||0;g=h.screenX;c=h.screenY;f.resize_minWidth>e&&(f.resize_minWidth=e);f.resize_minHeight>b&&(f.resize_minHeight=b);CKEDITOR.document.on("mousemove",d);CKEDITOR.document.on("mouseup",j);if(a.document){a.document.on("mousemove",d);a.document.on("mouseup",j)}h.preventDefault&&h.preventDefault()});a.on("destroy",function(){CKEDITOR.tools.removeFunction(q)});a.on("uiSpace",function(b){if(b.data.space=="bottom"){var c="";n&&!o&&(c=" cke_resizer_horizontal");!n&&o&&(c=" cke_resizer_vertical");var d='<span id="'+h+'" class="cke_resizer'+c+" cke_resizer_"+i+'" title="'+CKEDITOR.tools.htmlEncode(a.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+q+', event)">'+(i=="ltr"?"◢":"◣")+"</span>";i=="ltr"&&c=="ltr"?b.data.html=b.data.html+d:b.data.html=d+b.data.html}},a,null,100);a.on("maximize",function(b){a.ui.space("resizer")[b.data==CKEDITOR.TRISTATE_ON?"hide":"show"]()})}}}),CKEDITOR.plugins.add("menubutton",{requires:"button,menu",onLoad:function(){var a=function(a){var b=this._,g=b.menu;if(b.state!==CKEDITOR.TRISTATE_DISABLED)if(b.on&&g)g.hide();else{b.previousState=b.state;if(!g){g=b.menu=new CKEDITOR.menu(a,{panel:{className:"cke_menu_panel",attributes:{"aria-label":a.lang.common.options}}});g.onHide=CKEDITOR.tools.bind(function(){var c=this.command?a.getCommand(this.command).modes:this.modes;this.setState(!c||c[a.mode]?b.previousState:CKEDITOR.TRISTATE_DISABLED);b.on=0},this);this.onMenu&&g.addListener(this.onMenu)}this.setState(CKEDITOR.TRISTATE_ON);b.on=1;setTimeout(function(){g.show(CKEDITOR.document.getById(b.id),4)},0)}};CKEDITOR.ui.menuButton=CKEDITOR.tools.createClass({base:CKEDITOR.ui.button,$:function(e){delete e.panel;this.base(e);this.hasArrow=true;this.click=a},statics:{handler:{create:function(a){return new CKEDITOR.ui.menuButton(a)}}}})},beforeInit:function(a){a.ui.addHandler(CKEDITOR.UI_MENUBUTTON,CKEDITOR.ui.menuButton.handler)}}),CKEDITOR.UI_MENUBUTTON="menubutton","use strict",CKEDITOR.plugins.add("scayt",{requires:"menubutton,dialog",tabToOpen:null,dialogName:"scaytDialog",init:function(a){var e=this,b=CKEDITOR.plugins.scayt;this.bindEvents(a);this.parseConfig(a);this.addRule(a);CKEDITOR.dialog.add(this.dialogName,CKEDITOR.getUrl(this.path+"dialogs/options.js"));this.addMenuItems(a);var g=a.lang.scayt,c=CKEDITOR.env;a.ui.add("Scayt",CKEDITOR.UI_MENUBUTTON,{label:g.text_title,title:a.plugins.wsc?a.lang.wsc.title:g.text_title,modes:{wysiwyg:!(c.ie&&(c.version<8||c.quirks))},toolbar:"spellchecker,20",refresh:function(){var c=a.ui.instances.Scayt.getState();a.scayt&&(c=b.state[a.name]?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF);a.fire("scaytButtonState",c)},onRender:function(){var b=this;a.on("scaytButtonState",function(a){typeof a.data!==void 0&&b.setState(a.data)})},onMenu:function(){var c=a.scayt;a.getMenuItem("scaytToggle").label=a.lang.scayt[c&&b.state[a.name]?"btn_disable":"btn_enable"];c={scaytToggle:CKEDITOR.TRISTATE_OFF,scaytOptions:c?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytLangs:c?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytDict:c?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytAbout:c?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,WSC:a.plugins.wsc?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED};a.config.scayt_uiTabs[0]||delete c.scaytOptions;a.config.scayt_uiTabs[1]||delete c.scaytLangs;a.config.scayt_uiTabs[2]||delete c.scaytDict;return c}});if(a.contextMenu&&a.addMenuItems){a.contextMenu.addListener(function(){var b=a.scayt,c;if(b){var f=b.getSelectionNode();if(f=f?f.getAttribute(b.getNodeAttribute()):f){c=e.menuGenerator(a,f,e);b.showBanner("."+a.contextMenu._.definition.panel.className.split(" ").join(" ."))}}return c});a.contextMenu._.onHide=CKEDITOR.tools.override(a.contextMenu._.onHide,function(b){return function(){var c=a.scayt;c&&c.hideBanner();return b.apply(this)}})}},addMenuItems:function(a){var e=this,b=CKEDITOR.plugins.scayt;a.addMenuGroup("scaytButton");var g=a.config.scayt_contextMenuItemsOrder.split("|");if(g&&g.length)for(var c=0;c<g.length;c++)a.addMenuGroup("scayt_"+g[c],c-10);g={scaytToggle:{label:a.lang.scayt.btn_enable,group:"scaytButton",onClick:function(){var c=a.scayt;b.state[a.name]=!b.state[a.name];b.state[a.name]===true?c||b.createScayt(a):c&&b.destroy(a)}},scaytAbout:{label:a.lang.scayt.btn_about,group:"scaytButton",onClick:function(){a.scayt.tabToOpen="about";a.lockSelection();a.openDialog(e.dialogName)}},scaytOptions:{label:a.lang.scayt.btn_options,group:"scaytButton",onClick:function(){a.scayt.tabToOpen="options";a.lockSelection();a.openDialog(e.dialogName)}},scaytLangs:{label:a.lang.scayt.btn_langs,group:"scaytButton",onClick:function(){a.scayt.tabToOpen="langs";a.lockSelection();a.openDialog(e.dialogName)}},scaytDict:{label:a.lang.scayt.btn_dictionaries,group:"scaytButton",onClick:function(){a.scayt.tabToOpen="dictionaries";a.lockSelection();a.openDialog(e.dialogName)}}};if(a.plugins.wsc)g.WSC={label:a.lang.wsc.toolbar,group:"scaytButton",onClick:function(){var b=CKEDITOR.plugins.scayt,c=a.scayt,f=a.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?a.container.getText():a.document.getBody().getText();if(f=f.replace(/\s/g,"")){c&&(b.state[a.name]&&c.setMarkupPaused)&&c.setMarkupPaused(true);a.lockSelection();a.execCommand("checkspell")}else alert("Nothing to check!")}};a.addMenuItems(g)},bindEvents:function(a){function e(){var b=a.scayt;if(b){b.removeMarkupInSelectionNode();b.fire("startSpellCheck")}}var b=CKEDITOR.plugins.scayt,g=a.elementMode==CKEDITOR.ELEMENT_MODE_INLINE;CKEDITOR.on("dialogDefinition",function(a){if(a.data.name==="scaytDialog")a.data.definition.dialog.on("cancel",function(){return false},this,null,-1)});var c=function(){a.scayt&&b.destroy(a)},d=function(){b.state[a.name]&&!a.readOnly&&b.createScayt(a)},j=function(){var b=a.editable();b.attachListener(b,"focus",function(){var b=CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state[a.name]&&a.scayt,c,d;if((g||b)&&a._.savedSelection)for(var b=a._.savedSelection.getSelectedElement(),b=!b&&a._.savedSelection.getRanges(),f=0;f<b.length;f++){d=b[f];c=d.startContainer.getText().length;(c<d.startOffset||c<d.endOffset)&&a.unlockSelection(false)}},this,null,-10)},f=function(){if(g){a.on("blur",c);a.on("focus",d);a.focusManager.hasFocus&&d()}else d();j()};a.on("contentDom",f);a.on("beforeCommandExec",function(c){var d;if(c.data.name in b.options.disablingCommandExec&&a.mode=="wysiwyg"){if(d=a.scayt){b.destroy(a);a.fire("scaytButtonState",CKEDITOR.TRISTATE_DISABLED)}}else if(c.data.name==="bold"||c.data.name==="italic"||c.data.name==="underline"||c.data.name==="strike"||c.data.name==="subscript"||c.data.name==="superscript")if(d=a.scayt){d.removeMarkupInSelectionNode();setTimeout(function(){d.fire("startSpellCheck")},0)}});a.on("beforeSetMode",function(c){if(c.data=="source"){if(c=a.scayt){b.destroy(a);a.fire("scaytButtonState",CKEDITOR.TRISTATE_DISABLED)}if(a.document){a.document.getBody().removeAttribute("_jquid");a.document.getBody().removeAttribute("dir")}}});a.on("afterCommandExec",function(b){var c;if(a.mode=="wysiwyg"&&(b.data.name=="undo"||b.data.name=="redo"))(c=a.scayt)&&setTimeout(function(){c.fire("startSpellCheck")},250)});a.on("readOnly",function(c){var d;if(c){d=a.scayt;if(c.editor.readOnly===true)d&&d.fire("removeMarkupInDocument",{});else if(d)d.fire("startSpellCheck");else if(c.editor.mode=="wysiwyg"&&b.state[c.editor.name]===true){b.createScayt(a);c.editor.fire("scaytButtonState",CKEDITOR.TRISTATE_ON)}}});a.on("beforeDestroy",c);a.on("setData",function(){c();a.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&f()},this,null,50);a.on("insertElement",function(){CKEDITOR.env.ie?setTimeout(function(){e()},50):e()},this,null,50);a.on("insertHtml",function(){e()},this,null,50);a.on("insertText",function(){e()},this,null,50);a.on("scaytDialogShown",function(b){b.data.selectPage(a.scayt.tabToOpen)})},parseConfig:function(a){var e=CKEDITOR.plugins.scayt;e.replaceOldOptionsNames(a.config);if(typeof a.config.scayt_autoStartup!=="boolean")a.config.scayt_autoStartup=false;e.state[a.name]=a.config.scayt_autoStartup;if(!a.config.scayt_contextCommands)a.config.scayt_contextCommands="ignore|ignoreall|add";if(!a.config.scayt_contextMenuItemsOrder)a.config.scayt_contextMenuItemsOrder="suggest|moresuggest|control";if(!a.config.scayt_sLang)a.config.scayt_sLang="en_US";if(a.config.scayt_maxSuggestions===void 0||typeof a.config.scayt_maxSuggestions!="number"||a.config.scayt_maxSuggestions<0)a.config.scayt_maxSuggestions=5;if(a.config.scayt_customDictionaryIds===void 0||typeof a.config.scayt_customDictionaryIds!=="string")a.config.scayt_customDictionaryIds="";if(a.config.scayt_userDictionaryName===void 0||typeof a.config.scayt_userDictionaryName!=="string")a.config.scayt_userDictionaryName=null;if(typeof a.config.scayt_uiTabs==="string"&&a.config.scayt_uiTabs.split(",").length===3){var b=[],g=[];a.config.scayt_uiTabs=a.config.scayt_uiTabs.split(",");CKEDITOR.tools.search(a.config.scayt_uiTabs,function(a){if(Number(a)===1||Number(a)===0){g.push(true);b.push(Number(a))}else g.push(false)});a.config.scayt_uiTabs=CKEDITOR.tools.search(g,false)===null?b:[1,1,1]}else a.config.scayt_uiTabs=[1,1,1];if(typeof a.config.scayt_serviceProtocol!="string")a.config.scayt_serviceProtocol=null;if(typeof a.config.scayt_serviceHost!="string")a.config.scayt_serviceHost=null;if(typeof a.config.scayt_servicePort!="string")a.config.scayt_servicePort=null;if(typeof a.config.scayt_servicePath!="string")a.config.scayt_servicePath=null;if(!a.config.scayt_moreSuggestions)a.config.scayt_moreSuggestions="on";if(typeof a.config.scayt_customerId!=="string")a.config.scayt_customerId="1:WvF0D4-UtPqN1-43nkD4-NKvUm2-daQqk3-LmNiI-z7Ysb4-mwry24-T8YrS3-Q2tpq2";if(typeof a.config.scayt_srcUrl!=="string"){e=document.location.protocol;e=e.search(/https?:/)!=-1?e:"http:";a.config.scayt_srcUrl=e+"//svc.webspellchecker.net/spellcheck31/lf/scayt3/ckscayt/ckscayt.js"}if(typeof CKEDITOR.config.scayt_handleCheckDirty!=="boolean")CKEDITOR.config.scayt_handleCheckDirty=true;if(typeof CKEDITOR.config.scayt_handleUndoRedo!=="boolean")CKEDITOR.config.scayt_handleUndoRedo=true;if(a.config.scayt_disableOptionsStorage){var e=CKEDITOR.tools.isArray(a.config.scayt_disableOptionsStorage)?a.config.scayt_disableOptionsStorage:typeof a.config.scayt_disableOptionsStorage==="string"?[a.config.scayt_disableOptionsStorage]:void 0,c=["all","options","lang","ignore-all-caps-words","ignore-domain-names","ignore-words-with-mixed-cases","ignore-words-with-numbers"],d=["lang","ignore-all-caps-words","ignore-domain-names","ignore-words-with-mixed-cases","ignore-words-with-numbers"],j=CKEDITOR.tools.search,f=CKEDITOR.tools.indexOf;a.config.scayt_disableOptionsStorage=function(a){for(var b=[],e=0;e<a.length;e++){var g=a[e],o=!!j(a,"options");if(!j(c,g)||o&&j(d,function(a){if(a==="lang")return false}))return;j(d,g)&&d.splice(f(d,g),1);if(g==="all"||o&&j(a,"lang"))return[];g==="options"&&(d=["lang"])}return b=b.concat(d)}(e)}},addRule:function(a){var e=a.dataProcessor,b=e&&e.htmlFilter,g=a._.elementsPath&&a._.elementsPath.filters,e=e&&e.dataFilter,c=a.addRemoveFormatFilter,d=function(b){var c=CKEDITOR.plugins.scayt;if(a.scayt&&b.hasAttribute(c.options.data_attribute_name))return false},j=function(b){var c=CKEDITOR.plugins.scayt,d=true;a.scayt&&b.hasAttribute(c.options.data_attribute_name)&&(d=false);return d};g&&g.push(d);e&&e.addRules({elements:{span:function(b){var c=CKEDITOR.plugins.scayt;if(c&&c.state[a.name]&&b.classes&&CKEDITOR.tools.search(b.classes,c.options.misspelled_word_class))if(b.classes&&b.parent.type===CKEDITOR.NODE_DOCUMENT_FRAGMENT){delete b.attributes.style;delete b.name}else delete b.classes[CKEDITOR.tools.indexOf(b.classes,c.options.misspelled_word_class)];return b}}});b&&b.addRules({elements:{span:function(b){var c=CKEDITOR.plugins.scayt;if(c&&c.state[a.name]&&b.hasClass(c.options.misspelled_word_class)&&b.attributes[c.options.data_attribute_name]){b.removeClass(c.options.misspelled_word_class);delete b.attributes[c.options.data_attribute_name];delete b.name}return b}}});c&&c.call(a,j)},scaytMenuDefinition:function(a){var e=this,a=a.scayt;return{scayt_ignore:{label:a.getLocal("btn_ignore"),group:"scayt_control",order:1,exec:function(a){a.scayt.ignoreWord()}},scayt_ignoreall:{label:a.getLocal("btn_ignoreAll"),group:"scayt_control",order:2,exec:function(a){a.scayt.ignoreAllWords()}},scayt_add:{label:a.getLocal("btn_addWord"),group:"scayt_control",order:3,exec:function(a){var e=a.scayt;setTimeout(function(){e.addWordToUserDictionary()},10)}},option:{label:a.getLocal("btn_options"),group:"scayt_control",order:4,exec:function(a){a.scayt.tabToOpen="options";a.lockSelection();a.openDialog(e.dialogName)},verification:function(a){return a.config.scayt_uiTabs[0]==1?true:false}},language:{label:a.getLocal("btn_langs"),group:"scayt_control",order:5,exec:function(a){a.scayt.tabToOpen="langs";a.lockSelection();a.openDialog(e.dialogName)},verification:function(a){return a.config.scayt_uiTabs[1]==1?true:false}},dictionary:{label:a.getLocal("btn_dictionaries"),group:"scayt_control",order:6,exec:function(a){a.scayt.tabToOpen="dictionaries";a.lockSelection();a.openDialog(e.dialogName)},verification:function(a){return a.config.scayt_uiTabs[2]==1?true:false}},about:{label:a.getLocal("btn_about"),group:"scayt_control",order:7,exec:function(a){a.scayt.tabToOpen="about";a.lockSelection();a.openDialog(e.dialogName)}}}},buildSuggestionMenuItems:function(a,e){var b={},g={},c=a.scayt;if(e.length>0&&e[0]!=="no_any_suggestions")for(var d=0;d<e.length;d++){var j="scayt_suggest_"+CKEDITOR.plugins.scayt.suggestions[d].replace(" ","_");a.addCommand(j,this.createCommand(CKEDITOR.plugins.scayt.suggestions[d]));if(d<a.config.scayt_maxSuggestions){a.addMenuItem(j,{label:e[d],command:j,group:"scayt_suggest",order:d+1});b[j]=CKEDITOR.TRISTATE_OFF}else{a.addMenuItem(j,{label:e[d],command:j,group:"scayt_moresuggest",order:d+1});g[j]=CKEDITOR.TRISTATE_OFF;if(a.config.scayt_moreSuggestions==="on"){a.addMenuItem("scayt_moresuggest",{label:c.getLocal("btn_moreSuggestions"),group:"scayt_moresuggest",order:10,getItems:function(){return g}});b.scayt_moresuggest=CKEDITOR.TRISTATE_OFF}}}else{b.no_scayt_suggest=CKEDITOR.TRISTATE_DISABLED;a.addCommand("no_scayt_suggest",{exec:function(){}});a.addMenuItem("no_scayt_suggest",{label:c.getLocal("btn_noSuggestions")||"no_scayt_suggest",command:"no_scayt_suggest",group:"scayt_suggest",order:0})}return b},menuGenerator:function(a,e){var b=a.scayt,g=this.scaytMenuDefinition(a),c={},d=a.config.scayt_contextCommands.split("|");b.fire("getSuggestionsList",{lang:b.getLang(),word:e});c=this.buildSuggestionMenuItems(a,CKEDITOR.plugins.scayt.suggestions);if(a.config.scayt_contextCommands=="off")return c;for(var j in g)if(!(CKEDITOR.tools.indexOf(d,j.replace("scayt_",""))==-1&&a.config.scayt_contextCommands!="all")){c[j]=CKEDITOR.TRISTATE_OFF;typeof g[j].verification==="function"&&!g[j].verification(a)&&delete c[j];a.addCommand(j,{exec:g[j].exec});a.addMenuItem(j,{label:a.lang.scayt[g[j].label]||g[j].label,command:j,group:g[j].group,order:g[j].order})}return c},createCommand:function(a){return{exec:function(e){e.scayt.replaceSelectionNode({word:a})}}}}),CKEDITOR.plugins.scayt={state:{},suggestions:[],loadingHelper:{loadOrder:[]},isLoading:!1,options:{disablingCommandExec:{source:!0,newpage:!0,templates:!0},data_attribute_name:"data-scayt-word",misspelled_word_class:"scayt-misspell-word"},backCompatibilityMap:{scayt_service_protocol:"scayt_serviceProtocol",scayt_service_host:"scayt_serviceHost",scayt_service_port:"scayt_servicePort",scayt_service_path:"scayt_servicePath",scayt_customerid:"scayt_customerId"},replaceOldOptionsNames:function(a){for(var e in a)if(e in this.backCompatibilityMap){a[this.backCompatibilityMap[e]]=a[e];delete a[e]}},createScayt:function(a){var e=this;this.loadScaytLibrary(a,function(a){var g={lang:a.config.scayt_sLang,container:a.editable().$.nodeName=="BODY"?a.document.getWindow().$.frameElement:a.editable().$,customDictionary:a.config.scayt_customDictionaryIds,userDictionaryName:a.config.scayt_userDictionaryName,localization:a.langCode,customer_id:a.config.scayt_customerId,debug:a.config.scayt_debug,data_attribute_name:e.options.data_attribute_name,misspelled_word_class:e.options.misspelled_word_class,"options-to-restore":a.config.scayt_disableOptionsStorage,focused:a.editable().hasFocus,ignoreElementsRegex:a.config.scayt_elementsToIgnore};if(a.config.scayt_serviceProtocol)g.service_protocol=a.config.scayt_serviceProtocol;if(a.config.scayt_serviceHost)g.service_host=a.config.scayt_serviceHost;if(a.config.scayt_servicePort)g.service_port=a.config.scayt_servicePort;if(a.config.scayt_servicePath)g.service_path=a.config.scayt_servicePath;g=new SCAYT.CKSCAYT(g,function(){},function(){});g.subscribe("suggestionListSend",function(a){for(var b={},e=[],f=0;f<a.suggestionList.length;f++)if(!b["word_"+
a.suggestionList[f]]){b["word_"+a.suggestionList[f]]=a.suggestionList[f];e.push(a.suggestionList[f])}CKEDITOR.plugins.scayt.suggestions=e});a.scayt=g;a.fire("scaytButtonState",a.readOnly?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_ON)})},destroy:function(a){a.scayt&&a.scayt.destroy();delete a.scayt;a.fire("scaytButtonState",CKEDITOR.TRISTATE_OFF)},loadScaytLibrary:function(a,e){var b=this;if(typeof window.SCAYT==="undefined"||typeof window.SCAYT.CKSCAYT!=="function"){this.loadingHelper[a.name]=e;this.loadingHelper.loadOrder.push(a.name);CKEDITOR.scriptLoader.load(a.config.scayt_srcUrl,function(){var a;CKEDITOR.fireOnce("scaytReady");for(var c=0;c<b.loadingHelper.loadOrder.length;c++){a=b.loadingHelper.loadOrder[c];if(typeof b.loadingHelper[a]==="function")b.loadingHelper[a](CKEDITOR.instances[a]);delete b.loadingHelper[a]}b.loadingHelper.loadOrder=[]})}else if(window.SCAYT&&typeof window.SCAYT.CKSCAYT==="function"){CKEDITOR.fireOnce("scaytReady");a.scayt||typeof e==="function"&&e(a)}}},CKEDITOR.on("scaytReady",function(){if(CKEDITOR.config.scayt_handleCheckDirty===true){var a=CKEDITOR.editor.prototype;a.checkDirty=CKEDITOR.tools.override(a.checkDirty,function(a){return function(){var e=null,c=this.scayt;if(!CKEDITOR.plugins.scayt||!CKEDITOR.plugins.scayt.state[this.name]||!this.scayt)e=a.call(this);else if(e=this.status=="ready")var d=c.removeMarkupFromString(this.getSnapshot()),c=c.removeMarkupFromString(this._.previousValue),e=e&&c!==d;return e}});a.resetDirty=CKEDITOR.tools.override(a.resetDirty,function(a){return function(){var e=this.scayt;!CKEDITOR.plugins.scayt||!CKEDITOR.plugins.scayt.state[this.name]||!this.scayt?a.call(this):this._.previousValue=e.removeMarkupFromString(this.getSnapshot())}})}if(CKEDITOR.config.scayt_handleUndoRedo===true){var a=CKEDITOR.plugins.undo.Image.prototype,e=typeof a.equalsContent=="function"?"equalsContent":"equals";a[e]=CKEDITOR.tools.override(a[e],function(a){return function(e){var c=e.editor.scayt,d=this.contents,j=e.contents,f=null;if(CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state[e.editor.name]&&e.editor.scayt){this.contents=c.removeMarkupFromString(d)||"";e.contents=c.removeMarkupFromString(j)||""}f=a.apply(this,arguments);this.contents=d;e.contents=j;return f}})}}),function(){var a={preserveState:true,editorFocus:false,readOnly:1,exec:function(a){this.toggleState();this.refresh(a)},refresh:function(a){if(a.document){var b=this.state==CKEDITOR.TRISTATE_ON?"attachClass":"removeClass";a.editable()[b]("cke_show_borders")}}};CKEDITOR.plugins.add("showborders",{modes:{wysiwyg:1},onLoad:function(){var a;a=(CKEDITOR.env.ie6Compat?[".%1 table.%2,",".%1 table.%2 td, .%1 table.%2 th","{","border : #d3d3d3 1px dotted","}"]:[".%1 table.%2,",".%1 table.%2 > tr > td, .%1 table.%2 > tr > th,",".%1 table.%2 > tbody > tr > td, .%1 table.%2 > tbody > tr > th,",".%1 table.%2 > thead > tr > td, .%1 table.%2 > thead > tr > th,",".%1 table.%2 > tfoot > tr > td, .%1 table.%2 > tfoot > tr > th","{","border : #d3d3d3 1px dotted","}"]).join("").replace(/%2/g,"cke_show_border").replace(/%1/g,"cke_show_borders ");CKEDITOR.addCss(a)},init:function(e){var b=e.addCommand("showborders",a);b.canUndo=false;e.config.startupShowBorders!==false&&b.setState(CKEDITOR.TRISTATE_ON);e.on("mode",function(){b.state!=CKEDITOR.TRISTATE_DISABLED&&b.refresh(e)},null,null,100);e.on("contentDom",function(){b.state!=CKEDITOR.TRISTATE_DISABLED&&b.refresh(e)});e.on("removeFormatCleanup",function(a){a=a.data;e.getCommand("showborders").state==CKEDITOR.TRISTATE_ON&&(a.is("table")&&(!a.hasAttribute("border")||parseInt(a.getAttribute("border"),10)<=0))&&a.addClass("cke_show_border")})},afterInit:function(a){var b=a.dataProcessor,a=b&&b.dataFilter,b=b&&b.htmlFilter;a&&a.addRules({elements:{table:function(a){var a=a.attributes,b=a["class"],d=parseInt(a.border,10);if((!d||d<=0)&&(!b||b.indexOf("cke_show_border")==-1))a["class"]=(b||"")+" cke_show_border"}}});b&&b.addRules({elements:{table:function(a){var a=a.attributes,b=a["class"];b&&(a["class"]=b.replace("cke_show_border","").replace(/\s{2}/," ").replace(/^\s+|\s+$/,""))}}})}});CKEDITOR.on("dialogDefinition",function(a){var b=a.data.name;if(b=="table"||b=="tableProperties"){a=a.data.definition;b=a.getContents("info").get("txtBorder");b.commit=CKEDITOR.tools.override(b.commit,function(a){return function(b,d){a.apply(this,arguments);var e=parseInt(this.getValue(),10);d[!e||e<=0?"addClass":"removeClass"]("cke_show_border")}});if(a=(a=a.getContents("advanced"))&&a.get("advCSSClasses")){a.setup=CKEDITOR.tools.override(a.setup,function(a){return function(){a.apply(this,arguments);this.setValue(this.getValue().replace(/cke_show_border/,""))}});a.commit=CKEDITOR.tools.override(a.commit,function(a){return function(b,d){a.apply(this,arguments);parseInt(d.getAttribute("border"),10)||d.addClass("cke_show_border")}})}}})}(),function(){CKEDITOR.plugins.add("sourcearea",{init:function(e){function b(){var a=c&&this.equals(CKEDITOR.document.getActive());this.hide();this.setStyle("height",this.getParent().$.clientHeight+"px");this.setStyle("width",this.getParent().$.clientWidth+"px");this.show();a&&this.focus()}if(e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var g=CKEDITOR.plugins.sourcearea;e.addMode("source",function(c){var g=e.ui.space("contents").getDocument().createElement("textarea");g.setStyles(CKEDITOR.tools.extend({width:CKEDITOR.env.ie7Compat?"99%":"100%",height:"100%",resize:"none",outline:"none","text-align":"left"},CKEDITOR.tools.cssVendorPrefix("tab-size",e.config.sourceAreaTabSize||4)));g.setAttribute("dir","ltr");g.addClass("cke_source cke_reset cke_enable_context_menu");e.ui.space("contents").append(g);g=e.editable(new a(e,g));g.setData(e.getData(1));if(CKEDITOR.env.ie){g.attachListener(e,"resize",b,g);g.attachListener(CKEDITOR.document.getWindow(),"resize",b,g);CKEDITOR.tools.setTimeout(b,0,g)}e.fire("ariaWidget",this);c()});e.addCommand("source",g.commands.source);e.ui.addButton&&e.ui.addButton("Source",{label:e.lang.sourcearea.toolbar,command:"source",toolbar:"mode,10"});e.on("mode",function(){e.getCommand("source").setState(e.mode=="source"?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)});var c=CKEDITOR.env.ie&&CKEDITOR.env.version==9}}});var a=CKEDITOR.tools.createClass({base:CKEDITOR.editable,proto:{setData:function(a){this.setValue(a);this.status="ready";this.editor.fire("dataReady")},getData:function(){return this.getValue()},insertHtml:function(){},insertElement:function(){},insertText:function(){},setReadOnly:function(a){this[(a?"set":"remove")+"Attribute"]("readOnly","readonly")},detach:function(){a.baseProto.detach.call(this);this.clearCustomData();this.remove()}}})}(),CKEDITOR.plugins.sourcearea={commands:{source:{modes:{wysiwyg:1,source:1},editorFocus:!1,readOnly:1,exec:function(a){a.mode=="wysiwyg"&&a.fire("saveSnapshot");a.getCommand("source").setState(CKEDITOR.TRISTATE_DISABLED);a.setMode(a.mode=="source"?"wysiwyg":"source")},canUndo:!1}}},CKEDITOR.plugins.add("specialchar",{availableLangs:{af:1,ar:1,bg:1,ca:1,cs:1,cy:1,da:1,de:1,el:1,en:1,"en-gb":1,eo:1,es:1,et:1,fa:1,fi:1,fr:1,"fr-ca":1,gl:1,he:1,hr:1,hu:1,id:1,it:1,ja:1,km:1,ku:1,lt:1,lv:1,nb:1,nl:1,no:1,pl:1,pt:1,"pt-br":1,ru:1,si:1,sk:1,sl:1,sq:1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,zh:1,"zh-cn":1},requires:"dialog",init:function(a){var e=this;CKEDITOR.dialog.add("specialchar",this.path+"dialogs/specialchar.js");a.addCommand("specialchar",{exec:function(){var b=a.langCode,b=e.availableLangs[b]?b:e.availableLangs[b.replace(/-.*/,"")]?b.replace(/-.*/,""):"en";CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(e.path+"dialogs/lang/"+b+".js"),function(){CKEDITOR.tools.extend(a.lang.specialchar,e.langEntries[b]);a.openDialog("specialchar")})},modes:{wysiwyg:1},canUndo:false});a.ui.addButton&&a.ui.addButton("SpecialChar",{label:a.lang.specialchar.toolbar,command:"specialchar",toolbar:"insert,50"})}}),CKEDITOR.config.specialChars="! &quot; # $ % &amp; ' ( ) * + - . / 0 1 2 3 4 5 6 7 8 9 : ; &lt; = &gt; ? @ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z [ ] ^ _ ` a b c d e f g h i j k l m n o p q r s t u v w x y z { | } ~ &euro; &lsquo; &rsquo; &ldquo; &rdquo; &ndash; &mdash; &iexcl; &cent; &pound; &curren; &yen; &brvbar; &sect; &uml; &copy; &ordf; &laquo; &not; &reg; &macr; &deg; &sup2; &sup3; &acute; &micro; &para; &middot; &cedil; &sup1; &ordm; &raquo; &frac14; &frac12; &frac34; &iquest; &Agrave; &Aacute; &Acirc; &Atilde; &Auml; &Aring; &AElig; &Ccedil; &Egrave; &Eacute; &Ecirc; &Euml; &Igrave; &Iacute; &Icirc; &Iuml; &ETH; &Ntilde; &Ograve; &Oacute; &Ocirc; &Otilde; &Ouml; &times; &Oslash; &Ugrave; &Uacute; &Ucirc; &Uuml; &Yacute; &THORN; &szlig; &agrave; &aacute; &acirc; &atilde; &auml; &aring; &aelig; &ccedil; &egrave; &eacute; &ecirc; &euml; &igrave; &iacute; &icirc; &iuml; &eth; &ntilde; &ograve; &oacute; &ocirc; &otilde; &ouml; &divide; &oslash; &ugrave; &uacute; &ucirc; &uuml; &yacute; &thorn; &yuml; &OElig; &oelig; &#372; &#374 &#373 &#375; &sbquo; &#8219; &bdquo; &hellip; &trade; &#9658; &bull; &rarr; &rArr; &hArr; &diams; &asymp;".split(" "),function(){CKEDITOR.plugins.add("stylescombo",{requires:"richcombo",init:function(a){var e=a.config,b=a.lang.stylescombo,g={},c=[],d=[];a.on("stylesSet",function(b){if(b=b.data.styles){for(var f,h,i,k=0,n=b.length;k<n;k++){f=b[k];if(!(a.blockless&&f.element in CKEDITOR.dtd.$block)){h=f.name;f=new CKEDITOR.style(f);if(!a.filter.customConfig||a.filter.check(f)){f._name=h;f._.enterMode=e.enterMode;f._.type=i=f.assignedTo||f.type;f._.weight=k+(i==CKEDITOR.STYLE_OBJECT?1:i==CKEDITOR.STYLE_BLOCK?2:3)*1E3;g[h]=f;c.push(f);d.push(f)}}}c.sort(function(a,b){return a._.weight-b._.weight})}});a.ui.addRichCombo("Styles",{label:b.label,title:b.panelTitle,toolbar:"styles,10",allowedContent:d,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(e.contentsCss),multiSelect:true,attributes:{"aria-label":b.panelTitle}},init:function(){var a,d,e,g,k,n;k=0;for(n=c.length;k<n;k++){a=c[k];d=a._name;g=a._.type;if(g!=e){this.startGroup(b["panelTitle"+g]);e=g}this.add(d,a.type==CKEDITOR.STYLE_OBJECT?d:a.buildPreview(),d)}this.commit()},onClick:function(b){a.focus();a.fire("saveSnapshot");var b=g[b],c=a.elementPath();a[b.checkActive(c,a)?"removeStyle":"applyStyle"](b);a.fire("saveSnapshot")},onRender:function(){a.on("selectionChange",function(b){for(var c=this.getValue(),b=b.data.path.elements,d=0,e=b.length,k;d<e;d++){k=b[d];for(var n in g)if(g[n].checkElementRemovable(k,true,a)){n!=c&&this.setValue(n);return}}this.setValue("")},this)},onOpen:function(){var c=a.getSelection().getSelectedElement(),c=a.elementPath(c),d=[0,0,0,0];this.showAll();this.unmarkAll();for(var e in g){var i=g[e],k=i._.type;i.checkApplicable(c,a,a.activeFilter)?d[k]++:this.hideItem(e);i.checkActive(c,a)&&this.mark(e)}d[CKEDITOR.STYLE_BLOCK]||this.hideGroup(b["panelTitle"+CKEDITOR.STYLE_BLOCK]);d[CKEDITOR.STYLE_INLINE]||this.hideGroup(b["panelTitle"+CKEDITOR.STYLE_INLINE]);d[CKEDITOR.STYLE_OBJECT]||this.hideGroup(b["panelTitle"+CKEDITOR.STYLE_OBJECT])},refresh:function(){var b=a.elementPath();if(b){for(var c in g)if(g[c].checkApplicable(b,a,a.activeFilter))return;this.setState(CKEDITOR.TRISTATE_DISABLED)}},reset:function(){g={};c=[]}})}})}(),function(){function a(a){return{editorFocus:false,canUndo:false,modes:{wysiwyg:1},exec:function(b){if(b.editable().hasFocus){var e=b.getSelection(),f;if(f=(new CKEDITOR.dom.elementPath(e.getCommonAncestor(),e.root)).contains({td:1,th:1},1)){var e=b.createRange(),g=CKEDITOR.tools.tryThese(function(){var b=f.getParent().$.cells[f.$.cellIndex+(a?-1:1)];b.parentNode.parentNode;return b},function(){var b=f.getParent(),b=b.getAscendant("table").$.rows[b.$.rowIndex+(a?-1:1)];return b.cells[a?b.cells.length-1:0]});if(!g&&!a){for(var i=f.getAscendant("table").$,g=f.getParent().$.cells,i=new CKEDITOR.dom.element(i.insertRow(-1),b.document),k=0,n=g.length;k<n;k++)i.append((new CKEDITOR.dom.element(g[k],b.document)).clone(false,false)).appendBogus();e.moveToElementEditStart(i)}else if(g){g=new CKEDITOR.dom.element(g);e.moveToElementEditStart(g);(!e.checkStartOfBlock()||!e.checkEndOfBlock())&&e.selectNodeContents(g)}else return true;e.select(true);return true}}return false}}}var e={editorFocus:false,modes:{wysiwyg:1,source:1}},b={exec:function(a){a.container.focusNext(true,a.tabIndex)}},g={exec:function(a){a.container.focusPrevious(true,a.tabIndex)}};CKEDITOR.plugins.add("tab",{init:function(c){for(var d=c.config.enableTabKeyTools!==false,j=c.config.tabSpaces||0,f="";j--;)f=f+" ";if(f)c.on("key",function(a){if(a.data.keyCode==9){c.insertText(f);a.cancel()}});if(d)c.on("key",function(a){(a.data.keyCode==9&&c.execCommand("selectNextCell")||a.data.keyCode==CKEDITOR.SHIFT+9&&c.execCommand("selectPreviousCell"))&&a.cancel()});c.addCommand("blur",CKEDITOR.tools.extend(b,e));c.addCommand("blurBack",CKEDITOR.tools.extend(g,e));c.addCommand("selectNextCell",a());c.addCommand("selectPreviousCell",a(true))}})}(),CKEDITOR.dom.element.prototype.focusNext=function(a,e){var b=e===void 0?this.getTabIndex():e,g,c,d,j,f,h;if(b<=0)for(f=this.getNextSourceNode(a,CKEDITOR.NODE_ELEMENT);f;){if(f.isVisible()&&f.getTabIndex()===0){d=f;break}f=f.getNextSourceNode(false,CKEDITOR.NODE_ELEMENT)}else for(f=this.getDocument().getBody().getFirst();f=f.getNextSourceNode(false,CKEDITOR.NODE_ELEMENT);){if(!g)if(!c&&f.equals(this)){c=true;if(a){if(!(f=f.getNextSourceNode(true,CKEDITOR.NODE_ELEMENT)))break;g=1}}else c&&!this.contains(f)&&(g=1);if(f.isVisible()&&!((h=f.getTabIndex())<0)){if(g&&h==b){d=f;break}if(h>b&&(!d||!j||h<j)){d=f;j=h}else if(!d&&h===0){d=f;j=h}}}d&&d.focus()},CKEDITOR.dom.element.prototype.focusPrevious=function(a,e){for(var b=e===void 0?this.getTabIndex():e,g,c,d,j=0,f,h=this.getDocument().getBody().getLast();h=h.getPreviousSourceNode(false,CKEDITOR.NODE_ELEMENT);){if(!g)if(!c&&h.equals(this)){c=true;if(a){if(!(h=h.getPreviousSourceNode(true,CKEDITOR.NODE_ELEMENT)))break;g=1}}else c&&!this.contains(h)&&(g=1);if(h.isVisible()&&!((f=h.getTabIndex())<0))if(b<=0){if(g&&f===0){d=h;break}if(f>j){d=h;j=f}}else{if(g&&f==b){d=h;break}if(f<b&&(!d||f>j)){d=h;j=f}}}d&&d.focus()},CKEDITOR.plugins.add("table",{requires:"dialog",init:function(a){function e(a){return CKEDITOR.tools.extend(a||{},{contextSensitive:1,refresh:function(a,b){this.setState(b.contains("table",1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}if(!a.blockless){var b=a.lang.table;a.addCommand("table",new CKEDITOR.dialogCommand("table",{context:"table",allowedContent:"table{width,height}[align,border,cellpadding,cellspacing,summary];caption tbody thead tfoot;th td tr[scope];"+(a.plugins.dialogadvtab?"table"+a.plugins.dialogadvtab.allowedContent():""),requiredContent:"table",contentTransformations:[["table{width}: sizeToStyle","table[width]: sizeToAttribute"]]}));a.addCommand("tableProperties",new CKEDITOR.dialogCommand("tableProperties",e()));a.addCommand("tableDelete",e({exec:function(a){var b=a.elementPath().contains("table",1);if(b){var d=b.getParent(),e=a.editable();d.getChildCount()==1&&(!d.is("td","th")&&!d.equals(e))&&(b=d);a=a.createRange();a.moveToPosition(b,CKEDITOR.POSITION_BEFORE_START);b.remove();a.select()}}}));a.ui.addButton&&a.ui.addButton("Table",{label:b.toolbar,command:"table",toolbar:"insert,30"});CKEDITOR.dialog.add("table",this.path+"dialogs/table.js");CKEDITOR.dialog.add("tableProperties",this.path+"dialogs/table.js");a.addMenuItems&&a.addMenuItems({table:{label:b.menu,command:"tableProperties",group:"table",order:5},tabledelete:{label:b.deleteTable,command:"tableDelete",group:"table",order:1}});a.on("doubleclick",function(a){if(a.data.element.is("table"))a.data.dialog="tableProperties"});a.contextMenu&&a.contextMenu.addListener(function(){return{tabledelete:CKEDITOR.TRISTATE_OFF,table:CKEDITOR.TRISTATE_OFF}})}}}),function(){function a(a){function b(a){if(!(c.length>0)&&a.type==CKEDITOR.NODE_ELEMENT&&o.test(a.getName())&&!a.getCustomData("selected_cell")){CKEDITOR.dom.element.setMarker(d,a,"selected_cell",true);c.push(a)}}for(var a=a.getRanges(),c=[],d={},f=0;f<a.length;f++){var e=a[f];if(e.collapsed){e=e.getCommonAncestor();(e=e.getAscendant("td",true)||e.getAscendant("th",true))&&c.push(e)}else{var e=new CKEDITOR.dom.walker(e),g;for(e.guard=b;g=e.next();)if(g.type!=CKEDITOR.NODE_ELEMENT||!g.is(CKEDITOR.dtd.table))if((g=g.getAscendant("td",true)||g.getAscendant("th",true))&&!g.getCustomData("selected_cell")){CKEDITOR.dom.element.setMarker(d,g,"selected_cell",true);c.push(g)}}}CKEDITOR.dom.element.clearAllMarkers(d);return c}function e(b,c){for(var d=a(b),f=d[0],e=f.getAscendant("table"),f=f.getDocument(),g=d[0].getParent(),h=g.$.rowIndex,d=d[d.length-1],i=d.getParent().$.rowIndex+d.$.rowSpan-1,d=new CKEDITOR.dom.element(e.$.rows[i]),h=c?h:i,g=c?g:d,d=CKEDITOR.tools.buildTableMap(e),e=d[h],h=c?d[h-1]:d[h+1],d=d[0].length,f=f.createElement("tr"),i=0;e[i]&&i<d;i++){var j;if(e[i].rowSpan>1&&h&&e[i]==h[i]){j=e[i];j.rowSpan=j.rowSpan+1}else{j=(new CKEDITOR.dom.element(e[i])).clone();j.removeAttribute("rowSpan");j.appendBogus();f.append(j);j=j.$}i=i+(j.colSpan-1)}c?f.insertBefore(g):f.insertAfter(g)}function b(c){if(c instanceof CKEDITOR.dom.selection){for(var d=a(c),f=d[0].getAscendant("table"),e=CKEDITOR.tools.buildTableMap(f),c=d[0].getParent().$.rowIndex,d=d[d.length-1],g=d.getParent().$.rowIndex+d.$.rowSpan-1,d=[],h=c;h<=g;h++){for(var i=e[h],j=new CKEDITOR.dom.element(f.$.rows[h]),k=0;k<i.length;k++){var n=new CKEDITOR.dom.element(i[k]),o=n.getParent().$.rowIndex;if(n.$.rowSpan==1)n.remove();else{n.$.rowSpan=n.$.rowSpan-1;if(o==h){o=e[h+1];o[k-1]?n.insertAfter(new CKEDITOR.dom.element(o[k-1])):(new CKEDITOR.dom.element(f.$.rows[h+1])).append(n,1)}}k=k+(n.$.colSpan-1)}d.push(j)}e=f.$.rows;f=new CKEDITOR.dom.element(e[g+1]||(c>0?e[c-1]:null)||f.$.parentNode);for(h=d.length;h>=0;h--)b(d[h]);return f}if(c instanceof
CKEDITOR.dom.element){f=c.getAscendant("table");f.$.rows.length==1?f.remove():c.remove()}return null}function g(a,b){for(var c=b?Infinity:0,d=0;d<a.length;d++){var f;f=a[d];for(var e=b,g=f.getParent().$.cells,h=0,i=0;i<g.length;i++){var j=g[i],h=h+(e?1:j.colSpan);if(j==f.$)break}f=h-1;if(b?f<c:f>c)c=f}return c}function c(b,c){for(var d=a(b),f=d[0].getAscendant("table"),e=g(d,1),d=g(d),e=c?e:d,h=CKEDITOR.tools.buildTableMap(f),f=[],d=[],i=h.length,j=0;j<i;j++){f.push(h[j][e]);d.push(c?h[j][e-1]:h[j][e+
1])}for(j=0;j<i;j++)if(f[j]){if(f[j].colSpan>1&&d[j]==f[j]){e=f[j];e.colSpan=e.colSpan+1}else{e=(new CKEDITOR.dom.element(f[j])).clone();e.removeAttribute("colSpan");e.appendBogus();e[c?"insertBefore":"insertAfter"].call(e,new CKEDITOR.dom.element(f[j]));e=e.$}j=j+(e.rowSpan-1)}}function d(a,b){var c=a.getStartElement();if(c=c.getAscendant("td",1)||c.getAscendant("th",1)){var d=c.clone();d.appendBogus();b?d.insertBefore(c):d.insertAfter(c)}}function j(b){if(b instanceof CKEDITOR.dom.selection){var b=a(b),c=b[0]&&b[0].getAscendant("table"),d;a:{var e=0;d=b.length-1;for(var g={},h,i;h=b[e++];)CKEDITOR.dom.element.setMarker(g,h,"delete_cell",true);for(e=0;h=b[e++];)if((i=h.getPrevious())&&!i.getCustomData("delete_cell")||(i=h.getNext())&&!i.getCustomData("delete_cell")){CKEDITOR.dom.element.clearAllMarkers(g);d=i;break a}CKEDITOR.dom.element.clearAllMarkers(g);i=b[0].getParent();if(i=i.getPrevious())d=i.getLast();else{i=b[d].getParent();d=(i=i.getNext())?i.getChild(0):null}}for(i=b.length-1;i>=0;i--)j(b[i]);d?f(d,true):c&&c.remove()}else if(b instanceof CKEDITOR.dom.element){c=b.getParent();c.getChildCount()==1?c.remove():b.remove()}}function f(a,b){var c=a.getDocument(),d=CKEDITOR.document;if(CKEDITOR.env.ie&&CKEDITOR.env.version==10){d.focus();c.focus()}c=new CKEDITOR.dom.range(c);if(!c["moveToElementEdit"+(b?"End":"Start")](a)){c.selectNodeContents(a);c.collapse(b?false:true)}c.select(true)}function h(a,b,c){a=a[b];if(typeof c=="undefined")return a;for(b=0;a&&b<a.length;b++){if(c.is&&a[b]==c.$)return b;if(b==c)return new CKEDITOR.dom.element(a[b])}return c.is?-1:null}function i(b,c,d){var f=a(b),e;if((c?f.length!=1:f.length<2)||(e=b.getCommonAncestor())&&e.type==CKEDITOR.NODE_ELEMENT&&e.is("table"))return false;var g,b=f[0];e=b.getAscendant("table");var i=CKEDITOR.tools.buildTableMap(e),j=i.length,k=i[0].length,n=b.getParent().$.rowIndex,o=h(i,n,b);if(c){var y;try{var z=parseInt(b.getAttribute("rowspan"),10)||1;g=parseInt(b.getAttribute("colspan"),10)||1;y=i[c=="up"?n-z:c=="down"?n+z:n][c=="left"?o-g:c=="right"?o+g:o]}catch(B){return false}if(!y||b.$==y)return false;f[c=="up"||c=="left"?"unshift":"push"](new CKEDITOR.dom.element(y))}for(var c=b.getDocument(),A=n,z=y=0,G=!d&&new CKEDITOR.dom.documentFragment(c),D=0,c=0;c<f.length;c++){g=f[c];var J=g.getParent(),C=g.getFirst(),F=g.$.colSpan,E=g.$.rowSpan,J=J.$.rowIndex,I=h(i,J,g),D=D+F*E,z=Math.max(z,I-o+F);y=Math.max(y,J-n+E);if(!d){F=g;(E=F.getBogus())&&E.remove();F.trim();if(g.getChildren().count()){if(J!=A&&C&&(!C.isBlockBoundary||!C.isBlockBoundary({br:1})))(A=G.getLast(CKEDITOR.dom.walker.whitespaces(true)))&&(!A.is||!A.is("br"))&&G.append("br");g.moveChildren(G)}c?g.remove():g.setHtml("")}A=J}if(d)return y*z==D;G.moveChildren(b);b.appendBogus();z>=k?b.removeAttribute("rowSpan"):b.$.rowSpan=y;y>=j?b.removeAttribute("colSpan"):b.$.colSpan=z;d=new CKEDITOR.dom.nodeList(e.$.rows);f=d.count();for(c=f-1;c>=0;c--){e=d.getItem(c);if(!e.$.cells.length){e.remove();f++}}return b}function k(b,c){var d=a(b);if(d.length>1)return false;if(c)return true;var d=d[0],f=d.getParent(),e=f.getAscendant("table"),g=CKEDITOR.tools.buildTableMap(e),i=f.$.rowIndex,j=h(g,i,d),k=d.$.rowSpan,n;if(k>1){n=Math.ceil(k/2);for(var k=Math.floor(k/2),f=i+n,e=new CKEDITOR.dom.element(e.$.rows[f]),g=h(g,f),o,f=d.clone(),i=0;i<g.length;i++){o=g[i];if(o.parentNode==e.$&&i>j){f.insertBefore(new CKEDITOR.dom.element(o));break}else o=null}o||e.append(f)}else{k=n=1;e=f.clone();e.insertAfter(f);e.append(f=d.clone());o=h(g,i);for(j=0;j<o.length;j++)o[j].rowSpan++}f.appendBogus();d.$.rowSpan=n;f.$.rowSpan=k;n==1&&d.removeAttribute("rowSpan");k==1&&f.removeAttribute("rowSpan");return f}function n(b,c){var d=a(b);if(d.length>1)return false;if(c)return true;var d=d[0],f=d.getParent(),e=f.getAscendant("table"),e=CKEDITOR.tools.buildTableMap(e),g=h(e,f.$.rowIndex,d),i=d.$.colSpan;if(i>1){f=Math.ceil(i/2);i=Math.floor(i/2)}else{for(var i=f=1,j=[],k=0;k<e.length;k++){var n=e[k];j.push(n[g]);n[g].rowSpan>1&&(k=k+(n[g].rowSpan-1))}for(e=0;e<j.length;e++)j[e].colSpan++}e=d.clone();e.insertAfter(d);e.appendBogus();d.$.colSpan=f;e.$.colSpan=i;f==1&&d.removeAttribute("colSpan");i==1&&e.removeAttribute("colSpan");return e}var o=/^(?:td|th)$/;CKEDITOR.plugins.tabletools={requires:"table,dialog,contextmenu",init:function(g){function h(a){return CKEDITOR.tools.extend(a||{},{contextSensitive:1,refresh:function(a,b){this.setState(b.contains({td:1,th:1},1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}function l(a,b){var c=g.addCommand(a,b);g.addFeature(c)}var o=g.lang.table;l("cellProperties",new CKEDITOR.dialogCommand("cellProperties",h({allowedContent:"td th{width,height,border-color,background-color,white-space,vertical-align,text-align}[colspan,rowspan]",requiredContent:"table"})));CKEDITOR.dialog.add("cellProperties",this.path+"dialogs/tableCell.js");l("rowDelete",h({requiredContent:"table",exec:function(a){a=a.getSelection();f(b(a))}}));l("rowInsertBefore",h({requiredContent:"table",exec:function(a){a=a.getSelection();e(a,true)}}));l("rowInsertAfter",h({requiredContent:"table",exec:function(a){a=a.getSelection();e(a)}}));l("columnDelete",h({requiredContent:"table",exec:function(b){for(var b=b.getSelection(),b=a(b),c=b[0],d=b[b.length-1],b=c.getAscendant("table"),e=CKEDITOR.tools.buildTableMap(b),g,h,i=[],j=0,k=e.length;j<k;j++)for(var m=0,l=e[j].length;m<l;m++){e[j][m]==c.$&&(g=m);e[j][m]==d.$&&(h=m)}for(j=g;j<=h;j++)for(m=0;m<e.length;m++){d=e[m];c=new CKEDITOR.dom.element(b.$.rows[m]);d=new CKEDITOR.dom.element(d[j]);if(d.$){d.$.colSpan==1?d.remove():d.$.colSpan=d.$.colSpan-
1;m=m+(d.$.rowSpan-1);c.$.cells.length||i.push(c)}}h=b.$.rows[0]&&b.$.rows[0].cells;g=new CKEDITOR.dom.element(h[g]||(g?h[g-1]:b.$.parentNode));i.length==k&&b.remove();g&&f(g,true)}}));l("columnInsertBefore",h({requiredContent:"table",exec:function(a){a=a.getSelection();c(a,true)}}));l("columnInsertAfter",h({requiredContent:"table",exec:function(a){a=a.getSelection();c(a)}}));l("cellDelete",h({requiredContent:"table",exec:function(a){a=a.getSelection();j(a)}}));l("cellMerge",h({allowedContent:"td[colspan,rowspan]",requiredContent:"td[colspan,rowspan]",exec:function(a){f(i(a.getSelection()),true)}}));l("cellMergeRight",h({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(a){f(i(a.getSelection(),"right"),true)}}));l("cellMergeDown",h({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(a){f(i(a.getSelection(),"down"),true)}}));l("cellVerticalSplit",h({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(a){f(k(a.getSelection()))}}));l("cellHorizontalSplit",h({allowedContent:"td[colspan]",requ iredContent:"td[colspan]",exec:function(a){f(n(a.getSelection()))}}));l("cellInsertBefore",h({requiredContent:"table",exec:function(a){a=a.getSelection();d(a,true)}}));l("cellInsertAfter",h({requiredContent:"table",exec:function(a){a=a.getSelection();d(a)}}));g.addMenuItems&&g.addMenuItems({tablecell:{label:o.cell.menu,group:"tablecell",order:1,getItems:function(){var b=g.getSelection(),c=a(b);return{tablecell_insertBefore:CKEDITOR.TRISTATE_OFF,tablecell_insertAfter:CKEDITOR.TRISTATE_OFF,tablecell_delete:CKEDITOR.TRISTATE_OFF,tablecell_merge:i(b,null,true)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_right:i(b,"right",true)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_down:i(b,"down",true)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_vertical:k(b,true)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_horizontal:n(b,true)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_properties:c.length>0?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED}}},tablecell_insertBefore:{label:o.cell.insertBefore,group:"tablecell",command:"cellInsertBefore",order:5},tablecell_insertAfter:{label:o.cell.insertAfter,group:"tablecell",command:"cellInsertAfter",order:10},tablecell_delete:{label:o.cell.deleteCell,group:"tablecell",command:"cellDelete",order:15},tablecell_merge:{label:o .cell.merge,group:"tablecell",command:"cellMerge",order:16},tablecell_merge_right:{label:o.cell.mergeRight,group:"tablecell",command:"cellMergeRight",order:17},tablecell_merge_down:{label:o.cell.mergeDown,group:"tablecell",command:"cellMergeDown",order:18},tablecell_split_horizontal:{label:o.cell.splitHorizontal,group:"tablecell",command:"cellHorizontalSplit",order:19},tablecell_split_vertical:{label:o.cell.splitVertical,group:"tablecell",command:"cellVerticalSplit",order:20},tablecell_properties:{label:o.cell.title,group:"tablecellproperties",command:"cellProperties",order:21},tablerow:{label:o.row.menu,group:"tablerow",order:1,getItems:function(){return{tablerow_insertBefore:CKEDITOR.TRISTATE_OFF,tablerow_insertAfter:CKEDITOR.TRISTATE_OFF,tablerow_delete:CKEDITOR.TRISTATE_OFF}}},tablerow_insertBefore:{label:o.row.insertBefore,group:"tablerow",command:"rowInsertBefore",order:5},tablerow_insertAfter:{label:o.row.insertAfter,group:"tablerow",command:"rowInsertAfter",order:10},tablerow_ delete:{label:o.row.deleteRow,group:"tablerow",command:"rowDelete",order:15},tablecolumn:{label:o.column.menu,group:"tablecolumn",order:1,getItems:function(){return{tablecolumn_insertBefore:CKEDITOR.TRISTATE_OFF,tablecolumn_insertAfter:CKEDITOR.TRISTATE_OFF,tablecolumn_delete:CKEDITOR.TRISTATE_OFF}}},tablecolumn_insertBefore:{label:o.column.insertBefore,group:"tablecolumn",command:"columnInsertBefore",order:5},tablecolumn_insertAfter:{label:o.column.insertAfter,group:"tablecolumn",command:"columnInsertAfter",order:10},tablecolumn_delete:{label:o.column.deleteColumn,group:"tablecolumn",command:"columnDelete",order:15}});g.contextMenu&&g.contextMenu.addListener(function(a,b,c){return(a=c.contains({td:1,th:1},1))&&!a.isReadOnly()?{tablecell:CKEDITOR.TRISTATE_OFF,tablerow:CKEDITOR.TRISTATE_OFF,tablecolumn:CKEDITOR.TRISTATE_OFF}:null})},getSelectedCells:a};CKEDITOR.plugins.add("tabletools",CKEDITOR.plugins.tabletools)}(),CKEDITOR.tools.buildTableMap=function(a){for(var a=a.$.rows,e=-1,b=[],g=0;g<a.length;g++){e++;!b[e]&&(b[e]=[]);for(var c=-1,d=0;d<a[g].cells.length;d++){var j=a[g].cells[d];for(c++;b[e][c];)c++;for(var f=isNaN(j.colSpan)?1:j.colSpan,j=isNaN(j.rowSpan)?1:j.rowSpan,h=0;h<j;h++){b[e+h]||(b[e+
h]=[]);for(var i=0;i<f;i++)b[e+h][c+i]=a[g].cells[d]}c=c+(f-1)}}return b},function(){function a(a){function b(){for(var d=g(),h=CKEDITOR.tools.clone(a.config.toolbarGroups)||e(a),i=0;i<h.length;i++){var k=h[i];if(k!="/"){typeof k=="string"&&(k=h[i]={name:k});var l,p=k.groups;if(p)for(var t=0;t<p.length;t++){l=p[t];(l=d[l])&&f(k,l)}(l=d[k.name])&&f(k,l)}}return h}function g(){var b={},d,f,e;for(d in a.ui.items){f=a.ui.items[d];e=f.toolbar||"others";e=e.split(",");f=e[0];e=parseInt(e[1]||-1,10);b[f]||(b[f]=[]);b[f].push({name:d,order:e})}for(f in b)b[f]=b[f].sort(function(a,b){return a.order==b.order?0:b.order<0?-1:a.order<0?1:a.order<b.order?-1:1});return b}function f(b,d){if(d.length){b.items?b.items.push(a.ui.create("-")):b.items=[];for(var f;f=d.shift();){f=typeof f=="string"?f:f.name;if(!i||CKEDITOR.tools.indexOf(i,f)==-1)(f=a.ui.create(f))&&a.addFeature(f)&&b.items.push(f)}}}function h(a){var b=[],c,d,e;for(c=0;c<a.length;++c){d=a[c];e={};if(d=="/")b.push(d);else if(CKEDITOR.tools.isArray(d)){f(e,CKEDITOR.tools.clone(d));b.push(e)}else if(d.items){f(e,CKEDITOR.tools.clone(d.items));e.name=d.name;b.push(e)}}return b}var i=a.config.removeButtons,i=i&&i.split(","),k=a.config.toolbar;typeof k=="string"&&(k=a.config["toolbar_"+k]);return a.toolbar=k?h(k):b()}function e(a){return a._.toolbarGroups||(a._.toolbarGroups=[{name:"document",groups:["mode","document","doctools"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker"]},{name:"forms"},"/",{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"links"},{name:"insert"},"/",{name:"styles"},{name:"colors"},{name:"tools"},{name:"others"},{name:"about"}])}var b=function(){this.toolbars=[];this.focusCommandExecuted=false};b.prototype.focus=function(){for(var a=0,b;b=this.toolbars[a++];)for(var e=0,f;f=b.items[e++];)if(f.focus){f.focus();return}};var g={modes:{wysiwyg:1,source:1},readOnly:1,exec:function(a){if(a.toolbox){a.toolbox.focusCommandExecuted=true;CKEDITOR.env.ie||CKEDITOR.env.air?setTimeout(function(){a.toolbox.focus()},100):a.toolbox.focus()}}};CKEDITOR.plugins.add("toolbar",{requires:"button",init:function(c){var d,e=function(a,b){var g,k=c.lang.dir=="rtl",n=c.config.toolbarGroupCycling,o=k?37:39,k=k?39:37,n=n===void 0||n;switch(b){case 9:case CKEDITOR.SHIFT+9:for(;!g||!g.items.length;){g=b==9?(g?g.next:a.toolbar.next)||c.toolbox.toolbars[0]:(g?g.previous:a.toolbar.previous)||c.toolbox.toolbars[c.toolbox.toolbars.length-1];if(g.items.length)for(a=g.items[d?g.items.length-1:0];a&&!a.focus;)(a=d?a.previous:a.next)||(g=0)}a&&a.focus();return false;case o:g=a;do{g=g.next;!g&&n&&(g=a.toolbar.items[0])}while(g&&!g.focus);g?g.focus():e(a,9);return false;case 40:if(a.button&&a.button.hasArrow){c.once("panelShow",function(a){a.data._.panel._.currentBlock.onKeyDown(40)});a.execute()}else e(a,b==40?o:k);return false;case k:case 38:g=a;do{g=g.previous;!g&&n&&(g=a.toolbar.items[a.toolbar.items.length-1])}while(g&&!g.focus);if(g)g.focus();else{d=1;e(a,CKEDITOR.SHIFT+9);d=0}return false;case 27:c.focus();return false;case 13:case 32:a.execute();return false}return true};c.on("uiSpace",function(d){if(d.data.space==c.config.toolbarLocation){d.removeListener();c.toolbox=new b;var g=CKEDITOR.tools.getNextId(),i=['<span id="',g,'" class="cke_voice_label">',c.lang.toolbar.toolbars,"</span>",'<span id="'+c.ui.spaceId("toolbox")+'" class="cke_toolbox" role="group" aria-labelledby="',g,'" onmousedown="return false;">'],g=c.config.toolbarStartupExpanded!==false,k,n;c.config.toolbarCanCollapse&&c.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&i.push('<span class="cke_toolbox_main"'+(g?">":' style="display:none">'));for(var o=c.toolbox.toolbars,q=a(c),m=0;m<q.length;m++){var l,p=0,t,s=q[m],u;if(s){if(k){i.push("</span>");n=k=0}if(s==="/")i.push('<span class="cke_toolbar_break"></span>');else{u=s.items||s;for(var w=0;w<u.length;w++){var x=u[w],v;if(x)if(x.type==CKEDITOR.UI_SEPARATOR)n=k&&x;else{v=x.canGroup!==false;if(!p){l=CKEDITOR.tools.getNextId();p={id:l,items:[]};t=s.name&&(c.lang.toolbar.toolbarGroups[s.name]||s.name);i.push('<span id="',l,'" class="cke_toolbar"',t?' aria-labelledby="'+l+'_label"':"",' role="toolbar">');t&&i.push('<span id="',l,'_label" class="cke_voice_label">',t,"</span>");i.push('<span class="cke_toolbar_start"></span>');var r=o.push(p)-1;if(r>0){p.previous=o[r-1];p.previous.next=p}}if(v){if(!k){i.push('<span class="cke_toolgroup" role="presentation">');k=1}}else if(k){i.push("</span>");k=0}l=function(a){a=a.render(c,i);r=p.items.push(a)-
1;if(r>0){a.previous=p.items[r-1];a.previous.next=a}a.toolbar=p;a.onkey=e;a.onfocus=function(){c.toolbox.focusCommandExecuted||c.focus()}};if(n){l(n);n=0}l(x)}}if(k){i.push("</span>");n=k=0}p&&i.push('<span class="cke_toolbar_end"></span></span>')}}}c.config.toolbarCanCollapse&&i.push("</span>");if(c.config.toolbarCanCollapse&&c.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var y=CKEDITOR.tools.addFunction(function(){c.execCommand("toolbarCollapse")});c.on("destroy",function(){CKEDITOR.tools.removeFunction(y)});c.addCommand("toolbarCollapse",{readOnly:1,exec:function(a){var b=a.ui.space("toolbar_collapser"),c=b.getPrevious(),d=a.ui.space("contents"),f=c.getParent(),e=parseInt(d.$.style.height,10),g=f.$.offsetHeight,h=b.hasClass("cke_toolbox_collapser_min");if(h){c.show();b.removeClass("cke_toolbox_collapser_min");b.setAttribute("title",a.lang.toolbar.toolbarCollapse)}else{c.hide();b.addClass("cke_toolbox_collapser_min");b.setAttribute("title",a.lang.toolbar.toolbarExpand)}b.getFirst().setText(h?"▲":"◀");d.setStyle("height",e-(f.$.offsetHeight-g)+"px");a.fire("resize")},modes:{wysiwyg:1,source:1}});c.setKeystroke(CKEDITOR.ALT+(CKEDITOR.env.ie||CKEDITOR.env.webkit?189:109),"toolbarCollapse");i.push('<a title="'+(g?c.lang.toolbar.toolbarCollapse:c.lang.toolbar.toolbarExpand)+'" id="'+c.ui.spaceId("toolbar_collapser")+'" tabIndex="-1" class="cke_toolbox_collapser');g||i.push(" cke_toolbox_collapser_min");i.push('" onclick="CKEDITOR.tools.callFunction('+y+')">','<span class="cke_arrow">&#9650;</span>',"</a>")}i.push("</span>");d.data.html=d.data.html+i.join("")}});c.on("destroy",function(){if(this.toolbox){var a,b=0,c,d,e;for(a=this.toolbox.toolbars;b<a.length;b++){d=a[b].items;for(c=0;c<d.length;c++){e=d[c];e.clickFn&&CKEDITOR.tools.removeFunction(e.clickFn);e.keyDownFn&&CKEDITOR.tools.removeFunction(e.keyDownFn)}}}});c.on("uiReady",function(){var a=c.ui.space("toolbox");a&&c.focusManager.add(a,1)});c.addCommand("toolbarFocus",g);c.setKeystroke(CKEDITOR.ALT+121,"toolbarFocus");c.ui.add("-",CKEDITOR.UI_SEPARATOR,{});c.ui.addHandler(CKEDITOR.UI_SEPARATOR,{create:function(){return{render:function(a,b){b.push('<span class="cke_toolbar_separator" role="separator"></span>');return{}}}}})}});CKEDITOR.ui.prototype.addToolbarGroup=function(a,b,g){var f=e(this.editor),h=b===0,i={name:a};if(g){if(g=CKEDITOR.tools.search(f,function(a){return a.name==g})){!g.groups&&(g.groups=[]);if(b){b=CKEDITOR.tools.indexOf(g.groups,b);if(b>=0){g.groups.splice(b+1,0,a);return}}h?g.groups.splice(0,0,a):g.groups.push(a);return}b=null}b&&(b=CKEDITOR.tools.indexOf(f,function(a){return a.name==b}));h?f.splice(0,0,a):typeof b=="number"?f.splice(b+1,0,i):f.push(a)}}(),CKEDITOR.UI_SEPARATOR="separator",CKEDITOR.config.toolbarLocation="top","use strict",function(){var a=[CKEDITOR.CTRL+90,CKEDITOR.CTRL+89,CKEDITOR.CTRL+CKEDITOR.SHIFT+90],e={8:1,46:1};CKEDITOR.plugins.add("undo",{init:function(c){function e(a){j.enabled&&a.data.command.canUndo!==false&&j.save()}function g(){j.enabled=c.readOnly?false:c.mode=="wysiwyg";j.onChange()}var j=c.undoManager=new b(c),n=j.editingHandler=new d(j),o=c.addCommand("undo",{exec:function(){if(j.undo()){c.selectionChange();this.fire("afterUndo")}},startDisabled:true,canUndo:false}),q=c.addCommand("redo",{exec:function(){if(j.redo()){c.selectionChange();this.fire("afterRedo")}},startDisabled:true,canUndo:false});c.setKeystroke([[a[0],"undo"],[a[1],"redo"],[a[2],"redo"]]);j.onChange=function(){o.setState(j.undoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED);q.setState(j.redoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)};c.on("beforeCommandExec",e);c.on("afterCommandExec",e);c.on("saveSnapshot",function(a){j.save(a.data&&a.data.contentOnly)});c.on("contentDom",n.attachListeners,n);c.on("instanceReady",function(){c.fire("saveSnapshot")});c.on("beforeModeUnload",function(){c.mode=="wysiwyg"&&j.save(true)});c.on("mode",g);c.on("readOnly",g);if(c.ui.addButton){c.ui.addButton("Undo",{label:c.lang.undo.undo,command:"undo",toolbar:"undo,10"});c.ui.addButton("Redo",{label:c.lang.undo.redo,command:"r edo",toolbar:"undo,20"})}c.resetUndo=function(){j.reset();c.fire("saveSnapshot")};c.on("updateSnapshot",function(){j.currentImage&&j.update()});c.on("lockSnapshot",function(a){a=a.data;j.lock(a&&a.dontUpdate,a&&a.forceUpdate)});c.on("unlockSnapshot",j.unlock,j)}});CKEDITOR.plugins.undo={};var b=CKEDITOR.plugins.undo.UndoManager=function(a){this.strokesRecorded=[0,0];this.locked=null;this.previousKeyGroup=-1;this.limit=a.config.undoStackSize||20;this.strokesLimit=25;this.editor=a;this.reset()};b.prototype={type:function(a,c){var d=b.getKeyGroup(a),e=this.strokesRecorded[d]+1,c=c||e>=this.strokesLimit;if(!this.typing){this.hasUndo=this.typing=true;this.hasRedo=false;this.onChange()}if(c){e=0;this.editor.fire("saveSnapshot")}else this.editor.fire("change");this.strokesRecorded[d]=e;this.previousKeyGroup=d},keyGroupChanged:function(a){return b.getKeyGroup(a)!=this.previousKeyGroup},reset:function(){this.snapshots=[];this.index=-1;this.currentImage=null;this.hasRedo=this.hasUndo=false;this.locked=null;this.resetType()},resetType:function(){this.strokesRecorded=[0,0];this.typing=false;this.previousKeyGroup=-1},refreshState:function(){this.hasUndo=!!this.getNextImage(true);this.hasRedo=!!this.getNextImage(false);this.resetType();this.onChange()},save:function(a,b,c){var d=this.editor;if(this.locked||d.status!="ready"||d.mode!="wysiwyg")return false;var e=d.editable();if(!e||e.status!="ready")return false;e=this.snapshots;b||(b=new g(d));if(b.contents===false)return false;if(this.currentImage)if(b.equalsContent(this.currentImage)){if(a||b.equalsSelection(this.currentImage))return false}else c!==false&&d.fire("change");e.splice(this.index+1,e.length-this.index-1);e.length==this.limit&&e.shift();this.index=e.push(b)-1;this.currentImage=b;c!==false&&this.refreshState();return true},restoreImage:function(a){var b=this.editor,c;if(a.bookmarks){b.focus();c=b.getSelection()}this.locked={level:999};this.editor.loadSnapshot(a.contents);if(a.bookmarks)c.selectBookmarks(a.bookmarks);else if(CKEDITOR.env.ie){c=this.editor.document.getBody().$.createTextRange();c.collapse(true);c.select()}this.locked=null;this.index=a.index;this.currentImage=this.snapshots[this.index];this.update();this.refreshState();b.fire("change")},getNextImage:function(a){var b=this.snapshots,c=this.currentImage,d;if(c)if(a)for(d=this.index-1;d>=0;d--){a=b[d];if(!c.equalsContent(a)){a.index=d;return a}}else for(d=this.index+1;d<b.length;d++){a=b[d];if(!c.equalsContent(a)){a.index=d;return a}}return null},redoable:function(){return this.enabled&&this.hasRedo},undoable:function(){return this.enabled&&this.hasUndo},undo:function(){if(this.undoable()){this.save(true);var a=this.getNextImage(true);if(a)return this.restoreImage(a),true}return false},redo:function(){if(this.redoable()){this.save(true);if(this.redoable()){var a=this.getNextImage(false);if(a)return this.restoreImage(a),true}}return false},update:function(a){if(!this.locked){a||(a=new g(this.editor));for(var b=this.index,c=this.snapshots;b>0&&this.currentImage.equalsContent(c[b-1]);)b=b-1;c.splice(b,this.index-b+1,a);this.index=b;this.currentImage=a}},updateSelection:function(a){if(!this.snapshots.length)return false;var b=this.snapshots,c=b[b.length-1];if(c.equalsContent(a)&&!c.equalsSelection(a)){this.currentImage=b[b.length-1]=a;return true}return false},lock:function(a,b){if(this.locked)this.locked.level++;else if(a)this.locked={level:1};else{var c=null;if(b)c=true;else{var d=new g(this.editor,true);this.currentImage&&this.currentImage.equalsContent(d)&&(c=d)}this.locked={update:c,level:1}}},unlock:function(){if(this.locked&&!--this.locked.level){var a=this.locked.update;this.locked=null;if(a===true)this.update();else if(a){var b=new g(this.editor,true);a.equalsContent(b)||this.update()}}}};b.navigationKeyCodes={37:1,38:1,39:1,40:1,36:1,35:1,33:1,34:1};b.keyGroups={PRINTABLE:0,FUNCTIONAL:1};b.isNavigationKey=function(a){return!!b.navigationKeyCodes[a]};b.getKeyGroup=function(a){var c=b.keyGroups;return e[a]?c.FUNCTIONAL:c.PRINTABLE};b.getOppositeKeyGroup=function(a){var c=b.keyGroups;return a==c.FUNCTIONAL?c.PRINTABLE:c.FUNCTIONAL};b.ieFunctionalKeysBug=function(a){return CKEDITOR.env.ie&&b.getKeyGroup(a)==b.keyGroups.FUNCTIONAL};var g=CKEDITOR.plugins.undo.Image=function(a,b){this.editor=a;a.fire("beforeUndoImage");var c=a.getSnapshot();CKEDITOR.env.ie&&c&&(c=c.replace(/\s+data-cke-expando=".*?"/g,""));this.contents=c;if(!b)this.bookmarks=(c=c&&a.getSelection())&&c.createBookmarks2(true);a.fire("afterUndoImage")},c=/\b(?:href|src|name)="[^"]*?"/gi;g.prototype={equalsContent:function(a){var b=this.contents,a=a.contents;if(CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)){b=b.replace(c,"");a=a.replace(c,"")}return b!=a?false:true},equalsSelection:function(a){var b=this.bookmarks,a=a.bookmarks;if(b||a){if(!b||!a||b.length!=a.length)return false;for(var c=0;c<b.length;c++){var d=b[c],e=a[c];if(d.startOffset!=e.startOffset||d.endOffset!=e.endOffset||!CKEDITOR.tools.arrayCompare(d.start,e.start)||!CKEDITOR.tools.arrayCompare(d.end,e.end))return false}}return true}};var d=CKEDITOR.plugins.undo.NativeEditingHandler=function(a){this.undoManager=a;this.ignoreInputEvent=false;this.keyEventsStack=new j;this.lastKeydownImage=null};d.prototype={onKeydown:function(c){var d=c.data.getKey();if(d!==229)if(CKEDITOR.tools.indexOf(a,c.data.getKeystroke())>-1)c.data.preventDefault();else{this.keyEventsStack.cleanUp(c);c=this.undoManager;this.keyEventsStack.getLast(d)||this.keyEventsStack.push(d);this.lastKeydownImage=new g(c.editor);if(b.isNavigationKey(d)||this.undoManager.keyGroupChanged(d))if(c.strokesRecorded[0]||c.strokesRecorded[1]){c.save(false,this.lastKeydownImage,false);c.resetType()}}},onInput:function(){if(this.ignoreInputEvent)this.ignoreInputEvent=false;else{var a=this.keyEventsStack.getLast();a||(a=this.keyEventsStack.push(0));this.keyEventsStack.increment(a.keyCode);if(this.keyEventsStack.getTotalInputs()>=this.undoManager.strokesLimit){this.undoManager.type(a.keyCode,true);this.keyEventsStack.resetInputs()}}},onKeyup:function(a){var c=this.undoManager,a=a.data.getKey(),d=this.keyEventsStack.getTotalInputs();this.keyEventsStack.remove(a);if(!b.ieFunctionalKeysBug(a)||!this.lastKeydownImage||!this.lastKeydownImage.equalsContent(new g(c.editor,true)))if(d>0)c.type(a);else if(b.isNavigationKey(a))this.onNavigationKey(true)},onNavigationKey:function(a){var b=this.undoManager;(a||!b.save(true,null,false))&&b.updateSelection(new g(b.editor));b.resetType()},ignoreInputEventListener:function(){this.ignoreInputEvent=true},attachListeners:function(){var a=this.undoManager.editor,c=a.editable(),d=this;c.attachListener(c,"keydown",function(a){d.onKeydown(a);if(b.ieFunctionalKeysBug(a.data.getKey()))d.onInput()},null,null,999);c.attachListener(c,CKEDITOR.env.ie?"keypress":"input",d.onInput,d,null,999);c.attachListener(c,"keyup",d.onKeyup,d,null,999);c.attachListener(c,"paste",d.ignoreInputEventListener,d,null,999);c.attachListener(c,"drop",d.ignoreInputEventListener,d,null,999);c.attachListener(c.isInline()?c:a.document.getDocumentElement(),"click",function(){d.onNavigationKey()},null,null,999);c.attachListener(this.undoManager.editor,"blur",function(){d.keyEventsStack.remove(9)},null,null,999)}};var j=CKEDITOR.plugins.undo.KeyEventsStack=function(){this.stack=[]};j.prototype={push:function(a){return this.stack[this.stack.push({keyCode:a,inputs:0})-1]},getLastIndex:function(a){if(typeof a!="number")return this.stack.length-1;for(var b=this.stack.length;b--;)if(this.stack[b].keyCode==a)return b;return-1},getLast:function(a){a=this.getLastIndex(a);return a!=-1?this.stack[a]:null},increment:function(a){this.getLast(a).inputs++},remove:function(a){a=this.getLastIndex(a);a!=-1&&this.stack.splice(a,1)},resetInputs:function(a){if(typeof a=="number")this.getLast(a).inputs=0;else for(a=this.stack.length;a--;)this.stack[a].inputs=0},getTotalInputs:function(){for(var a=this.stack.length,b=0;a--;)b=b+this.stack[a].inputs;return b},cleanUp:function(a){a=a.data.$;!a.ctrlKey&&!a.metaKey&&this.remove(17);a.shiftKey||this.remove(16);a.altKey||this.remove(18)}}}(),CKEDITOR.plugins.add("wsc",{requires:"dialog",parseApi:function(a){a.config.wsc_onFinish=typeof a.config.wsc_onFinish==="function"?a.config.wsc_onFinish:function(){};a.config.wsc_onClose=typeof a.config.wsc_onClose==="function"?a.config.wsc_onClose:function(){}},parseConfig:function(a){a.config.wsc_customerId=a.config.wsc_customerId||CKEDITOR.config.wsc_customerId||"1:ua3xw1-2XyGJ3-GWruD3-6OFNT1-oXcuB1-nR6Bp4-hgQHc-EcYng3-sdRXG3-NOfFk";a.config.wsc_customDictionaryIds=a.config.wsc_customDictionaryIds||CKEDITOR.config.wsc_customDictionaryIds||"";a.config.wsc_userDictionaryName=a.config.wsc_userDictionaryName||CKEDITOR.config.wsc_userDictionaryName||"";a.config.wsc_customLoaderScript=a.config.wsc_customLoaderScript||CKEDITOR.config.wsc_customLoaderScript;CKEDITOR.config.wsc_cmd=a.config.wsc_cmd||CKEDITOR.config.wsc_cmd||"spell";CKEDITOR.config.wsc_version="v4.3.0-26-g5bcf855";CKEDITOR.config.wsc_removeGlobalVariable=true},init:function(a){var e=CKEDITOR.env;this.parseConfig(a);this.parseApi(a);a.addCommand("checkspell",new CKEDITOR.dialogCommand("checkspell")).modes={wysiwyg:!CKEDITOR.env.opera&&!CKEDITOR.env.air&&document.domain==window.location.hostname&&!(e.ie&&(e.version<8||e.quirks))};typeof a.plugins.scayt=="undefined"&&a.ui.addButton&&a.ui.addButton("SpellChecker",{label:a.lang.wsc.toolbar,click:function(a){var e=a.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?a.container.getText():a.document.getBody().getText();(e=e.replace(/\s/g,""))?a.execCommand("checkspell"):alert("Nothing to check!")},toolbar:"spellchecker,10"});CKEDITOR.dialog.add("checkspell",this.path+(CKEDITOR.env.ie&&CKEDITOR.env.version<=7?"dialogs/wsc_ie.js":window.postMessage?"dialogs/wsc.js":"dialogs/wsc_ie.js"))}}),function(){function a(a){var b=this.editor,g=a.document,f=g.body,h=g.getElementById("cke_actscrpt");h&&h.parentNode.removeChild(h);(h=g.getElementById("cke_shimscrpt"))&&h.parentNode.removeChild(h);(h=g.getElementById("cke_basetagscrpt"))&&h.parentNode.removeChild(h);f.contentEditable=true;if(CKEDITOR.env.ie){f.hideFocus=true;f.disabled=true;f.removeAttribute("disabled")}delete this._.isLoadingData;this.$=f;g=new CKEDITOR.dom.document(g);this.setup();this.fixInitialSelection();if(CKEDITOR.env.ie){g.getDocumentElement().addClass(g.$.compatMode);b.config.enterMode!=CKEDITOR.ENTER_P&&this.attachListener(g,"selectionchange",function(){var a=g.getBody(),c=b.getSelection(),e=c&&c.getRanges()[0];e&&(a.getHtml().match(/^<p>(?:&nbsp;|<br>)<\/p>$/i)&&e.startContainer.equals(a))&&setTimeout(function(){e=b.getSelection().getRanges()[0];if(!e.startContainer.equals("body")){a.getFirst().remove(1);e.moveToElementEditEnd(a);e.select()}},0)})}if(CKEDITOR.env.webkit||CKEDITOR.env.ie&&CKEDITOR.env.version>10)g.getDocumentElement().on("mousedown",function(a){a.data.getTarget().is("html")&&setTimeout(function(){b.editable().focus()})});e(b);try{b.document.$.execCommand("2D-position",false,true)}catch(i){}(CKEDITOR.env.gecko||CKEDITOR.env.ie&&b.document.$.compatMode=="CSS1Compat")&&this.attachListener(this,"keydown",function(a){var c=a.data.getKeystroke();if(c==33||c==34)if(CKEDITOR.env.ie)setTimeout(function(){b.getSelection().scrollIntoView()},0);else if(b.window.$.innerHeight>this.$.offsetHeight){var e=b.createRange();e[c==33?"moveToElementEditStart":"moveToElementEditEnd"](this);e.select();a.data.preventDefault()}});CKEDITOR.env.ie&&this.attachListener(g,"blur",function(){try{g.$.selection.empty()}catch(a){}});CKEDITOR.env.iOS&&this.attachListener(g,"touchend",function(){a.focus()});f=b.document.getElementsByTag("title").getItem(0);f.data("cke-title",f.getText());if(CKEDITOR.env.ie)b.document.$.title=this._.docTitle;CKEDITOR.tools.setTimeout(function(){if(this.status=="unloaded")this.status="ready";b.fire("contentDom");if(this._.isPendingFocus){b.focus();this._.isPendingFocus=false}setTimeout(function(){b.fire("dataReady")},0);CKEDITOR.env.ie&&setTimeout(function(){if(b.document){var a=b.document.$.body;a.runtimeStyle.marginBottom="0px";a.runtimeStyle.marginBottom=""}},1E3)},0,this)}function e(a){function b(){var d;a.editable().attachListener(a,"selectionChange",function(){var b=a.getSelection().getSelectedElement();if(b){if(d){d.detachEvent("onresizestart",e);d=null}b.$.attachEvent("onresizestart",e);d=b.$}})}function e(a){a.returnValue=false}if(CKEDITOR.env.gecko)try{var f=a.document.$;f.execCommand("enableObjectResizing",false,!a.config.disableObjectResizing);f.execCommand("enableInlineTableEditing",false,!a.config.disableNativeTableHandles)}catch(g){}else CKEDITOR.env.ie&&(CKEDITOR.env.version<11&&a.config.disableObjectResizing)&&b(a)}function b(){var a=[];if(CKEDITOR.document.$.documentMode>=8){a.push("html.CSS1Compat [contenteditable=false]{min-height:0 !important}");var b=[],e;for(e in CKEDITOR.dtd.$removeEmpty)b.push("html.CSS1Compat "+e+"[contenteditable=false]");a.push(b.join(",")+"{display:inline-block}")}else if(CKEDITOR.env.gecko){a.push("html{height:100% !important}");a.push("img:-moz-broken{-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")}a.push("html{cursor:text;*cursor:auto}");a.push("img,input,textarea{cursor:default}");return a.join("\n")}CKEDITOR.plugins.add("wysiwygarea",{init:function(a){a.config.fullPage&&a.addFeature({allowedContent:"html head title; style [media,type]; body (*)[id]; meta link [*]",requiredContent:"body"});a.addMode("wysiwyg",function(b){function e(f){f&&f.removeListener();a.editable(new g(a,h.$.contentWindow.document.body));a.setData(a.getData(1),b)}var f="document.open();"+(CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"")+"document.close();",f=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie?"javascript:void(function(){"+encodeURIComponent(f)+"}())":"",h=CKEDITOR.dom.element.createFromHtml('<iframe src="'+f+'" frameBorder="0"></iframe>');h.setStyles({width:"100%",height:"100%"});h.addClass("cke_wysiwyg_frame cke_reset");var i=a.ui.space("contents");i.append(h);if(f=CKEDITOR.env.ie||CKEDITOR.env.gecko)h.on("load",e);var k=a.title,n=a.fire("ariaEditorHelpLabel",{}).label;if(k){CKEDITOR.env.ie&&n&&(k=k+(", "+n));h.setAttribute("title",k)}if(n){var k=CKEDITOR.tools.getNextId(),o=CKEDITOR.dom.element.createFromHtml('<span id="'+k+'" class="cke_voice_label">'+n+"</span>");i.append(o,1);h.setAttribute("aria-describedby",k)}a.on("beforeModeUnload",function(a){a.removeListener();o&&o.remove()});h.setAttributes({tabIndex:a.tabIndex,allowTransparency:"true"});!f&&e();if(CKEDITOR.env.webkit){f=function(){i.setStyle("width","100%");h.hide();h.setSize("width",i.getSize("width"));i.removeStyle("width");h.show()};h.setCustomData("onResize",f);CKEDITOR.document.getWindow().on("resize",f)}a.fire("ariaWidget",h)})}});CKEDITOR.editor.prototype.addContentsCss=function(a){var b=this.config,e=b.contentsCss;if(!CKEDITOR.tools.isArray(e))b.contentsCss=e?[e]:[];b.contentsCss.push(a)};var g=CKEDITOR.tools.createClass({$:function(){this.base.apply(this,arguments);this._.frameLoadedHandler=CKEDITOR.tools.addFunction(function(b){CKEDITOR.tools.setTimeout(a,0,this,b)},this);this._.docTitle=this.getWindow().getFrame().getAttribute("title")},base:CKEDITOR.editable,proto:{setData:function(a,d){var e=this.editor;if(d){this.setHtml(a);this.fixInitialSelection();e.fire("dataReady")}else{this._.isLoadingData=true;e._.dataStore={id:1};var f=e.config,g=f.fullPage,i=f.docType,k=CKEDITOR.tools.buildStyleHtml(b()).replace(/<style>/,'<style data-cke-temp="1">');g||(k=k+CKEDITOR.tools.buildStyleHtml(e.config.contentsCss));var n=f.baseHref?'<base href="'+f.baseHref+'" data-cke-temp="1" />':"";g&&(a=a.replace(/<!DOCTYPE[^>]*>/i,function(a){e.docType=i=a;return""}).replace(/<\?xml\s[^\?]*\?>/i,function(a){e.xmlDeclaration=a;return""}));a=e.dataProcessor.toHtml(a);if(g){/<body[\s|>]/.test(a)||(a="<body>"+a);/<html[\s|>]/.test(a)||(a="<html>"+a+"</html>");/<head[\s|>]/.test(a)?/<title[\s|>]/.test(a)||(a=a.replace(/<head[^>]*>/,"$&<title></title>")):a=a.replace(/<html[^>]*>/,"$&<head><title></title></head>");n&&(a=a.replace(/<head[^>]*?>/,"$&"+n));a=a.replace(/<\/head\s*>/,k+"$&");a=i+a}else a=f.docType+'<html dir="'+f.contentsLangDirection+'" lang="'+(f.contentsLanguage||e.langCode)+'"><head><title>'+this._.docTitle+"</title>"+n+k+"</head><body"+(f.bodyId?' id="'+f.bodyId+'"':"")+(f.bodyClass?' class="'+f.bodyClass+'"':"")+">"+a+"</body></html>";if(CKEDITOR.env.gecko){a=a.replace(/<body/,'<body contenteditable="true" ');CKEDITOR.env.version<2E4&&(a=a.replace(/<body[^>]*>/,"$&<\!-- cke-content-start --\>"))}f='<script id="cke_actscrpt" type="text/javascript"'+(CKEDITOR.env.ie?' defer="defer" ':"")+">var wasLoaded=0;function onload(){if(!wasLoaded)window.parent.CKEDITOR.tools.callFunction("+this._.frameLoadedHandler+",window);wasLoaded=1;}"+(CKEDITOR.env.ie?"onload();":'document.addEventListener("DOMContentLoaded", onload, false );')+"<\/script>";CKEDITOR.env.ie&&CKEDITOR.env.version<9&&(f=f+'<script id="cke_shimscrpt">window.parent.CKEDITOR.tools.enableHtml5Elements(document)<\/script>');n&&(CKEDITOR.env.ie&&CKEDITOR.env.version<10)&&(f=f+'<script id="cke_basetagscrpt">var baseTag = document.querySelector( "base" );baseTag.href = baseTag.href;<\/script>');a=a.replace(/(?=\s*<\/(:?head)>)/,f);this.clearCustomData();this.clearListeners();e.fire("contentDomUnload");var o=this.getDocument();try{o.write(a)}catch(q){setTimeout(function(){o.write(a)},0)}}},getData:function(a){if(a)return this.getHtml();var a=this.editor,b=a.config,e=b.fullPage,f=e&&a.docType,g=e&&a.xmlDeclaration,i=this.getDocument(),e=e?i.getDocumentElement().getOuterHtml():i.getBody().getHtml();CKEDITOR.env.gecko&&b.enterMode!=CKEDITOR.ENTER_BR&&(e=e.replace(/<br>(?=\s*(:?$|<\/body>))/,""));e=a.dataProcessor.toDataFormat(e);g&&(e=g+"\n"+e);f&&(e=f+"\n"+e);return e},focus:function(){this._.isLoadingData?this._.isPendingFocus=true:g.baseProto.focus.call(this)},detach:function(){var a=this.editor,b=a.document,a=a.window.getFrame();g.baseProto.detach.call(this);this.clearCustomData();b.getDocumentElement().clearCustomData();a.clearCustomData();CKEDITOR.tools.removeFunction(this._.frameLoadedHandler);(b=a.removeCustomData("onResize"))&&b.removeListener();a.remove()}}})}(),CKEDITOR.config.disableObjectResizing=!1,CKEDITOR.config.disableNativeTableHandles=!0,CKEDITOR.config.disableNativeSpellChecker=!0,CKEDITOR.config.contentsCss=CKEDITOR.getUrl("contents.css"),CKEDITOR.config.plugins="dialogui,dialog,a11yhelp,about,basicstyles,blockquote,clipboard,panel,floatpanel,menu,contextmenu,elementspath,indent,indentlist,list,enterkey,entities,popup,filebrowser,floatingspace,listblock,button,richcombo,format,horizontalrule,htmlwriter,image,fakeobjects,link,magicline,maximize,pastefromword,pastetext,removeformat,resize,menubutton,scayt,showborders,sourcearea,specialchar,stylescombo,tab,table,tabletools,toolbar,undo,wsc,wysiwygarea",CKEDITOR.config.skin="moono",func tion(){var a=function(a,b){for(var g=CKEDITOR.getUrl("plugins/"+b),a=a.split(","),c=0;c<a.length;c++)CKEDITOR.skin.icons[a[c]]={path:g,offset:-a[++c],bgsize:a[++c]}};CKEDITOR.env.hidpi?a("about,0,,bold,24,,italic,48,,strike,72,,subscript,96,,superscript,120,,underline,144,,bidiltr,168,,bidirtl,192,,blockquote,216,,copy-rtl,240,,copy,264,,cut-rtl,288,,cut,312,,paste-rtl,336,,paste,360,,codesnippet,384,,bgcolor,408,,textcolor,432,,creatediv,456,,docprops-rtl,480,,docprops,504,,find-rtl,528,,find,552,,replace,576,,flash,600,,button,624,,checkbox,648,,form,672,,hiddenfield,696,,imagebutton,720,,radio,744,,select-rtl,768,,select,792,,textarea-rtl,816,,textarea,840,,textfield-rtl,864,,textfield,888,,horizontalrule,912,,iframe,936,,image,960,,indent-rtl,984,,indent,1008,,outdent-rtl,1032,,outdent,1056,,justifyblock,1080,,justifycenter,1104,,justifyleft,1128,,justifyright,1152,,language,1176,,anchor-rtl,1200,,anchor,1224,,link,1248,,unlink,1272,,bulletedlist-rtl,1296,,bulletedlist,1320,,numberedlist-rtl,1344,,numberedli st,1368,,mathjax,1392,,maximize,1416,,newpage-rtl,1440,,newpage,1464,,pagebreak-rtl,1488,,pagebreak,1512,,pastefromword-rtl,1536,,pastefromword,1560,,pastetext-rtl,1584,,pastetext,1608,,placeholder,1632,,preview-rtl,1656,,preview,1680,,print,1704,,removeformat,1728,,save,1752,,scayt,1776,,selectall,1800,,showblocks-rtl,1824,,showblocks,1848,,smiley,1872,,source-rtl,1896,,source,1920,,sourcedialog-rtl,1944,,sourcedialog,1968,,specialchar,1992,,table,2016,,templates-rtl,2040,,templates,2064,,uicolor,2088,,redo-rtl,2112,,redo,2136,,undo-rtl,2160,,undo,2184,,simplebox,4416,auto,spellchecker,2232,","icons_hidpi.png"):a("about,0,auto,bold,24,auto,italic,48,auto,strike,72,auto,subscript,96,auto,superscript,120,auto,underline,144,auto,bidiltr,168,auto,bidirtl,192,auto,blockquote,216,auto,copy-rtl,240,auto,copy,264,auto,cut-rtl,288,auto,cut,312,auto,paste-rtl,336,auto,paste,360,auto,codesnippet,384,auto,bgcolor,408,auto,textcolor,432,auto,creatediv,456,auto,docprops-rtl,480,auto,docprops,504,a uto,find-rtl,528,auto,find,552,auto,replace,576,auto,flash,600,auto,button,624,auto,checkbox,648,auto,form,672,auto,hiddenfield,696,auto,imagebutton,720,auto,radio,744,auto,select-rtl,768,auto,select,792,auto,textarea-rtl,816,auto,textarea,840,auto,textfield-rtl,864,auto,textfield,888,auto,horizontalrule,912,auto,iframe,936,auto,image,960,auto,indent-rtl,984,auto,indent,1008,auto,outdent-rtl,1032,auto,outdent,1056,auto,justifyblock,1080,auto,justifycenter,1104,auto,justifyleft,1128,auto,justifyright,1152,auto,language,1176,auto,anchor-rtl,1200,auto,anchor,1224,auto,link,1248,auto,unlink,1272,auto,bulletedlist-rtl,1296,auto,bulletedlist,1320,auto,numberedlist-rtl,1344,auto,numberedlist,1368,auto,mathjax,1392,auto,maximize,1416,auto,newpage-rtl,1440,auto,newpage,1464,auto,pagebreak-rtl,1488,auto,pagebreak,1512,auto,pastefromword-rtl,1536,auto,pastefromword,1560,auto,pastetext-rtl,1584,auto,pastetext,1608,auto,placeholder,1632,auto,preview-rtl,1656,auto,preview,1680,auto,print,1704,auto, removeformat,1728,auto,save,1752,auto,scayt,1776,auto,selectall,1800,auto,showblocks-rtl,1824,auto,showblocks,1848,auto,smiley,1872,auto,source-rtl,1896,auto,source,1920,auto,sourcedialog-rtl,1944,auto,sourcedialog,1968,auto,specialchar,1992,auto,table,2016,auto,templates-rtl,2040,auto,templates,2064,auto,uicolor,2088,auto,redo-rtl,2112,auto,redo,2136,auto,undo-rtl,2160,auto,undo,2184,auto,simplebox,2208,auto,spellchecker,2232,auto","icons.png")}()})();define("ckeditor",function(){});(function(a){CKEDITOR.config.jqueryOverrideVal="undefined"==typeof CKEDITOR.config.jqueryOverrideVal?!0:CKEDITOR.config.jqueryOverrideVal;"undefined"!=typeof a&&(a.extend(a.fn,{ckeditorGet:function(){var a=this.eq(0).data("ckeditorInstance");if(!a)throw"CKEditor is not initialized yet, use ckeditor() with a callback.";return a},ckeditor:function(g,d){if(!CKEDITOR.env.isCompatible)throw Error("The environment is incompatible.");if(!a.isFunction(g))var k=d,d=g,g=k;var i=[],d=d||{};this.each(function(){var b=a(this),c=b.data("ckeditorInstance"),f=b.data("_ckeditorInstanceLock"),h=this,j=new a.Deferred;i.push(j.promise());if(c&&!f)g&&g.apply(c,[this]),j.resolve();else if(f)c.once("instanceReady",function(){setTimeout(function(){c.element?(c.element.$==h&&g&&g.apply(c,[h]),j.resolve()):setTimeout(arguments.callee,100)},0)},null,null,9999);else{if(d.autoUpdateElement||"undefined"==typeof d.autoUpdateElement&&CKEDITOR.config.autoUpdateElement)d.autoUpdateElementJquery=!0;d.autoUpdateElement=!1;b.data("_ckeditorInstanceLock",!0);c=a(this).is("textarea")?CKEDITOR.replace(h,d):CKEDITOR.inline(h,d);b.data("ckeditorInstance",c);c.on("instanceReady",function(d){var e=d.editor;setTimeout(function(){if(e.element){d.removeListener();e.on("dataReady",function(){b.trigger("dataReady.ckeditor",[e])});e.on("setData",function(a){b.trigger("setData.ckeditor",[e,a.data])});e.on("getData",function(a){b.trigger("getData.ckeditor",[e,a.data])},999);e.on("destroy",function(){b.trigger("destroy.ckeditor",[e])});e.on("save",function(){a(h.form).submit();return!1},null,null,20);if(e.config.autoUpdateElementJquery&&b.is("textarea")&&a(h.form).length){var c=function(){b.ckeditor(function(){e.updateElement()})};a(h.form).submit(c);a(h.form).bind("form-pre-serialize",c);b.bind("destroy.ckeditor",function(){a(h.form).unbind("submit",c);a(h.form).unbind("form-pre-serialize",c)})}e.on("destroy",function(){b.removeData("ckeditorInstance")});b.removeData("_ckeditorInstanceLock");b.trigger("instanceReady.ckeditor",[e]);g&&g.apply(e,[h]);j.resolve()}else setTimeout(arguments.callee,100)},0)},null,null,9999)}});var f=new a.Deferred;this.promise=f.promise();a.when.apply(this,i).then(function(){f.resolve()});this.editor=this.eq(0).data("ckeditorInstance");return this}}),CKEDITOR.config.jqueryOverrideVal&&(a.fn.val=CKEDITOR.tools.override(a.fn.val,function(g){return function(d){if(arguments.length){var k=this,i=[],f=this.each(function(){var b=a(this),c=b.data("ckeditorInstance");if(b.is("textarea")&&c){var f=new a.Deferred;c.setData(d,function(){f.resolve()});i.push(f.promise());return!0}return g.call(b,d)});if(i.length){var b=new a.Deferred;a.when.apply(this,i).done(function(){b.resolveWith(k)});return b.promise()}return f}var f=a(this).eq(0),c=f.data("ckeditorInstance");return f.is("textarea")&&c?c.getData():g.call(f)}})))})(window.jQuery);define("jqueryAdapter",function(){});;(function(root,factory){if(typeof define==='function'&&define.amd){define('html.sortable',['jquery'],factory);}else if(typeof exports==='object'){module.exports=factory(require('jquery'));}else{root.sortable=factory(root.jQuery);}}(this,function($){'use strict';var dragging;var draggingHeight;var placeholders=$();var sortables=[];var _removeItemEvents=function(items){items.off('dragstart.h5s');items.off('dragend.h5s');items.off('selectstart.h5s');items.off('dragover.h5s');items.off('dragenter.h5s');items.off('drop.h5s');};var _removeSortableEvents=function(sortable){sortable.off('dragover.h5s');sortable.off('dragenter.h5s');sortable.off('drop.h5s');};var _attachGhost=function(event,ghost){event.dataTransfer.effectAllowed='move';event.dataTransfer.setData('text','');if(event.dataTransfer.setDragImage){event.dataTransfer.setDragImage(ghost.item,ghost.x,ghost.y);}};var _addGhostPos=function(e,ghost){if(!ghost.x){ghost.x=parseInt(e.pageX-ghost.draggedItem.offset().left);}
if(!ghost.y){ghost.y=parseInt(e.pageY-ghost.draggedItem.offset().top);}
return ghost;};var _makeGhost=function($draggedItem){return{item:$draggedItem[0],draggedItem:$draggedItem};};var _getGhost=function(event,$draggedItem){var ghost=_makeGhost($draggedItem);ghost=_addGhostPos(event,ghost);_attachGhost(event,ghost);};var _getOptions=function(soptions,options){if(typeof soptions==='undefined'){return options;}
return soptions;};var _removeSortableData=function(sortable){sortable.removeData('opts');sortable.removeData('connectWith');sortable.removeData('items');sortable.removeAttr('aria-dropeffect');};var _removeItemData=function(items){items.removeAttr('aria-grabbed');items.removeAttr('draggable');items.removeAttr('role');};var _listsConnected=function(curList,destList){if(curList[0]===destList[0]){return true;}
if(curList.data('connectWith')!==undefined){return curList.data('connectWith')===destList.data('connectWith');}
return false;};var _destroySortable=function(sortable){var opts=sortable.data('opts')||{};var items=sortable.children(opts.items);var handles=opts.handle?items.find(opts.handle):items;_removeSortableEvents(sortable);_removeSortableData(sortable);handles.off('mousedown.h5s');_removeItemEvents(items);_removeItemData(items);};var _enableSortable=function(sortable){var opts=sortable.data('opts');var items=sortable.children(opts.items);var handles=opts.handle?items.find(opts.handle):items;sortable.attr('aria-dropeffect','move');handles.attr('draggable','true');var spanEl=(document||window.document).createElement('span');if(typeof spanEl.dragDrop==='function'&&!opts.disableIEFix){handles.on('mousedown.h5s',function(){if(items.index(this)!==-1){this.dragDrop();}else{$(this).parents(opts.items)[0].dragDrop();}});}};var _disableSortable=function(sortable){var opts=sortable.data('opts');var items=sortable.children(opts.items);var handles=opts.handle?items.find(opts.handle):items;sortable.attr('aria-dropeffect','none');handles.attr('draggable',false);handles.off('mousedown.h5s');};var _reloadSortable=function(sortable){var opts=sortable.data('opts');var items=sortable.children(opts.items);var handles=opts.handle?items.find(opts.handle):items;_removeItemEvents(items);handles.off('mousedown.h5s');_removeSortableEvents(sortable);};var sortable=function(selector,options){var $sortables=$(selector);var method=String(options);options=$.extend({connectWith:false,placeholder:null,dragImage:null,disableIEFix:false,placeholderClass:'sortable-placeholder',draggingClass:'sortable-dragging',hoverClass:false},options);return $sortables.each(function(){var $sortable=$(this);if(/enable|disable|destroy/.test(method)){sortable[method]($sortable);return;}
options=_getOptions($sortable.data('opts'),options);$sortable.data('opts',options);_reloadSortable($sortable);var items=$sortable.children(options.items);var index;var startParent;var newParent;var placeholder=(options.placeholder===null)?$('<'+(/^ul|ol$/i.test(this.tagName)?'li':'div')+' class="'+options.placeholderClass+'"/>'):$(options.placeholder).addClass(options.placeholderClass);if(!$sortable.attr('data-sortable-id')){var id=sortables.length;sortables[id]=$sortable;$sortable.attr('data-sortable-id',id);items.attr('data-item-sortable-id',id);}
$sortable.data('items',options.items);placeholders=placeholders.add(placeholder);if(options.connectWith){$sortable.data('connectWith',options.connectWith);}
_enableSortable($sortable);items.attr('role','option');items.attr('aria-grabbed','false');if(options.hoverClass){var hoverClass='sortable-over';if(typeof options.hoverClass==='string'){hoverClass=options.hoverClass;}
items.hover(function(){$(this).addClass(hoverClass);},function(){$(this).removeClass(hoverClass);});}
items.on('dragstart.h5s',function(e){e.stopImmediatePropagation();if(options.dragImage){_attachGhost(e.originalEvent,{item:options.dragImage,x:0,y:0});console.log('WARNING: dragImage option is deprecated'+' and will be removed in the future!');}else{_getGhost(e.originalEvent,$(this),options.dragImage);}
dragging=$(this);dragging.addClass(options.draggingClass);dragging.attr('aria-grabbed','true');index=dragging.index();draggingHeight=dragging.height();startParent=$(this).parent();dragging.parent().triggerHandler('sortstart',{item:dragging,placeholder:placeholder,startparent:startParent});});items.on('dragend.h5s',function(){if(!dragging){return;}
dragging.removeClass(options.draggingClass);dragging.attr('aria-grabbed','false');dragging.show();placeholders.detach();newParent=$(this).parent();dragging.parent().triggerHandler('sortstop',{item:dragging,startparent:startParent,});if(index!==dragging.index()||startParent.get(0)!==newParent.get(0)){dragging.parent().triggerHandler('sortupdate',{item:dragging,index:newParent.children(newParent.data('items')).index(dragging),oldindex:items.index(dragging),elementIndex:dragging.index(),oldElementIndex:index,startparent:startParent,endparent:newParent});}
dragging=null;draggingHeight=null;});$(this).add([placeholder]).on('drop.h5s',function(e){if(!_listsConnected($sortable,$(dragging).parent())){return;}
e.stopPropagation();placeholders.filter(':visible').after(dragging);dragging.trigger('dragend.h5s');return false;});items.add([this]).on('dragover.h5s dragenter.h5s',function(e){if(!_listsConnected($sortable,$(dragging).parent())){return;}
e.preventDefault();e.originalEvent.dataTransfer.dropEffect='move';if(items.is(this)){var thisHeight=$(this).height();if(options.forcePlaceholderSize){placeholder.height(draggingHeight);}
if(thisHeight>draggingHeight){var deadZone=thisHeight-draggingHeight;var offsetTop=$(this).offset().top;if(placeholder.index()<$(this).index()&&e.originalEvent.pageY<offsetTop+deadZone){return false;}
if(placeholder.index()>$(this).index()&&e.originalEvent.pageY>offsetTop+thisHeight-deadZone){return false;}}
dragging.hide();if(placeholder.index()<$(this).index()){$(this).after(placeholder);}else{$(this).before(placeholder);}
placeholders.not(placeholder).detach();}else{if(!placeholders.is(this)&&!$(this).children(options.items).length){placeholders.detach();$(this).append(placeholder);}}
return false;});});};sortable.destroy=function(sortable){_destroySortable(sortable);};sortable.enable=function(sortable){_enableSortable(sortable);};sortable.disable=function(sortable){_disableSortable(sortable);};$.fn.sortable=function(options){return sortable(this,options);};return sortable;}));(function(exportCallback){"use strict";var UriTemplateError=(function(){function UriTemplateError(options){this.options=options;}
UriTemplateError.prototype.toString=function(){if(JSON&&JSON.stringify){return JSON.stringify(this.options);}
else{return this.options;}};return UriTemplateError;}());var objectHelper=(function(){function isArray(value){return Object.prototype.toString.apply(value)==='[object Array]';}
function isString(value){return Object.prototype.toString.apply(value)==='[object String]';}
function isNumber(value){return Object.prototype.toString.apply(value)==='[object Number]';}
function isBoolean(value){return Object.prototype.toString.apply(value)==='[object Boolean]';}
function join(arr,separator){var
result='',first=true,index;for(index=0;index<arr.length;index+=1){if(first){first=false;}
else{result+=separator;}
result+=arr[index];}
return result;}
function map(arr,mapper){var
result=[],index=0;for(;index<arr.length;index+=1){result.push(mapper(arr[index]));}
return result;}
function filter(arr,predicate){var
result=[],index=0;for(;index<arr.length;index+=1){if(predicate(arr[index])){result.push(arr[index]);}}
return result;}
function deepFreezeUsingObjectFreeze(object){if(typeof object!=="object"||object===null){return object;}
Object.freeze(object);var property,propertyName;for(propertyName in object){if(object.hasOwnProperty(propertyName)){property=object[propertyName];if(typeof property==="object"){deepFreeze(property);}}}
return object;}
function deepFreeze(object){if(typeof Object.freeze==='function'){return deepFreezeUsingObjectFreeze(object);}
return object;}
return{isArray:isArray,isString:isString,isNumber:isNumber,isBoolean:isBoolean,join:join,map:map,filter:filter,deepFreeze:deepFreeze};}());var charHelper=(function(){function isAlpha(chr){return(chr>='a'&&chr<='z')||((chr>='A'&&chr<='Z'));}
function isDigit(chr){return chr>='0'&&chr<='9';}
function isHexDigit(chr){return isDigit(chr)||(chr>='a'&&chr<='f')||(chr>='A'&&chr<='F');}
return{isAlpha:isAlpha,isDigit:isDigit,isHexDigit:isHexDigit};}());var pctEncoder=(function(){var utf8={encode:function(chr){return unescape(encodeURIComponent(chr));},numBytes:function(firstCharCode){if(firstCharCode<=0x7F){return 1;}
else if(0xC2<=firstCharCode&&firstCharCode<=0xDF){return 2;}
else if(0xE0<=firstCharCode&&firstCharCode<=0xEF){return 3;}
else if(0xF0<=firstCharCode&&firstCharCode<=0xF4){return 4;}
return 0;},isValidFollowingCharCode:function(charCode){return 0x80<=charCode&&charCode<=0xBF;}};function encodeCharacter(chr){var
result='',octets=utf8.encode(chr),octet,index;for(index=0;index<octets.length;index+=1){octet=octets.charCodeAt(index);result+='%'+(octet<0x10?'0':'')+octet.toString(16).toUpperCase();}
return result;}
function isPercentDigitDigit(text,start){return text.charAt(start)==='%'&&charHelper.isHexDigit(text.charAt(start+1))&&charHelper.isHexDigit(text.charAt(start+2));}
function parseHex2(text,start){return parseInt(text.substr(start,2),16);}
function isPctEncoded(chr){if(!isPercentDigitDigit(chr,0)){return false;}
var firstCharCode=parseHex2(chr,1);var numBytes=utf8.numBytes(firstCharCode);if(numBytes===0){return false;}
for(var byteNumber=1;byteNumber<numBytes;byteNumber+=1){if(!isPercentDigitDigit(chr,3*byteNumber)||!utf8.isValidFollowingCharCode(parseHex2(chr,3*byteNumber+1))){return false;}}
return true;}
function pctCharAt(text,startIndex){var chr=text.charAt(startIndex);if(!isPercentDigitDigit(text,startIndex)){return chr;}
var utf8CharCode=parseHex2(text,startIndex+1);var numBytes=utf8.numBytes(utf8CharCode);if(numBytes===0){return chr;}
for(var byteNumber=1;byteNumber<numBytes;byteNumber+=1){if(!isPercentDigitDigit(text,startIndex+3*byteNumber)||!utf8.isValidFollowingCharCode(parseHex2(text,startIndex+3*byteNumber+1))){return chr;}}
return text.substr(startIndex,3*numBytes);}
return{encodeCharacter:encodeCharacter,isPctEncoded:isPctEncoded,pctCharAt:pctCharAt};}());var rfcCharHelper=(function(){function isVarchar(chr){return charHelper.isAlpha(chr)||charHelper.isDigit(chr)||chr==='_'||pctEncoder.isPctEncoded(chr);}
function isUnreserved(chr){return charHelper.isAlpha(chr)||charHelper.isDigit(chr)||chr==='-'||chr==='.'||chr==='_'||chr==='~';}
function isReserved(chr){return chr===':'||chr==='/'||chr==='?'||chr==='#'||chr==='['||chr===']'||chr==='@'||chr==='!'||chr==='$'||chr==='&'||chr==='('||chr===')'||chr==='*'||chr==='+'||chr===','||chr===';'||chr==='='||chr==="'";}
return{isVarchar:isVarchar,isUnreserved:isUnreserved,isReserved:isReserved};}());var encodingHelper=(function(){function encode(text,passReserved){var
result='',index,chr='';if(typeof text==="number"||typeof text==="boolean"){text=text.toString();}
for(index=0;index<text.length;index+=chr.length){chr=text.charAt(index);result+=rfcCharHelper.isUnreserved(chr)||(passReserved&&rfcCharHelper.isReserved(chr))?chr:pctEncoder.encodeCharacter(chr);}
return result;}
function encodePassReserved(text){return encode(text,true);}
function encodeLiteralCharacter(literal,index){var chr=pctEncoder.pctCharAt(literal,index);if(chr.length>1){return chr;}
else{return rfcCharHelper.isReserved(chr)||rfcCharHelper.isUnreserved(chr)?chr:pctEncoder.encodeCharacter(chr);}}
function encodeLiteral(literal){var
result='',index,chr='';for(index=0;index<literal.length;index+=chr.length){chr=pctEncoder.pctCharAt(literal,index);if(chr.length>1){result+=chr;}
else{result+=rfcCharHelper.isReserved(chr)||rfcCharHelper.isUnreserved(chr)?chr:pctEncoder.encodeCharacter(chr);}}
return result;}
return{encode:encode,encodePassReserved:encodePassReserved,encodeLiteral:encodeLiteral,encodeLiteralCharacter:encodeLiteralCharacter};}());var operators=(function(){var
bySymbol={};function create(symbol){bySymbol[symbol]={symbol:symbol,separator:(symbol==='?')?'&':(symbol===''||symbol==='+'||symbol==='#')?',':symbol,named:symbol===';'||symbol==='&'||symbol==='?',ifEmpty:(symbol==='&'||symbol==='?')?'=':'',first:(symbol==='+')?'':symbol,encode:(symbol==='+'||symbol==='#')?encodingHelper.encodePassReserved:encodingHelper.encode,toString:function(){return this.symbol;}};}
create('');create('+');create('#');create('.');create('/');create(';');create('?');create('&');return{valueOf:function(chr){if(bySymbol[chr]){return bySymbol[chr];}
if("=,!@|".indexOf(chr)>=0){return null;}
return bySymbol[''];}};}());function isDefined(object){var
propertyName;if(object===null||object===undefined){return false;}
if(objectHelper.isArray(object)){return object.length>0;}
if(typeof object==="string"||typeof object==="number"||typeof object==="boolean"){return true;}
for(propertyName in object){if(object.hasOwnProperty(propertyName)&&isDefined(object[propertyName])){return true;}}
return false;}
var LiteralExpression=(function(){function LiteralExpression(literal){this.literal=encodingHelper.encodeLiteral(literal);}
LiteralExpression.prototype.expand=function(){return this.literal;};LiteralExpression.prototype.toString=LiteralExpression.prototype.expand;return LiteralExpression;}());var parse=(function(){function parseExpression(expressionText){var
operator,varspecs=[],varspec=null,varnameStart=null,maxLengthStart=null,index,chr='';function closeVarname(){var varname=expressionText.substring(varnameStart,index);if(varname.length===0){throw new UriTemplateError({expressionText:expressionText,message:"a varname must be specified",position:index});}
varspec={varname:varname,exploded:false,maxLength:null};varnameStart=null;}
function closeMaxLength(){if(maxLengthStart===index){throw new UriTemplateError({expressionText:expressionText,message:"after a ':' you have to specify the length",position:index});}
varspec.maxLength=parseInt(expressionText.substring(maxLengthStart,index),10);maxLengthStart=null;}
operator=(function(operatorText){var op=operators.valueOf(operatorText);if(op===null){throw new UriTemplateError({expressionText:expressionText,message:"illegal use of reserved operator",position:index,operator:operatorText});}
return op;}(expressionText.charAt(0)));index=operator.symbol.length;varnameStart=index;for(;index<expressionText.length;index+=chr.length){chr=pctEncoder.pctCharAt(expressionText,index);if(varnameStart!==null){if(chr==='.'){if(varnameStart===index){throw new UriTemplateError({expressionText:expressionText,message:"a varname MUST NOT start with a dot",position:index});}
continue;}
if(rfcCharHelper.isVarchar(chr)){continue;}
closeVarname();}
if(maxLengthStart!==null){if(index===maxLengthStart&&chr==='0'){throw new UriTemplateError({expressionText:expressionText,message:"A :prefix must not start with digit 0",position:index});}
if(charHelper.isDigit(chr)){if(index-maxLengthStart>=4){throw new UriTemplateError({expressionText:expressionText,message:"A :prefix must have max 4 digits",position:index});}
continue;}
closeMaxLength();}
if(chr===':'){if(varspec.maxLength!==null){throw new UriTemplateError({expressionText:expressionText,message:"only one :maxLength is allowed per varspec",position:index});}
if(varspec.exploded){throw new UriTemplateError({expressionText:expressionText,message:"an exploeded varspec MUST NOT be varspeced",position:index});}
maxLengthStart=index+1;continue;}
if(chr==='*'){if(varspec===null){throw new UriTemplateError({expressionText:expressionText,message:"exploded without varspec",position:index});}
if(varspec.exploded){throw new UriTemplateError({expressionText:expressionText,message:"exploded twice",position:index});}
if(varspec.maxLength){throw new UriTemplateError({expressionText:expressionText,message:"an explode (*) MUST NOT follow to a prefix",position:index});}
varspec.exploded=true;continue;}
if(chr===','){varspecs.push(varspec);varspec=null;varnameStart=index+1;continue;}
throw new UriTemplateError({expressionText:expressionText,message:"illegal character",character:chr,position:index});}
if(varnameStart!==null){closeVarname();}
if(maxLengthStart!==null){closeMaxLength();}
varspecs.push(varspec);return new VariableExpression(expressionText,operator,varspecs);}
function parse(uriTemplateText){var
index,chr,expressions=[],braceOpenIndex=null,literalStart=0;for(index=0;index<uriTemplateText.length;index+=1){chr=uriTemplateText.charAt(index);if(literalStart!==null){if(chr==='}'){throw new UriTemplateError({templateText:uriTemplateText,message:"unopened brace closed",position:index});}
if(chr==='{'){if(literalStart<index){expressions.push(new LiteralExpression(uriTemplateText.substring(literalStart,index)));}
literalStart=null;braceOpenIndex=index;}
continue;}
if(braceOpenIndex!==null){if(chr==='{'){throw new UriTemplateError({templateText:uriTemplateText,message:"brace already opened",position:index});}
if(chr==='}'){if(braceOpenIndex+1===index){throw new UriTemplateError({templateText:uriTemplateText,message:"empty braces",position:braceOpenIndex});}
try{expressions.push(parseExpression(uriTemplateText.substring(braceOpenIndex+1,index)));}
catch(error){if(error.prototype===UriTemplateError.prototype){throw new UriTemplateError({templateText:uriTemplateText,message:error.options.message,position:braceOpenIndex+error.options.position,details:error.options});}
throw error;}
braceOpenIndex=null;literalStart=index+1;}
continue;}
throw new Error('reached unreachable code');}
if(braceOpenIndex!==null){throw new UriTemplateError({templateText:uriTemplateText,message:"unclosed brace",position:braceOpenIndex});}
if(literalStart<uriTemplateText.length){expressions.push(new LiteralExpression(uriTemplateText.substr(literalStart)));}
return new UriTemplate(uriTemplateText,expressions);}
return parse;}());var VariableExpression=(function(){function prettyPrint(value){return(JSON&&JSON.stringify)?JSON.stringify(value):value;}
function isEmpty(value){if(!isDefined(value)){return true;}
if(objectHelper.isString(value)){return value==='';}
if(objectHelper.isNumber(value)||objectHelper.isBoolean(value)){return false;}
if(objectHelper.isArray(value)){return value.length===0;}
for(var propertyName in value){if(value.hasOwnProperty(propertyName)){return false;}}
return true;}
function propertyArray(object){var
result=[],propertyName;for(propertyName in object){if(object.hasOwnProperty(propertyName)){result.push({name:propertyName,value:object[propertyName]});}}
return result;}
function VariableExpression(templateText,operator,varspecs){this.templateText=templateText;this.operator=operator;this.varspecs=varspecs;}
VariableExpression.prototype.toString=function(){return this.templateText;};function expandSimpleValue(varspec,operator,value){var result='';value=value.toString();if(operator.named){result+=encodingHelper.encodeLiteral(varspec.varname);if(value===''){result+=operator.ifEmpty;return result;}
result+='=';}
if(varspec.maxLength!==null){value=value.substr(0,varspec.maxLength);}
result+=operator.encode(value);return result;}
function valueDefined(nameValue){return isDefined(nameValue.value);}
function expandNotExploded(varspec,operator,value){var
arr=[],result='';if(operator.named){result+=encodingHelper.encodeLiteral(varspec.varname);if(isEmpty(value)){result+=operator.ifEmpty;return result;}
result+='=';}
if(objectHelper.isArray(value)){arr=value;arr=objectHelper.filter(arr,isDefined);arr=objectHelper.map(arr,operator.encode);result+=objectHelper.join(arr,',');}
else{arr=propertyArray(value);arr=objectHelper.filter(arr,valueDefined);arr=objectHelper.map(arr,function(nameValue){return operator.encode(nameValue.name)+','+operator.encode(nameValue.value);});result+=objectHelper.join(arr,',');}
return result;}
function expandExplodedNamed(varspec,operator,value){var
isArray=objectHelper.isArray(value),arr=[];if(isArray){arr=value;arr=objectHelper.filter(arr,isDefined);arr=objectHelper.map(arr,function(listElement){var tmp=encodingHelper.encodeLiteral(varspec.varname);if(isEmpty(listElement)){tmp+=operator.ifEmpty;}
else{tmp+='='+operator.encode(listElement);}
return tmp;});}
else{arr=propertyArray(value);arr=objectHelper.filter(arr,valueDefined);arr=objectHelper.map(arr,function(nameValue){var tmp=encodingHelper.encodeLiteral(nameValue.name);if(isEmpty(nameValue.value)){tmp+=operator.ifEmpty;}
else{tmp+='='+operator.encode(nameValue.value);}
return tmp;});}
return objectHelper.join(arr,operator.separator);}
function expandExplodedUnnamed(operator,value){var
arr=[],result='';if(objectHelper.isArray(value)){arr=value;arr=objectHelper.filter(arr,isDefined);arr=objectHelper.map(arr,operator.encode);result+=objectHelper.join(arr,operator.separator);}
else{arr=propertyArray(value);arr=objectHelper.filter(arr,function(nameValue){return isDefined(nameValue.value);});arr=objectHelper.map(arr,function(nameValue){return operator.encode(nameValue.name)+'='+operator.encode(nameValue.value);});result+=objectHelper.join(arr,operator.separator);}
return result;}
VariableExpression.prototype.expand=function(variables){var
expanded=[],index,varspec,value,valueIsArr,oneExploded=false,operator=this.operator;for(index=0;index<this.varspecs.length;index+=1){varspec=this.varspecs[index];value=variables[varspec.varname];if(value===null||value===undefined){continue;}
if(varspec.exploded){oneExploded=true;}
valueIsArr=objectHelper.isArray(value);if(typeof value==="string"||typeof value==="number"||typeof value==="boolean"){expanded.push(expandSimpleValue(varspec,operator,value));}
else if(varspec.maxLength&&isDefined(value)){throw new Error('Prefix modifiers are not applicable to variables that have composite values. You tried to expand '+this+" with "+prettyPrint(value));}
else if(!varspec.exploded){if(operator.named||!isEmpty(value)){expanded.push(expandNotExploded(varspec,operator,value));}}
else if(isDefined(value)){if(operator.named){expanded.push(expandExplodedNamed(varspec,operator,value));}
else{expanded.push(expandExplodedUnnamed(operator,value));}}}
if(expanded.length===0){return"";}
else{return operator.first+objectHelper.join(expanded,operator.separator);}};return VariableExpression;}());var UriTemplate=(function(){function UriTemplate(templateText,expressions){this.templateText=templateText;this.expressions=expressions;objectHelper.deepFreeze(this);}
UriTemplate.prototype.toString=function(){return this.templateText;};UriTemplate.prototype.expand=function(variables){var
index,result='';for(index=0;index<this.expressions.length;index+=1){result+=this.expressions[index].expand(variables);}
return result;};UriTemplate.parse=parse;UriTemplate.UriTemplateError=UriTemplateError;return UriTemplate;}());exportCallback(UriTemplate);}(function(UriTemplate){"use strict";if(typeof module!=="undefined"){module.exports=UriTemplate;}
else if(typeof define==="function"){define('uri-template',[],function(){return UriTemplate;});}
else if(typeof window!=="undefined"){window.UriTemplate=UriTemplate;}
else{global.UriTemplate=UriTemplate;}}));(function($){var _=function(){"use strict";return{isMsie:function(){return /(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:false;},isBlankString:function(str){return!str||/^\s*$/.test(str);},escapeRegExChars:function(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");},isString:function(obj){return typeof obj==="string";},isNumber:function(obj){return typeof obj==="number";},isArray:$.isArray,isFunction:$.isFunction,isObject:$.isPlainObject,isUndefined:function(obj){return typeof obj==="undefined";},toStr:function toStr(s){return _.isUndefined(s)||s===null?"":s+"";},bind:$.proxy,each:function(collection,cb){$.each(collection,reverseArgs);function reverseArgs(index,value){return cb(value,index);}},map:$.map,filter:$.grep,every:function(obj,test){var result=true;if(!obj){return result;}
$.each(obj,function(key,val){if(!(result=test.call(null,val,key,obj))){return false;}});return!!result;},some:function(obj,test){var result=false;if(!obj){return result;}
$.each(obj,function(key,val){if(result=test.call(null,val,key,obj)){return false;}});return!!result;},mixin:$.extend,getUniqueId:function(){var counter=0;return function(){return counter++;};}(),templatify:function templatify(obj){return $.isFunction(obj)?obj:template;function template(){return String(obj);}},defer:function(fn){setTimeout(fn,0);},debounce:function(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments,later,callNow;later=function(){timeout=null;if(!immediate){result=func.apply(context,args);}};callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow){result=func.apply(context,args);}
return result;};},throttle:function(func,wait){var context,args,timeout,result,previous,later;previous=0;later=function(){previous=new Date();timeout=null;result=func.apply(context,args);};return function(){var now=new Date(),remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args);}else if(!timeout){timeout=setTimeout(later,remaining);}
return result;};},noop:function(){}};}();var VERSION="0.10.5";var tokenizers=function(){"use strict";return{nonword:nonword,whitespace:whitespace,obj:{nonword:getObjTokenizer(nonword),whitespace:getObjTokenizer(whitespace)}};function whitespace(str){str=_.toStr(str);return str?str.split(/\s+/):[];}
function nonword(str){str=_.toStr(str);return str?str.split(/\W+/):[];}
function getObjTokenizer(tokenizer){return function setKey(){var args=[].slice.call(arguments,0);return function tokenize(o){var tokens=[];_.each(args,function(k){tokens=tokens.concat(tokenizer(_.toStr(o[k])));});return tokens;};};}}();var LruCache=function(){"use strict";function LruCache(maxSize){this.maxSize=_.isNumber(maxSize)?maxSize:100;this.reset();if(this.maxSize<=0){this.set=this.get=$.noop;}}
_.mixin(LruCache.prototype,{set:function set(key,val){var tailItem=this.list.tail,node;if(this.size>=this.maxSize){this.list.remove(tailItem);delete this.hash[tailItem.key];}
if(node=this.hash[key]){node.val=val;this.list.moveToFront(node);}else{node=new Node(key,val);this.list.add(node);this.hash[key]=node;this.size++;}},get:function get(key){var node=this.hash[key];if(node){this.list.moveToFront(node);return node.val;}},reset:function reset(){this.size=0;this.hash={};this.list=new List();}});function List(){this.head=this.tail=null;}
_.mixin(List.prototype,{add:function add(node){if(this.head){node.next=this.head;this.head.prev=node;}
this.head=node;this.tail=this.tail||node;},remove:function remove(node){node.prev?node.prev.next=node.next:this.head=node.next;node.next?node.next.prev=node.prev:this.tail=node.prev;},moveToFront:function(node){this.remove(node);this.add(node);}});function Node(key,val){this.key=key;this.val=val;this.prev=this.next=null;}
return LruCache;}();var PersistentStorage=function(){"use strict";var ls,methods;try{ls=window.localStorage;ls.setItem("~~~","!");ls.removeItem("~~~");}catch(err){ls=null;}
function PersistentStorage(namespace){this.prefix=["__",namespace,"__"].join("");this.ttlKey="__ttl__";this.keyMatcher=new RegExp("^"+_.escapeRegExChars(this.prefix));}
if(ls&&window.JSON){methods={_prefix:function(key){return this.prefix+key;},_ttlKey:function(key){return this._prefix(key)+this.ttlKey;},get:function(key){if(this.isExpired(key)){this.remove(key);}
return decode(ls.getItem(this._prefix(key)));},set:function(key,val,ttl){if(_.isNumber(ttl)){ls.setItem(this._ttlKey(key),encode(now()+ttl));}else{ls.removeItem(this._ttlKey(key));}
return ls.setItem(this._prefix(key),encode(val));},remove:function(key){ls.removeItem(this._ttlKey(key));ls.removeItem(this._prefix(key));return this;},clear:function(){var i,key,keys=[],len=ls.length;for(i=0;i<len;i++){if((key=ls.key(i)).match(this.keyMatcher)){keys.push(key.replace(this.keyMatcher,""));}}
for(i=keys.length;i--;){this.remove(keys[i]);}
return this;},isExpired:function(key){var ttl=decode(ls.getItem(this._ttlKey(key)));return _.isNumber(ttl)&&now()>ttl?true:false;}};}else{methods={get:_.noop,set:_.noop,remove:_.noop,clear:_.noop,isExpired:_.noop};}
_.mixin(PersistentStorage.prototype,methods);return PersistentStorage;function now(){return new Date().getTime();}
function encode(val){return JSON.stringify(_.isUndefined(val)?null:val);}
function decode(val){return JSON.parse(val);}}();var Transport=function(){"use strict";var pendingRequestsCount=0,pendingRequests={},maxPendingRequests=6,sharedCache=new LruCache(10);function Transport(o){o=o||{};this.cancelled=false;this.lastUrl=null;this._send=o.transport?callbackToDeferred(o.transport):$.ajax;this._get=o.rateLimiter?o.rateLimiter(this._get):this._get;this._cache=o.cache===false?new LruCache(0):sharedCache;}
Transport.setMaxPendingRequests=function setMaxPendingRequests(num){maxPendingRequests=num;};Transport.resetCache=function resetCache(){sharedCache.reset();};_.mixin(Transport.prototype,{_get:function(url,o,cb){var that=this,jqXhr;if(this.cancelled||url!==this.lastUrl){return;}
if(jqXhr=pendingRequests[url]){jqXhr.done(done).fail(fail);}else if(pendingRequestsCount<maxPendingRequests){pendingRequestsCount++;pendingRequests[url]=this._send(url,o).done(done).fail(fail).always(always);}else{this.onDeckRequestArgs=[].slice.call(arguments,0);}
function done(resp){cb&&cb(null,resp);that._cache.set(url,resp);}
function fail(){cb&&cb(true);}
function always(){pendingRequestsCount--;delete pendingRequests[url];if(that.onDeckRequestArgs){that._get.apply(that,that.onDeckRequestArgs);that.onDeckRequestArgs=null;}}},get:function(url,o,cb){var resp;if(_.isFunction(o)){cb=o;o={};}
this.cancelled=false;this.lastUrl=url;if(resp=this._cache.get(url)){_.defer(function(){cb&&cb(null,resp);});}else{this._get(url,o,cb);}
return!!resp;},cancel:function(){this.cancelled=true;}});return Transport;function callbackToDeferred(fn){return function customSendWrapper(url,o){var deferred=$.Deferred();fn(url,o,onSuccess,onError);return deferred;function onSuccess(resp){_.defer(function(){deferred.resolve(resp);});}
function onError(err){_.defer(function(){deferred.reject(err);});}};}}();var SearchIndex=function(){"use strict";function SearchIndex(o){o=o||{};if(!o.datumTokenizer||!o.queryTokenizer){$.error("datumTokenizer and queryTokenizer are both required");}
this.datumTokenizer=o.datumTokenizer;this.queryTokenizer=o.queryTokenizer;this.reset();}
_.mixin(SearchIndex.prototype,{bootstrap:function bootstrap(o){this.datums=o.datums;this.trie=o.trie;},add:function(data){var that=this;data=_.isArray(data)?data:[data];_.each(data,function(datum){var id,tokens;id=that.datums.push(datum)-1;tokens=normalizeTokens(that.datumTokenizer(datum));_.each(tokens,function(token){var node,chars,ch;node=that.trie;chars=token.split("");while(ch=chars.shift()){node=node.children[ch]||(node.children[ch]=newNode());node.ids.push(id);}});});},get:function get(query){var that=this,tokens,matches;tokens=normalizeTokens(this.queryTokenizer(query));_.each(tokens,function(token){var node,chars,ch,ids;if(matches&&matches.length===0){return false;}
node=that.trie;chars=token.split("");while(node&&(ch=chars.shift())){node=node.children[ch];}
if(node&&chars.length===0){ids=node.ids.slice(0);matches=matches?getIntersection(matches,ids):ids;}else{matches=[];return false;}});return matches?_.map(unique(matches),function(id){return that.datums[id];}):[];},reset:function reset(){this.datums=[];this.trie=newNode();},serialize:function serialize(){return{datums:this.datums,trie:this.trie};}});return SearchIndex;function normalizeTokens(tokens){tokens=_.filter(tokens,function(token){return!!token;});tokens=_.map(tokens,function(token){return token.toLowerCase();});return tokens;}
function newNode(){return{ids:[],children:{}};}
function unique(array){var seen={},uniques=[];for(var i=0,len=array.length;i<len;i++){if(!seen[array[i]]){seen[array[i]]=true;uniques.push(array[i]);}}
return uniques;}
function getIntersection(arrayA,arrayB){var ai=0,bi=0,intersection=[];arrayA=arrayA.sort(compare);arrayB=arrayB.sort(compare);var lenArrayA=arrayA.length,lenArrayB=arrayB.length;while(ai<lenArrayA&&bi<lenArrayB){if(arrayA[ai]<arrayB[bi]){ai++;}else if(arrayA[ai]>arrayB[bi]){bi++;}else{intersection.push(arrayA[ai]);ai++;bi++;}}
return intersection;function compare(a,b){return a-b;}}}();var oParser=function(){"use strict";return{local:getLocal,prefetch:getPrefetch,remote:getRemote};function getLocal(o){return o.local||null;}
function getPrefetch(o){var prefetch,defaults;defaults={url:null,thumbprint:"",ttl:24*60*60*1e3,filter:null,ajax:{}};if(prefetch=o.prefetch||null){prefetch=_.isString(prefetch)?{url:prefetch}:prefetch;prefetch=_.mixin(defaults,prefetch);prefetch.thumbprint=VERSION+prefetch.thumbprint;prefetch.ajax.type=prefetch.ajax.type||"GET";prefetch.ajax.dataType=prefetch.ajax.dataType||"json";!prefetch.url&&$.error("prefetch requires url to be set");}
return prefetch;}
function getRemote(o){var remote,defaults;defaults={url:null,cache:true,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}};if(remote=o.remote||null){remote=_.isString(remote)?{url:remote}:remote;remote=_.mixin(defaults,remote);remote.rateLimiter=/^throttle$/i.test(remote.rateLimitBy)?byThrottle(remote.rateLimitWait):byDebounce(remote.rateLimitWait);remote.ajax.type=remote.ajax.type||"GET";remote.ajax.dataType=remote.ajax.dataType||"json";delete remote.rateLimitBy;delete remote.rateLimitWait;!remote.url&&$.error("remote requires url to be set");}
return remote;function byDebounce(wait){return function(fn){return _.debounce(fn,wait);};}
function byThrottle(wait){return function(fn){return _.throttle(fn,wait);};}}}();(function(root){"use strict";var old,keys;old=root.Bloodhound;keys={data:"data",protocol:"protocol",thumbprint:"thumbprint"};root.Bloodhound=Bloodhound;function Bloodhound(o){if(!o||!o.local&&!o.prefetch&&!o.remote){$.error("one of local, prefetch, or remote is required");}
this.limit=o.limit||5;this.sorter=getSorter(o.sorter);this.dupDetector=o.dupDetector||ignoreDuplicates;this.local=oParser.local(o);this.prefetch=oParser.prefetch(o);this.remote=oParser.remote(o);this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null;this.index=new SearchIndex({datumTokenizer:o.datumTokenizer,queryTokenizer:o.queryTokenizer});this.storage=this.cacheKey?new PersistentStorage(this.cacheKey):null;}
Bloodhound.noConflict=function noConflict(){root.Bloodhound=old;return Bloodhound;};Bloodhound.tokenizers=tokenizers;_.mixin(Bloodhound.prototype,{_loadPrefetch:function loadPrefetch(o){var that=this,serialized,deferred;if(serialized=this._readFromStorage(o.thumbprint)){this.index.bootstrap(serialized);deferred=$.Deferred().resolve();}else{deferred=$.ajax(o.url,o.ajax).done(handlePrefetchResponse);}
return deferred;function handlePrefetchResponse(resp){that.clear();that.add(o.filter?o.filter(resp):resp);that._saveToStorage(that.index.serialize(),o.thumbprint,o.ttl);}},_getFromRemote:function getFromRemote(query,cb){var that=this,url,uriEncodedQuery;if(!this.transport){return;}
query=query||"";uriEncodedQuery=encodeURIComponent(query);url=this.remote.replace?this.remote.replace(this.remote.url,query):this.remote.url.replace(this.remote.wildcard,uriEncodedQuery);return this.transport.get(url,this.remote.ajax,handleRemoteResponse);function handleRemoteResponse(err,resp){err?cb([]):cb(that.remote.filter?that.remote.filter(resp):resp);}},_cancelLastRemoteRequest:function cancelLastRemoteRequest(){this.transport&&this.transport.cancel();},_saveToStorage:function saveToStorage(data,thumbprint,ttl){if(this.storage){this.storage.set(keys.data,data,ttl);this.storage.set(keys.protocol,location.protocol,ttl);this.storage.set(keys.thumbprint,thumbprint,ttl);}},_readFromStorage:function readFromStorage(thumbprint){var stored={},isExpired;if(this.storage){stored.data=this.storage.get(keys.data);stored.protocol=this.storage.get(keys.protocol);stored.thumbprint=this.storage.get(keys.thumbprint);}
isExpired=stored.thumbprint!==thumbprint||stored.protocol!==location.protocol;return stored.data&&!isExpired?stored.data:null;},_initialize:function initialize(){var that=this,local=this.local,deferred;deferred=this.prefetch?this._loadPrefetch(this.prefetch):$.Deferred().resolve();local&&deferred.done(addLocalToIndex);this.transport=this.remote?new Transport(this.remote):null;return this.initPromise=deferred.promise();function addLocalToIndex(){that.add(_.isFunction(local)?local():local);}},initialize:function initialize(force){return!this.initPromise||force?this._initialize():this.initPromise;},add:function add(data){this.index.add(data);},get:function get(query,cb){var that=this,matches=[],cacheHit=false;matches=this.index.get(query);matches=this.sorter(matches).slice(0,this.limit);matches.length<this.limit?cacheHit=this._getFromRemote(query,returnRemoteMatches):this._cancelLastRemoteRequest();if(!cacheHit){(matches.length>0||!this.transport)&&cb&&cb(matches);}
function returnRemoteMatches(remoteMatches){var matchesWithBackfill=matches.slice(0);_.each(remoteMatches,function(remoteMatch){var isDuplicate;isDuplicate=_.some(matchesWithBackfill,function(match){return that.dupDetector(remoteMatch,match);});!isDuplicate&&matchesWithBackfill.push(remoteMatch);return matchesWithBackfill.length<that.limit;});cb&&cb(that.sorter(matchesWithBackfill));}},clear:function clear(){this.index.reset();},clearPrefetchCache:function clearPrefetchCache(){this.storage&&this.storage.clear();},clearRemoteCache:function clearRemoteCache(){this.transport&&Transport.resetCache();},ttAdapter:function ttAdapter(){return _.bind(this.get,this);}});return Bloodhound;function getSorter(sortFn){return _.isFunction(sortFn)?sort:noSort;function sort(array){return array.sort(sortFn);}
function noSort(array){return array;}}
function ignoreDuplicates(){return false;}})(this);var html=function(){return{wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'};}();var css=function(){"use strict";var css={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};if(_.isMsie()){_.mixin(css.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"});}
if(_.isMsie()&&_.isMsie()<=7){_.mixin(css.input,{marginTop:"-1px"});}
return css;}();var EventBus=function(){"use strict";var namespace="typeahead:";function EventBus(o){if(!o||!o.el){$.error("EventBus initialized without el");}
this.$el=$(o.el);}
_.mixin(EventBus.prototype,{trigger:function(type){var args=[].slice.call(arguments,1);this.$el.trigger(namespace+type,args);}});return EventBus;}();var EventEmitter=function(){"use strict";var splitter=/\s+/,nextTick=getNextTick();return{onSync:onSync,onAsync:onAsync,off:off,trigger:trigger};function on(method,types,cb,context){var type;if(!cb){return this;}
types=types.split(splitter);cb=context?bindContext(cb,context):cb;this._callbacks=this._callbacks||{};while(type=types.shift()){this._callbacks[type]=this._callbacks[type]||{sync:[],async:[]};this._callbacks[type][method].push(cb);}
return this;}
function onAsync(types,cb,context){return on.call(this,"async",types,cb,context);}
function onSync(types,cb,context){return on.call(this,"sync",types,cb,context);}
function off(types){var type;if(!this._callbacks){return this;}
types=types.split(splitter);while(type=types.shift()){delete this._callbacks[type];}
return this;}
function trigger(types){var type,callbacks,args,syncFlush,asyncFlush;if(!this._callbacks){return this;}
types=types.split(splitter);args=[].slice.call(arguments,1);while((type=types.shift())&&(callbacks=this._callbacks[type])){syncFlush=getFlush(callbacks.sync,this,[type].concat(args));asyncFlush=getFlush(callbacks.async,this,[type].concat(args));syncFlush()&&nextTick(asyncFlush);}
return this;}
function getFlush(callbacks,context,args){return flush;function flush(){var cancelled;for(var i=0,len=callbacks.length;!cancelled&&i<len;i+=1){cancelled=callbacks[i].apply(context,args)===false;}
return!cancelled;}}
function getNextTick(){var nextTickFn;if(window.setImmediate){nextTickFn=function nextTickSetImmediate(fn){setImmediate(function(){fn();});};}else{nextTickFn=function nextTickSetTimeout(fn){setTimeout(function(){fn();},0);};}
return nextTickFn;}
function bindContext(fn,context){return fn.bind?fn.bind(context):function(){fn.apply(context,[].slice.call(arguments,0));};}}();var highlight=function(doc){"use strict";var defaults={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:false,caseSensitive:false};return function hightlight(o){var regex;o=_.mixin({},defaults,o);if(!o.node||!o.pattern){return;}
o.pattern=_.isArray(o.pattern)?o.pattern:[o.pattern];regex=getRegex(o.pattern,o.caseSensitive,o.wordsOnly);traverse(o.node,hightlightTextNode);function hightlightTextNode(textNode){var match,patternNode,wrapperNode;if(match=regex.exec(textNode.data)){wrapperNode=doc.createElement(o.tagName);o.className&&(wrapperNode.className=o.className);patternNode=textNode.splitText(match.index);patternNode.splitText(match[0].length);wrapperNode.appendChild(patternNode.cloneNode(true));textNode.parentNode.replaceChild(wrapperNode,patternNode);}
return!!match;}
function traverse(el,hightlightTextNode){var childNode,TEXT_NODE_TYPE=3;for(var i=0;i<el.childNodes.length;i++){childNode=el.childNodes[i];if(childNode.nodeType===TEXT_NODE_TYPE){i+=hightlightTextNode(childNode)?1:0;}else{traverse(childNode,hightlightTextNode);}}}};function getRegex(patterns,caseSensitive,wordsOnly){var escapedPatterns=[],regexStr;for(var i=0,len=patterns.length;i<len;i++){escapedPatterns.push(_.escapeRegExChars(patterns[i]));}
regexStr=wordsOnly?"\\b("+escapedPatterns.join("|")+")\\b":"("+escapedPatterns.join("|")+")";return caseSensitive?new RegExp(regexStr):new RegExp(regexStr,"i");}}(window.document);var Input=function(){"use strict";var specialKeyCodeMap;specialKeyCodeMap={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};function Input(o){var that=this,onBlur,onFocus,onKeydown,onInput;o=o||{};if(!o.input){$.error("input is missing");}
onBlur=_.bind(this._onBlur,this);onFocus=_.bind(this._onFocus,this);onKeydown=_.bind(this._onKeydown,this);onInput=_.bind(this._onInput,this);this.$hint=$(o.hint);this.$input=$(o.input).on("blur.tt",onBlur).on("focus.tt",onFocus).on("keydown.tt",onKeydown);if(this.$hint.length===0){this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=_.noop;}
if(!_.isMsie()){this.$input.on("input.tt",onInput);}else{this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function($e){if(specialKeyCodeMap[$e.which||$e.keyCode]){return;}
_.defer(_.bind(that._onInput,that,$e));});}
this.query=this.$input.val();this.$overflowHelper=buildOverflowHelper(this.$input);}
Input.normalizeQuery=function(str){return(str||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ");};_.mixin(Input.prototype,EventEmitter,{_onBlur:function onBlur(){this.resetInputValue();this.trigger("blurred");},_onFocus:function onFocus(){this.trigger("focused");},_onKeydown:function onKeydown($e){var keyName=specialKeyCodeMap[$e.which||$e.keyCode];this._managePreventDefault(keyName,$e);if(keyName&&this._shouldTrigger(keyName,$e)){this.trigger(keyName+"Keyed",$e);}},_onInput:function onInput(){this._checkInputValue();},_managePreventDefault:function managePreventDefault(keyName,$e){var preventDefault,hintValue,inputValue;switch(keyName){case"tab":hintValue=this.getHint();inputValue=this.getInputValue();preventDefault=hintValue&&hintValue!==inputValue&&!withModifier($e);break;case"up":case"down":preventDefault=!withModifier($e);break;default:preventDefault=false;}
preventDefault&&$e.preventDefault();},_shouldTrigger:function shouldTrigger(keyName,$e){var trigger;switch(keyName){case"tab":trigger=!withModifier($e);break;default:trigger=true;}
return trigger;},_checkInputValue:function checkInputValue(){var inputValue,areEquivalent,hasDifferentWhitespace;inputValue=this.getInputValue();areEquivalent=areQueriesEquivalent(inputValue,this.query);hasDifferentWhitespace=areEquivalent?this.query.length!==inputValue.length:false;this.query=inputValue;if(!areEquivalent){this.trigger("queryChanged",this.query);}else if(hasDifferentWhitespace){this.trigger("whitespaceChanged",this.query);}},focus:function focus(){this.$input.focus();},blur:function blur(){this.$input.blur();},getQuery:function getQuery(){return this.query;},setQuery:function setQuery(query){this.query=query;},getInputValue:function getInputValue(){return this.$input.val();},setInputValue:function setInputValue(value,silent){this.$input.val(value);silent?this.clearHint():this._checkInputValue();},resetInputValue:function resetInputValue(){this.setInputValue(this.query,true);},getHint:function getHint(){return this.$hint.val();},setHint:function setHint(value){this.$hint.val(value);},clearHint:function clearHint(){this.setHint("");},clearHintIfInvalid:function clearHintIfInvalid(){var val,hint,valIsPrefixOfHint,isValid;val=this.getInputValue();hint=this.getHint();valIsPrefixOfHint=val!==hint&&hint.indexOf(val)===0;isValid=val!==""&&valIsPrefixOfHint&&!this.hasOverflow();!isValid&&this.clearHint();},getLanguageDirection:function getLanguageDirection(){return(this.$input.css("direction")||"ltr").toLowerCase();},hasOverflow:function hasOverflow(){var constraint=this.$input.width()-2;this.$overflowHelper.text(this.getInputValue());return this.$overflowHelper.width()>=constraint;},isCursorAtEnd:function(){var valueLength,selectionStart,range;valueLength=this.$input.val().length;selectionStart=this.$input[0].selectionStart;if(_.isNumber(selectionStart)){return selectionStart===valueLength;}else if(document.selection){range=document.selection.createRange();range.moveStart("character",-valueLength);return valueLength===range.text.length;}
return true;},destroy:function destroy(){this.$hint.off(".tt");this.$input.off(".tt");this.$hint=this.$input=this.$overflowHelper=null;}});return Input;function buildOverflowHelper($input){return $('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:$input.css("font-family"),fontSize:$input.css("font-size"),fontStyle:$input.css("font-style"),fontVariant:$input.css("font-variant"),fontWeight:$input.css("font-weight"),wordSpacing:$input.css("word-spacing"),letterSpacing:$input.css("letter-spacing"),textIndent:$input.css("text-indent"),textRendering:$input.css("text-rendering"),textTransform:$input.css("text-transform")}).insertAfter($input);}
function areQueriesEquivalent(a,b){return Input.normalizeQuery(a)===Input.normalizeQuery(b);}
function withModifier($e){return $e.altKey||$e.ctrlKey||$e.metaKey||$e.shiftKey;}}();var Dataset=function(){"use strict";var datasetKey="ttDataset",valueKey="ttValue",datumKey="ttDatum";function Dataset(o){o=o||{};o.templates=o.templates||{};if(!o.source){$.error("missing source");}
if(o.name&&!isValidName(o.name)){$.error("invalid dataset name: "+o.name);}
this.query=null;this.highlight=!!o.highlight;this.name=o.name||_.getUniqueId();this.source=o.source;this.displayFn=getDisplayFn(o.display||o.displayKey);this.templates=getTemplates(o.templates,this.displayFn);this.$el=$(html.dataset.replace("%CLASS%",this.name));}
Dataset.extractDatasetName=function extractDatasetName(el){return $(el).data(datasetKey);};Dataset.extractValue=function extractDatum(el){return $(el).data(valueKey);};Dataset.extractDatum=function extractDatum(el){return $(el).data(datumKey);};_.mixin(Dataset.prototype,EventEmitter,{_render:function render(query,suggestions){if(!this.$el){return;}
var that=this,hasSuggestions;this.$el.empty();hasSuggestions=suggestions&&suggestions.length;if(!hasSuggestions&&this.templates.empty){this.$el.html(getEmptyHtml()).prepend(that.templates.header?getHeaderHtml():null).append(that.templates.footer?getFooterHtml():null);}else if(hasSuggestions){this.$el.html(getSuggestionsHtml()).prepend(that.templates.header?getHeaderHtml():null).append(that.templates.footer?getFooterHtml():null);}
this.trigger("rendered");function getEmptyHtml(){return that.templates.empty({query:query,isEmpty:true});}
function getSuggestionsHtml(){var $suggestions,nodes;$suggestions=$(html.suggestions).css(css.suggestions);nodes=_.map(suggestions,getSuggestionNode);$suggestions.append.apply($suggestions,nodes);that.highlight&&highlight({className:"tt-highlight",node:$suggestions[0],pattern:query});return $suggestions;function getSuggestionNode(suggestion){var $el;$el=$(html.suggestion).append(that.templates.suggestion(suggestion)).data(datasetKey,that.name).data(valueKey,that.displayFn(suggestion)).data(datumKey,suggestion);$el.children().each(function(){$(this).css(css.suggestionChild);});return $el;}}
function getHeaderHtml(){return that.templates.header({query:query,isEmpty:!hasSuggestions});}
function getFooterHtml(){return that.templates.footer({query:query,isEmpty:!hasSuggestions});}},getRoot:function getRoot(){return this.$el;},update:function update(query){var that=this;this.query=query;this.canceled=false;this.source(query,render);function render(suggestions){if(!that.canceled&&query===that.query){that._render(query,suggestions);}}},cancel:function cancel(){this.canceled=true;},clear:function clear(){this.cancel();this.$el.empty();this.trigger("rendered");},isEmpty:function isEmpty(){return this.$el.is(":empty");},destroy:function destroy(){this.$el=null;}});return Dataset;function getDisplayFn(display){display=display||"value";return _.isFunction(display)?display:displayFn;function displayFn(obj){return obj[display];}}
function getTemplates(templates,displayFn){return{empty:templates.empty&&_.templatify(templates.empty),header:templates.header&&_.templatify(templates.header),footer:templates.footer&&_.templatify(templates.footer),suggestion:templates.suggestion||suggestionTemplate};function suggestionTemplate(context){return"<p>"+displayFn(context)+"</p>";}}
function isValidName(str){return /^[_a-zA-Z0-9-]+$/.test(str);}}();var Dropdown=function(){"use strict";function Dropdown(o){var that=this,onSuggestionClick,onSuggestionMouseEnter,onSuggestionMouseLeave;o=o||{};if(!o.menu){$.error("menu is required");}
this.isOpen=false;this.isEmpty=true;this.datasets=_.map(o.datasets,initializeDataset);onSuggestionClick=_.bind(this._onSuggestionClick,this);onSuggestionMouseEnter=_.bind(this._onSuggestionMouseEnter,this);onSuggestionMouseLeave=_.bind(this._onSuggestionMouseLeave,this);this.$menu=$(o.menu).on("click.tt",".tt-suggestion",onSuggestionClick).on("mouseenter.tt",".tt-suggestion",onSuggestionMouseEnter).on("mouseleave.tt",".tt-suggestion",onSuggestionMouseLeave);_.each(this.datasets,function(dataset){that.$menu.append(dataset.getRoot());dataset.onSync("rendered",that._onRendered,that);});}
_.mixin(Dropdown.prototype,EventEmitter,{_onSuggestionClick:function onSuggestionClick($e){this.trigger("suggestionClicked",$($e.currentTarget));},_onSuggestionMouseEnter:function onSuggestionMouseEnter($e){this._removeCursor();this._setCursor($($e.currentTarget),true);},_onSuggestionMouseLeave:function onSuggestionMouseLeave(){this._removeCursor();},_onRendered:function onRendered(){this.isEmpty=_.every(this.datasets,isDatasetEmpty);this.isEmpty?this._hide():this.isOpen&&this._show();this.trigger("datasetRendered");function isDatasetEmpty(dataset){return dataset.isEmpty();}},_hide:function(){this.$menu.hide();},_show:function(){this.$menu.css("display","block");},_getSuggestions:function getSuggestions(){return this.$menu.find(".tt-suggestion");},_getCursor:function getCursor(){return this.$menu.find(".tt-cursor").first();},_setCursor:function setCursor($el,silent){$el.first().addClass("tt-cursor");!silent&&this.trigger("cursorMoved");},_removeCursor:function removeCursor(){this._getCursor().removeClass("tt-cursor");},_moveCursor:function moveCursor(increment){var $suggestions,$oldCursor,newCursorIndex,$newCursor;if(!this.isOpen){return;}
$oldCursor=this._getCursor();$suggestions=this._getSuggestions();this._removeCursor();newCursorIndex=$suggestions.index($oldCursor)+increment;newCursorIndex=(newCursorIndex+1)%($suggestions.length+1)-1;if(newCursorIndex===-1){this.trigger("cursorRemoved");return;}else if(newCursorIndex<-1){newCursorIndex=$suggestions.length-1;}
this._setCursor($newCursor=$suggestions.eq(newCursorIndex));this._ensureVisible($newCursor);},_ensureVisible:function ensureVisible($el){var elTop,elBottom,menuScrollTop,menuHeight;elTop=$el.position().top;elBottom=elTop+$el.outerHeight(true);menuScrollTop=this.$menu.scrollTop();menuHeight=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10);if(elTop<0){this.$menu.scrollTop(menuScrollTop+elTop);}else if(menuHeight<elBottom){this.$menu.scrollTop(menuScrollTop+(elBottom-menuHeight));}},close:function close(){if(this.isOpen){this.isOpen=false;this._removeCursor();this._hide();this.trigger("closed");}},open:function open(){if(!this.isOpen){this.isOpen=true;!this.isEmpty&&this._show();this.trigger("opened");}},setLanguageDirection:function setLanguageDirection(dir){this.$menu.css(dir==="ltr"?css.ltr:css.rtl);},moveCursorUp:function moveCursorUp(){this._moveCursor(-1);},moveCursorDown:function moveCursorDown(){this._moveCursor(+1);},getDatumForSuggestion:function getDatumForSuggestion($el){var datum=null;if($el.length){datum={raw:Dataset.extractDatum($el),value:Dataset.extractValue($el),datasetName:Dataset.extractDatasetName($el)};}
return datum;},getDatumForCursor:function getDatumForCursor(){return this.getDatumForSuggestion(this._getCursor().first());},getDatumForTopSuggestion:function getDatumForTopSuggestion(){return this.getDatumForSuggestion(this._getSuggestions().first());},update:function update(query){_.each(this.datasets,updateDataset);function updateDataset(dataset){dataset.update(query);}},empty:function empty(){_.each(this.datasets,clearDataset);this.isEmpty=true;function clearDataset(dataset){dataset.clear();}},isVisible:function isVisible(){return this.isOpen&&!this.isEmpty;},destroy:function destroy(){this.$menu.off(".tt");this.$menu=null;_.each(this.datasets,destroyDataset);function destroyDataset(dataset){dataset.destroy();}}});return Dropdown;function initializeDataset(oDataset){return new Dataset(oDataset);}}();var Typeahead=function(){"use strict";var attrsKey="ttAttrs";function Typeahead(o){var $menu,$input,$hint;o=o||{};if(!o.input){$.error("missing input");}
this.isActivated=false;this.autoselect=!!o.autoselect;this.minLength=_.isNumber(o.minLength)?o.minLength:1;this.$node=buildDom(o.input,o.withHint);$menu=this.$node.find(".tt-dropdown-menu");$input=this.$node.find(".tt-input");$hint=this.$node.find(".tt-hint");$input.on("blur.tt",function($e){var active,isActive,hasActive;active=document.activeElement;isActive=$menu.is(active);hasActive=$menu.has(active).length>0;if(_.isMsie()&&(isActive||hasActive)){$e.preventDefault();$e.stopImmediatePropagation();_.defer(function(){$input.focus();});}});$menu.on("mousedown.tt",function($e){$e.preventDefault();});this.eventBus=o.eventBus||new EventBus({el:$input});this.dropdown=new Dropdown({menu:$menu,datasets:o.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this);this.input=new Input({input:$input,hint:$hint}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this);this._setLanguageDirection();}
_.mixin(Typeahead.prototype,{_onSuggestionClicked:function onSuggestionClicked(type,$el){var datum;if(datum=this.dropdown.getDatumForSuggestion($el)){this._select(datum);}},_onCursorMoved:function onCursorMoved(){var datum=this.dropdown.getDatumForCursor();this.input.setInputValue(datum.value,true);this.eventBus.trigger("cursorchanged",datum.raw,datum.datasetName);},_onCursorRemoved:function onCursorRemoved(){this.input.resetInputValue();this._updateHint();},_onDatasetRendered:function onDatasetRendered(){this._updateHint();},_onOpened:function onOpened(){this._updateHint();this.eventBus.trigger("opened");},_onClosed:function onClosed(){this.input.clearHint();this.eventBus.trigger("closed");},_onFocused:function onFocused(){this.isActivated=true;this.dropdown.open();},_onBlurred:function onBlurred(){this.isActivated=false;this.dropdown.empty();this.dropdown.close();},_onEnterKeyed:function onEnterKeyed(type,$e){var cursorDatum,topSuggestionDatum;cursorDatum=this.dropdown.getDatumForCursor();topSuggestionDatum=this.dropdown.getDatumForTopSuggestion();if(cursorDatum){this._select(cursorDatum);$e.preventDefault();}else if(this.autoselect&&topSuggestionDatum){this._select(topSuggestionDatum);$e.preventDefault();}},_onTabKeyed:function onTabKeyed(type,$e){var datum;if(datum=this.dropdown.getDatumForCursor()){this._select(datum);$e.preventDefault();}else{this._autocomplete(true);}},_onEscKeyed:function onEscKeyed(){this.dropdown.close();this.input.resetInputValue();},_onUpKeyed:function onUpKeyed(){var query=this.input.getQuery();this.dropdown.isEmpty&&query.length>=this.minLength?this.dropdown.update(query):this.dropdown.moveCursorUp();this.dropdown.open();},_onDownKeyed:function onDownKeyed(){var query=this.input.getQuery();this.dropdown.isEmpty&&query.length>=this.minLength?this.dropdown.update(query):this.dropdown.moveCursorDown();this.dropdown.open();},_onLeftKeyed:function onLeftKeyed(){this.dir==="rtl"&&this._autocomplete();},_onRightKeyed:function onRightKeyed(){this.dir==="ltr"&&this._autocomplete();},_onQueryChanged:function onQueryChanged(e,query){this.input.clearHintIfInvalid();query.length>=this.minLength?this.dropdown.update(query):this.dropdown.empty();this.dropdown.open();this._setLanguageDirection();},_onWhitespaceChanged:function onWhitespaceChanged(){this._updateHint();this.dropdown.open();},_setLanguageDirection:function setLanguageDirection(){var dir;if(this.dir!==(dir=this.input.getLanguageDirection())){this.dir=dir;this.$node.css("direction",dir);this.dropdown.setLanguageDirection(dir);}},_updateHint:function updateHint(){var datum,val,query,escapedQuery,frontMatchRegEx,match;datum=this.dropdown.getDatumForTopSuggestion();if(datum&&this.dropdown.isVisible()&&!this.input.hasOverflow()){val=this.input.getInputValue();query=Input.normalizeQuery(val);escapedQuery=_.escapeRegExChars(query);frontMatchRegEx=new RegExp("^(?:"+escapedQuery+")(.+$)","i");match=frontMatchRegEx.exec(datum.value);match?this.input.setHint(val+match[1]):this.input.clearHint();}else{this.input.clearHint();}},_autocomplete:function autocomplete(laxCursor){var hint,query,isCursorAtEnd,datum;hint=this.input.getHint();query=this.input.getQuery();isCursorAtEnd=laxCursor||this.input.isCursorAtEnd();if(hint&&query!==hint&&isCursorAtEnd){datum=this.dropdown.getDatumForTopSuggestion();datum&&this.input.setInputValue(datum.value);this.eventBus.trigger("autocompleted",datum.raw,datum.datasetName);}},_select:function select(datum){this.input.setQuery(datum.value);this.input.setInputValue(datum.value,true);this._setLanguageDirection();this.eventBus.trigger("selected",datum.raw,datum.datasetName);this.dropdown.close();_.defer(_.bind(this.dropdown.empty,this.dropdown));},open:function open(){this.dropdown.open();},close:function close(){this.dropdown.close();},setVal:function setVal(val){val=_.toStr(val);if(this.isActivated){this.input.setInputValue(val);}else{this.input.setQuery(val);this.input.setInputValue(val,true);}
this._setLanguageDirection();},getVal:function getVal(){return this.input.getQuery();},destroy:function destroy(){this.input.destroy();this.dropdown.destroy();destroyDomStructure(this.$node);this.$node=null;}});return Typeahead;function buildDom(input,withHint){var $input,$wrapper,$dropdown,$hint;$input=$(input);$wrapper=$(html.wrapper).css(css.wrapper);$dropdown=$(html.dropdown).css(css.dropdown);$hint=$input.clone().css(css.hint).css(getBackgroundStyles($input));$hint.val("").removeData().addClass("tt-hint").removeAttr("id name placeholder required").prop("readonly",true).attr({autocomplete:"off",spellcheck:"false",tabindex:-1});$input.data(attrsKey,{dir:$input.attr("dir"),autocomplete:$input.attr("autocomplete"),spellcheck:$input.attr("spellcheck"),style:$input.attr("style")});$input.addClass("tt-input").attr({autocomplete:"off",spellcheck:false}).css(withHint?css.input:css.inputWithNoHint);try{!$input.attr("dir")&&$input.attr("dir","auto");}catch(e){}
return $input.wrap($wrapper).parent().prepend(withHint?$hint:null).append($dropdown);}
function getBackgroundStyles($el){return{backgroundAttachment:$el.css("background-attachment"),backgroundClip:$el.css("background-clip"),backgroundColor:$el.css("background-color"),backgroundImage:$el.css("background-image"),backgroundOrigin:$el.css("background-origin"),backgroundPosition:$el.css("background-position"),backgroundRepeat:$el.css("background-repeat"),backgroundSize:$el.css("background-size")};}
function destroyDomStructure($node){var $input=$node.find(".tt-input");_.each($input.data(attrsKey),function(val,key){_.isUndefined(val)?$input.removeAttr(key):$input.attr(key,val);});$input.detach().removeData(attrsKey).removeClass("tt-input").insertAfter($node);$node.remove();}}();(function(){"use strict";var old,typeaheadKey,methods;old=$.fn.typeahead;typeaheadKey="ttTypeahead";methods={initialize:function initialize(o,datasets){datasets=_.isArray(datasets)?datasets:[].slice.call(arguments,1);o=o||{};return this.each(attach);function attach(){var $input=$(this),eventBus,typeahead;_.each(datasets,function(d){d.highlight=!!o.highlight;});typeahead=new Typeahead({input:$input,eventBus:eventBus=new EventBus({el:$input}),withHint:_.isUndefined(o.hint)?true:!!o.hint,minLength:o.minLength,autoselect:o.autoselect,datasets:datasets});$input.data(typeaheadKey,typeahead);}},open:function open(){return this.each(openTypeahead);function openTypeahead(){var $input=$(this),typeahead;if(typeahead=$input.data(typeaheadKey)){typeahead.open();}}},close:function close(){return this.each(closeTypeahead);function closeTypeahead(){var $input=$(this),typeahead;if(typeahead=$input.data(typeaheadKey)){typeahead.close();}}},val:function val(newVal){return!arguments.length?getVal(this.first()):this.each(setVal);function setVal(){var $input=$(this),typeahead;if(typeahead=$input.data(typeaheadKey)){typeahead.setVal(newVal);}}
function getVal($input){var typeahead,query;if(typeahead=$input.data(typeaheadKey)){query=typeahead.getVal();}
return query;}},destroy:function destroy(){return this.each(unattach);function unattach(){var $input=$(this),typeahead;if(typeahead=$input.data(typeaheadKey)){typeahead.destroy();$input.removeData(typeaheadKey);}}}};$.fn.typeahead=function(method){var tts;if(methods[method]&&method!=="initialize"){tts=this.filter(function(){return!!$(this).data(typeaheadKey);});return methods[method].apply(tts,[].slice.call(arguments,1));}else{return methods.initialize.apply(this,arguments);}};$.fn.typeahead.noConflict=function noConflict(){$.fn.typeahead=old;return this;};})();})(window.jQuery);define("typeahead",function(){});(function(){var Dropzone,Emitter,camelize,contentLoaded,detectVerticalSquash,drawImageIOSFix,noop,without,__slice=[].slice,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};noop=function(){};Emitter=(function(){function Emitter(){}
Emitter.prototype.addEventListener=Emitter.prototype.on;Emitter.prototype.on=function(event,fn){this._callbacks=this._callbacks||{};if(!this._callbacks[event]){this._callbacks[event]=[];}
this._callbacks[event].push(fn);return this;};Emitter.prototype.emit=function(){var args,callback,callbacks,event,_i,_len;event=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];this._callbacks=this._callbacks||{};callbacks=this._callbacks[event];if(callbacks){for(_i=0,_len=callbacks.length;_i<_len;_i++){callback=callbacks[_i];callback.apply(this,args);}}
return this;};Emitter.prototype.removeListener=Emitter.prototype.off;Emitter.prototype.removeAllListeners=Emitter.prototype.off;Emitter.prototype.removeEventListener=Emitter.prototype.off;Emitter.prototype.off=function(event,fn){var callback,callbacks,i,_i,_len;if(!this._callbacks||arguments.length===0){this._callbacks={};return this;}
callbacks=this._callbacks[event];if(!callbacks){return this;}
if(arguments.length===1){delete this._callbacks[event];return this;}
for(i=_i=0,_len=callbacks.length;_i<_len;i=++_i){callback=callbacks[i];if(callback===fn){callbacks.splice(i,1);break;}}
return this;};return Emitter;})();Dropzone=(function(_super){var extend,resolveOption;__extends(Dropzone,_super);Dropzone.prototype.Emitter=Emitter;Dropzone.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"];Dropzone.prototype.defaultOptions={url:null,method:"post",withCredentials:false,parallelUploads:2,uploadMultiple:false,maxFilesize:256,paramName:"file",createImageThumbnails:true,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1000,maxFiles:null,filesizeBase:1000,params:{},clickable:true,ignoreHiddenFiles:true,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:true,autoQueue:true,addRemoveLinks:false,previewsContainer:null,capture:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(file,done){return done();},init:function(){return noop;},forceFallback:false,fallback:function(){var child,messageElement,span,_i,_len,_ref;this.element.className=""+this.element.className+" dz-browser-not-supported";_ref=this.element.getElementsByTagName("div");for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];if(/(^| )dz-message($| )/.test(child.className)){messageElement=child;child.className="dz-message";continue;}}
if(!messageElement){messageElement=Dropzone.createElement("<div class=\"dz-message\"><span></span></div>");this.element.appendChild(messageElement);}
span=messageElement.getElementsByTagName("span")[0];if(span){span.textContent=this.options.dictFallbackMessage;}
return this.element.appendChild(this.getFallbackForm());},resize:function(file){var info,srcRatio,trgRatio;info={srcX:0,srcY:0,srcWidth:file.width,srcHeight:file.height};srcRatio=file.width / file.height;info.optWidth=this.options.thumbnailWidth;info.optHeight=this.options.thumbnailHeight;if((info.optWidth==null)&&(info.optHeight==null)){info.optWidth=info.srcWidth;info.optHeight=info.srcHeight;}else if(info.optWidth==null){info.optWidth=srcRatio*info.optHeight;}else if(info.optHeight==null){info.optHeight=(1 / srcRatio)*info.optWidth;}
trgRatio=info.optWidth / info.optHeight;if(file.height<info.optHeight||file.width<info.optWidth){info.trgHeight=info.srcHeight;info.trgWidth=info.srcWidth;}else{if(srcRatio>trgRatio){info.srcHeight=file.height;info.srcWidth=info.srcHeight*trgRatio;}else{info.srcWidth=file.width;info.srcHeight=info.srcWidth / trgRatio;}}
info.srcX=(file.width-info.srcWidth)/ 2;info.srcY=(file.height-info.srcHeight)/ 2;return info;},drop:function(e){return this.element.classList.remove("dz-drag-hover");},dragstart:noop,dragend:function(e){return this.element.classList.remove("dz-drag-hover");},dragenter:function(e){return this.element.classList.add("dz-drag-hover");},dragover:function(e){return this.element.classList.add("dz-drag-hover");},dragleave:function(e){return this.element.classList.remove("dz-drag-hover");},paste:noop,reset:function(){return this.element.classList.remove("dz-started");},addedfile:function(file){var node,removeFileEvent,removeLink,_i,_j,_k,_len,_len1,_len2,_ref,_ref1,_ref2,_results;if(this.element===this.previewsContainer){this.element.classList.add("dz-started");}
if(this.previewsContainer){file.previewElement=Dropzone.createElement(this.options.previewTemplate.trim());file.previewTemplate=file.previewElement;this.previewsContainer.appendChild(file.previewElement);_ref=file.previewElement.querySelectorAll("[data-dz-name]");for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];node.textContent=file.name;}
_ref1=file.previewElement.querySelectorAll("[data-dz-size]");for(_j=0,_len1=_ref1.length;_j<_len1;_j++){node=_ref1[_j];node.innerHTML=this.filesize(file.size);}
if(this.options.addRemoveLinks){file._removeLink=Dropzone.createElement("<a class=\"dz-remove\" href=\"javascript:undefined;\" data-dz-remove>"+this.options.dictRemoveFile+"</a>");file.previewElement.appendChild(file._removeLink);}
removeFileEvent=(function(_this){return function(e){e.preventDefault();e.stopPropagation();if(file.status===Dropzone.UPLOADING){return Dropzone.confirm(_this.options.dictCancelUploadConfirmation,function(){return _this.removeFile(file);});}else{if(_this.options.dictRemoveFileConfirmation){return Dropzone.confirm(_this.options.dictRemoveFileConfirmation,function(){return _this.removeFile(file);});}else{return _this.removeFile(file);}}};})(this);_ref2=file.previewElement.querySelectorAll("[data-dz-remove]");_results=[];for(_k=0,_len2=_ref2.length;_k<_len2;_k++){removeLink=_ref2[_k];_results.push(removeLink.addEventListener("click",removeFileEvent));}
return _results;}},removedfile:function(file){var _ref;if(file.previewElement){if((_ref=file.previewElement)!=null){_ref.parentNode.removeChild(file.previewElement);}}
return this._updateMaxFilesReachedClass();},thumbnail:function(file,dataUrl){var thumbnailElement,_i,_len,_ref;if(file.previewElement){file.previewElement.classList.remove("dz-file-preview");_ref=file.previewElement.querySelectorAll("[data-dz-thumbnail]");for(_i=0,_len=_ref.length;_i<_len;_i++){thumbnailElement=_ref[_i];thumbnailElement.alt=file.name;thumbnailElement.src=dataUrl;}
return setTimeout(((function(_this){return function(){return file.previewElement.classList.add("dz-image-preview");};})(this)),1);}},error:function(file,message){var node,_i,_len,_ref,_results;if(file.previewElement){file.previewElement.classList.add("dz-error");if(typeof message!=="String"&&message.error){message=message.error;}
_ref=file.previewElement.querySelectorAll("[data-dz-errormessage]");_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];_results.push(node.textContent=message);}
return _results;}},errormultiple:noop,processing:function(file){if(file.previewElement){file.previewElement.classList.add("dz-processing");if(file._removeLink){return file._removeLink.textContent=this.options.dictCancelUpload;}}},processingmultiple:noop,uploadprogress:function(file,progress,bytesSent){var node,_i,_len,_ref,_results;if(file.previewElement){_ref=file.previewElement.querySelectorAll("[data-dz-uploadprogress]");_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];if(node.nodeName==='PROGRESS'){_results.push(node.value=progress);}else{_results.push(node.style.width=""+progress+"%");}}
return _results;}},totaluploadprogress:noop,sending:noop,sendingmultiple:noop,success:function(file){if(file.previewElement){return file.previewElement.classList.add("dz-success");}},successmultiple:noop,canceled:function(file){return this.emit("error",file,"Upload canceled.");},canceledmultiple:noop,complete:function(file){if(file._removeLink){file._removeLink.textContent=this.options.dictRemoveFile;}
if(file.previewElement){return file.previewElement.classList.add("dz-complete");}},completemultiple:noop,maxfilesexceeded:noop,maxfilesreached:noop,queuecomplete:noop,previewTemplate:"<div class=\"dz-preview dz-file-preview\">\n  <div class=\"dz-image\"><img data-dz-thumbnail /></div>\n  <div class=\"dz-details\">\n    <div class=\"dz-size\"><span data-dz-size></span></div>\n    <div class=\"dz-filename\"><span data-dz-name></span></div>\n  </div>\n  <div class=\"dz-progress\"><span class=\"dz-upload\" data-dz-uploadprogress></span></div>\n  <div class=\"dz-error-message\"><span data-dz-errormessage></span></div>\n  <div class=\"dz-success-mark\">\n    <svg width=\"54px\" height=\"54px\" viewBox=\"0 0 54 54\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:sketch=\"http://www.bohemiancoding.com/sketch/ns\">\n      <title>Check</title>\n      <defs></defs>\n      <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n        <path d=\"M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\" id=\"Oval-2\" stroke-opacity=\"0.198794158\" stroke=\"#747474\" fill-opacity=\"0.816519475\" fill=\"#FFFFFF\" sketch:type=\"MSShapeGroup\"></path>\n      </g>\n    </svg>\n  </div>\n  <div class=\"dz-error-mark\">\n    <svg width=\"54px\" height=\"54px\" viewBox=\"0 0 54 54\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:sketch=\"http://www.bohemiancoding.com/sketch/ns\">\n      <title>Error</title>\n      <defs></defs>\n      <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n        <g id=\"Check-+-Oval-2\" sketch:type=\"MSLayerGroup\" stroke=\"#747474\" stroke-opacity=\"0.198794158\" fill=\"#FFFFFF\" fill-opacity=\"0.816519475\">\n          <path d=\"M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\" id=\"Oval-2\" sketch:type=\"MSShapeGroup\"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>"};extend=function(){var key,object,objects,target,val,_i,_len;target=arguments[0],objects=2<=arguments.length?__slice.call(arguments,1):[];for(_i=0,_len=objects.length;_i<_len;_i++){object=objects[_i];for(key in object){val=object[key];target[key]=val;}}
return target;};function Dropzone(element,options){var elementOptions,fallback,_ref;this.element=element;this.version=Dropzone.version;this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,"");this.clickableElements=[];this.listeners=[];this.files=[];if(typeof this.element==="string"){this.element=document.querySelector(this.element);}
if(!(this.element&&(this.element.nodeType!=null))){throw new Error("Invalid dropzone element.");}
if(this.element.dropzone){throw new Error("Dropzone already attached.");}
Dropzone.instances.push(this);this.element.dropzone=this;elementOptions=(_ref=Dropzone.optionsForElement(this.element))!=null?_ref:{};this.options=extend({},this.defaultOptions,elementOptions,options!=null?options:{});if(this.options.forceFallback||!Dropzone.isBrowserSupported()){return this.options.fallback.call(this);}
if(this.options.url==null){this.options.url=this.element.getAttribute("action");}
if(!this.options.url){throw new Error("No URL provided.");}
if(this.options.acceptedFiles&&this.options.acceptedMimeTypes){throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");}
if(this.options.acceptedMimeTypes){this.options.acceptedFiles=this.options.acceptedMimeTypes;delete this.options.acceptedMimeTypes;}
this.options.method=this.options.method.toUpperCase();if((fallback=this.getExistingFallback())&&fallback.parentNode){fallback.parentNode.removeChild(fallback);}
if(this.options.previewsContainer!==false){if(this.options.previewsContainer){this.previewsContainer=Dropzone.getElement(this.options.previewsContainer,"previewsContainer");}else{this.previewsContainer=this.element;}}
if(this.options.clickable){if(this.options.clickable===true){this.clickableElements=[this.element];}else{this.clickableElements=Dropzone.getElements(this.options.clickable,"clickable");}}
this.init();}
Dropzone.prototype.getAcceptedFiles=function(){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.accepted){_results.push(file);}}
return _results;};Dropzone.prototype.getRejectedFiles=function(){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(!file.accepted){_results.push(file);}}
return _results;};Dropzone.prototype.getFilesWithStatus=function(status){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.status===status){_results.push(file);}}
return _results;};Dropzone.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(Dropzone.QUEUED);};Dropzone.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(Dropzone.UPLOADING);};Dropzone.prototype.getActiveFiles=function(){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.status===Dropzone.UPLOADING||file.status===Dropzone.QUEUED){_results.push(file);}}
return _results;};Dropzone.prototype.init=function(){var eventName,noPropagation,setupHiddenFileInput,_i,_len,_ref,_ref1;if(this.element.tagName==="form"){this.element.setAttribute("enctype","multipart/form-data");}
if(this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")){this.element.appendChild(Dropzone.createElement("<div class=\"dz-default dz-message\"><span>"+this.options.dictDefaultMessage+"</span></div>"));}
if(this.clickableElements.length){setupHiddenFileInput=(function(_this){return function(){if(_this.hiddenFileInput){document.body.removeChild(_this.hiddenFileInput);}
_this.hiddenFileInput=document.createElement("input");_this.hiddenFileInput.setAttribute("type","file");if((_this.options.maxFiles==null)||_this.options.maxFiles>1){_this.hiddenFileInput.setAttribute("multiple","multiple");}
_this.hiddenFileInput.className="dz-hidden-input";if(_this.options.acceptedFiles!=null){_this.hiddenFileInput.setAttribute("accept",_this.options.acceptedFiles);}
if(_this.options.capture!=null){_this.hiddenFileInput.setAttribute("capture",_this.options.capture);}
_this.hiddenFileInput.style.visibility="hidden";_this.hiddenFileInput.style.position="absolute";_this.hiddenFileInput.style.top="0";_this.hiddenFileInput.style.left="0";_this.hiddenFileInput.style.height="0";_this.hiddenFileInput.style.width="0";document.body.appendChild(_this.hiddenFileInput);return _this.hiddenFileInput.addEventListener("change",function(){var file,files,_i,_len;files=_this.hiddenFileInput.files;if(files.length){for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];_this.addFile(file);}}
return setupHiddenFileInput();});};})(this);setupHiddenFileInput();}
this.URL=(_ref=window.URL)!=null?_ref:window.webkitURL;_ref1=this.events;for(_i=0,_len=_ref1.length;_i<_len;_i++){eventName=_ref1[_i];this.on(eventName,this.options[eventName]);}
this.on("uploadprogress",(function(_this){return function(){return _this.updateTotalUploadProgress();};})(this));this.on("removedfile",(function(_this){return function(){return _this.updateTotalUploadProgress();};})(this));this.on("canceled",(function(_this){return function(file){return _this.emit("complete",file);};})(this));this.on("complete",(function(_this){return function(file){if(_this.getUploadingFiles().length===0&&_this.getQueuedFiles().length===0){return setTimeout((function(){return _this.emit("queuecomplete");}),0);}};})(this));noPropagation=function(e){e.stopPropagation();if(e.preventDefault){return e.preventDefault();}else{return e.returnValue=false;}};this.listeners=[{element:this.element,events:{"dragstart":(function(_this){return function(e){return _this.emit("dragstart",e);};})(this),"dragenter":(function(_this){return function(e){noPropagation(e);return _this.emit("dragenter",e);};})(this),"dragover":(function(_this){return function(e){var efct;try{efct=e.dataTransfer.effectAllowed;}catch(_error){}
e.dataTransfer.dropEffect='move'===efct||'linkMove'===efct?'move':'copy';noPropagation(e);return _this.emit("dragover",e);};})(this),"dragleave":(function(_this){return function(e){return _this.emit("dragleave",e);};})(this),"drop":(function(_this){return function(e){noPropagation(e);return _this.drop(e);};})(this),"dragend":(function(_this){return function(e){return _this.emit("dragend",e);};})(this)}}];this.clickableElements.forEach((function(_this){return function(clickableElement){return _this.listeners.push({element:clickableElement,events:{"click":function(evt){if((clickableElement!==_this.element)||(evt.target===_this.element||Dropzone.elementInside(evt.target,_this.element.querySelector(".dz-message")))){return _this.hiddenFileInput.click();}}}});};})(this));this.enable();return this.options.init.call(this);};Dropzone.prototype.destroy=function(){var _ref;this.disable();this.removeAllFiles(true);if((_ref=this.hiddenFileInput)!=null?_ref.parentNode:void 0){this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput);this.hiddenFileInput=null;}
delete this.element.dropzone;return Dropzone.instances.splice(Dropzone.instances.indexOf(this),1);};Dropzone.prototype.updateTotalUploadProgress=function(){var activeFiles,file,totalBytes,totalBytesSent,totalUploadProgress,_i,_len,_ref;totalBytesSent=0;totalBytes=0;activeFiles=this.getActiveFiles();if(activeFiles.length){_ref=this.getActiveFiles();for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];totalBytesSent+=file.upload.bytesSent;totalBytes+=file.upload.total;}
totalUploadProgress=100*totalBytesSent / totalBytes;}else{totalUploadProgress=100;}
return this.emit("totaluploadprogress",totalUploadProgress,totalBytes,totalBytesSent);};Dropzone.prototype._getParamName=function(n){if(typeof this.options.paramName==="function"){return this.options.paramName(n);}else{return""+this.options.paramName+(this.options.uploadMultiple?"["+n+"]":"");}};Dropzone.prototype.getFallbackForm=function(){var existingFallback,fields,fieldsString,form;if(existingFallback=this.getExistingFallback()){return existingFallback;}
fieldsString="<div class=\"dz-fallback\">";if(this.options.dictFallbackText){fieldsString+="<p>"+this.options.dictFallbackText+"</p>";}
fieldsString+="<input type=\"file\" name=\""+(this._getParamName(0))+"\" "+(this.options.uploadMultiple?'multiple="multiple"':void 0)+" /><input type=\"submit\" value=\"Upload!\"></div>";fields=Dropzone.createElement(fieldsString);if(this.element.tagName!=="FORM"){form=Dropzone.createElement("<form action=\""+this.options.url+"\" enctype=\"multipart/form-data\" method=\""+this.options.method+"\"></form>");form.appendChild(fields);}else{this.element.setAttribute("enctype","multipart/form-data");this.element.setAttribute("method",this.options.method);}
return form!=null?form:fields;};Dropzone.prototype.getExistingFallback=function(){var fallback,getFallback,tagName,_i,_len,_ref;getFallback=function(elements){var el,_i,_len;for(_i=0,_len=elements.length;_i<_len;_i++){el=elements[_i];if(/(^| )fallback($| )/.test(el.className)){return el;}}};_ref=["div","form"];for(_i=0,_len=_ref.length;_i<_len;_i++){tagName=_ref[_i];if(fallback=getFallback(this.element.getElementsByTagName(tagName))){return fallback;}}};Dropzone.prototype.setupEventListeners=function(){var elementListeners,event,listener,_i,_len,_ref,_results;_ref=this.listeners;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){elementListeners=_ref[_i];_results.push((function(){var _ref1,_results1;_ref1=elementListeners.events;_results1=[];for(event in _ref1){listener=_ref1[event];_results1.push(elementListeners.element.addEventListener(event,listener,false));}
return _results1;})());}
return _results;};Dropzone.prototype.removeEventListeners=function(){var elementListeners,event,listener,_i,_len,_ref,_results;_ref=this.listeners;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){elementListeners=_ref[_i];_results.push((function(){var _ref1,_results1;_ref1=elementListeners.events;_results1=[];for(event in _ref1){listener=_ref1[event];_results1.push(elementListeners.element.removeEventListener(event,listener,false));}
return _results1;})());}
return _results;};Dropzone.prototype.disable=function(){var file,_i,_len,_ref,_results;this.clickableElements.forEach(function(element){return element.classList.remove("dz-clickable");});this.removeEventListeners();_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];_results.push(this.cancelUpload(file));}
return _results;};Dropzone.prototype.enable=function(){this.clickableElements.forEach(function(element){return element.classList.add("dz-clickable");});return this.setupEventListeners();};Dropzone.prototype.filesize=function(size){var cutoff,i,selectedSize,selectedUnit,unit,units,_i,_len;units=['TB','GB','MB','KB','b'];selectedSize=selectedUnit=null;for(i=_i=0,_len=units.length;_i<_len;i=++_i){unit=units[i];cutoff=Math.pow(this.options.filesizeBase,4-i)/ 10;if(size>=cutoff){selectedSize=size / Math.pow(this.options.filesizeBase,4-i);selectedUnit=unit;break;}}
selectedSize=Math.round(10*selectedSize)/ 10;return"<strong>"+selectedSize+"</strong> "+selectedUnit;};Dropzone.prototype._updateMaxFilesReachedClass=function(){if((this.options.maxFiles!=null)&&this.getAcceptedFiles().length>=this.options.maxFiles){if(this.getAcceptedFiles().length===this.options.maxFiles){this.emit('maxfilesreached',this.files);}
return this.element.classList.add("dz-max-files-reached");}else{return this.element.classList.remove("dz-max-files-reached");}};Dropzone.prototype.drop=function(e){var files,items;if(!e.dataTransfer){return;}
this.emit("drop",e);files=e.dataTransfer.files;if(files.length){items=e.dataTransfer.items;if(items&&items.length&&(items[0].webkitGetAsEntry!=null)){this._addFilesFromItems(items);}else{this.handleFiles(files);}}};Dropzone.prototype.paste=function(e){var items,_ref;if((e!=null?(_ref=e.clipboardData)!=null?_ref.items:void 0:void 0)==null){return;}
this.emit("paste",e);items=e.clipboardData.items;if(items.length){return this._addFilesFromItems(items);}};Dropzone.prototype.handleFiles=function(files){var file,_i,_len,_results;_results=[];for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];_results.push(this.addFile(file));}
return _results;};Dropzone.prototype._addFilesFromItems=function(items){var entry,item,_i,_len,_results;_results=[];for(_i=0,_len=items.length;_i<_len;_i++){item=items[_i];if((item.webkitGetAsEntry!=null)&&(entry=item.webkitGetAsEntry())){if(entry.isFile){_results.push(this.addFile(item.getAsFile()));}else if(entry.isDirectory){_results.push(this._addFilesFromDirectory(entry,entry.name));}else{_results.push(void 0);}}else if(item.getAsFile!=null){if((item.kind==null)||item.kind==="file"){_results.push(this.addFile(item.getAsFile()));}else{_results.push(void 0);}}else{_results.push(void 0);}}
return _results;};Dropzone.prototype._addFilesFromDirectory=function(directory,path){var dirReader,entriesReader;dirReader=directory.createReader();entriesReader=(function(_this){return function(entries){var entry,_i,_len;for(_i=0,_len=entries.length;_i<_len;_i++){entry=entries[_i];if(entry.isFile){entry.file(function(file){if(_this.options.ignoreHiddenFiles&&file.name.substring(0,1)==='.'){return;}
file.fullPath=""+path+"/"+file.name;return _this.addFile(file);});}else if(entry.isDirectory){_this._addFilesFromDirectory(entry,""+path+"/"+entry.name);}}};})(this);return dirReader.readEntries(entriesReader,function(error){return typeof console!=="undefined"&&console!==null?typeof console.log==="function"?console.log(error):void 0:void 0;});};Dropzone.prototype.accept=function(file,done){if(file.size>this.options.maxFilesize*1024*1024){return done(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(file.size / 1024 / 10.24)/ 100).replace("{{maxFilesize}}",this.options.maxFilesize));}else if(!Dropzone.isValidFile(file,this.options.acceptedFiles)){return done(this.options.dictInvalidFileType);}else if((this.options.maxFiles!=null)&&this.getAcceptedFiles().length>=this.options.maxFiles){done(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles));return this.emit("maxfilesexceeded",file);}else{return this.options.accept.call(this,file,done);}};Dropzone.prototype.addFile=function(file){file.upload={progress:0,total:file.size,bytesSent:0};this.files.push(file);file.status=Dropzone.ADDED;this.emit("addedfile",file);this._enqueueThumbnail(file);return this.accept(file,(function(_this){return function(error){if(error){file.accepted=false;_this._errorProcessing([file],error);}else{file.accepted=true;if(_this.options.autoQueue){_this.enqueueFile(file);}}
return _this._updateMaxFilesReachedClass();};})(this));};Dropzone.prototype.enqueueFiles=function(files){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];this.enqueueFile(file);}
return null;};Dropzone.prototype.enqueueFile=function(file){if(file.status===Dropzone.ADDED&&file.accepted===true){file.status=Dropzone.QUEUED;if(this.options.autoProcessQueue){return setTimeout(((function(_this){return function(){return _this.processQueue();};})(this)),0);}}else{throw new Error("This file can't be queued because it has already been processed or was rejected.");}};Dropzone.prototype._thumbnailQueue=[];Dropzone.prototype._processingThumbnail=false;Dropzone.prototype._enqueueThumbnail=function(file){if(this.options.createImageThumbnails&&file.type.match(/image.*/)&&file.size<=this.options.maxThumbnailFilesize*1024*1024){this._thumbnailQueue.push(file);return setTimeout(((function(_this){return function(){return _this._processThumbnailQueue();};})(this)),0);}};Dropzone.prototype._processThumbnailQueue=function(){if(this._processingThumbnail||this._thumbnailQueue.length===0){return;}
this._processingThumbnail=true;return this.createThumbnail(this._thumbnailQueue.shift(),(function(_this){return function(){_this._processingThumbnail=false;return _this._processThumbnailQueue();};})(this));};Dropzone.prototype.removeFile=function(file){if(file.status===Dropzone.UPLOADING){this.cancelUpload(file);}
this.files=without(this.files,file);this.emit("removedfile",file);if(this.files.length===0){return this.emit("reset");}};Dropzone.prototype.removeAllFiles=function(cancelIfNecessary){var file,_i,_len,_ref;if(cancelIfNecessary==null){cancelIfNecessary=false;}
_ref=this.files.slice();for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.status!==Dropzone.UPLOADING||cancelIfNecessary){this.removeFile(file);}}
return null;};Dropzone.prototype.createThumbnail=function(file,callback){var fileReader;fileReader=new FileReader;fileReader.onload=(function(_this){return function(){if(file.type==="image/svg+xml"){_this.emit("thumbnail",file,fileReader.result);if(callback!=null){callback();}
return;}
return _this.createThumbnailFromUrl(file,fileReader.result,callback);};})(this);return fileReader.readAsDataURL(file);};Dropzone.prototype.createThumbnailFromUrl=function(file,imageUrl,callback){var img;img=document.createElement("img");img.onload=(function(_this){return function(){var canvas,ctx,resizeInfo,thumbnail,_ref,_ref1,_ref2,_ref3;file.width=img.width;file.height=img.height;resizeInfo=_this.options.resize.call(_this,file);if(resizeInfo.trgWidth==null){resizeInfo.trgWidth=resizeInfo.optWidth;}
if(resizeInfo.trgHeight==null){resizeInfo.trgHeight=resizeInfo.optHeight;}
canvas=document.createElement("canvas");ctx=canvas.getContext("2d");canvas.width=resizeInfo.trgWidth;canvas.height=resizeInfo.trgHeight;drawImageIOSFix(ctx,img,(_ref=resizeInfo.srcX)!=null?_ref:0,(_ref1=resizeInfo.srcY)!=null?_ref1:0,resizeInfo.srcWidth,resizeInfo.srcHeight,(_ref2=resizeInfo.trgX)!=null?_ref2:0,(_ref3=resizeInfo.trgY)!=null?_ref3:0,resizeInfo.trgWidth,resizeInfo.trgHeight);thumbnail=canvas.toDataURL("image/png");_this.emit("thumbnail",file,thumbnail);if(callback!=null){return callback();}};})(this);if(callback!=null){img.onerror=callback;}
return img.src=imageUrl;};Dropzone.prototype.processQueue=function(){var i,parallelUploads,processingLength,queuedFiles;parallelUploads=this.options.parallelUploads;processingLength=this.getUploadingFiles().length;i=processingLength;if(processingLength>=parallelUploads){return;}
queuedFiles=this.getQueuedFiles();if(!(queuedFiles.length>0)){return;}
if(this.options.uploadMultiple){return this.processFiles(queuedFiles.slice(0,parallelUploads-processingLength));}else{while(i<parallelUploads){if(!queuedFiles.length){return;}
this.processFile(queuedFiles.shift());i++;}}};Dropzone.prototype.processFile=function(file){return this.processFiles([file]);};Dropzone.prototype.processFiles=function(files){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.processing=true;file.status=Dropzone.UPLOADING;this.emit("processing",file);}
if(this.options.uploadMultiple){this.emit("processingmultiple",files);}
return this.uploadFiles(files);};Dropzone.prototype._getFilesWithXhr=function(xhr){var file,files;return files=(function(){var _i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.xhr===xhr){_results.push(file);}}
return _results;}).call(this);};Dropzone.prototype.cancelUpload=function(file){var groupedFile,groupedFiles,_i,_j,_len,_len1,_ref;if(file.status===Dropzone.UPLOADING){groupedFiles=this._getFilesWithXhr(file.xhr);for(_i=0,_len=groupedFiles.length;_i<_len;_i++){groupedFile=groupedFiles[_i];groupedFile.status=Dropzone.CANCELED;}
file.xhr.abort();for(_j=0,_len1=groupedFiles.length;_j<_len1;_j++){groupedFile=groupedFiles[_j];this.emit("canceled",groupedFile);}
if(this.options.uploadMultiple){this.emit("canceledmultiple",groupedFiles);}}else if((_ref=file.status)===Dropzone.ADDED||_ref===Dropzone.QUEUED){file.status=Dropzone.CANCELED;this.emit("canceled",file);if(this.options.uploadMultiple){this.emit("canceledmultiple",[file]);}}
if(this.options.autoProcessQueue){return this.processQueue();}};resolveOption=function(){var args,option;option=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];if(typeof option==='function'){return option.apply(this,args);}
return option;};Dropzone.prototype.uploadFile=function(file){return this.uploadFiles([file]);};Dropzone.prototype.uploadFiles=function(files){var file,formData,handleError,headerName,headerValue,headers,i,input,inputName,inputType,key,method,option,progressObj,response,updateProgress,url,value,xhr,_i,_j,_k,_l,_len,_len1,_len2,_len3,_m,_ref,_ref1,_ref2,_ref3,_ref4,_ref5;xhr=new XMLHttpRequest();for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.xhr=xhr;}
method=resolveOption(this.options.method,files);url=resolveOption(this.options.url,files);xhr.open(method,url,true);xhr.withCredentials=!!this.options.withCredentials;response=null;handleError=(function(_this){return function(){var _j,_len1,_results;_results=[];for(_j=0,_len1=files.length;_j<_len1;_j++){file=files[_j];_results.push(_this._errorProcessing(files,response||_this.options.dictResponseError.replace("{{statusCode}}",xhr.status),xhr));}
return _results;};})(this);updateProgress=(function(_this){return function(e){var allFilesFinished,progress,_j,_k,_l,_len1,_len2,_len3,_results;if(e!=null){progress=100*e.loaded / e.total;for(_j=0,_len1=files.length;_j<_len1;_j++){file=files[_j];file.upload={progress:progress,total:e.total,bytesSent:e.loaded};}}else{allFilesFinished=true;progress=100;for(_k=0,_len2=files.length;_k<_len2;_k++){file=files[_k];if(!(file.upload.progress===100&&file.upload.bytesSent===file.upload.total)){allFilesFinished=false;}
file.upload.progress=progress;file.upload.bytesSent=file.upload.total;}
if(allFilesFinished){return;}}
_results=[];for(_l=0,_len3=files.length;_l<_len3;_l++){file=files[_l];_results.push(_this.emit("uploadprogress",file,progress,file.upload.bytesSent));}
return _results;};})(this);xhr.onload=(function(_this){return function(e){var _ref;if(files[0].status===Dropzone.CANCELED){return;}
if(xhr.readyState!==4){return;}
response=xhr.responseText;if(xhr.getResponseHeader("content-type")&&~xhr.getResponseHeader("content-type").indexOf("application/json")){try{response=JSON.parse(response);}catch(_error){e=_error;response="Invalid JSON response from server.";}}
updateProgress();if(!((200<=(_ref=xhr.status)&&_ref<300))){return handleError();}else{return _this._finished(files,response,e);}};})(this);xhr.onerror=(function(_this){return function(){if(files[0].status===Dropzone.CANCELED){return;}
return handleError();};})(this);progressObj=(_ref=xhr.upload)!=null?_ref:xhr;progressObj.onprogress=updateProgress;headers={"Accept":"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};if(this.options.headers){extend(headers,this.options.headers);}
for(headerName in headers){headerValue=headers[headerName];xhr.setRequestHeader(headerName,headerValue);}
formData=new FormData();if(this.options.params){_ref1=this.options.params;for(key in _ref1){value=_ref1[key];formData.append(key,value);}}
for(_j=0,_len1=files.length;_j<_len1;_j++){file=files[_j];this.emit("sending",file,xhr,formData);}
if(this.options.uploadMultiple){this.emit("sendingmultiple",files,xhr,formData);}
if(this.element.tagName==="FORM"){_ref2=this.element.querySelectorAll("input, textarea, select, button");for(_k=0,_len2=_ref2.length;_k<_len2;_k++){input=_ref2[_k];inputName=input.getAttribute("name");inputType=input.getAttribute("type");if(input.tagName==="SELECT"&&input.hasAttribute("multiple")){_ref3=input.options;for(_l=0,_len3=_ref3.length;_l<_len3;_l++){option=_ref3[_l];if(option.selected){formData.append(inputName,option.value);}}}else if(!inputType||((_ref4=inputType.toLowerCase())!=="checkbox"&&_ref4!=="radio")||input.checked){formData.append(inputName,input.value);}}}
for(i=_m=0,_ref5=files.length-1;0<=_ref5?_m<=_ref5:_m>=_ref5;i=0<=_ref5?++_m:--_m){formData.append(this._getParamName(i),files[i],files[i].name);}
return xhr.send(formData);};Dropzone.prototype._finished=function(files,responseText,e){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.status=Dropzone.SUCCESS;this.emit("success",file,responseText,e);this.emit("complete",file);}
if(this.options.uploadMultiple){this.emit("successmultiple",files,responseText,e);this.emit("completemultiple",files);}
if(this.options.autoProcessQueue){return this.processQueue();}};Dropzone.prototype._errorProcessing=function(files,message,xhr){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.status=Dropzone.ERROR;this.emit("error",file,message,xhr);this.emit("complete",file);}
if(this.options.uploadMultiple){this.emit("errormultiple",files,message,xhr);this.emit("completemultiple",files);}
if(this.options.autoProcessQueue){return this.processQueue();}};return Dropzone;})(Emitter);Dropzone.version="4.0.1";Dropzone.options={};Dropzone.optionsForElement=function(element){if(element.getAttribute("id")){return Dropzone.options[camelize(element.getAttribute("id"))];}else{return void 0;}};Dropzone.instances=[];Dropzone.forElement=function(element){if(typeof element==="string"){element=document.querySelector(element);}
if((element!=null?element.dropzone:void 0)==null){throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");}
return element.dropzone;};Dropzone.autoDiscover=true;Dropzone.discover=function(){var checkElements,dropzone,dropzones,_i,_len,_results;if(document.querySelectorAll){dropzones=document.querySelectorAll(".dropzone");}else{dropzones=[];checkElements=function(elements){var el,_i,_len,_results;_results=[];for(_i=0,_len=elements.length;_i<_len;_i++){el=elements[_i];if(/(^| )dropzone($| )/.test(el.className)){_results.push(dropzones.push(el));}else{_results.push(void 0);}}
return _results;};checkElements(document.getElementsByTagName("div"));checkElements(document.getElementsByTagName("form"));}
_results=[];for(_i=0,_len=dropzones.length;_i<_len;_i++){dropzone=dropzones[_i];if(Dropzone.optionsForElement(dropzone)!==false){_results.push(new Dropzone(dropzone));}else{_results.push(void 0);}}
return _results;};Dropzone.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i];Dropzone.isBrowserSupported=function(){var capableBrowser,regex,_i,_len,_ref;capableBrowser=true;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector){if(!("classList"in document.createElement("a"))){capableBrowser=false;}else{_ref=Dropzone.blacklistedBrowsers;for(_i=0,_len=_ref.length;_i<_len;_i++){regex=_ref[_i];if(regex.test(navigator.userAgent)){capableBrowser=false;continue;}}}}else{capableBrowser=false;}
return capableBrowser;};without=function(list,rejectedItem){var item,_i,_len,_results;_results=[];for(_i=0,_len=list.length;_i<_len;_i++){item=list[_i];if(item!==rejectedItem){_results.push(item);}}
return _results;};camelize=function(str){return str.replace(/[\-_](\w)/g,function(match){return match.charAt(1).toUpperCase();});};Dropzone.createElement=function(string){var div;div=document.createElement("div");div.innerHTML=string;return div.childNodes[0];};Dropzone.elementInside=function(element,container){if(element===container){return true;}
while(element=element.parentNode){if(element===container){return true;}}
return false;};Dropzone.getElement=function(el,name){var element;if(typeof el==="string"){element=document.querySelector(el);}else if(el.nodeType!=null){element=el;}
if(element==null){throw new Error("Invalid `"+name+"` option provided. Please provide a CSS selector or a plain HTML element.");}
return element;};Dropzone.getElements=function(els,name){var e,el,elements,_i,_j,_len,_len1,_ref;if(els instanceof Array){elements=[];try{for(_i=0,_len=els.length;_i<_len;_i++){el=els[_i];elements.push(this.getElement(el,name));}}catch(_error){e=_error;elements=null;}}else if(typeof els==="string"){elements=[];_ref=document.querySelectorAll(els);for(_j=0,_len1=_ref.length;_j<_len1;_j++){el=_ref[_j];elements.push(el);}}else if(els.nodeType!=null){elements=[els];}
if(!((elements!=null)&&elements.length)){throw new Error("Invalid `"+name+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");}
return elements;};Dropzone.confirm=function(question,accepted,rejected){if(window.confirm(question)){return accepted();}else if(rejected!=null){return rejected();}};Dropzone.isValidFile=function(file,acceptedFiles){var baseMimeType,mimeType,validType,_i,_len;if(!acceptedFiles){return true;}
acceptedFiles=acceptedFiles.split(",");mimeType=file.type;baseMimeType=mimeType.replace(/\/.*$/,"");for(_i=0,_len=acceptedFiles.length;_i<_len;_i++){validType=acceptedFiles[_i];validType=validType.trim();if(validType.charAt(0)==="."){if(file.name.toLowerCase().indexOf(validType.toLowerCase(),file.name.length-validType.length)!==-1){return true;}}else if(/\/\*$/.test(validType)){if(baseMimeType===validType.replace(/\/.*$/,"")){return true;}}else{if(mimeType===validType){return true;}}}
return false;};if(typeof jQuery!=="undefined"&&jQuery!==null){jQuery.fn.dropzone=function(options){return this.each(function(){return new Dropzone(this,options);});};}
if(typeof module!=="undefined"&&module!==null){module.exports=Dropzone;}else{window.Dropzone=Dropzone;}
Dropzone.ADDED="added";Dropzone.QUEUED="queued";Dropzone.ACCEPTED=Dropzone.QUEUED;Dropzone.UPLOADING="uploading";Dropzone.PROCESSING=Dropzone.UPLOADING;Dropzone.CANCELED="canceled";Dropzone.ERROR="error";Dropzone.SUCCESS="success";detectVerticalSquash=function(img){var alpha,canvas,ctx,data,ey,ih,iw,py,ratio,sy;iw=img.naturalWidth;ih=img.naturalHeight;canvas=document.createElement("canvas");canvas.width=1;canvas.height=ih;ctx=canvas.getContext("2d");ctx.drawImage(img,0,0);data=ctx.getImageData(0,0,1,ih).data;sy=0;ey=ih;py=ih;while(py>sy){alpha=data[(py-1)*4+3];if(alpha===0){ey=py;}else{sy=py;}
py=(ey+sy)>>1;}
ratio=py / ih;if(ratio===0){return 1;}else{return ratio;}};drawImageIOSFix=function(ctx,img,sx,sy,sw,sh,dx,dy,dw,dh){var vertSquashRatio;vertSquashRatio=detectVerticalSquash(img);return ctx.drawImage(img,sx,sy,sw,sh,dx,dy,dw,dh / vertSquashRatio);};contentLoaded=function(win,fn){var add,doc,done,init,poll,pre,rem,root,top;done=false;top=true;doc=win.document;root=doc.documentElement;add=(doc.addEventListener?"addEventListener":"attachEvent");rem=(doc.addEventListener?"removeEventListener":"detachEvent");pre=(doc.addEventListener?"":"on");init=function(e){if(e.type==="readystatechange"&&doc.readyState!=="complete"){return;}
(e.type==="load"?win:doc)[rem](pre+e.type,init,false);if(!done&&(done=true)){return fn.call(win,e.type||e);}};poll=function(){var e;try{root.doScroll("left");}catch(_error){e=_error;setTimeout(poll,50);return;}
return init("poll");};if(doc.readyState!=="complete"){if(doc.createEventObject&&root.doScroll){try{top=!win.frameElement;}catch(_error){}
if(top){poll();}}
doc[add](pre+"DOMContentLoaded",init,false);doc[add](pre+"readystatechange",init,false);return win[add](pre+"load",init,false);}};Dropzone._autoDiscoverFunction=function(){if(Dropzone.autoDiscover){return Dropzone.discover();}};contentLoaded(window,Dropzone._autoDiscoverFunction);}).call(this);define("dropzone",["jquery"],(function(global){return function(){var ret,fn;return ret||global.Dropzone;};}(this)));(function($){"use strict";var defaults={prefilled:null,CapitalizeFirstLetter:false,preventSubmitOnEnter:true,isClearInputOnEsc:true,externalTagId:false,prefillIdFieldName:'Id',prefillValueFieldName:'Value',AjaxPush:null,AjaxPushAllTags:null,AjaxPushParameters:null,delimiters:[9,13,44],backspace:[8],maxTags:0,hiddenTagListName:null,hiddenTagListId:null,replace:true,output:null,deleteTagsOnBackspace:true,tagsContainer:null,tagCloseIcon:'x',tagClass:'',validator:null,onlyTagList:false,tagList:null,fillInputOnTagRemove:false},publicMethods={pushTag:function(tag,ignoreEvents,externalTagId){var $self=$(this),opts=$self.data('opts'),alreadyInList,tlisLowerCase,max,tagId,tlis=$self.data("tlis"),tlid=$self.data("tlid"),idx,newTagId,newTagRemoveId,escaped,html,$el,lastTagId,lastTagObj;tag=privateMethods.trimTag(tag,opts.delimiterChars);if(!tag||tag.length<=0){return;}
if(opts.onlyTagList&&undefined!==opts.tagList){if(opts.tagList){var $tagList=opts.tagList;$.each($tagList,function(index,item){$tagList[index]=item.toLowerCase();});var suggestion=$.inArray(tag.toLowerCase(),$tagList);if(-1===suggestion){return;}}}
if(opts.CapitalizeFirstLetter&&tag.length>1){tag=tag.charAt(0).toUpperCase()+tag.slice(1).toLowerCase();}
if(opts.validator&&!opts.validator(tag)){$self.trigger('tm:invalid',tag)
return;}
if(opts.maxTags>0&&tlis.length>=opts.maxTags){return;}
alreadyInList=false;tlisLowerCase=jQuery.map(tlis,function(elem){return elem.toLowerCase();});idx=$.inArray(tag.toLowerCase(),tlisLowerCase);if(-1!==idx){alreadyInList=true;}
if(alreadyInList){$self.trigger('tm:duplicated',tag);if(opts.blinkClass){for(var i=0;i<6;++i){$("#"+$self.data("tm_rndid")+"_"+tlid[idx]).queue(function(next){$(this).toggleClass(opts.blinkClass);next();}).delay(100);}}else{$("#"+$self.data("tm_rndid")+"_"+tlid[idx]).stop().animate({backgroundColor:opts.blinkBGColor_1},100).animate({backgroundColor:opts.blinkBGColor_2},100).animate({backgroundColor:opts.blinkBGColor_1},100).animate({backgroundColor:opts.blinkBGColor_2},100).animate({backgroundColor:opts.blinkBGColor_1},100).animate({backgroundColor:opts.blinkBGColor_2},100);}}else{if(opts.externalTagId===true){if(externalTagId===undefined){$.error('externalTagId is not passed for tag -'+tag);}
tagId=externalTagId;}else{max=Math.max.apply(null,tlid);max=max===-Infinity?0:max;tagId=++max;}
if(!ignoreEvents){$self.trigger('tm:pushing',[tag,tagId]);}
tlis.push(tag);tlid.push(tagId);if(!ignoreEvents)
if(opts.AjaxPush!==null&&opts.AjaxPushAllTags==null){if($.inArray(tag,opts.prefilled)===-1){$.post(opts.AjaxPush,$.extend({tag:tag},opts.AjaxPushParameters));}}
newTagId=$self.data("tm_rndid")+'_'+tagId;newTagRemoveId=$self.data("tm_rndid")+'_Remover_'+tagId;escaped=$("<span/>").text(tag).html();html='<span class="'+privateMethods.tagClasses.call($self)+'" id="'+newTagId+'">';html+='<span>'+escaped+'</span>';html+='<a href="#" class="tm-tag-remove" id="'+newTagRemoveId+'" TagIdToRemove="'+tagId+'">';html+=opts.tagCloseIcon+'</a></span> ';$el=$(html);if(opts.tagsContainer!==null){$(opts.tagsContainer).append($el);}else{if(tlid.length>1){lastTagObj=$self.siblings("#"+$self.data("tm_rndid")+"_"+tlid[tlid.length-2]);lastTagObj.after($el);}else{$self.before($el);}}
$el.find("#"+newTagRemoveId).on("click",$self,function(e){e.preventDefault();var TagIdToRemove=parseInt($(this).attr("TagIdToRemove"));privateMethods.spliceTag.call($self,TagIdToRemove,e.data);});privateMethods.refreshHiddenTagList.call($self);if(!ignoreEvents){$self.trigger('tm:pushed',[tag,tagId]);}
privateMethods.showOrHide.call($self);}
$self.val("");},popTag:function(){var $self=$(this),tagId,tagBeingRemoved,tlis=$self.data("tlis"),tlid=$self.data("tlid");if(tlid.length>0){tagId=tlid.pop();tagBeingRemoved=tlis[tlis.length-1];$self.trigger('tm:popping',[tagBeingRemoved,tagId]);tlis.pop();$("#"+$self.data("tm_rndid")+"_"+tagId).remove();privateMethods.refreshHiddenTagList.call($self);$self.trigger('tm:popped',[tagBeingRemoved,tagId]);}},empty:function(){var $self=$(this),tlis=$self.data("tlis"),tlid=$self.data("tlid"),tagId;while(tlid.length>0){tagId=tlid.pop();tlis.pop();$("#"+$self.data("tm_rndid")+"_"+tagId).remove();privateMethods.refreshHiddenTagList.call($self);}
$self.trigger('tm:emptied',null);privateMethods.showOrHide.call($self);},tags:function(){var $self=this,tlis=$self.data("tlis");return tlis;}},privateMethods={showOrHide:function(){var $self=this,opts=$self.data('opts'),tlis=$self.data("tlis");if(opts.maxTags>0&&tlis.length<opts.maxTags){$self.show();$self.trigger('tm:show');}
if(opts.maxTags>0&&tlis.length>=opts.maxTags){$self.hide();$self.trigger('tm:hide');}},tagClasses:function(){var $self=$(this),opts=$self.data('opts'),tagBaseClass=opts.tagBaseClass,inputBaseClass=opts.inputBaseClass,cl;cl=tagBaseClass;if($self.attr('class')){$.each($self.attr('class').split(' '),function(index,value){if(value.indexOf(inputBaseClass+'-')!==-1){cl+=' '+tagBaseClass+value.substring(inputBaseClass.length);}});}
cl+=(opts.tagClass?' '+opts.tagClass:'');return cl;},trimTag:function(tag,delimiterChars){var i;tag=$.trim(tag);i=0;for(i;i<tag.length;i++){if($.inArray(tag.charCodeAt(i),delimiterChars)!==-1){break;}}
return tag.substring(0,i);},refreshHiddenTagList:function(){var $self=$(this),tlis=$self.data("tlis"),lhiddenTagList=$self.data("lhiddenTagList");if(lhiddenTagList){$(lhiddenTagList).val(tlis.join($self.data('opts').baseDelimiter)).change();}
$self.trigger('tm:refresh',tlis.join($self.data('opts').baseDelimiter));},killEvent:function(e){e.cancelBubble=true;e.returnValue=false;e.stopPropagation();e.preventDefault();},keyInArray:function(e,ary){return $.inArray(e.which,ary)!==-1;},applyDelimiter:function(e){var $self=$(this);publicMethods.pushTag.call($self,$(this).val());e.preventDefault();},prefill:function(pta){var $self=$(this);var opts=$self.data('opts')
$.each(pta,function(key,val){if(opts.externalTagId===true){publicMethods.pushTag.call($self,val[opts.prefillValueFieldName],true,val[opts.prefillIdFieldName]);}else{publicMethods.pushTag.call($self,val,true);}});},pushAllTags:function(e,tag){var $self=$(this),opts=$self.data('opts'),tlis=$self.data("tlis");if(opts.AjaxPushAllTags){if(e.type!=='tm:pushed'||$.inArray(tag,opts.prefilled)===-1){$.post(opts.AjaxPush,$.extend({tags:tlis.join(opts.baseDelimiter)},opts.AjaxPushParameters));}}},spliceTag:function(tagId){var $self=this,tlis=$self.data("tlis"),tlid=$self.data("tlid"),idx=$.inArray(tagId,tlid),tagBeingRemoved;if(-1!==idx){tagBeingRemoved=tlis[idx];$self.trigger('tm:splicing',[tagBeingRemoved,tagId]);$("#"+$self.data("tm_rndid")+"_"+tagId).remove();tlis.splice(idx,1);tlid.splice(idx,1);privateMethods.refreshHiddenTagList.call($self);$self.trigger('tm:spliced',[tagBeingRemoved,tagId]);}
privateMethods.showOrHide.call($self);},init:function(options){var opts=$.extend({},defaults,options),delimiters,keyNums;opts.hiddenTagListName=(opts.hiddenTagListName===null)?'hidden-'+this.attr('name'):opts.hiddenTagListName;delimiters=opts.delimeters||opts.delimiters;keyNums=[9,13,17,18,19,37,38,39,40];opts.delimiterChars=[];opts.delimiterKeys=[];$.each(delimiters,function(i,v){if($.inArray(v,keyNums)!==-1){opts.delimiterKeys.push(v);}else{opts.delimiterChars.push(v);}});opts.baseDelimiter=String.fromCharCode(opts.delimiterChars[0]||44);opts.tagBaseClass='tm-tag';opts.inputBaseClass='tm-input';if(!$.isFunction(opts.validator)){opts.validator=null;}
this.each(function(){var $self=$(this),hiddenObj='',rndid='',albet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";if($self.data('tagManager')){return false;}
$self.data('tagManager',true);for(var i=0;i<5;i++){rndid+=albet.charAt(Math.floor(Math.random()*albet.length));}
$self.data("tm_rndid",rndid);$self.data('opts',opts).data('tlis',[]).data('tlid',[]);if(opts.output===null){hiddenObj=$('<input/>',{type:'hidden',name:opts.hiddenTagListName});$self.after(hiddenObj);$self.data("lhiddenTagList",hiddenObj);}else{$self.data("lhiddenTagList",$(opts.output));}
if(opts.AjaxPushAllTags){$self.on('tm:spliced',privateMethods.pushAllTags);$self.on('tm:popped',privateMethods.pushAllTags);$self.on('tm:pushed',privateMethods.pushAllTags);}
$self.on('focus keypress',function(e){if($(this).popover){$(this).popover('hide');}});if(opts.isClearInputOnEsc){$self.on('keyup',function(e){if(e.which===27){$(this).val('');privateMethods.killEvent(e);}});}
$self.on('keypress',function(e){if(privateMethods.keyInArray(e,opts.delimiterChars)){privateMethods.applyDelimiter.call($self,e);}});$self.on('keydown',function(e){if(e.which===13){if(opts.preventSubmitOnEnter){privateMethods.killEvent(e);}}
if(privateMethods.keyInArray(e,opts.delimiterKeys)){privateMethods.applyDelimiter.call($self,e);}});if(opts.deleteTagsOnBackspace){$self.on('keydown',function(e){if(privateMethods.keyInArray(e,opts.backspace)){if($(this).val().length<=0){publicMethods.popTag.call($self);privateMethods.killEvent(e);}}});}
if(opts.fillInputOnTagRemove){$self.on('tm:popped',function(e,tag){$(this).val(tag);});}
$self.change(function(e){if(!/webkit/.test(navigator.userAgent.toLowerCase())){$self.focus();}
privateMethods.killEvent(e);});if(opts.prefilled!==null){if(typeof(opts.prefilled)==="object"){privateMethods.prefill.call($self,opts.prefilled);}else if(typeof(opts.prefilled)==="string"){privateMethods.prefill.call($self,opts.prefilled.split(opts.baseDelimiter));}else if(typeof(opts.prefilled)==="function"){privateMethods.prefill.call($self,opts.prefilled());}}else if(opts.output!==null){if($(opts.output)&&$(opts.output).val()){var existing_tags=$(opts.output);}
privateMethods.prefill.call($self,$(opts.output).val().split(opts.baseDelimiter));}});return this;}};$.fn.tagsManager=function(method){var $self=$(this);if(!(0 in this)){return this;}
if(publicMethods[method]){return publicMethods[method].apply($self,Array.prototype.slice.call(arguments,1));}else if(typeof method==='object'||!method){return privateMethods.init.apply(this,arguments);}else{$.error('Method '+method+' does not exist.');return false;}};}(jQuery));define("tagsManager",function(){});define('type/husky-select',['type/default','form/util'],function(Default){'use strict';return function($el,options){var defaults={id:'id',label:'value',required:false},typeInterface={setValue:function(data){if(data===undefined||data===''||data===null){return;}
if(typeof data==='object'){this.$el.data({'selection':data[this.options.id],'selectionValues':data[this.options.label]}).trigger('data-changed');}else{this.$el.data({'selection':data}).trigger('data-changed');}},getValue:function(){var data={},ids=this.$el.data('selection'),values=this.$el.data('selection-values'),returnValue=this.$el.attr('data-mapper-return-value');if(!ids||ids.length===0){return undefined;}
if(typeof returnValue!=='undefined'){if(returnValue==='id'){return Array.isArray(ids)?ids[0]:ids;}else if(returnValue==='value'){return Array.isArray(values)?values[0]:values;}}
if(this.$el.attr('data-mapper-property-type')==='string'){return Array.isArray(values)?values[0]:values;}
data[this.options.label]=Array.isArray(values)?values[0]:values;data[this.options.id]=Array.isArray(ids)?ids[0]:ids;return data;},needsValidation:function(){var val=this.getValue();return!!val;},validate:function(){var value=this.getValue();if(typeof value==='object'&&value.hasOwnProperty('id')){return!!value.id;}else{return value!==''&&typeof value!=='undefined';}}};return new Default($el,defaults,options,'husky-select',typeInterface);};});define('services/husky/url-validator',[],function(){'use strict';var constants={regex:"(?:\\S+(?::\\S*)?@)?(?:(?!10(?:\\.\\d{1,3}){3})(?!127(?:\\.\\d{1,3}){3})(?!169\\.254(?:\\.\\d{1,3}){2})(?!192\\.168(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00A1-\\uFFFF0-9]+-?)*[a-z\\u00A1-\\uFFFF0-9]+)(?:\\.(?:[a-z\\u00A1-\\uFFFF0-9]+-?)*[a-z\\u00A1-\\uFFFF0-9]+) *(?:\\.(?:[a-z\\u00A1-\\uFFFF]{2,})))(?::\\d{2,5})?(?:\/[^\\s]*)?",regexOptions:'im',defaultProtocols:['http://','https://','ftp://','ftps://'],specificPartKey:3,schemeKey:1,urlKey:0},getRegexp=function(schemes){var schemeNames=_.map(schemes,function(scheme){return scheme.replace('://','');}),hasSameScheme=schemes.indexOf('//')>-1,schemeRegex=[(hasSameScheme?'((':'('),schemeNames.join('|'),(hasSameScheme?'):)?':'):'),'\\/{2}'].join(''),regexParts=[];regexParts.push('^(');if(schemes.length>0){regexParts.push(schemeRegex);regexParts.push(')(');}
regexParts.push(constants.regex);regexParts.push(')$');return new RegExp(regexParts.join(''),constants.regexOptions);};function Validator(){}
Validator.prototype.getDefaultSchemes=function(){return constants.defaultProtocols;};Validator.prototype.test=function(url,schemes){if(!schemes){schemes=this.getDefaultSchemes();}
return getRegexp(schemes).test(url);};Validator.prototype.match=function(url,schemes){if(!schemes){schemes=this.getDefaultSchemes();}
var match=url.match(getRegexp(schemes));if(!match){return match;}
return{scheme:match[constants.schemeKey],specificPart:match[constants.specificPartKey]};};return new Validator();});define('type/husky-input',['type/default','services/husky/url-validator'],function(Default,urlValidator){'use strict';return function($el,options){var defaults={id:'id',label:'value',required:false,dateFormat:'d',timeFormat:'t'},typeValidators={phone:function(value){var regex=/^[0-9 \\(\\)/+-]*$/;return regex.test(value);},password:function(value){var regex=/^.{6,30}$/;return regex.test(value);},email:function(value){var regex=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))){2,6}$/i;return regex.test(value);},url:function(value){return urlValidator.test(value,[]);},time:function(value){return Globalize.parseDate(value,this.options.timeFormat)!==null;},color:function(value){var regex=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/;return regex.test(value);}},typeSetter={default:function(data){this.$el.data({value:data}).trigger('data-changed');},time:function(data){var dateTime=Globalize.parseDate(data,'HH:mm:ss');typeSetter.default.call(this,Globalize.format(dateTime,this.options.timeFormat));}},typeGetter={default:function(){return this.$el.find('input').val();},time:function(){var value=typeGetter.default.call(this),dateTime=Globalize.parseDate(value,this.options.timeFormat);if(value===''){return value;}
return Globalize.format(dateTime,'HH:mm:ss');},date:function(){return this.$el.data('value');}},typeInterface={setValue:function(data){var type=this.$el.data('auraSkin'),setter=typeSetter[type]||typeSetter.default;setter.call(this,data);},getValue:function(){var type=this.$el.data('auraSkin'),getter=typeGetter[type]||typeGetter.default;return getter.call(this);},needsValidation:function(){var val=this.getInputValue();return val!=='';},getInputValue:function(){var type=this.$el.data('auraSkin');if(type==='data'){return typeGetter.date.call(this);}
return typeGetter.default.call(this);},validate:function(){var value=this.getInputValue(),type=this.$el.data('auraSkin');if(!!type&&!!typeValidators[type]){return typeValidators[type].call(this,value);}else{return true;}}};return new Default($el,defaults,options,'husky-input',typeInterface);};});define('type/url-input',['type/default','services/husky/url-validator'],function(Default,urlValidator){'use strict';return function($el,options){var defaults={schemes:urlValidator.getDefaultSchemes()},constants={dataKey:'url-data',dataChangedEvent:'data-changed'},typeInterface={setValue:function(data){var match=urlValidator.match(data,this.options.schemes);if(!!match){this.$el.data(constants.dataKey,match);this.$el.trigger(constants.dataChangedEvent)}},getValue:function(){var data=this.$el.data(constants.dataKey);if(!!data&&!!data.scheme&&!!data.specificPart){return data.scheme+data.specificPart;}
return null},needsValidation:function(){return this.getValue()!==null;},validate:function(){var url=this.getValue();return urlValidator.test(url,this.options.schemes);}};return new Default($el,defaults,options,'url-input',typeInterface);};});define('services/husky/util',[],function(){'use strict';var instance=null,entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':'&quot;',"'":'&#39;',"/":'&#x2F;'};function Util(){}
Util.prototype.compare=function(a,b){if(typeof a==='object'&&typeof b==='object'){return JSON.stringify(a)===JSON.stringify(b);}};Util.prototype.typeOf=function(value){var s=typeof value;if(s==='object'){if(value){if(value instanceof Array){s='array';}}else{s='null';}}
return s;};Util.prototype.isEqual=_.isEqual;Util.prototype.isEmpty=_.isEmpty;Util.prototype.foreach=function(array,callbackValue){if(array.length&&array.length>0){for(var i=-1,length=array.length;++i<length;){callbackValue(array[i],i);}}};Util.prototype.load=function(url,data,dataType){var deferred=new $.Deferred(),settings={url:url,data:data||null,dataType:'json',success:function(data,textStatus){deferred.resolve(data,textStatus);}.bind(this),error:function(jqXHR,textStatus,error){deferred.reject(textStatus,error);}};if(typeof(dataType)!=='undefined'){settings.dataType=dataType;}
this.ajax(settings);return deferred.promise();};Util.prototype.save=function(url,type,data){var deferred=$.Deferred();this.ajax({headers:{'Content-Type':'application/json'},url:url,type:type,data:JSON.stringify(data),success:function(data,textStatus){deferred.resolve(data,textStatus);}.bind(this),error:function(jqXHR,textStatus,error){deferred.reject(jqXHR,textStatus,error);}});return deferred.promise();};Util.prototype.cropMiddle=function(text,maxLength,delimiter){var substrLength;if(!text||text.length<=maxLength||!text.slice){return text;}
if(!delimiter){delimiter='...';}
substrLength=Math.floor((maxLength-delimiter.length)/ 2);return text.slice(0,substrLength)+delimiter+text.slice(-substrLength);};Util.prototype.cropFront=function(text,maxLength,delimiter){if(!text||text.length<=maxLength||!text.slice){return text;}
delimiter=delimiter||'...';return delimiter+text.slice(-(maxLength-delimiter.length));};Util.prototype.cropTail=function(text,maxLength,delimiter){if(!text||text.length<=maxLength||!text.slice){return text;}
delimiter=delimiter||'...';return text.slice(0,(maxLength-delimiter.length))+delimiter;};Util.prototype.contains=function(list,value){return _.contains(list,value);};Util.prototype.isAlphaNumeric=function(str){var code,i,len;for(i=0,len=str.length;i<len;i++){code=str.charCodeAt(i);if(!(code>47&&code<58)&&!(code>64&&code<91)&&!(code>96&&code<123)){return false;}}
return true;};Util.prototype.uniqueId=function(prefix){return _.uniqueId(prefix);};Util.prototype.delay=function(delay,callback){return _.delay(delay,callback);};Util.prototype.union=function(){return _.union.apply(this,arguments);};Util.prototype.each=$.each;Util.prototype.ajax=$.ajax;Util.prototype.ajaxError=function(callback){$(document).ajaxError(callback);};Util.prototype.when=function(){return $.when.apply(null,arguments);};Util.prototype.deepCopy=function(object){var parent={};if($.isArray(object)){parent=[];}
return $.extend(true,parent,object);};Util.prototype.arrayGetColumn=function(data,propertyName){if(Util.prototype.typeOf(data)==='array'&&data.length>0&&Util.prototype.typeOf(data[0])==='object'){var values=[];Util.prototype.foreach(data,function(el){values.push(el[propertyName]);}.bind(this));return values;}else{return data;}};Util.prototype.removeFromArray=function(array,remove){return $.grep(array,function(value){return remove.indexOf(value)==-1;});};Util.prototype.getParameterByName=function(name,url){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(url);return results===null?"":decodeURIComponent(results[1].replace(/\+/g," "));};Util.prototype.template=_.template;Util.prototype.extend=$.extend;Util.prototype.Deferred=$.Deferred;Util.prototype.arrayMap=_.map;Util.prototype.object=_.object;Util.prototype.escapeHtml=function(string){return String(string).replace(/[&<>"'\/]/g,function(s){return entityMap[s];});};Util.prototype.capitalizeFirstLetter=function(string){if(!string.slice){return string;}
return string.charAt(0).toUpperCase()+string.slice(1);};Util.prototype.formatBytes=function(bytes){if(bytes===0){return'0 Byte';}
var k=1000,sizes=['Bytes','KB','MB','GB','TB','PB','EB','ZB','YB'],i=Math.floor(Math.log(bytes)/ Math.log(k));return(bytes / Math.pow(k,i)).toFixed(2)+' '+sizes[i];};Util.getInstance=function(){if(instance==null){instance=new Util();}
return instance;};return Util.getInstance();});define('services/husky/mediator',[],function(){'use strict';var instance=null;function Mediator(){}
Mediator.getInstance=function(){if(instance==null){instance=new Mediator();}
return instance;};Mediator.prototype.on=window.Husky.on;Mediator.prototype.once=window.Husky.once;Mediator.prototype.off=window.Husky.off;Mediator.prototype.emit=window.Husky.emit;return Mediator.getInstance();});define('services/husky/translator',[],function(){'use strict';var instance=null;function Translator(){}
Translator.getInstance=function(){if(instance==null){instance=new Translator();}
return instance;};Translator.prototype.translate=window.Husky.translate;return Translator.getInstance();});define('bower_components/aura/lib/platform',[],function(){if(typeof Function.prototype.bind!=="function"){Function.prototype.bind=function(context){var fn=this,args=Array.prototype.slice.call(arguments,1);return function(){return fn.apply(context,Array.prototype.concat.apply(args,arguments));};};}
if(typeof Array.isArray!=="function"){Array.isArray=function(vArg){return Object.prototype.toString.call(vArg)==="[object Array]";};}
if(!Object.create){Object.create=function(o){if(arguments.length>1){throw new Error('Object.create implementation only accepts the first parameter.');}
function F(){}
F.prototype=o;return new F();};}
if(!Object.keys){Object.keys=(function(){var ownProp=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable('toString'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=='object'&&typeof obj!=='function'||obj===null){throw new TypeError('Object.keys called on non-object');}
var result=[];for(var prop in obj){if(ownProp.call(obj,prop)){result.push(prop);}}
if(hasDontEnumBug){for(var i=0;i<dontEnumsLength;i++){if(ownProp.call(obj,dontEnums[i])){result.push(dontEnums[i]);}}}
return result;};})();}});(function(){if(window.jQuery){define('jquery',[],function(){return window.jQuery;});}else{require.config({paths:{jquery:'bower_components/jquery/jquery'},shim:{jquery:{exports:'$'}}});}
if(window._){define('underscore',[],function(){return window._;});}else{require.config({paths:{underscore:'bower_components/underscore/underscore'},shim:{underscore:{exports:'_'}}});}
define('bower_components/aura/lib/base',['module','underscore','jquery','./platform'],function(module,_,$,platform){if(!require.s.contexts._.config.paths.aura){require.config({paths:{aura:module.id.replace(/base$/,'')}});}
var base={};base.dom={find:function(selector,context){context=context||document;return $(context).find(selector);},contains:function(selector,context){return $.contains(context||document,selector);},data:function(selector,attribute){return $(selector).data(attribute);}};base.data={deferred:$.Deferred,when:$.when};base.util={each:$.each,extend:$.extend,uniq:_.uniq,_:_,decamelize:function(camelCase,delimiter){delimiter=(delimiter===undefined)?'_':delimiter;return camelCase.replace(/([A-Z])/g,delimiter+'$1').toLowerCase();}};base.events={listen:function(context,events,selector,callback){return $(context).on(events,selector,callback);},bindAll:function(){return _.bindAll.apply(this,arguments);}};base.template={parse:_.template};return base;});})();define('bower_components/aura/lib/logger',[],function(){'use strict';var noop=function(){},console=window.console||{};function Logger(name){this.name=name;this._log=noop;this._warn=noop;this._error=noop;this._enabled=false;return this;}
Logger.prototype.isEnabled=function(){return this._enabled;};Logger.prototype.setName=function(name){this.name=name;};Logger.prototype.enable=function(){if(Function.prototype.bind&&typeof console==="object"){var logFns=["log","warn","error"];for(var i=0;i<logFns.length;i++){console[logFns[i]]=Function.prototype.call.bind(console[logFns[i]],console);}}
this._log=(console.log||noop);this._warn=(console.warn||this._log);this._error=(console.error||this._log);this._enabled=true;return this;};Logger.prototype.write=function(output,args){var parameters=Array.prototype.slice.call(args);parameters.unshift(this.name+":");output.apply(console,parameters);};Logger.prototype.log=function(){this.write(this._log,arguments);};Logger.prototype.warn=function(){this.write(this._warn,arguments);};Logger.prototype.error=function(){this.write(this._error,arguments);};return Logger;});define('bower_components/aura/lib/aura.extensions',['./base','./logger'],function(base,Logger){var _=base.util._,slice=Array.prototype.slice,deferred=base.data.deferred,when=base.data.when,logger=new Logger('Extensions').enable();function ExtManager(){this._extensions=[];this.initStatus=deferred();return this;}
ExtManager.prototype.add=function(ext){if(_.include(this._extensions,ext)){var msg=ext.ref.toString()+" is already registered.";msg+="Extensions can only be added once.";throw new Error(msg);}
if(this.initStarted){throw new Error("Init extensions already called");}
this._extensions.push(ext);return this;};ExtManager.prototype.onReady=function(fn){this.initStatus.then(fn);return this;};ExtManager.prototype.onFailure=function(fn){this.initStatus.fail(fn);return this;};ExtManager.prototype.init=function(){if(this.initStarted){throw new Error("Init extensions already called");}
this.initStarted=true;var extensions=_.compact(this._extensions.slice(0)),initialized=[],initStatus=this.initStatus;(function _init(extDef){if(extDef){var ext=initExtension(extDef);initialized.push(ext);ext.done(function(){_init(extensions.shift());});ext.fail(function(err){if(!err){err="Unknown error while loading an extension";}
if(!(err instanceof Error)){err=new Error(err);}
initStatus.reject(err);});}else if(extensions.length===0){when.apply(undefined,initialized).done(function(){initStatus.resolve(Array.prototype.slice.call(arguments));});}})(extensions.shift());return initStatus.promise();};function getFn(){var funcs=slice.call(arguments),fn;for(var f=0,l=funcs.length;f<l;f++){fn=funcs[f];if(typeof(fn)==='function'){return fn;}}
return function(){};}
function getVal(val){if(typeof val==='function'){return val.apply(undefined,slice.call(arguments,1));}else{return val;}}
function initExtension(extDef){var dfd=deferred(),ref=extDef.ref,context=extDef.context;var req=requireExtension(ref,context);req.fail(dfd.reject);req.done(function(ext){if(!ext){return dfd.resolve();}
var init=when(getFn(ext,ext.initialize)(context));init.done(function(){dfd.resolve(ext);});init.fail(dfd.reject);});return dfd.promise();}
function requireExtension(ext,context){var dfd=deferred();var resolve=function(ext){ext=getVal(ext,context);if(ext&&ext.require&&ext.require.paths){var deps=Object.keys(ext.require.paths)||[];require.config(ext.require);require(deps,function(){dfd.resolve(ext);},reject);}else{dfd.resolve(ext);}};var reject=function(err){logger.error("Error loading ext:",ext,err);dfd.reject(err);};if(typeof ext==='string'){require([ext],resolve,reject);}else{resolve(ext);}
return dfd;}
return ExtManager;});define('bower_components/aura/lib/aura',['./base','./aura.extensions','./logger'],function(base,ExtManager,Logger){var _=base.util._,noop=function(){},freeze=Object.freeze||noop;function Aura(config){if(!(this instanceof Aura)){return new Aura(config);}
var extManager=new ExtManager(),app=this;app.ref=_.uniqueId('aura_');app.config=config=config||{};app.config.sources=app.config.sources||{"default":"./aura_components"};var appSandboxes={};var baseSandbox=Object.create(base);app.sandboxes={};app.sandboxes.create=function(ref,options){ref=ref||_.uniqueId('sandbox-');if(appSandboxes[ref]){throw new Error("Sandbox with ref "+ref+" already exists.");}
var sandbox=Object.create(baseSandbox);sandbox.ref=ref||_.uniqueId('sandbox-');sandbox.logger=new Logger(sandbox.ref);appSandboxes[sandbox.ref]=sandbox;var debug=config.debug;if(debug===true||(debug.enable&&(debug.components.length===0||debug.components.indexOf(ref)!==-1))){sandbox.logger.enable();}
_.extend(sandbox,options||{});return sandbox;};app.sandboxes.get=function(ref){return appSandboxes[ref];};app.use=function(ref){extManager.add({ref:ref,context:app});return app;};app.components={};app.components.addSource=function(name,baseUrl){if(config.sources[name]){throw new Error("Components source '"+name+"' is already registered");}
config.sources[name]=baseUrl;return app;};app.core=Object.create(base);app.start=function(options){if(app.started){app.logger.error("Aura already started!");return extManager.initStatus;}
app.logger.log("Starting Aura");var startOptions=options||{};if(typeof options==='string'){startOptions={components:app.core.dom.find(options)};}else if(Array.isArray(options)){startOptions={components:options};}else if(options&&options.widgets&&!options.components){startOptions.components=options.widgets;}else if(startOptions.components===undefined){startOptions.components=app.core.dom.find(app.config.components||'body');}
extManager.onReady(function(exts){base.util.each(exts,function(i,ext){if(ext&&typeof(ext.afterAppStart)==='function'){ext.afterAppStart(app);}});});extManager.onFailure(function(){app.logger.error("Error initializing app:",app.config.name,arguments);app.stop();});app.startOptions=startOptions;app.started=true;return extManager.init();};app.stop=function(){app.started=false;};app.cleanUp=function(){_.defer(function(){_.each(appSandboxes,function(sandbox){if(!!sandbox&&!!sandbox.el&&!app.core.dom.contains($(sandbox.el)[0],document)){sandbox.stop();}});});};app.sandbox=baseSandbox;app.logger=new Logger(app.ref);app.sandbox.stop=function(selector){var sandbox=app.sandboxes.get(selector);if(sandbox){stopSandbox(sandbox);}
try{$.find(selector);}catch(err){return err;}
if(selector){app.core.dom.find(selector,this.el).each(function(i,el){var ref=app.core.dom.find(el).data('__sandbox_ref__');stopSandbox(ref);});}else{stopSandbox(this);}};function stopSandbox(sandbox){if(typeof sandbox==='string'){sandbox=app.sandboxes.get(sandbox);}
if(sandbox){var event=['aura','sandbox','stop'].join(app.config.mediator.delimiter);_.invoke(sandbox._children,'stop');app.core.mediator.emit(event,sandbox);if(sandbox._component){sandbox._component.invokeWithCallbacks('remove');sandbox._component.invokeWithCallbacks('destroy');}
sandbox.stopped=true;sandbox.el&&app.core.dom.find(sandbox.el).remove();appSandboxes[sandbox.ref]=null;delete appSandboxes[sandbox.ref];return sandbox;}}
config.debug=config.debug||{};var debug=config.debug;if(debug===true){config.debug=debug={enable:true};}
if(debug.enable){if(debug.components){debug.components=debug.components.split(' ');}else{debug.components=[];}
app.logger.enable();app.use('aura/ext/debug');}
app.use('aura/ext/mediator');app.use('aura/ext/components');return app;}
return Aura;});define('husky',['bower_components/aura/lib/aura'],function(Aura){'use strict';function Husky(config){if(!(this instanceof Husky)){return new Husky(config);}
Aura.call(this,config);var app=this;app.components.addSource('husky','./husky_components');app.use('./husky_extensions/jquery');app.use('./husky_extensions/backbone');app.use('./husky_extensions/collection');app.use('./husky_extensions/model');app.use('./husky_extensions/html.sortable');app.use('./husky_extensions/husky-validation');app.use('./husky_extensions/util');app.use('./husky_extensions/confirm');app.use('./husky_extensions/template');app.use('./husky_extensions/globalize');app.use('./husky_extensions/uri-template');app.use('./husky_extensions/ckeditor-extension');app.use('./husky_extensions/typeahead');app.use('./husky_extensions/tagmanager');app.use('./husky_extensions/dropzone');app.use('./husky_extensions/colorpicker');app.use('./husky_extensions/datepicker');app.use('./husky_extensions/itembox');app.use('./husky_extensions/itemgrid');app.use('./husky_extensions/cache-factory');app.use('./husky_extensions/infinite-scroll');app.use(function(app){window.Husky=app.sandboxes.create('husky-sandbox');});} 
Husky.prototype=Object.create(Aura.prototype);Husky.prototype.constructor=Husky;Husky.prototype.version='0.1.0';return Husky;});define('__component__$navigation@husky',[],function(){'use strict';var templates={skeleton:['<nav class="navigation<% if (collapsed === "true") {%> collapsed<% } %>">','   <div class="navigation-content">','       <div class="fa-chevron-left navigation-close-icon"></div>','       <div class="wrapper">','           <header class="navigation-header">','               <div class="logo"></div>','               <div class="navigation-header-title"><% if (data.title) { %> <%= translate(data.title) %><% } %></div>','           </header>','           <div id="navigation-item-container" class="navigation-item-container"></div>','       </div>','       <footer>','       </footer>','   </div>','</nav>'].join(''),mainItem:['<li class="js-navigation-items navigation-items" id="<%= item.id %>" data-id="<%= item.id %>">','   <div <% if (item.items && item.items.length > 0) { %> class="navigation-items-toggle" <% } %> >','       <a class="<% if (!!item.action || !!item.event) { %>js-navigation-item <% } %>navigation-item" href="#">','           <span class="<%= icon %> navigation-item-icon"></span>','           <span class="navigation-item-title"><%= translate(item.title) %></span>','       </a>','       <% if (item.hasSettings) { %>','           <a class="fa-cogwheel navigation-settings-icon js-navigation-settings" id="<%= item.id %>" href="#"></a>','       <% } %>','       <% if (item.items && item.items.length > 0) { %>','           <a class="fa-chevron-right navigation-toggle-icon" href="#"></a>','       <% } %>','   </div>','</li>'].join(''),subToggleItem:['   <li class="js-navigation-items navigation-subitems" id="<%= item.id %>" data-id="<%= item.id %>">','       <div class="navigation-subitems-toggle">','           <a class="<% if (!!item.action || !!item.event) { %>js-navigation-item <% } %> navigation-item" href="#"><%= translate(item.title) %></a>','           <% if (item.hasSettings) { %>','           <a class="fa-cogwheel navigation-settings-icon js-navigation-settings" href="#"></a>','           <% } %>','           <a class="fa-chevron-right navigation-toggle-icon" href="#"></a>','       </div>','</li>'].join(''),subItem:['<li class="js-navigation-sub-item" id="<%= item.id %>" data-id="<%= item.id %>">','   <a href="#"><%= translate(item.title) %></a>','</li>'].join(''),footer:['<div class="user">','   <span class="fa-user pic"></span>','   <div class="name"><%= userName %></div>','</div>','<div class="options">','   <div class="locale-dropdown"></div>','       <a href="<%= logoutRoute %>" title="Logout" class="fa-lock logout"></a>','   </div>','<div class="version"><%= system %> (<%= version %>, <a href="#"><%= versionHistory %></a>)</div>'].join('')},defaults={footerTemplate:'',collapsed:false,resizeWidth:1300,forceCollapse:false,systemName:'Sulu 2.0',footer:true,logoutRoute:'/logout',translations:{versionHistory:'navigation.version-history',user:'navigation.user'}},CONSTANTS={COMPONENT_CLASS:'husky-navigation',UNCOLLAPSED_WIDTH:250,COLLAPSED_WIDTH:50,ITEM_LABEL_HEIGHT:50,TRANSITIONEND_EVENT:'transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd',HIDDEN_CLASS:'disappeared'},namespace='husky.navigation.',EVENT_HEADER_CLICKED=namespace+'header.clicked',EVENT_ITEM_SELECT=namespace+'item.select',EVENT_SELECT_ITEM=namespace+'select-item',EVENT_SELECT_ID=namespace+'select-id',EVENT_COLLAPSED=namespace+'collapsed',EVENT_UNCOLLAPSED=namespace+'uncollapsed',EVENT_COLLAPSE=namespace+'collapse',EVENT_UNCOLLAPSE=namespace+'uncollapse',EVENT_SIZE_CHANGE=namespace+'size.change',EVENT_SIZE_CHANGED=namespace+'size.changed',USER_LOCALE_CHANGED=namespace+'user-locale.changed',VERSION_HISTORY_CLICKED=namespace+'version-history.clicked',USERNAME_CLICKED=namespace+'username.clicked',EVENT_SHOW=namespace+'show',EVENT_SIZE_UPDATE=namespace+'size.update',EVENT_HIDE=namespace+'hide';return{initialize:function(){this.sandbox.logger.log('Initialized Navigation');this.options=this.sandbox.util.extend(true,{},defaults,this.options);this.stayCollapsed=false;this.hidden=false;this.tooltipsEnabled=true;this.animating=false;this.bindDOMEvents();this.bindCustomEvents();if(!!this.options.url){this.sandbox.util.load(this.options.url,null,'json').then(this.render.bind(this)).fail(function(data){this.sandbox.logger.log("data could not be loaded:",data);}.bind(this));}},render:function(data){this.options.data=data;this.items=[];this.sandbox.dom.addClass(this.$el,CONSTANTS.COMPONENT_CLASS);this.sandbox.dom.html(this.$el,this.sandbox.template.parse(templates.skeleton,this.sandbox.util.extend(true,{},this.options,{translate:this.sandbox.translate})));this.$navigation=this.$find('.navigation');this.$navigationContent=this.$find('.navigation-content');this.renderNavigationItems(this.options.data);this.renderFooter();this.resizeListener();if(!!this.options.selectAction&&this.options.selectAction.length>0){this.preselectItem(this.options.selectAction);}
this.sandbox.emit('husky.navigation.initialized');},renderNavigationItems:function(data){var $elem,$sectionDiv,$sectionList;this.sandbox.util.foreach(data.items,function(section){if(!section.items||!section.items.length){return;}
$sectionDiv=this.sandbox.dom.createElement('<div class="section">');$sectionList=this.sandbox.dom.createElement('<ul class="section-items">');var title;if(!!section.title&&!!(title=this.sandbox.translate(section.title))){this.sandbox.dom.append($sectionDiv,'<div class="section-headline"><span class="section-headline-title">'+title.toUpperCase()+'</span></div>');}else if(!!$elem&&$elem.children().length>0){this.sandbox.dom.append($sectionDiv,'<hr class="section-headline-divider"/>');}
this.sandbox.dom.append($sectionDiv,$sectionList);this.sandbox.dom.append('#navigation-item-container',$sectionDiv);this.sandbox.util.foreach(section.items,function(item){$elem=this.sandbox.dom.createElement(this.sandbox.template.parse(templates.mainItem,{item:item,icon:item.icon?'fa-'+item.icon:'',translate:this.sandbox.translate}));this.sandbox.dom.append($sectionList,$elem);if(item.items&&item.items.length>0){this.renderSubNavigationItems(item,$elem);}
item.domObject=$elem;this.items.push(item);}.bind(this));}.bind(this));},renderSubNavigationItems:function(data,$parentList){var elem,textCont,list=this.sandbox.dom.createElement('<ul class="navigation-items-list" />');this.sandbox.dom.append($parentList,list);this.sandbox.util.foreach(data.items,function(item){item.parentTitle=data.title;this.items.push(item);if(item.items&&item.items.length>0){elem=this.sandbox.dom.createElement(this.sandbox.template.parse(templates.subToggleItem,{item:item,translate:this.sandbox.translate}));this.renderSubNavigationItems(item,this.sandbox.dom.find('div',elem));}else{elem=this.sandbox.dom.createElement(this.sandbox.template.parse(templates.subItem,{item:item,translate:this.sandbox.translate}));}
this.sandbox.dom.append(list,elem);textCont=this.sandbox.dom.find('a',elem);if(this.sandbox.dom.width(textCont)+20<this.sandbox.dom.get(textCont,0).scrollWidth){this.sandbox.dom.attr(textCont,{'title':this.sandbox.dom.html(textCont)});}
item.domObject=elem;}.bind(this));},renderFooter:function(){if(this.options.footer===true){var $footer=this.sandbox.dom.find('footer',this.$el);this.sandbox.dom.html($footer,_.template(templates.footer)({userName:this.options.userName,system:this.options.systemName,version:this.options.systemVersion,versionHistory:this.sandbox.translate(this.options.translations.versionHistory),logoutRoute:this.options.logoutRoute}));this.sandbox.start([{name:'select@husky',options:{el:this.sandbox.dom.find('.locale-dropdown',$footer),instanceName:'navigation-locale',value:'name',data:this.options.userLocales,preSelectedElements:[this.options.userLocale],style:'small',emitValues:true}}]);}},collapsedFooterClickHandler:function(){this.unCollapse(true);this.sandbox.dom.one(this.sandbox.dom.$window,CONSTANTS.TRANSITIONEND_EVENT,this.checkBottomHit.bind(this,null,this.sandbox.dom.find('footer',this.$el)));},bindDOMEvents:function(){this.sandbox.dom.on(this.$el,'click',this.toggleItems.bind(this),'.navi gation-items-toggle, .navigation-subitems-toggle');this.sandbox.dom.on(this.$el,'click',this.settingsClicked.bind(this),'.js-navigation-settings');this.sandbox.dom.on(this.$el,'click',this.selectSubItem.bind(this),'.js-navigation-sub-item, .js-navigation-item');this.sandbox.dom.on(this.$el,'click',function(){this.sandbox.emit(EVENT_HEADER_CLICKED);}.bind(this),'.navigation-header div');this.sandbox.dom.on(this.sandbox.dom.window,'resize',this.resizeListener.bind(this));this.sandbox.dom.on(this.$el,'click',this.collapse.bind(this),'.navigation.collapseIcon .navigation-close-icon');this.sandbox.dom.on(this.$el,'click',this.collapsedFooterClickHandler.bind(this),'.navigation.collapsed footer');this.sandbox.dom.on(this.$el,'mouseenter',function(event){this.showToolTip.call(this,this.sandbox.translate(this.options.translations.user),event);}.bind(this),'.navigation.collapsed footer');this.sandbox.dom.on(this.$el,'mouseenter',this.showToolTip.bind(this,''),'.navigation.collapsed .navigation-items');this.sandbox.dom.on(this.$el,'mouseleave',this.hideToolTip.bind(this),'.navigation.collapsed .navigation-items, .navigation.collapsed, .navigation.collapsed footer');this.sandbox.dom.on(this.$el,CONSTANTS.TRANSITIONEND_EVENT,function(){this.sandbox.emit(EVENT_SIZE_CHANGED,this.sandbox.dom.width(this.$navigation));this.tooltipsEnabled=true;}.bind(this));this.sandbox.dom.on(this.$el,CONSTANTS.TRANSITIONEND_EVENT,function(event){event.stopPropagation();}.bind(this),'.navigation *');this.sandbox.dom.on(this.$el,'click',function(){this.sandbox.emit(VERSION_HISTORY_CLICKED);}.bind(this),'footer .version a');this.sandbox.dom.on(this.$el,'click',function(){this.sandbox.emit(USERNAME_CLICKED);}.bind(this),'footer .user');},bindCustomEvents:function(){this.sandbox.on('husky.navigation.footer.set',function(options){this.options=this.sandbox.util.extend(true,{},this.options,options);this.renderFooter();}.bind(this));this.sandbox.on('husky.select.navigation-locale.selected.item',function(locale){this.sandbox.emit(USER_LOCALE_CHANGED,locale);}.bind(this));this.sandbox.on(EVENT_COLLAPSE,function(stayCollapsed){this.stayCollapsed=(typeof stayCollapsed==='boolean')?stayCollapsed:false;this.collapse();}.bind(this));this.sandbox.on(EVENT_UNCOLLAPSE,function(force){this.stayCollapsed=false;this.unCollapse(force);}.bind(this));this.sandbox.on(EVENT_HIDE,this.hide.bind(this));this.sandbox.on(EVENT_SHOW,this.show.bind(this));this.sandbox.on(EVENT_SIZE_UPDATE,this.resizeListener.bind(this));this.sandbox.on(EVENT_SELECT_ITEM,this.preselectItem.bind(this));this.sandbox.on(EVENT_SELECT_ID,this.selectItem.bind(this));},resizeListener:function(){var windowWidth=this.sandbox.dom.width(this.sandbox.dom.window);if(windowWidth<=this.options.resizeWidth||this.stayCollapsed===true){this.collapse();}else if(this.sandbox.dom.hasClass(this.$navigation,'collapsed')){this.unCollapse();}},showToolTip:function(title,event){if(this.tooltipsEnabled===true){var offset,target=event.currentTarget;if(!title){title=this.sandbox.dom.html(this.sandbox.dom.find('.navigation-item-title',event.currentTarget));}
if(!this.$tooltip){this.$tooltip=this.sandbox.dom.createElement('<div class="navigation-tooltip">'+title+'</div>');this.sandbox.dom.append('body',this.$tooltip);}
offset=this.sandbox.dom.offset(target);this.sandbox.dom.css(this.$tooltip,{top:offset.top+(this.sandbox.dom.outerHeight(target)-30)/ 2});}},hideToolTip:function(){if(!!this.$tooltip){this.sandbox.dom.remove(this.$tooltip);this.$tooltip=null;}},preselectItem:function(selectAction){var matchLength=0,matchItem,parent,match;this.sandbox.util.foreach(this.items,function(item){if(!item||!item.action){return;}
if(selectAction.indexOf(item.action)!==-1&&item.action.length>matchLength){matchItem=item;matchLength=item.action.length;}}.bind(this));if(matchLength>0){match=matchItem.domObject;if(this.sandbox.dom.hasClass(match,'js-navigation-sub-item')){parent=this.sandbox.dom.closest(match,'.navigation-items');if(!this.sandbox.dom.hasClass(parent,'is-expanded')){this.toggleItems(null,parent);}}
this.selectSubItem(null,match,false);this.checkBottomHit(null,match);}},selectItem:function(id,options){var item=this.getItemById(id),domObject=item.domObject,parent;if($(domObject).hasClass('is-selected')){return;}
if(this.sandbox.dom.hasClass(domObject,'js-navigation-sub-item')){parent=this.sandbox.dom.closest(domObject,'.navigation-items');if(!this.sandbox.dom.hasClass(parent,'is-expanded')){this.toggleItems(null,parent);}}
this.selectSubItem(null,domObject,false,options);this.checkBottomHit(null,domObject);},settingsClicked:function(event){event.stopPropagation();event.preventDefault();var listItem=this.sandbox.dom.closest(event.currentTarget,'.js-navigation-items'),item=this.getItemById(this.sandbox.dom.data(listItem,'id'));this.sandbox.emit('husky.navigation.item.settings',item);},toggleItems:function(event,customTarget){if(event){event.preventDefault();}else{event={currentTarget:customTarget};}
var $items=this.sandbox.dom.closest(event.currentTarget,'.js-navigation-items'),$childList=this.sandbox.dom.find('ul:first',$items),item,$toggle,isExpanded=this.sandbox.dom.hasClass($items,'is-expanded'),navWasCollapsed;if(!customTarget){navWasCollapsed=this.showIfCollapsed();}
if(isExpanded&&!navWasCollapsed){$toggle=this.sandbox.dom.find('.fa-chevron-down',event.currentTarget);this.animateSlideUp($items,$toggle);}else if(this.collapsed!==true){$toggle=this.sandbox.dom.find('.fa-chevron-right',event.currentTarget);this.animateSlideDown($items,$toggle,$childList);}
item=this.getItemById(this.sandbox.dom.data($items,'id'));this.sandbox.emit('husky.navigation.item.toggle',!isExpanded,item);},animateSlideUp:function($items,$toggle){if(this.animating===false){this.animating=true;this.sandbox.dom.animate($items,{height:CONSTANTS.ITEM_LABEL_HEIGHT},{duration:180,complete:function(){this.animating=false;}.bind(this)});this.sandbox.dom.removeClass($items,'is-expanded');this.sandbox.dom.removeClass($toggle,'fa-chevron-down');this.sandbox.dom.prependClass($toggle,'fa-chevron-right');}},animateSlideDown:function($items,$toggle,$childList){if(this.animating===false){this.animating=true;var expandedHeight=CONSTANTS.ITEM_LABEL_HEIGHT+this.sandbox.dom.outerHeight($childList);this.sandbox.dom.stop($items);this.sandbox.dom.animate($items,{height:(expandedHeight+30)},{duration:120});this.sandbox.dom.animate($items,{height:expandedHeight},{duration:100,complete:function(){this.animating=false;}.bind(this)});this.sandbox.dom.addClass($items,'is-expanded');this.sandbox.dom.removeClass($toggle,'fa-chevron-right');this.sandbox.dom.prependClass($toggle,'fa-chevron-down');this.sandbox.dom.one($items,CONSTANTS.TRANSITIONEND_EVENT,this.checkBottomHit.bind(this));}},checkBottomHit:function(event,customTarget){var xBottom,windowHeight,itemHeight,itemTop,scrollTop,$items;if(event){$items=event.currentTarget;}else{$items=customTarget;}
itemTop=this.sandbox.dom.offset($items).top;itemHeight=this.sandbox.dom.height($items);xBottom=itemTop+itemHeight;windowHeight=this.sandbox.dom.height(this.sandbox.dom.window);scrollTop=this.sandbox.dom.scrollTop(this.$navigationContent);if(xBottom>windowHeight){if(itemHeight<windowHeight){this.sandbox.dom.scrollAnimate(scrollTop+(xBottom-windowHeight+40),this.$navigationContent);}else{this.sandbox.dom.scrollAnimate(itemTop,this.$navigationContent);}}},removeHeightforExpanded:function(){var $expandedItems=this.sandbox.dom.find('.is-expanded',this.$el),i,length;for(i=-1,length=$expandedItems.length;++i<length;){this.sandbox.dom.removeAttr($expandedItems[i],'style');}},setHeightForExpanded:function(){var $expandedItems=this.sandbox.dom.find('.is-expanded',this.$el),height,i,length;for(i=-1,length=$expandedItems.length;++i<length;){height=CONSTANTS.ITEM_LABEL_HEIGHT+this.sandbox.dom.outerHeight(this.sandbox.dom.find('.navigation-items-list',$expandedItems[i]));this.sandbox.dom.css($expandedItems[i],{'height':height});}},showIfCollapsed:function(){if(this.sandbox.dom.hasClass(this.$navigation,'collapsed')){this.unCollapse(true);return true;}
return false;},collapse:function(){if(this.hidden===false){this.sandbox.dom.addClass(this.$navigation,'collapsed');this.sandbox.dom.removeClass(this.$navigation,'collapseIcon');this.removeHeightforExpanded();if(!this.collapsed){this.sandbox.emit(EVENT_COLLAPSED,CONSTANTS.COLLAPSED_WIDTH);this.sandbox.emit(EVENT_SIZE_CHANGE,CONSTANTS.COLLAPSED_WIDTH);this.collapsed=!this.collapsed;this.tooltipsEnabled=false;}}},unCollapse:function(forced){if((this.stayCollapsed===false||forced===true)&&this.hidden===false){if(forced){if(!this.hasDataNavigation()){this.sandbox.dom.width(this.$el,this.sandbox.dom.width(this.$navigation));}
this.sandbox.dom.addClass(this.$navigation,'collapseIcon');}else{this.sandbox.dom.removeClass(this.$navigation,'collapseIcon');this.sandbox.dom.css(this.$el,{'width':''});}
this.sandbox.dom.removeClass(this.$navigation,'collapsed');this.hideToolTip();this.setHeightForExpanded();if(this.collapsed){this.sandbox.emit(EVENT_UNCOLLAPSED,CONSTANTS.UNCOLLAPSED_WIDTH,forced);if(!forced){this.sandbox.emit(EVENT_SIZE_CHANGE,CONSTANTS.UNCOLLAPSED_WIDTH);}
this.collapsed=!this.collapsed;this.tooltipsEnabled=false;}}},selectSubItem:function(event,customTarget,emit,options){if(!!event){event.preventDefault();}else{event={currentTarget:customTarget};}
var $subItem=this.sandbox.dom.createElement(event.currentTarget),$items=this.sandbox.dom.parents(event.currentTarget,'.js-navigation-items'),$parent=this.sandbox.dom.parent(event.currentTarget),item;if(this.sandbox.dom.hasClass($subItem,'js-navigation-item')){$subItem=this.sandbox.dom.createElement(this.sandbox.dom.closest(event.currentTarget,'li'));}
item=this.getItemById(this.sandbox.dom.data($subItem,'id'));if(this.sandbox.dom.hasClass($parent,'navigation-items-toggle')||this.sandbox.dom.hasClass($parent,'navigation-subitems-toggle')){return;}
if(!item.event){this.sandbox.dom.removeClass(this.sandbox.dom.find('.is-selected',this.$el),'is-selected');this.sandbox.dom.addClass($subItem,'is-selected');this.sandbox.dom.removeClass(this.sandbox.dom.find('.is-active',this.$el),'is-active');this.sandbox.dom.addClass($items,'is-active');}
var extendedItem=item;if(!!options){extendedItem=this.sandbox.util.extend(true,{},extendedItem,options);}
if(emit!==false){if(item.event){this.sandbox.emit('husky.navigation.item.event.'+item.event,item.eventArgs);}else{this.sandbox.emit(EVENT_ITEM_SELECT,extendedItem);}}
if(this.hasDataNavigation()){this.removeDataNavigation();}
if(!!extendedItem&&!!extendedItem.dataNavigation){this.renderDataNavigation(extendedItem.dataNavigation);}else if(!customTarget){setTimeout(this.resizeListener.bind(this),700);}},getItemById:function(id){for(var i=-1,length=this.items.length;++i<length;){if(id==this.items[i].id){return this.items[i];}}
return null;},show:function(){this.sandbox.dom.removeClass(this.$navigation,CONSTANTS.HIDDEN_CLASS);if(!!this.currentNavigationWidth){this.sandbox.dom.removeAttr(this.$navigation,'style');this.currentNavigationWidth=null;this.hidden=false;}},hide:function(){this.sandbox.dom.addClass(this.$navigation,CONSTANTS.HIDDEN_CLASS);this.currentNavigationWidth=this.sandbox.dom.width(this.$navigation);this.sandbox.dom.width(this.$navigation,0);this.hidden=true;},renderDataNavigation:function(options){this.collapse();var $element=this.sandbox.dom.createElement('<div/>',{class:'navigation-data-container'}),key;this.sandbox.dom.append(this.$el,$element);var componentOptions={el:$element,url:options.url,rootUrl:options.rootUrl};if(!!options.resultKey){componentOptions.resultKey=options.resultKey;}
if(!!options.nameKey){componentOptions.nameKey=options.nameKey;}
if(!!options.childrenLinkKey){componentOptions.childrenLinkKey=options.childrenLinkKey;}
if(!!options.instanceName){componentOptions.instanceName=options.instanceName;}
if(!!options.showAddBtn){componentOptions.showAddBtn=options.showAddBtn;}
if(!!options.translates){componentOptions.translates={};for(key in options.translates){componentOptions.translates[key]=this.sandbox.translate(options.translates[key]);}}
this.sandbox.dom.addClass(this.$el,'data-navigation-opened');this.sandbox.dom.width(this.$el,'');this.sandbox.util.delay(function(){$element.addClass('expanded');},0);this.sandbox.start([{name:'data-navigation@husky',options:componentOptions}]);},removeDataNavigation:function(){this.sandbox.dom.removeClass(this.$el,'data-navigation-opened');this.sandbox.stop(this.$find('.navigation-data-container'));this.unCollapse();},hasDataNavigation:function(){return this.$find('.navigation-data-container').length>0;}};});define('__component__$column-options@husky',[],function(){'use strict';var defaults={url:null,data:[],trigger:null,instanceName:null,header:{disabled:false,title:'Column Options'},footer:{disabled:false},hidden:false},templates={listItem:['<li class="column-options-list-item" data-id="<%= id %>" draggable="true">','   <span class="move">&#8942;</span>','   <span class="text"><%= title %></span>','   <span class="<%= toggleIcon %> visibility-toggle"></span>','</li>'].join(''),header:['<div class="column-options-header">','   <span class="title"><%= title %></span>','   <a href="#" class="fa-times close-button"></a>','</div>'].join('')},iconClasses={visible:'fa-eye',hidden:'fa-eye-slash'},INITIALIZED=function(){return getEventName.call(this,'initialized');},ENABLED=function(){return getEventName.call(this,'item.enabled');},DISABLED=function(){return getEventName.call(this,'item.disabled');},SAVED=function(){return getEventName.call(this,'saved');},GET_SELECTED=function(){return getEventName.call(this,'get-selected');},GET_ALL=function(){return getEventName.call(this,'get-all');},bindDOMEvents=function(){this.sandbox.dom.on(this.$el,'click',customStopPropagation.bind(this),this.$container);this.sandbox.dom.on(this.$el,'mouseover',onMouseOver.bind(this),'li');this.sandbox.dom.on(this.$el,'mouseout',onMouseOut.bind(this),'li');this.sandbox.dom.on(this.$el,'click',toggleVisibility.bind(this),'.visibility-toggle');},bindCustomEvents=function(){this.sandbox.on(GET_SELECTED.call(this),getSelectedItems.bind(this));this.sandbox.on(GET_ALL.call(this),getAllItems.bind(this));},getEventName=function(postFix){return'husky.column-options.'+(this.options.instanceName?this.options.instanceName+'.':'')+postFix;},getSelectedItems=function(callbackFunction){var id,items,$visibleItems=this.sandbox.dom.find('li:not(.disabled)',this.$el);items=[];this.sandbox.util.foreach($visibleItems,function($domItem){id=this.sandbox.dom.data($domItem,'id');items.push(this.items[id]);}.bind(this));callbackFunction(items);},getAllItems=function(callbackFunction){var id,items,$visibleItems=this.sandbox.dom.find('li',this.$el);items=[];this.sandbox.util.foreach($visibleItems,function($domItem){id=this.sandbox.dom.data($domItem,'id');items.push(this.items[id]);}.bind(this));callbackFunction(items);},onMouseOver=function(event){this.sandbox.dom.addClass(event.currentTarget,'hover-style');},onMouseOut=function(event){this.sandbox.dom.removeClass(event.currentTarget,'hover-style');},checkItemId=function(item){if(!item.id||!!this.items[item.id]){do{item.id=this.sandbox.util._.uniqueId();}while(!!this.items[item.id]);}},customStopPropagation=function(event){event.preventDefault();event.stopPropagation();},submit=function(){var $items=this.sandbox.dom.find('.column-options-list-item',this.$list),items=[],id;this.sandbox.util.foreach($items,function($item){id=this.sandbox.dom.data($item,'id');items.push(this.items[id]);}.bind(this));this.data=items;this.options.data=this.data;getAllItems.call(this,function(items){this.sandbox.emit(SAVED.call(this),items);}.bind(this));},close=function(){this.sandbox.dom.remove(this.$el);},renderItems=function(){var $listItem;this.items=[];this.sandbox.util.foreach(this.data,function(item){checkItemId.call(this,item);this.items[item.id]=item;$listItem=this.sandbox.dom.createElement(this.sandbox.template.parse(templates.listItem,{id:item.id,toggleIcon:(item.default===true||item.default==='true')?'':iconClasses.visible,title:this.sandbox.translate(item.translation)}));this.sandbox.dom.append(this.$list,$listItem);if(typeof item.disabled!=='undefined'&&item.disabled!=="false"&&item.disabled!==false){toggleVisibility.call(this,{currentTarget:this.sandbox.dom.find('.visibility-toggle',$listItem),doNotEmitEvents:true,preventDefault:function(){}});}}.bind(this));},startOverlay=function(){if(this.overlayLoaded===false){var $element=this.sandbox.dom.createElement('<div/>');this.sandbox.dom.append(this.$el,$element);this.sandbox.start([{name:'overlay@husky',options:{el:$element,container:this.$el,data:this.$list,okCallback:function(){submit.call(this);close.call(this);}.bind(this),closeCallback:function(){close.call(this);}.bind(this),instanceName:'column-options-'+this.options.instanceName,title:this.options.header.title,openOnStart:!this.options.hidden,removeOnClose:true}}]);this.overlayLoaded=true;}},toggleVisibility=function(event){event.preventDefault();var $listItem=this.sandbox.dom.parent(event.currentTarget),isDisabled=this.sandbox.dom.hasClass($listItem,'disabled'),id=this.sandbox.dom.data($listItem,'id'),item=this.items[id],visible=iconClasses.visible,hidden=iconClasses.hidden;if(isDisabled){this.numVisible++;this.sandbox.dom.removeClass(event.currentTarget,hidden);this.sandbox.dom.prependClass(event.currentTarget,visible);}else{if(this.numVisible===1){return;}
this.numVisible--;this.sandbox.dom.prependClass(event.currentTarget,hidden);this.sandbox.dom.removeClass(event.currentTarget,visible);}
this.sandbox.dom.toggleClass($listItem,'disabled');item.disabled=!isDisabled;if(!event.doNotEmitEvents){this.sandbox.emit(isDisabled?ENABLED.call(this):DISABLED.call(this),item);}};return{initialize:function(){this.options=this.sandbox.util.extend(true,{},defaults,this.options);this.overlayLoaded=false;this.options.trigger=this.options.trigger||this.$el;if(!!this.options.url){this.sandbox.util.load(this.options.url).then(this.render.bind(this)).fail(function(data){this.sandbox.logger.log('data could not be loaded:',data);}.bind(this));}else if(!!this.options.data){this.render((this.options.data));}else{this.sandbox.logger.log('no data provided for tabs!');}
bindDOMEvents.call(this);bindCustomEvents.call(this);},render:function(data){this.numVisible=data.length;this.options.data=data;this.data=this.sandbox.util.extend(true,[],this.options.data);this.sandbox.dom.addClass(this.$el,'column-options-parent');this.$list=this.sandbox.dom.createElement('<ul class="column-options-list" />');renderItems.call(this);this.sandbox.dom.sortable(this.$list,{handle:'.move'});startOverlay.call(this);this.sandbox.emit(INITIALIZED.call(this));},rerender:function(){this.data=this.sandbox.util.extend(true,[],this.options.data);this.sandbox.dom.html(this.$list,'');renderItems.call(this);this.sandbox.dom.sortable(this.$list,{handle:'.move'});}};});define('husky_components/datagrid/decorators/table-view',[],function(){'use strict';var defaults={editable:false,removeRow:false,selectItem:{type:'checkbox',inFirstCell:false},noItemsText:'This list is empty',addRowTop:true,excludeFields:[''],cssClass:'',thumbnailFormat:'50x50',showHead:true,hideChildrenAtBeginning:true,openChildId:null,highlightSelected:false,icons:[],cssClasses:[],removeIcon:'trash-o',emptyIcon:'fa-coffee',noImgIcon:'fa-coffee',actionIcon:'pencil',actionIconColumn:null,croppedMaxLength:35,openPathToSelectedChildren:true,cropContents:true},constants={selectedRowClass:'selected',isSelectableClass:'is-selectable',sortableClass:'is-sortable',skeletonClass:'husky-table',containerClass:'table-container',overflowClass:'overflow',emptyListElementClass:'empty-list',rowRemoverClass:'row-remover',checkboxClass:'checkbox',radioClass:'radio',cellFitClass:'fit',tableClass:'table',rowClass:'row',thumbSrcKey:'url',thumbAltKey:'alt',evenClass:'even',oddClass:'odd',headerCellClass:'header-cell',ascSortedClass:'sorted-asc',descSortedClass:'sorted-desc',headerCellLoaderClass:'header-loader',headerLoadingClass:'is-loading',editableItemClass:'editable',editableInputClass:'editable- input',inputWrapperClass:'input-wrapper',editedErrorClass:'server-validation-error',newRecordId:'newrecord',gridIconClass:'grid-icon',gridBadgeClass:'badge',gridImageClass:'grid-image',childWrapperClass:'child-wrapper',parentClass:'children-toggler',noChildrenClass:'no-children',toggleIconClass:'toggle-icon',collapsedIcon:'fa-caret-right',expandedIcon:'fa-caret-down',checkboxCellClass:'checkbox-cell',thumbnailCellClass:'thumbnail-cell',textContainerClass:'cell-content',renderingClass:'rendering',actionClass:'has-action',inactiveClass:'inactive',childIndent:28},selectItems={CHECKBOX:'checkbox',RADIO:'radio'},templates={skeleton:['<div class="'+constants.skeletonClass+'">','   <div class="'+constants.containerClass+'"></div>','</div>'].join(''),table:'<table class="'+constants.tableClass+'"></table>',header:'<thead></thead>',body:'<tbody></tbody>',row:'<tr class="'+constants.rowClass+'"></tr>',headerCell:'<th class="'+constants.headerCellClass+'"></th>',cell:'<td></td>',textContainer:'<span class="'+constants.textContainerClass+'"><%= content %></span>',headerCellLoader:'<div class="'+constants.headerCellLoaderClass+'"></div>',removeCellContent:'<span class="fa-<%= icon %> '+constants.rowRemoverClass+'"></span>',editableCellContent:['<span class="'+constants.editableItemClass+'"><%= value %></span>','<div class="'+constants.inputWrapperClass+'">','   <input type="text" class="form-element husky-validate '+constants.editableInputClass+'" value="<%= value %>">','</div>'].join(''),img:['<div class="'+constants.gridImageClass+'">','   <img alt="<%= alt %>" src="<%= src %>"/>','   <div class="<%= noImgIcon %> empty"></div>','</div>'].join(''),childWrapper:'<div class="'+constants.childWrapperClass+'"></div>',toggleIcon:'<span class="'+constants.toggleIconClass+'"></span>',icon:['<span class="',constants.gridIconClass,' <%= cssClass %> <%= align %>" data-icon-index="<%= index %>">','   <span class="fa-<%= icon %>"></span>','</span>'].join(''),badge:['<span class="'+constants.gridBadgeClass+' <%= cssClass %>">','   <% if(!!icon) { %><span class="fa-<%= icon %>"></span><% } %>','   <% if(!!title) { %><%= title %><% } %>','</span> '].join(''),checkbox:['<div class="custom-checkbox">','   <input class="'+constants.checkboxClass+'" type="checkbox" data-form="false"/>','   <span class="icon"></span>','</div>'].join(''),radio:['<div class="custom-radio">','    <input class="'+constants.radioClass+'" name="<%= name %>" type="radio" data-form="false"/>','    <span class="icon"></span>','</div>'].join(''),empty:['<div class="'+constants.emptyListElementClass+'">','   <div class="<%= emptyIcon %> icon"></div>','   <span><%= text %></span>','</div>'].join('')},UPDATE_TABLE=function(){return this.datagrid.createEventName.call(this.datagrid,'update.table');},OPEN_PARENTS=function(){return this.datagrid.createEventName.call(this.datagrid,'table.open-parents');},RADIO_SELECTED=function(){return this.datagrid.createEventName.call(this.datagrid,'radio.selected');},CHILDREN_COLLAPSED=function(){return this.datagrid.createEventName.call(this.datagrid,'children.collapsed');},CHILDREN_EXPANDED=function(){return this.datagrid.createEventName.call(this.datagrid,'children.expanded');};return{initialize:function(context,options){this.datagrid=context;this.keys={id:this.datagrid.options.idKey};this.sandbox=this.datagrid.sandbox;this.options=this.sandbox.util.extend(true,{},defaults,options);this.editStatuses={};this.bindCustomEvents();this.setVariables();},bindCustomEvents:function(){this.sandbox.on(UPDATE_TABLE.call(this),this.onResize.bind(this));this.sandbox.on(OPEN_PARENTS.call(this),this.openParents.bind(this));if(!!this.options.openPathToSelectedChildren){var eventName='';if(!!this.datagrid.options.instanceName){eventName='husky.datagrid.'+this.datagrid.options.instanceName+'.view.rendered';}else{eventName='husky.datagrid.view.rendered';}
this.sandbox.on(eventName,this.openPathToSelectedChildren.bind(this));}},openPathToSelectedChildren:function(){this.sandbox.util.each(this.datagrid.selectedItems,function(idx,id){this.openParents(id);}.bind(this));},unbindCustomEvents:function(){this.sandbox.off(UPDATE_TABLE.call(this),this.onResize.bind(this));this.sandbox.off(OPEN_PARENTS.call(this),this.openParents.bind(this));},render:function(data,$container){this.$el=this.sandbox.dom.createElement(templates.skeleton);this.sandbox.dom.append($container,this.$el);this.addViewClasses();this.addActionIcon();this.data=data;this.renderTable();this.bindDomEvents();if(this.datagrid.options.resizeListeners===true){this.onResize();}
if(!!this.options.openChildId){this.openParents(this.options.openChildId);this.options.openChildId=null;}
this.renderChildrenHidden=false;this.sandbox.dom.removeClass(this.$el,constants.renderingClass);this.rendered=true;},destroy:function(){this.sandbox.stop(this.sandbox.dom.find('*',this.$el));this.sandbox.dom.remove(this.$el);this.setVariables();},addRecord:function(record,appendAtBottom){var prepend=(!!appendAtBottom)?false:this.options.addRowTop;this.removeEmptyIndicator();this.renderBodyRow(record,prepend);this.setAlternateClasses();},removeRecord:function(recordId){this.datagrid.removeRecord.call(this.datagrid,recordId);this.sandbox.dom.remove(this.table.rows[recordId].$el);delete this.table.rows[recordId];if(Object.keys(this.table.rows).length===0){this.toggleSelectAllItem(false);this.renderEmptyIndicator();}},onResize:function(){if(this.containerIsOverflown()===true){this.overflowHandler();}else{this.underflowHandler();}},setVariables:function(){this.rendered=false;this.$el=null;this.table={};this.data=null;this.rowClicked={};this.isFocusoutHandlerEnabled=this.options.editable===true||this.options.editable==='true';this.renderChildrenHidden=this.options.hideChildrenAtBeginning;this.tableCropped=false;this.cropBreakPoint=null;this.icons=this.sandbox.util.extend(true,[],this.options.icons);this.badges=this.sandbox.util.extend(true,[],this.options.badges);this.cssClasses=this.sandbox.util.extend(true,[],this.options.cssClasses);},addViewClasses:function(){this.sandbox.dom.addClass(this.$el,this.options.cssClass);this.sandbox.dom.addClass(this.$el,constants.renderingClass);if((this.options.highlightSelected===true||!!this.options.selectItem)&&this.opt ions.editable!==true){this.sandbox.dom.addClass(this.$el,constants.isSelectableClass);}},addActionIcon:function(){if(typeof this.datagrid.options.actionCallback==='function'&&!!this.datagrid.matchings&&this.datagrid.matchings.length>0){this.icons.push({icon:this.options.actionIcon,column:this.options.actionIconColumn||this.datagrid.matchings[0].attribute,align:'left',callback:this.datagrid.options.actionCallback,actionIcon:true});}},renderTable:function(){this.table.$el=this.sandbox.dom.createElement(templates.table);this.table.$container=this.sandbox.dom.find('.'+constants.containerClass,this.$el);if(this.options.showHead===true){this.renderHeader();}
this.renderBody();this.sandbox.dom.append(this.table.$container,this.table.$el);this.setAlternateClasses();},renderHeader:function(){this.table.header={};this.table.header.$el=this.sandbox.dom.createElement(templates.header);this.table.header.$row=this.sandbox.dom.createElement(templates.row);this.sandbox.dom.append(this.table.header.$el,this.table.header.$row);this.renderHeaderSelectItem();this.renderHeaderCells();this.renderHeaderRemoveItem();this.sandbox.dom.append(this.table.$el,this.table.header.$el);},renderHeaderSelectItem:function(){if(!!this.options.selectItem&&!!this.options.selectItem.type){var $cell=this.sandbox.dom.createElement(templates.headerCell);this.sandbox.dom.addClass($cell,constants.checkboxCellClass);if(this.options.selectItem.type===selectItems.CHECKBOX){this.sandbox.dom.html($cell,templates.checkbox);}
this.sandbox.dom.prepend(this.table.header.$row,$cell);}},renderHeaderCells:function(){var $headerCell;this.table.header.cells={};this.sandbox.util.foreach(this.datagrid.matchings,function(column){$headerCell=this.sandbox.dom.createElement(templates.headerCell);if(!!column.class&&typeof column.class==='string'){this.sandbox.dom.addClass($headerCell,column.class);}
this.sandbox.dom.html($headerCell,this.sandbox.util.template(templates.textContainer)({content:this.sandbox.translate(column.content)}));this.sandbox.dom.data($headerCell,'attribute',column.attribute);this.table.header.cells[column.attribute]={$el:$headerCell,sortable:column.sortable};this.sandbox.dom.append(this.table.header.$row,this.table.header.cells[column.attribute].$el);this.setHeaderCellClasses(column.attribute);}.bind(this));},setHeaderCellClasses:function(column){if(this.datagrid.options.sortable===true){var $element=this.table.header.cells[column].$el,sortedClass;if(this.table.header.cells[column].sortable===true){this.sandbox.dom.addClass($element,constants.sortableClass);if(column===this.datagrid.sort.attribute){sortedClass=(this.datagrid.sort.direction==='asc')?constants.ascSortedClass:constants.descSortedClass;this.sandbox.dom.addClass($element,sortedClass);}}}},renderHeaderRemoveItem:function(){if(this.options.removeRow===true){var $cell=this.sandbox.dom.createElement(templates.headerCell);this.sandbox.dom.addClass($cell,constants.cellFitClass);this.sandbox.dom.append(this.table.header.$row,$cell);}},renderBody:function(){this.table.$body=this.sandbox.dom.createElement(templates.body);this.table.rows={};if(this.data.embedded.length>0){this.sandbox.util.foreach(this.data.embedded,function(record){this.renderBodyRow(record);}.bind(this));}else{this.renderEmptyIndicator();}
this.sandbox.dom.append(this.table.$el,this.table.$body);},renderRowSelectItem:function(id,norender){if(this.datagrid.options.onlySelectLeaves===true&&!!this.table.rows[id].hasChildren){return'';}
if(!!this.options.selectItem&&!!this.options.selectItem.type&&(this.options.selectItem.inFirstCell===false||norender===true)){var $cell=this.sandbox.dom.createElement(templates.cell);this.sandbox.dom.addClass($cell,constants.cellFitClass);if(this.options.selectItem.type===selectItems.CHECKBOX){this.sandbox.dom.html($cell,templates.checkbox);}else if(this.options.selectItem.type===selectItems.RADIO){this.sandbox.dom.html($cell,this.sandbox.util.template(templates.radio)({name:'datagrid-'+this.datagrid.options.instanceName}));}
if(norender===true){return this.sandbox.dom.html($cell);}
this.sandbox.dom.addClass($cell,constants.checkboxCellClass);this.sandbox.dom.prepend(this.table.rows[id].$el,$cell);}},renderBodyRow:function(record,prepend){this.removeNewRecordRow();var $row=this.sandbox.dom.createElement(templates.row),$overrideElement=(!!this.table.rows[record.id])?this.table.rows[record.id].$el:null,hasParent=this.hasParent(record);record.id=(!!record[this.keys.id])?record[this.keys.id]:constants.newRecordId;this.sandbox.dom.data($row,'id',record.id);if(hasParent){if(!this.table.rows[record.parent]){this.renderBodyRow(this.data.embedded[this.datagrid.getRecordIndexById(record.parent)],prepend);}
this.table.rows[record.parent].childrenLoaded=true;}
this.table.rows[record.id]={$el:$row,cells:{},childrenLoaded:!!this.table.rows[record.id]?this.table.rows[record.id].childrenLoaded:false,childrenExpanded:false,parent:hasParent?record.parent:null,hasChildren:(!!record[this.datagrid.options.childrenPropertyName])?record[this.datagrid.options.childrenPropertyName]:false,selectedChildren:0,level:1};if(typeof this.datagrid.options.clickCallback==='function'||typeof this.datagrid.options.actionCallback==='function'||this.table.rows[record.id].hasChildren===true){this.sandbox.dom.addClass($row,constants.actionClass);}
if(typeof this.datagrid.options.clickCallback!=='function'&&this.table.rows[record.id].hasChildren===false){this.sandbox.dom.addClass($row,constants.inactiveClass);}
this.renderRowSelectItem(record.id);this.renderBodyCellsForRow(record);this.renderRowRemoveItem(record.id);this.insertBodyRow(record,$overrideElement,prepend);this.executeRowPostRenderActions(record);},insertBodyRow:function(record,$overrideElement,prepend){var $parentElement=(!!this.table.rows[record.parent])?this.table.rows[record.parent].$el:null,insertMethod=(prepend===true)?this.sandbox.dom.prepend:this.sandbox.dom.append;if(!!$overrideElement&&!!$overrideElement.length){this.sandbox.dom.after($overrideElement,this.table.rows[record.id].$el);this.sandbox.dom.remove($overrideElement);}else if(!!$parentElement&&!!$parentElement.length){if(this.renderChildrenHidden===true){this.sandbox.dom.hide(this.table.rows[record.id].$el);this.changeChildrenToggleIcon(record.parent,false);}else{this.table.rows[record.parent].childrenExpanded=true;this.changeChildrenToggleIcon(record.parent,true);}
this.sandbox.dom.after($parentElement,this.table.rows[record.id].$el);}else{insertMethod(this.table.$body,this.table.rows[record.id].$el);}},executeRowPostRenderActions:function(record){if(!!this.datagrid.itemIsSelected.call(this.datagrid,record.id)){this.toggleSelectRecord(record.id,true);}else{this.toggleSelectAllItem(false);}
if(this.options.editable===true&&record.id===constants.newRecordId){this.showInput(record.id);}},renderBodyCellsForRow:function(record){this.sandbox.util.foreach(this.datagrid.matchings,function(column,index){if(this.options.excludeFields.indexOf(column.attribute)===-1){this.renderBodyCell(record,column,index);}}.bind(this));},renderRowRemoveItem:function(id){if(this.options.removeRow===true){var $cell=this.sandbox.dom.createElement(templates.cell);this.sandbox.dom.html($cell,this.sandbox.util.template(templates.removeCellContent)({icon:this.options.removeIcon}));this.sandbox.dom.addClass($cell,constants.cellFitClass);this.sandbox.dom.append(this.table.rows[id].$el,$cell);}},renderBodyCell:function(record,column,index){var $cell=this.sandbox.dom.createElement(templates.cell),content=this.getCellContent(record,column,$cell),selectItem,isCroppable=false;if(!!this.datagrid.options.childrenPropertyName&&index===0){content=this.wrapChildrenCellContent(content,record);}
if(!!this.options.selectItem&&this.options.selectItem.inFirstCell===true&&index===0){this.sandbox.dom.attr($cell,'colspan',2);selectItem=this.renderRowSelectItem(record.id,true);if(typeof content==='string'){content=selectItem+content;}else{this.sandbox.dom.prepend(content,selectItem);}}
if(!!column.class&&typeof column.class==='string'){this.sandbox.dom.addClass($cell,column.class);}
if(column.type===this.datagrid.types.THUMBNAILS){this.sandbox.dom.addClass($cell,constants.thumbnailCellClass);this.sandbox.dom.addClass($cell,constants.cellFitClass);}
this.sandbox.dom.html($cell,content);this.sandbox.dom.data($cell,'attribute',column.attribute);if(!!this.sandbox.dom.find('.'+constants.textContainerClass,$cell).length&&this.sandbox.dom.children(this.sandbox.dom.find('.'+constants.textContainerClass,$cell)).length===0){isCroppable=true;}
this.table.rows[record.id].cells[column.attribute]={$el:$cell,originalData:record[column.attribute],originalContent:this.sandbox.dom.html(content),editable:!!column.editable,croppable:isCroppable};this.sandbox.dom.append(this.table.rows[record.id].$el,this.table.rows[record.id].cells[column.attribute].$el);},getCellContent:function(record,column,$cell){var content=record[column.attribute];if(!!column.type&&column.type===this.datagrid.types.THUMBNAILS){content=this.datagrid.manipulateContent(content,column.type,this.options.thumbnailFormat);content=this.sandbox.util.template(templates.img)({alt:content[constants.thumbAltKey],src:content[constants.thumbSrcKey],noImgIcon:typeof this.options.noImgIcon==='function'?this.options.noImgIcon(record):this.options.noImgIcon});}else{content=this.datagrid.processContentFilter(column.attribute,content,column.type,Object.keys(this.table.rows).length,record.hasOwnProperty('id')?record.id:null);}
if(this.options.editable===true&&column.editable===true){content=this.getEditableCellContent(content);}else{content=this.sandbox.util.template(templates.textContainer)({content:content});}
if(!!this.icons){content=this.addIconsToCellContent(content,column,$cell,record);}
if(!!this.badges){content=this.addBadgesToCellContent(content,column,record);}
if(!!this.cssClasses){content=this.addCssClassesToCellContent(content,column,record);}
return content;},wrapChildrenCellContent:function(content,record){var $wrappedContent=this.sandbox.dom.createElement(templates.childWrapper),$icon,paddingLeft=0;if(!!record[this.datagrid.options.childrenPropertyName]){this.sandbox.dom.addClass($wrappedContent,constants.parentClass);$icon=this.sandbox.dom.createElement(templates.toggleIcon);this.sandbox.dom.prependClass($icon,constants.collapsedIcon);this.sandbox.dom.prepend($wrappedContent,$icon);}else{this.sandbox.dom.addClass($wrappedContent,constants.noChildrenClass);}
if(this.hasParent(record)){this.table.rows[record.id].level=this.table.rows[record.parent].level+1;paddingLeft=constants.childIndent*(this.table.rows[record.id].level-1);}
if(this.datagrid.options.onlySelectLeaves==true&&this.table.rows[record.id].hasChildren==true){paddingLeft+=40;}
if(!!paddingLeft){this.sandbox.dom.css($wrappedContent,{'padding-left':paddingLeft+'px'});}
this.sandbox.dom.append($wrappedContent,content);return $wrappedContent;},hasParent:function(record){return(!!record.parent&&!!this.data.embedded[this.datagrid.getRecordIndexById(record.parent)]);},getEditableCellContent:function(content){return this.sandbox.util.template(templates.editableCellContent)({value:content});},addIconsToCellContent:function(content,column,$cell,record){var iconStr;this.sandbox.util.foreach(this.icons,function(icon,index){if(icon.column===column.attribute&&(!icon.disableCallback||icon.disableCallback(record))){iconStr=this.sandbox.util.template(templates.icon)({icon:icon.icon,align:icon.align,cssClass:icon.cssClass,index:index});if(typeof content==='object'){this.sandbox.dom.append(content,iconStr);}else if(typeof content==='string'){content+=iconStr;}
if(icon.actionIcon===true){this.sandbox.dom.addClass($cell,constants.actionClass);}}}.bind(this));return content;},addBadgesToCellContent:function(content,column,record){var badgeStr;this.sandbox.util.foreach(this.badges,function(badge){if(badge.column===column.attribute){if(!!badge.callback){badge=badge.callback(record,badge);}
if(!badge){return;}
badgeStr=this.sandbox.util.template(templates.badge)(this.sandbox.util.extend(true,{cssClass:null,title:null,icon:null},badge));if(typeof content==='object'){this.sandbox.dom.prepend(content,badgeStr);}else if(typeof content==='string'){content=badgeStr+content;}}}.bind(this));return content;},addCssClassesToCellContent:function(content,column,record){this.sandbox.util.foreach(this.cssClasses,function(cssClass){if(cssClass.column===column.attribute){if(!!cssClass.callback){cssClass=cssClass.callback(record,cssClass);}
if(!cssClass){return;}
if(typeof content==='object'){$(content).wrap(['<span class="',cssClass,'" />'].join(''));}else if(typeof content==='string'){content=['<span class="',cssClass,'">',content,"</span>"].join('');}}}.bind(this));return content;},renderEmptyIndicator:function(){this.sandbox.dom.append(this.$el,this.sandbox.util.template(templates.empty)({text:this.sandbox.translate(this.options.noItemsText),emptyIcon:this.options.emptyIcon}));},removeNewRecordRow:function(){if(!!this.table.rows[constants.newRecordId]){this.sandbox.dom.remove(this.table.rows[constants.newRecordId].$el);delete this.table.rows[constants.newRecordId];}},containerIsOverflown:function(){if(!this.table.$container){return false;}
return this.sandbox.dom.get(this.table.$container,0).scrollWidth>this.sandbox.dom.width(this.table.$container);},overflowHandler:function(){if(!!this.options.cropContents){this.toggleCropTable(true);}
if(this.containerIsOverflown()===true){this.sandbox.dom.addClass(this.$el,constants.overflowClass);}},underflowHandler:function(){if(this.tableCropped===true){if(!!this.options.cropContents&&this.sandbox.dom.width(this.table.$container)>this.cropBreakPoint){this.toggleCropTable(false);}
if(this.containerIsOverflown()===false){this.sandbox.dom.removeClass(this.$el,constants.overflowClass);}}},toggleCropTable:function(crop){if(this.tableCropped!==crop){var $contentContainer,content;this.sandbox.util.each(this.table.rows,function(rowId,row){this.sandbox.util.each(row.cells,function(cellId,cell){if(cell.croppable===true){$contentContainer=this.sandbox.dom.find('.'+constants.textContainerClass,cell.$el);if(crop===true){content=this.sandbox.util.cropMiddle(cell.originalContent,this.options.croppedMaxLength);this.sandbox.dom.attr($contentContainer,'title',cell.originalContent);this.tableCropped=true;this.cropBreakPoint=this.sandbox.dom.width(this.table.$container);}else{content=cell.originalContent;this.sandbox.dom.removeAttr($contentContainer,'title');this.tableCropped=false;}
this.sandbox.dom.html($contentContainer,content);}}.bind(this));}.bind(this));}},bindDomEvents:function(){this.sandbox.dom.on(this.table.$body,'click',this.selectItemChangeHandler.bind(this),'.'+constants.checkboxClass+', .'+constants.radioClass);this.sandbox.dom.on(this.table.$body,'click',this.bodyRowClickHandler.bind(this),'.'+constants.rowClass);this.sandbox.dom.on(this.table.$body,'dblclick',this.bodyRowDblClickHandler.bind(this),'.'+constants.rowClass);this.sandbox.dom.on(this.table.$body,'click',this.cellActionCallback.bind(this),'td.'+constants.actionClass);if(this.options.removeRow===true){this.sandbox.dom.on(this.table.$body,'click',this.removeItemClickHandler.bind(this),'.'+constants.rowRemoverClass);}
if(!!this.table.header){this.sandbox.dom.on(this.table.header.$el,'change',this.allSelectItemChangeHandler.bind(this));if(this.datagrid.options.sortable===true){this.sandbox.dom.on(this.table.header.$el,'click',this.sortItemClickHandler.bind(this),'.'+constants.headerCellClass+'.'+constants.sortableClass);}}
if(this.options.editable===true){this.sandbox.dom.on(this.table.$body,'click',this.editableItemClickHandler.bind(this),'.'+constants.editableItemClass);this.sandbox.dom.on(this.table.$body,'focusout',this.editableInputFocusoutHandler.bind(this),'.'+constants.editableInputClass);this.sandbox.dom.on(this.table.$body,'keydown',this.editableInputKeyHandler.bind(this),'.'+constants.editableInputClass);}
if(!!this.icons){this.sandbox.dom.on(this.table.$body,'click',this.iconClickHandler.bind(this),'.'+constants.gridIconClass);}
this.sandbox.dom.on(this.table.$body.find('img'),'error',function(){$(this).remove();});this.sandbox.dom.on(this.table.$body.find('img'),'load',function(){$(this).parent().find('.fa-coffee').remove();});this.sandbox.dom.on(this.table.$body,'click',this.radioButtonClickHandler.bind(this),'input[type="radio"]');},radioButtonClickHandler:function(event){this.sandbox.dom.stopPropagation(event);var recordId=this.sandbox.dom.data(this.sandbox.dom.parents(event.currentTarget,'.'+constants.rowClass),'id'),attribute=this.sandbox.dom.data(this.sandbox.dom.parents(event.currentTarget,'td'),'attribute');this.sandbox.emit(RADIO_SELECTED.call(this),recordId,attribute);},iconClickHandler:function(event){var icon=this.icons[this.sandbox.dom.data(event.currentTarget,'icon-index')],recordId=this.sandbox.dom.data(this.sandbox.dom.parents(event.currentTarget,'.'+constants.rowClass),'id');if(typeof recordId!=='undefined'&&!!icon&&typeof icon.callback==='function'){event.stopPropagation();icon.callback(recordId,this.datagrid.getRecordById(recordId));}},sortItemClickHandler:function(event){this.sandbox.dom.stopPropagation(event);if(this.sandbox.dom.hasClass(event.currentTarget,constants.headerLoadingClass)){return false;}
var attribute=this.sandbox.dom.data(event.currentTarget,'attribute'),direction='asc';if(this.datagrid.sort.attribute===attribute&&this.datagrid.sort.direction===direction){direction='desc';}
this.startHeaderCellLoader(attribute);this.datagrid.sortGrid.call(this.datagrid,attribute,direction);},editableItemClickHandler:function(event){this.sandbox.dom.stopPropagation(event);var recordId=this.sandbox.dom.data(this.sandbox.dom.parents(event.currentTarget,'.'+constants.rowClass),'id'),attribute=this.sandbox.dom.data(this.sandbox.dom.parents(event.currentTarget,'td'),'attribute');this.showInput(recordId,attribute);},showInput:function(recordId,attribute){var $cell,$inputs,$inputField,$inputWrapper;if(!attribute){$inputs=this.sandbox.dom.find('.'+constants.editableInputClass,this.table.rows[recordId].$el);attribute=this.sandbox.dom.data(this.sandbox.dom.parents($inputs[0],'td'),'attribute');}
$cell=this.table.rows[recordId].cells[attribute].$el;$inputField=this.sandbox.dom.find('.'+constants.editableInputClass,$cell);$inputWrapper=this.sandbox.dom.find('.'+constants.inputWrapperClass,$cell);this.sandbox.dom.show($inputWrapper);this.sandbox.dom.focus($inputField);this.sandbox.dom.select($inputField);this.editStatuses[recordId]=true;},editableInputKeyHandler:function(event){this.removeEditedErrorCallback($(event.currentTarget).parents('.'+constants.rowClass).data('id'));if(event.keyCode===13){this.editableInputEventHandler(event);}},editableInputFocusoutHandler:function(event){if(!!this.isFocusoutHandlerEnabled){this.editableInputEventHandler(event);}},editableInputEventHandler:function(event){this.sandbox.dom.stopPropagation(event);var $parent=this.sandbox.dom.parents(event.currentTarget,'.'+constants.rowClass),recordId=this.sandbox.dom.data($parent,'id');if(!!this.editStatuses[recordId]){this.editRow(recordId);}
this.editStatuses[recordId]=false;},editRow:function(recordId){var modifiedRecord={};this.sandbox.util.each(this.table.rows[recordId].cells,function(attribute,cell){if(!!this.sandbox.dom.find('.'+constants.editableInputClass,cell.$el).length){modifiedRecord[attribute]=this.sandbox.dom.val(this.sandbox.dom.find('.'+constants.editableInputClass,cell.$el));}}.bind(this));this.saveRow(recordId,modifiedRecord,this.editedSuccessCallback.bind(this),this.editedErrorCallback.bind(this,recordId));},editedSuccessCallback:function(record){var $row;if(!!record.id&&!!this.table.rows[record.id]){$row=this.table.rows[record.id].$el;}else if(!!this.table.rows[constants.newRecordId]){$row=this.table.rows[constants.newRecordId].$el;}
if(!!$row&&!!$row.length){this.sandbox.dom.hide(this.sandbox.dom.find('.'+constants.inputWrapperClass,$row));this.renderBodyRow(record,this.options.addRowTop);}},editedErrorCallback:function(recordId){var $row=this.table.rows[recordId].$el;this.sandbox.dom.addClass(this.sandbox.dom.find('.'+constants.inputWrapperClass,$row),constants.editedErrorClass);},removeEditedErrorCallback:function(recordId){var $row=this.table.rows[recordId].$el;$row.find('.'+constants.inputWrapperClass).removeClass(constants.editedErrorClass);this.editStatuses[recordId]=true;},saveRow:function(recordId,newRecordData,successCallback,errorCallback){var hasChanged=false,record;this.sandbox.util.each(this.table.rows[recordId].cells,function(attribute,cell){if(cell.editable===true&&cell.originalData!==newRecordData[attribute]){hasChanged=true;}}.bind(this));record=this.sandbox.util.extend(true,{},this.data.embedded[this.datagrid.getRecordIndexById(recordId)],newRecordData);if(recordId===constants.newRecordId){delete record.id;}
if(hasChanged===true){this.datagrid.saveGrid.call(this.datagrid,record,this.datagrid.getUrlWithoutParams.call(this.datagrid),successCallback,errorCallback,this.options.addRowTop);}else{typeof successCallback==='function'&&successCallback(record);}},startHeaderCellLoader:function(column){var $container=this.sandbox.dom.createElement(templates.headerCellLoader);this.sandbox.dom.addClass(this.table.header.cells[column].$el,constants.headerLoadingClass);this.sandbox.dom.append(this.sandbox.dom.find('.'+constants.textContainerClass,this.table.header.cells[column].$el),$container);this.sandbox.start([{name:'loader@husky',options:{el:$container,size:'10px',color:'#999999'}}]);},bodyRowClickHandler:function(event){this.sandbox.dom.stopPropagation(event);var recordId=this.sandbox.dom.data(event.currentTarget,'id');if(!!recordId&&!!this.table.rows&&!!this.table.rows[recordId]){if(!!this.table.rows[recordId].hasChildren){this.toggleChildren(recordId);}}
this.rowClickCallback(event);},bodyRowDblClickHandler:function(event){this.sandbox.dom.stopPropagation(event);this.rowActionCallback(event);},rowClickCallback:function(event){var recordId=this.sandbox.dom.data(event.currentTarget,'id');if(!this.rowClicked[recordId]){this.rowClicked[recordId]=true;this.datagrid.itemClicked.call(this.datagrid,recordId);this.sandbox.util.delay(function(){this.rowClicked[recordId]=false;}.bind(this),500);}},rowActionCallback:function(event){var recordId=this.sandbox.dom.data(event.currentTarget,'id');this.datagrid.itemAction.call(this.datagrid,recordId);},cellActionCallback:function(event){var recordId=this.sandbox.dom.data(this.sandbox.dom.parent(event.currentTarget),'id');if(!!this.table.rows[recordId]&&!this.table.rows[recordId].hasChildren){this.datagrid.itemAction.call(this.datagrid,recordId);}},removeItemClickHandler:function(event){this.sandbox.dom.stopPropagation(event);var recordId=this.sandbox.dom.data(this.sandbox.dom.parents(event.currentTarget,'.'+constants.rowClass),'id');this.removeRecord(recordId);},selectItemChangeHandler:function(event){if(!!event.type){this.sandbox.dom.stopPropagation(event);}
var recordId=this.sandbox.dom.data(this.sandbox.dom.parents(event.target,'.'+constants.rowClass),'id'),isChecked=this.sandbox.dom.is(event.target,':checked');if(this.options.selectItem.type===selectItems.CHECKBOX){this.toggleSelectRecord(recordId,isChecked);}else if(this.options.selectItem.type===selectItems.RADIO){this.uniqueSelectRecord(recordId);}},allSelectItemChangeHandler:function(event){if(this.data.total==0){this.sandbox.dom.prop(event.target,'checked',false);return false;}
this.sandbox.dom.stopPropagation(event);var isChecked=this.sandbox.dom.is(event.target,':checked');if(isChecked===true){this.selectAllRecords();}else{this.deselectAllRecords();}},selectAllRecords:function(){this.datagrid.selectAllItems.call(this.datagrid);this.sandbox.dom.prop(this.sandbox.dom.find('.'+constants.checkboxClass,this.table.$body),'checked',true);this.sandbox.dom.addClass(this.sandbox.dom.find('.'+constants.rowClass,this.table.$body),constants.selectedRowClass);},deselectAllRecords:function(){this.datagrid.deselectAllItems.call(this.datagrid);this.sandbox.dom.prop(this.sandbox.dom.find('.'+constants.checkboxClass,this.table.$body),'checked',false);this.sandbox.dom.removeClass(this.sandbox.dom.find('.'+constants.rowClass,this.table.$body),constants.selectedRowClass);this.updateSelectAll();},selectRecord:function(recordId){this.toggleSelectRecord(recordId,true);},deselectRecord:function(recordId){this.toggleSelectRecord(recordId,false);},toggleSelectRecord:function(id,select){if(select===true){this.datagrid.setItemSe lected.call(this.datagrid,id);this.sandbox.dom.prop(this.sandbox.dom.find('.'+constants.checkboxClass,this.table.rows[id].$el),'checked',true);this.sandbox.dom.addClass(this.table.rows[id].$el,constants.selectedRowClass);this.indeterminateSelectParents(id);}else{this.datagrid.setItemUnselected.call(this.datagrid,id);this.sandbox.dom.prop(this.sandbox.dom.find('.'+constants.checkboxClass,this.table.rows[id].$el),'checked',false);if(this.table.rows[id].selectedChildren>0){this.sandbox.dom.prop(this.sandbox.dom.find('.'+constants.checkboxClass,this.table.rows[id].$el),'indeterminate',true);}
this.sandbox.dom.removeClass(this.table.rows[id].$el,constants.selectedRowClass);this.indeterminateUnselectParents(id);}
this.updateSelectAll();},toggleSelectAllItem:function(select){if(!!this.table.header){this.sandbox.dom.prop(this.sandbox.dom.find('.'+constants.checkboxClass,this.table.header.$el),'checked',select);}},updateSelectAll:function(){if(!!this.table.header){this.toggleSelectAllItem(this.datagrid.getSelectedItemIds.call(this.datagrid).length===this.data.embedded.length);}},uniqueSelectRecord:function(id){this.datagrid.deselectAllItems.call(this.datagrid);this.datagrid.setItemSelected.call(this.datagrid,id);},removeEmptyIndicator:function(){this.sandbox.dom.remove(this.sandbox.dom.find('.'+constants.emptyListElementClass,this.$el));},changeChildrenToggleIcon:function(recordId,isExpanded){var $icon=this.sandbox.dom.find('.'+constants.toggleIconClass,this.table.rows[recordId].$el);if(!!$icon&&!!$icon.length){if(isExpanded===true){this.sandbox.dom.removeClass($icon,constants.collapsedIcon);this.sandbox.dom.prependClass($icon,constants.expandedIcon);}else{this.sandbox.dom.removeClass($icon,constants.expandedIcon);this.sandbox.dom.prependClass($icon,constants.collapsedIcon);}}},toggleChildren:function(recordId){if(this.table.rows[recordId].childrenLoaded===true){if(this.table.rows[recordId].childrenExpanded===true){this.hideChildren(recordId);this.sandbox.emit(CHILDREN_COLLAPSED.call(this));}else{this.showChildren(recordId);this.sandbox.emit(CHILDREN_EXPANDED.call(this));}}else{this.loadChildren(recordId);}},hideChildren:function(recordId){this.sandbox.util.each(this.table.rows,function(rowId,row){if(row.parent==recordId){if(!!row.hasChildren){this.hideChildren(rowId);}
this.sandbox.dom.hide(row.$el);}}.bind(this));this.table.rows[recordId].childrenExpanded=false;this.changeChildrenToggleIcon(recordId,false);this.setAlternateClasses();},showChildren:function(recordId){this.sandbox.util.each(this.table.rows,function(rowId,row){if(row.parent==recordId){this.sandbox.dom.show(row.$el);}}.bind(this));this.table.rows[recordId].childrenExpanded=true;this.changeChildrenToggleIcon(recordId,true);this.setAlternateClasses();},loadChildren:function(recordId){this.datagrid.loadChildren.call(this.datagrid,recordId);this.table.rows[recordId].childrenLoaded=true;},openParents:function(recordId){if(!!this.table.rows[recordId]){var parentId=this.table.rows[recordId].parent;if(!!parentId){if(!!this.table.rows[parentId].parent){this.openParents(parentId);}
this.showChildren(parentId);}}},indeterminateSelectParents:function(recordId){var parentId=this.table.rows[recordId].parent,$checkbox;if(!!parentId){this.table.rows[parentId].selectedChildren+=1;$checkbox=this.table.rows[parentId].$el.find('.'+constants.checkboxClass);if(!$checkbox.prop('checked')){$checkbox.prop('indeterminate',true);}
this.indeterminateSelectParents(parentId);}},indeterminateUnselectParents:function(recordId){var parentId=this.table.rows[recordId].parent,$checkbox;if(!!parentId){this.table.rows[parentId].selectedChildren-=1;$checkbox=this.table.rows[parentId].$el.find('.'+constants.checkboxClass);if(this.table.rows[parentId].selectedChildren===0&&!!$checkbox.prop('indeterminate')){$checkbox.prop('indeterminate',false);}
this.indeterminateUnselectParents(parentId);}},setAlternateClasses:function(){var $rows=this.sandbox.dom.find('.'+constants.rowClass,this.table.$body);this.sandbox.dom.removeClass($rows,constants.evenClass);this.sandbox.dom.removeClass($rows,constants.oddClass);this.sandbox.dom.addClass(this.sandbox.dom.filter($rows,':visible:even'),constants.evenClass);this.sandbox.dom.addClass(this.sandbox.dom.filter($rows,':visible:odd'),constants.oddClass);},collapseAllChildren:function(){for(var i=0,length=this.data.embedded.length;i<length;i++){this.hideChildren(this.data.embedded[i].id);}},showSelected:function(show){var $items=this.datagrid.$find('tbody .row:not(.selected)');if(!!show){$items.hide();}else{$items.show();this.collapseAllChildren();if(!!this.options.openPathToSelectedChildren){this.openPathToSelectedChildren();}}}};});define('husky_components/datagrid/decorators/thumbnail-view',[],function(){'use strict';var defaults={large:false,fadeInDuration:400,largeThumbnailFormat:'170x170',smallThumbnailFormat:'50x50',unselectOnBackgroundClick:true,selectable:true},constants={containerClass:'husky-thumbnails',itemClass:'item',smallClass:'small',largeClass:'large',titleClass:'title',downloadClass:'download',downloadIcon:'cloud-download',checkboxClass:'checkbox',descriptionClass:'description',thumbnailSrcProperty:'url',thumbnailAltProperty:'alt',idProperty:'id',textClass:'text',imageClass:'image',descriptionDelimiter:', ',selectedClass:'is-selected'},templates={item:['<div class="'+constants.itemClass+' <%= styleClass %>">','   <div class="'+constants.imageClass+'">','       <div class="fa-coffee empty"></div>','       <img src="<%= imgSrc %>" alt="<%= imgAlt %>"/>','   </div>','   <div class="'+constants.textClass+'">','       <span class="'+constants.titleClass+'"><%= title %></span><br />','       <span class="'+constants.descriptionClass+'"><%= description %></span>','   </div>','<% if (!!selectable) { %>','   <div class="'+constants.checkboxClass+' custom-checkbox no-spacing">','       <input type="checkbox"<% if (!!checked) { %> checked<% } %>/>','       <span class="icon"></span>','   </div>','<% } %>','   <div class="fa-'+constants.downloadIcon+' '+constants.downloadClass+'"></div>','</div>'].join('')},DOWNLOAD_CLICKED=function(){return this.datagrid.createEventName.call(this.datagrid,'download-clicked');};return{initialize:function(context,options){this.datagrid=context;this.sandbox=this.datagrid.sandbox;this.options=this.sandbox.util.extend(true,{},defaults,options);this.setVariables();},extendOptions:function(options){this.options=this.sandbox.util.extend(true,{},this.options,options);},setVariables:function(){this.rendered=false;this.data=null;this.$el=null;this.thumbnailFormat=null;this.$thumbnails={};},render:function(data,$container){this.$el=this.sandbox.dom.createElement('<div class="'+constants.containerClass+'"/>');this.sandbox.dom.append($container,this.$el);this.data=data;this.renderThumbnails(this.data.embedded);this.sandbox.dom.on('body','click.grid-thumbnails.'+this.datagrid.options.instanceName,function(){if(this.options.unselectOnBackgroundClick){this.unselectAll();}}.bind(this));this.rendered=true;},renderThumbnails:function(thumbnails,appendAtBottom){var imgSrc,imgAlt,title,description,id,thumbnail;this.thumbnailFormat=(this.options.large===false)?this.options.smallThumbnailFormat:this.options.largeThumbnailFormat;this.sandbox.util.foreach(thumbnails,function(record){imgSrc=imgAlt=title='';description=[];this.sandbox.util.foreach(this.datagrid.matchings,function(matching){var argument,result;if(matching.type===this.datagrid.types.THUMBNAILS){argument=this.thumbnailFormat;}
result=this.datagrid.processContentFilter.call(this.datagrid,matching.attribute,record[matching.attribute],matching.type,argument);if(matching.type===this.datagrid.types.THUMBNAILS){imgSrc=result[constants.thumbnailSrcProperty];imgAlt=result[constants.thumbnailAltProperty];}else if(matching.type===this.datagrid.types.TITLE){title=result;}else if(matching.type===this.datagrid.types.BYTES){description.push(result);}}.bind(this));id=record[constants.idProperty];description=description.join(constants.descriptionDelimiter);this.renderThumbnail(id,imgSrc,imgAlt,title,description,record,appendAtBottom);}.bind(this));},renderThumbnail:function(id,imgSrc,imgAlt,title,description,record,appendAtBottom){this.$thumbnails[id]=this.sandbox.dom.createElement(this.sandbox.util.template(templates.item)({imgSrc:imgSrc,imgAlt:imgAlt,title:this.sandbox.util.cropMiddle(String(title),24),description:this.sandbox.util.cropMiddle(String(description),32),styleClass:(this.options.large===true)?constants.largeClass:constants.smallClass,checked:!!this.datagrid.itemIsSelected.call(this.datagrid,record.id),selectable:this.options.selectable}));if(this.datagrid.itemIsSelected.call(this.datagrid,record.id)){this.selectItem(id,true);}
this.sandbox.dom.data(this.$thumbnails[id],'id',id);this.sandbox.dom.hide(this.$thumbnails[id]);if(!!appendAtBottom){this.sandbox.dom.append(this.$el,this.$thumbnails[id]);}else{this.sandbox.dom.prepend(this.$el,this.$thumbnails[id]);}
this.sandbox.dom.fadeIn(this.$thumbnails[id],this.options.fadeInDuration);this.bindThumbnailDomEvents(id);},destroy:function(){this.sandbox.dom.off('body','click.grid-thumbnails.'+this.datagrid.options.instanceName);this.sandbox.dom.remove(this.$el);},bindThumbnailDomEvents:function(id){this.sandbox.dom.on(this.$thumbnails[id],'click',function(event){this.sandbox.dom.stopPropagation(event);if(!!this.options.selectable){this.toggleItemSelected(id);}else{this.selectItem(id);}}.bind(this));this.sandbox.dom.on(this.$thumbnails[id],'click',function(event){this.sandbox.dom.stopPropagation(event);this.downloadHandler(id);}.bind(this),'.'+constants.downloadClass);this.sandbox.dom.on(this.$thumbnails[id].find('img'),'error',function(){this.$thumbnails[id].find('img').remove();}.bind(this));this.sandbox.dom.on(this.$thumbnails[id].find('img'),'load',function(){this.$thumbnails[id].find('.fa-coffee').remove();}.bind(this));if(!!this.options.selectable){this.sandbox.dom.on(this.$thumbnails[id],'d blclick',function(){this.datagrid.itemAction.call(this.datagrid,id);this.selectItem(id);}.bind(this));}},selectRecord:function(recordId){this.selectItem(recordId,false);},deselectAllRecords:function(){this.unselectAll();},toggleItemSelected:function(id){if(this.datagrid.itemIsSelected.call(this.datagrid,id)===true){this.unselectItem(id,false);}else{this.selectItem(id,false);}},selectItem:function(id,onlyView){if(!!this.options.selectable){this.sandbox.dom.addClass(this.$thumbnails[id],constants.selectedClass);if(!this.sandbox.dom.is(this.sandbox.dom.find('input[type="checkbox"]',this.$thumbnails[id]),':checked')){this.sandbox.dom.prop(this.sandbox.dom.find('input[type="checkbox"]',this.$thumbnails[id]),'checked',true);}
if(onlyView!==true){this.datagrid.setItemSelected.call(this.datagrid,id);}}else{this.datagrid.itemAction(id);}},unselectItem:function(id,onlyView){this.sandbox.dom.removeClass(this.$thumbnails[id],constants.selectedClass);if(this.sandbox.dom.is(this.sandbox.dom.find('input[type="checkbox"]',this.$thumbnails[id]),':checked')){this.sandbox.dom.prop(this.sandbox.dom.find('input[type="checkbox"]',this.$thumbnails[id]),'checked',false);}
if(onlyView!==true){this.datagrid.setItemUnselected.call(this.datagrid,id);}},addRecord:function(record,appendAtBottom){this.renderThumbnails([record],appendAtBottom);},downloadHandler:function(id){this.sandbox.emit(DOWNLOAD_CLICKED.call(this),id);},removeRecord:function(recordId){if(!!this.$thumbnails[recordId]){this.sandbox.dom.remove(this.$thumbnails[recordId]);this.datagrid.removeRecord.call(this.datagrid,recordId);return true;}
return false;},unselectAll:function(){this.sandbox.util.each(this.$thumbnails,function(id){this.unselectItem(id,true);}.bind(this));this.datagrid.deselectAllItems.call(this.datagrid);}};});define('husky_components/datagrid/decorators/dropdown-pagination',[],function(){'use strict';var defaults={showElementsSteps:[10,20,50,100,200],limit:20},constants={paginationClass:'pagination-wrapper dropdowns',paginationElementClass:'pagination',prevClass:'previous',nextClass:'next',inputClass:'page-input',pageLabelClass:'page-label',sizeChangeClass:'size-change',loaderClass:'pagination-loader'},templates={pageLabel:['<div class="',constants.pageLabelClass,'">','    <%= translate("pagination.page") %>','    <input type="text" class="form-element ',constants.inputClass,'" value="<%= i %>" />','    <%= translate("pagination.of") %> <%= pages %>','</div>'].join(''),pageChanger:['<span class="inline-block"><%= label %></span>','<div class="',constants.nextClass,' pagination-prev pull-right pointer <%= prevButtonClass %>"></div>','<div class="'+constants.prevClass+' pagination-next pull-right pointer <%= nextButtonClass %>"></div>'].join(''),loader:['<div class="',constants.loaderClass,'"></div>'].join(''),showElements:['<div class="show-elements">','<span class="text"><%= translate(text) %>:</span>','<div class="'+constants.sizeChangeClass+' dropdown-trigger">','<%= desc %>','<span class="dropdown-toggle"></span>','</div>','</div>'].join('')},translations={show:'pagination.show',elementsOf:'pagination.elements-of',elementsPerPage:'pagination.elements-per-page'};return{initialize:function(context,options){this.datagrid=context;this.sandbox=this.datagrid.sandbox;this.options=this.sandbox.util.extend(true,{},defaults,options);this.setVariables();this.bindCustomEvents();},getHeight:function(){return this.sandbox.dom.outerHeight(this.$paginationContainer,true);},render:function(data,$container){this.$el=$container;this.data=data;this.$paginationContainer=this.sandbox.dom.createElement('<div class="'+constants.paginationClass+'"/>');this.preparePagination();this.sandbox.dom.append(this.$el,this.$paginationContainer);this.bindDomEvents();},getLimit:function(){return this.options.limit;},setVariables:function(){this.$el=null;this.$paginationContainer=null;this.data=null;},destroy:function(){this.sandbox.stop(this.sandbox.dom.find('*',this.$paginationContainer));this.unbindDomEvents();this.sandbox.dom.remove(this.$paginationContainer);},bindCustomEvents:function(){this.sandbox.on('husky.dropdown.'+this.datagrid.options.instanceName+'-pagination-dropdown-show.item.click',function(item){if(this.data.limit!==item.id||this.data.embedded.length===this.data.total){this.startLoader();this.datagrid.changePage.call(this.datagrid,null,1,item.id);}}.bind(this));},startLoader:function(){var $container=this.sandbox.dom.createElement(templates.loader);this.sandbox.dom.append(this.$paginationContainer,$container);this.sandbox.start([{name:'loader@husky',options:{el:$container,size:'20px',color:'#999999'}}]);},bindDomEvents:function(){var $element=this.sandbox.dom.find('input.'+constants.inputClass,this.$el),fontSize=parseInt($element.css('font-size'),10),minWidth=parseInt($element.css('min-width'),10),maxWidth=parseInt($element.css('max-width'),10);this.sandbox.dom.on(this.sandbox.dom.find('.'+constants.nextClass,this.$el),'click',this.nextPage.bind(this));this.sandbox.dom.on(this.sandbox.dom.find('.'+constants.prevClass,this.$el),'click',this.prevPage.bind(this));this.sandbox.dom.on($element,'focusout',this.inputHandler.bind(this));this.sandbox.dom.on($element,'keydown',function(){if(event.which===13){this.inputHandler(event);return;}
var width=50+(($element.val().length*fontSize)/ 2);if(width>minWidth&&width<=maxWidth){$element.css({width:width+'px'});}}.bind(this));},inputHandler:function(event){var $element=this.sandbox.dom.find(event.currentTarget),page=parseInt($element.val(),10);if(isNaN(page)){$element.val(this.data.page);return;}
if(page<1){page=1;}
if(page>this.data.pages){page=this.data.pages;}
if(page===this.data.page){$element.val(this.data.page);return;}
this.startLoader();this.datagrid.changePage.call(this.datagrid,null,page);},nextPage:function(){if(!!this.data.links.next){this.startLoader();this.datagrid.changePage.call(this.datagrid,this.data.links.next.href);}},prevPage:function(){if(!!this.data.links.previous){this.startLoader();this.datagrid.changePage.call(this.datagrid,this.data.links.previous.href);}},unbindDomEvents:function(){this.sandbox.dom.unbind(this.sandbox.dom.find('*',this.$paginationContainer));this.sandbox.dom.unbind(this.$paginationContainer);},preparePagination:function(){var $pagination,$showElements,paginationLabel,description;if(this.data.total>this.options.showElementsSteps[0]){description=this.data.embedded.length;$showElements=this.sandbox.dom.createElement(this.sandbox.util.template(templates.showElements)({desc:description,text:translations.elementsPerPage,translate:this.sandbox.translate}));this.sandbox.dom.append(this.$paginationContainer,'<span></span>');this.sandbox.dom.append(this.$paginationContainer,$showElements);this.prepareShowElementsDropdown();}
if(parseInt(this.data.pages,10)>1){$pagination=this.sandbox.dom.createElement('<div/>');$pagination.addClass(constants.paginationElementClass);this.sandbox.dom.append(this.$paginationContainer,$pagination);paginationLabel=this.renderPaginationRow(this.data.page,this.data.pages);this.sandbox.dom.append($pagination,this.sandbox.util.template(templates.pageChanger,{label:paginationLabel,prevButtonClass:(this.data.page<this.data.pages)?'':'disabled',nextButtonClass:(this.data.page>1)?'':'disabled'}));}},renderPaginationRow:function(i,pages){var defaults={translate:this.sandbox.translate,i:i,pages:pages};return this.sandbox.util.template(templates.pageLabel,defaults);},prepareShowElementsDropdown:function(){var i,length,data=[];for(i=-1,length=this.options.showElementsSteps.length;++i<length;){data.push({id:this.options.showElementsSteps[i],name:this.options.showElementsSteps[i]});}
this.sandbox.start([{name:'dropdown@husky',options:{el:this.sandbox.dom.find('.'+constants.sizeChangeClass,this.$paginationContainer),setParentDropDown:true,instanceName:this.datagrid.options.instanceName+'-pagination-dropdown-show',alignment:'left',verticalAlignment:this.options.verticalAlignment,data:data}}]);}};});define('husky_components/datagrid/decorators/infinite-scroll-pagination',[],function(){'use strict';var defaults={scrollContainer:'.page',reachedBottomMessage:'you reached the end of the list',scrollOffset:0,limit:50},constants={paginationClass:'pagination-wrapper infinite-scroll',paginationElementClass:'pagination',loaderClass:'pagination-loader'},templates={paginationContainer:['<div class="'+constants.paginationClass+'">','   <div class="'+constants.loaderClass+'"/>','   <span class="pagination-message"><%= reachedBottomMessage %></span>','</div>'].join('')};return{initialize:function(context,options){this.datagrid=context;this.sandbox=this.datagrid.sandbox;this.options=this.sandbox.util.extend(true,{},defaults,options);this.setVariables();},setVariables:function(){this.$el=null;this.$paginationContainer=null;this.$loader=null;this.data=null;},getHeight:function(){return this.sandbox.dom.outerHeight(this.$paginationContainer,true);},render:function(data,$container){this.$el=$container;this.data=data;this.$paginationContainer=this.sandbox.dom.createElement(this.sandbox.util.template(templates.paginationContainer,{reachedBottomMessage:this.sandbox.translate(this.options.reachedBottomMessage)}));this.$loader=$(this.$paginationContainer).find('.'+constants.loaderClass);this.sandbox.dom.append(this.$el,this.$paginationContainer);this.startLoader();this.bindInfiniteScroll();this.fillScrollContainer();},startLoader:function(){this.sandbox.start([{name:'loader@husky',options:{el:this.$loader,size:'40px',color:'#cccccc'}}]);},getLimit:function(){return this.options.limit;},destroy:function(){this.sandbox.stop(this.sandbox.dom.find('*',this.$paginationContainer));this.sandbox.dom.unbind(this.sandbox.dom.find('*',this.$paginationContainer));this.sandbox.infiniteScroll.destroy(this.options.scrollContainer);this.sandbox.dom.remove(this.$paginationContainer);},bindInfiniteScroll:function(){this.sandbox.infiniteScroll.initialize(this.options.scrollContainer,this.appendNextPage.bind(this),this.options.scrollOffset);},fillScrollContainer:function(){var $scrollContainer=$(this.options.scrollContainer);if($scrollContainer[0].clientHeight>=$scrollContainer[0].scrollHeight){if(!!this.datagrid.data.links&&!!this.datagrid.data.links.next){this.appendNextPage().then(function(){this.fillScrollContainer();}.bind(this));}}},appendNextPage:function(){var promise=$.Deferred();if(!!this.datagrid.data.links&&!!this.datagrid.data.links.next){this.$paginationContainer.addClass('loading');this.sandbox.util.load(this.datagrid.data.links.next.href).then(function(data){this.updateDatagrid(data);this.$paginationContainer.data('showReachedEnd',true);this.$paginationContainer.removeClass('loading');promise.resolve();}.bind(this))}else{if(!!this.$paginationContainer.data('showReachedEnd')){this.$paginationContainer.addClass('reached-end');}
promise.resolve();}
return promise;},updateDatagrid:function(data){this.datagrid.data.links=this.datagrid.parseLinks(data._links);this.datagrid.data.total=data.total;this.datagrid.data.page=data.page;this.datagrid.data.pages=data.pages;this.datagrid.data.limit=data.limit;this.addRecordsToDatagrid(data._embedded[this.datagrid.options.resultKey]);},addRecordsToDatagrid:function(records){this.sandbox.util.foreach(records,function(record){if(!!record.id){this.datagrid.data.embedded.push(record);this.datagrid.gridViews[this.datagrid.viewId].addRecord(record,true);}}.bind(this));}};});(function(){'use strict';define('__component__$datagrid@husky',['husky_components/datagrid/decorators/table-view','husky_components/datagrid/decorators/thumbnail-view','husky_components/datagrid/decorators/dropdown-pagination','husky_components/datagrid/decorators/infinite-scroll-pagination'],function(decoratorTableView,thumbnailView,decoratorDropdownPagination,infiniteScrollPagination){var defaults={view:'table',viewOptions:{table:{},thumbnail:{}},pagination:'dropdown',paginationOptions:{dropdown:{},'infinite-scroll':{}},contentFilters:null,sortable:true,matchings:[],url:null,saveParams:{},data:null,instanceName:'',searchInstanceName:null,searchFields:[],columnOptionsInstanceName:null,defaultMeasureUnit:'px',preselected:[],onlySelectLeaves:false,childrenPropertyName:false,resizeListeners:true,resultKey:'items',selectedCounter:false,selectedCounterText:'public.elements-selected',selectedCounterShowSelectedText:'public.show-selected',selectedCounterShowAllText:'public.show-all',viewSpacingBottom:110,clickCallback:null,actionCallback:null,idKey:'id',childrenKey:'children'},types={DATE:'date',DATETIME:'datetime',THUMBNAILS:'thumbnails',TITLE:'title',BYTES:'bytes',RADIO:'radio',CHECKBOX:'checkbox',CHECKBOX_READONLY:'checkbox_readonly',COUNT:'count',TRANSLATION:'tran slation',NUMBER:'number',CURRENCY:'currency'},decorators={views:{table:decoratorTableView,thumbnail:thumbnailView},paginations:{dropdown:decoratorDropdownPagination,'infinite-scroll':infiniteScrollPagination}},filters={bytes:function(bytes){return this.sandbox.util.formatBytes(bytes);},title:function(content){return content;},date:function(date){var parsedDate=this.sandbox.date.format(date);if(parsedDate!==null){return parsedDate;}
return date;},datetime:function(datetime){var parsedDate=this.sandbox.date.format(datetime,true);if(parsedDate!==null){return parsedDate;}
return datetime;},translation:function(val){return this.sandbox.translate(val);},number:function(val){return this.sandbox.numberFormat(val,'n');},currency:function(val){return this.sandbox.numberFormat(val,'c');},count:function(number,postfix){return(!!postfix)?number+' '+postfix:number;},thumbnails:function(thumbnails,format){var thumbnail={url:null,alt:null};if(!!thumbnails&&!!thumbnails[format]){if(typeof thumbnails[format]==='object'){thumbnail.url=thumbnails[format].url;thumbnail.alt=thumbnails[format].alt;}else{thumbnail.url=thumbnails[format];thumbnail.alt='';}}
return thumbnail;},radio:function(content,index,columnName){return this.sandbox.util.template(templates.radio,{checked:!!content,columnName:columnName});},checkbox:function(content,index,columnName){return this.sandbox.util.template(templates.checkbox,{checked:!!content,columnName:columnName,readonly:false});},checkbox_readonly:function(content,index,columnName){return this.sandbox.util.template(templates.checkbox,{checked:!!content,columnName:columnName,readonly:true});}},templates={radio:['<div class="custom-radio custom-filter">','   <input name="radio-<%= columnName %>" type="radio" class="form-element" <% if (checked) { print("checked")} %>/>','   <span class="icon"></span>','</div>'].join(''),checkbox:['<div class="custom-checkbox custom-filter">','   <input name="radio-<%= columnName %>" type="checkbox" class="form-element"','       <% if (readonly) { %>readonly="readonly"<% } %>','       <% if (checked) { %>checked<% } %>/>','   <span class="icon"></span>','</div>'].join(''),selectedCounter:['<span class="selected-elements invisible smaller-font grey-font">','    <span class="number">0</span>','    &nbsp;<%= text %>','    <span class="show-selected-container" <% if (!showSelectedLink) { %>style="display: none;"<% } %>>','        &nbsp;(<span class="show-selected"><%= showText %></span>)','    </span>','</span>'].join('')},namespace='husky.datagrid.',INITIALIZED=function(){return this.createEventName('initialized');},VIEW_RENDERED=function(){return this.createEventName('view.rendered');},PAGE_CHANGE=function(){return this.createEventName('page.change');},UPDATED=function(){return this.createEventName('updated');},LOADED=function(){return this.createEventName('loaded');},ITEM_DESELECT=function(){return this.createEventName('item.deselect');},NUMBER_SELECTIONS=function(){return this.createEventName('number.selections');},ITEM_SELECT=function(){return this.createEventName('item.select');},ITEM_CLICK=function(){return this.createEventName('item.click');},ALL_DESELECT=function(){return this.createEventName('all.deselect');},ALL_SELECT=function(){return this.createEventName('all.select');},SELECTED_UPDATE=function(){return this.createEventName('selected.update');},DATA_SAVED=function(){return this.createEventName('updated');},DATA_SAVE_FAILED=function(){return this.createEventName('data.save.failed');},LOADING_FAILED=function(){return this.createEventName('loading.failed');},DATA_CHANGED=function(){return this.createEventName('data.changed');},DATA_PROVIDE=function(){return this.createEventName('data.provide');},CHANGE_VIEW=function(){return this.createEventName('view.change');},CHANGE=function(){return this.createEventName('change');},CHANGE_PAGINATION=function(){return this.createEventName('pagination.change');},CHANGE_PAGE=function(){return this.createEventName('change.page');},RECORD_ADD=function(){return this.createEventName('record.add');},RECORDS_ADD=function(){return this.createEventName('records.add');},RECORD_REMOVE=function(){return this.createEventName('record.remove');},RECORDS_CHANGE=function(){return this.createEventName('records.change');},PAGE_SIZE_CHANGED=function(){return this.createEventName('page-size.changed');},UPDATE=function(){return this.createEventName('update');},DATA_SEARCH=function(){return this.createEventName('data.search');},DATA_SORT=function(){return this.createEventName('data.sort');},URL_UPDATE=function(){return this.createEventName('url.update');},DATA_GET=function(){return this.createEventName('data.get');},DATA_SET=function(){return this.createEventName('data.set');},ITEMS_GET_SELECTED=function(){return this.createEventName('items.get-selected');},MEDIUM_LOADER_SHOW=function(){return this.createEventName('medium-loader.show');},MEDIUM_LOADER_HIDE=function(){return this.createEventName('medium-loader.hide');},SELECT_ITEM=function(){return this.createEventName('select.item');},DESELECT_ITEM=function(){return this.createEventName('deselect.item');},TOGGLE_ITEM=function(){return this.createEventName('toggle.item');},ITEMS_DESELECT=function(){return this.createEventName('items.deselect');},setGetParameter=function(url,paramName,paramValue){if(url.indexOf(paramName+"=")>=0){var prefix=url.substring(0,url.indexOf(paramName+"=")),suffix=url.substring(url.indexOf(paramName+"="));suffix=suffix.substring(suffix.indexOf('=')+1);suffix=(suffix.indexOf('&')>=0)?suffix.substring(suffix.indexOf('&')):'';if(!!paramValue){url=prefix+paramName+'='+paramValue+suffix;}else{if(url.substr(url.indexOf(paramName+'=')-1,1)==='&'){url=url.substring(0,prefix.length-1)+suffix;}else{url=prefix+suffix.substring(1,suffix.length);}}}
else if(!!paramValue){if(url.indexOf("?")<0){url+="?"+paramName+"="+paramValue;}
else{url+="&"+paramName+"="+paramValue;}}
return url;};return{createEventName:function(postfix){return namespace+((!!this.options.instanceName)?this.options.instanceName+'.':'')+postfix;},initialize:function(){this.sandbox.logger.log('initialized datagrid');this.options=this.sandbox.util.extend(true,{},defaults,this.options);this.matchings=[];this.requestFields=[];this.selectedItems=[];this.decorators=this.sandbox.util.extend(true,{},decorators);this.types=types;this.gridViews={};this.viewId=this.options.view;this.paginations={};this.paginationId=this.options.pagination;this.$loader=null;this.$mediumLoader=null;this.isLoading=false;this.initialLoaded=false;this.$element=this.sandbox.dom.$('<div class="husky-datagrid"/>');this.$el.append(this.$element);this.dataGridWindowResize=null;this.sort={attribute:null,direction:null};this.bindCustomEvents();this.bindDOMEvents();this.renderMediumLoader();this.loadAndInitializeDecorators().then(function(){if(this.options.selectedCounter===true){this.renderSelectedCounter();}
this.loadAndEvaluateMatchings().then(function(){this.loadAndRenderData();this.sandbox.emit(INITIALIZED.call(this));}.bind(this));}.bind(this));},remove:function(){this.unbindWindowResize();this.destroy();},loadAndRenderData:function(){var url;if(!!this.options.url){url=this.options.url;this.sandbox.logger.log('load data from url');if(this.requestFields.length>0){url+=(url.indexOf('?')===-1)?'?':'&';url+='fields='+this.requestFields.join(',');}
this.loading();this.load({url:url,success:function(data){this.sandbox.emit(LOADED.call(this),data);}.bind(this)});}else if(!!this.options.data){this.sandbox.logger.log('load data from array');this.data={};if(!!this.options.resultKey&&!!this.options.data[this.options.resultKey]){this.data.embedded=this.parseEmbedded(this.options.data[this.options.resultKey]);}else{this.data.embedded=this.parseEmbedded(this.options.data);}
this.render();if(!!this.paginations[this.paginationId]){this.paginations[this.paginationId].render(this.data,this.$element);}}},loadAndEvaluateMatchings:function(){var def=this.sandbox.data.deferred();var matchings=this.options.matchings;if(typeof(matchings)==='string'){this.loading();this.loadMatchings({url:matchings,success:function(response){this.filterMatchings(response);def.resolve();}.bind(this)});}else{this.filterMatchings(matchings);def.resolve();}
return def;},loadMatchings:function(params){this.sandbox.dom.addClass(this.$find('.selected-elements'),'invisible');this.sandbox.util.load(params.url).then(function(response){this.updateSelectedCounter();if(this.isLoading===true){this.stopLoading();}
this.destroy();if(!!params.success&&typeof params.success==='function'){params.success(response);}}.bind(this)).fail(function(jqXHR,textStatus,error){this.sandbox.emit(LOADING_FAILED.call(this),jqXHR,textStatus,error);}.bind(this));},filterMatchings:function(matchings){var matchingObject;this.matchings=[];this.requestFields=[];this.sandbox.util.foreach(matchings,function(matching){matchingObject={};if((matching.disabled!=='true'&&matching.disabled!==true)){for(var key in matching){if(key==='translation'){matchingObject.content=this.sandbox.translate(matching.translation);}else if(key==='name'){matchingObject.attribute=matching.name;}else if(key==='sortable'){matchingObject.sortable=matching.sortable;if(typeof matching.sortable==='string'){matchingObject.sortable=JSON.parse(matching.sortable);}}else{matchingObject[key]=matching[key];}}
this.matchings.push(matchingObject);this.requestFields.push(matching.name);}else if(matching.name===this.options.idKey){this.requestFields.push(matching.name);}}.bind(this));},render:function(){if(!this.initialLoaded){this.preSelectItems();this.initialLoaded=true;}
this.renderView();if(!!this.paginations[this.paginationId]){this.paginations[this.paginationId].render(this.data,this.$element);}
if(this.options.resizeListeners===true){this.windowResizeListener();}},renderSelectedCounter:function(){this.sandbox.dom.append(this.$element,this.sandbox.util.template(templates.selectedCounter,{text:this.sandbox.translate(this.options.selectedCounterText),showText:this.sandbox.translate(this.options.selectedCounterShowSelectedText),showSelectedLink:!!this.gridViews[this.viewId].showSelected}));this.updateSelectedCounter();},renderView:function(){this.gridViews[this.viewId].render(this.data,this.$element);this.updateSelectedCounter();this.sandbox.emit(VIEW_RENDERED.call(this));},preSelectItems:function(){var dataSelected=this.sandbox.dom.data(this.$el,'selected'),convertedArray=[];if(!!dataSelected){this.options.preselected=this.sandbox.util.union(this.options.preselected,dataSelected);}
this.sandbox.util.foreach(this.options.preselected,function(element){if(typeof element==='object'){convertedArray.push(element.id);}else{convertedArray.push(element);}}.bind(this));this.options.preselected=convertedArray;this.setSelectedItems(this.options.preselected);this.setSelectedItemsToData();},setSelectedItemsToData:function(){this.sandbox.dom.removeAttr(this.$el,'data-selected');this.sandbox.dom.data(this.$el,'selected',this.getSelectedItemIds());},destroy:function(){if(!!this.gridViews[this.viewId]&&!!this.gridViews[this.viewId].rendered){this.gridViews[this.viewId].destroy();if(!!this.paginations[this.paginationId]){this.paginations[this.paginationId].destroy();}}},rerenderView:function(){this.gridViews[this.viewId].destroy();this.renderView();},rerenderPagination:function(){if(!!this.paginations[this.paginationId]){this.paginations[this.paginationId].destroy();this.paginations[this.paginationId].render(this.data,this.$element);}},load:function(params){this.currentUrl=this.getUrl(params);this.sandbox.dom.addClass(this.$find('.selected-elemen ts'),'invisible');return this.sandbox.util.load(this.currentUrl,params.data).then(function(response){this.sandbox.dom.removeClass(this.$find('.selected-elements'),'invisible');if(this.isLoading===true){this.stopLoading();}
this.destroy();this.parseData(response);this.getSortingFromUrl(this.currentUrl);this.render();if(!!params.success&&typeof params.success==='function'){params.success(response);}}.bind(this)).fail(function(jqXHR,textStatus,error){this.sandbox.emit(LOADING_FAILED.call(this),jqXHR,textStatus,error);}.bind(this));},setData:function(data){this.destroy();if(!!data.resultKey&&!!data[data.resultKey]){this.data.embedded=data[data.resultKey];}else{this.data.embedded=data;}
if(!!this.paginations[this.paginationId]){this.paginations[this.paginationId].render(this.data,this.$element);}
this.render();},getSortingFromUrl:function(url){if(url.indexOf('sortOrder')>-1&&url.indexOf('sortBy')>-1){var attribute=this.sandbox.util.getParameterByName('sortBy',url),direction=this.sandbox.util.getParameterByName('sortOrder',url);if(!!attribute&&!!direction){this.sort.attribute=attribute;this.sort.direction=direction;}}},loading:function(){if(this.sandbox.dom.is(this.$element,':visible')){this.sandbox.dom.height(this.$element,this.sandbox.dom.outerHeight(this.$element));this.sandbox.dom.width(this.$element,this.sandbox.dom.outerWidth(this.$element));}
this.sandbox.dom.addClass(this.$element,'loading');if(!this.$loader){this.$loader=this.sandbox.dom.createElement('<div class="datagrid-loader"/>');this.sandbox.dom.hide(this.$loader);this.sandbox.dom.append(this.$element,this.$loader);this.sandbox.start([{name:'loader@husky',options:{el:this.$loader,size:'100px',color:'#cccccc'}}]);}
this.sandbox.dom.show(this.$loader);this.isLoading=true;},stopLoading:function(){this.isLoading=false;this.sandbox.dom.hide(this.$loader);this.sandbox.dom.removeClass(this.$element,'loading');this.sandbox.dom.height(this.$element,'');this.sandbox.dom.width(this.$element,'');return this.$element;},loadAndInitializeDecorators:function(){var def=this.sandbox.data.deferred();this.loadAndInitializePagination(this.paginationId).then(function(){this.loadAndInitializeView(this.viewId).then(function(){def.resolve();}.bind(this));}.bind(this));return def;},renderMediumLoader:function(){this.$mediumLoader=this.sandbox.dom.createElement('<div class="medium-loader"/>');this.sandbox.dom.append(this.$element,this.$mediumLoader);this.sandbox.start([{name:'loader@husky',options:{el:this.$mediumLoader,size:'50px',color:'#cccccc'}}]);},showMediumLoader:function(){this.sandbox.dom.addClass(this.$mediumLoader,'show');},hideMediumLoader:function(){this.sandbox.dom.removeClass(this.$mediumLoader,'show');},parseData:function(data){this.data={};this.data.links=this.parseLinks(data._links);this.data.embedded=this.parseEmbedded(data._embedded[this.options.resultKey]);this.data.total=data.total;this.data.page=data.page;this.data.pages=data.pages;this.data.limit=data.limit;},parseEmbedded:function(data,parent){var embedded=[];for(var i=0,len=data.length;i<len;i++){var children=[];if(!!parent){data[i].parent=parent;}
data[i].id=data[i][this.options.idKey];if(!data[i][this.options.childrenPropertyName]){data[i][this.options.childrenPropertyName]=false;}
if(data[i].hasOwnProperty(this.options.childrenKey)){children=this.parseEmbedded(data[i][this.options.childrenKey],data[i].id);data[i][this.options.childrenPropertyName]=(children.length>0);}
embedded.push(data[i]);embedded=embedded.concat(children);}
return embedded;},parseLinks:function(links){var linksObj={};this.sandbox.util.each(links,function(index,link){linksObj[index]={href:decodeURI(link.href)};}.bind(this));return linksObj;},loadAndInitializeView:function(viewId){this.viewId=viewId;var def=this.sandbox.data.deferred();if(!!this.gridViews[this.viewId]){def.resolve();}
else if(!!this.decorators.views[this.viewId]){this.gridViews[this.viewId]=this.decorators.views[this.viewId];this.initializeViewDecorator();def.resolve();}
else{require([viewId],function(view){this.gridViews[this.viewId]=view;this.initializeViewDecorator();def.resolve();}.bind(this));}
return def;},initializeViewDecorator:function(){if(this.isViewValid(this.gridViews[this.viewId])){this.gridViews[this.viewId].initialize(this,this.options.viewOptions[this.viewId]);}else{this.sandbox.logger.log('Error: View does not meet the configured requirements. See the documentation');}},isViewValid:function(view){if(!view||typeof view.initialize==='undefined'||typeof view.render==='undefined'||typeof view.destroy==='undefined'){return false;}
return true;},loadAndInitializePagination:function(paginationId){this.paginationId=paginationId;var def=this.sandbox.data.deferred();if(!paginationId||!!this.paginations[this.paginationId]){def.resolve();}
else if(!!this.decorators.paginations[this.paginationId]){this.paginations[this.paginationId]=this.decorators.paginations[this.paginationId];this.initializePaginationDecorator();def.resolve();}
else{require([paginationId],function(pagination){this.decorators.paginations[this.paginationId]=pagination;this.initializePaginationDecorator();def.resolve();}.bind(this));}
return def;},initializePaginationDecorator:function(){if(this.isPaginationValid(this.paginations[this.paginationId])){this.paginations[this.paginationId].initialize(this,this.options.paginationOptions[this.paginationId]);}else{this.sandbox.logger.log('Error: Pagination does not meet the configured requirements. See the documentation');}},changeView:function(view,options){if(view!==this.viewId||!!options){this.destroy();return this.loadAndInitializeView(view).then(function(){this.extendViewOptions(options);this.render();}.bind(this));}},changePagination:function(pagination){if(pagination!==this.paginationId){this.destroy();this.loadAndInitializePagination(pagination).then(function(){this.render();}.bind(this));}},change:function(page,limit,viewId,options,paginationId){if(paginationId===this.paginationId&&view===this.viewId){return;}
this.showMediumLoader();this.changePage(null,page,limit).then(function(){this.changeView(viewId,options).then(function(){this.changePagination(paginationId);this.hideMediumLoader();}.bind(this));}.bind(this));},extendViewOptions:function(options){if(!!options&&!!this.gridViews[this.viewId].extendOptions){this.gridViews[this.viewId].extendOptions(options);}},isPaginationValid:function(pagination){if(!pagination||typeof pagination.initialize==='undefined'||typeof pagination.render==='undefined'||typeof pagination.getLimit==='undefined'||typeof pagination.destroy==='undefined'){return false;}
return true;},getUrl:function(params){if(!!this.data&&!!this.data.links){return params.url;}
var delimiter='?',url=params.url;if(!!this.options.pagination&&!!this.paginations[this.paginationId].getLimit()){if(params.url.indexOf('?')!==-1){delimiter='&';}
url=params.url+delimiter+'limit='+this.paginations[this.paginationId].getLimit();if(params.page>1){url+='&page='+params.page;}}
return url;},getNumberAndUnit:function(numberUnit){numberUnit=String(numberUnit);var regex=numberUnit.match(/(\d+)\s*(.*)/);if(!regex[2]){regex[2]=this.options.defaultMeasureUnit;}
return{number:parseInt(regex[1],10),unit:regex[2]};},manipulateContent:function(content,type,argument,columnName){if(typeof type==='function'){return type(content,argument,columnName);}else if(filters.hasOwnProperty(type)){return filters[type].call(this,content,argument,columnName);}
return content;},processContentFilter:function(attributeName,content,type,argument,recordId){if(!!this.options.contentFilters&&this.options.contentFilters.hasOwnProperty(attributeName)){if(typeof this.options.contentFilters[attributeName]==='function'){return this.options.contentFilters[attributeName].call(this,content,argument,recordId);}else if(typeof this.options.contentFilters[attributeName]==='string'){type=this.options.contentFilters[attributeName];return this.manipulateContent(content,type,argument,attributeName);}}
else if(!!type){return this.manipulateContent(content,type,argument);}
return content;},resetSortingOptions:function(){this.sort.attribute=null;this.sort.direction=null;},bindDOMEvents:function(){if(this.options.resizeListeners===true){this.dataGridWindowResize=this.windowResizeListener.bind(this);this.sandbox.dom.on(this.sandbox.dom.$window,'resize.'+this.createEventName('dom'),this.dataGridWindowResize);}
if(this.options.selectedCounter){this.sandbox.dom.on(this.$el,'click',function(event){this.sandbox.dom.stopPropagation(event);if(!this.gridViews[this.viewId].showSelected){return;}
this.show=!this.show;this.gridViews[this.viewId].showSelected(this.show);this.updateSelectedCounter();}.bind(this),'.selected-elements .show-selected');}},unbindWindowResize:function(){this.sandbox.dom.off(this.sandbox.dom.$window,'resize.'+this.createEventName('dom'));},bindCustomEvents:function(){if(this.options.resizeListeners===true){this.sandbox.on('husky.navigation.size.changed',this.windowResizeListener.bind(this));}
this.sandbox.on(UPDATE.call(this),this.updateGrid.bind(this));this.sandbox.on(DATA_SET.call(this),this.setData.bind(this));this.sandbox.on(DATA_GET.call(this),this.provideData.bind(this));this.sandbox.on(DATA_SEARCH.call(this),this.searchGrid.bind(this));this.sandbox.on(URL_UPDATE.call(this),this.updateUrl.bind(this));this.sandbox.on(CHANGE_VIEW.call(this),this.changeView.bind(this));this.sandbox.on(CHANGE.call(this),this.change.bind(this));this.sandbox.on(CHANGE_PAGINATION.call(this),this.changePagination.bind(this));this.sandbox.on(RECORD_ADD.call(this),this.addRecordHandler.bind(this));this.sandbox.on(RECORDS_ADD.call(this),this.addRecordsHandler.bind(this));this.sandbox.on(RECORD_REMOVE.call(this),this.removeRecordHandler.bind(this));this.sandbox.on(RECORDS_CHANGE.call(this),this.changeRecordsHandler.bind(this));this.sandbox.on(NUMBER_SELECTIONS.call(this),this.updateSelectedCounter.bind(this));this.sandbox.on(MEDIUM_LOADER_SHOW.call(this),this.showMediumLoader.bind(this));thi s.sandbox.on(MEDIUM_LOADER_HIDE.call(this),this.hideMediumLoader.bind(this));this.sandbox.on(SELECTED_UPDATE.call(this),this.updateSelection.bind(this));this.sandbox.on(SELECT_ITEM.call(this),this.selectItem.bind(this));this.sandbox.on(DESELECT_ITEM.call(this),this.deselectItem.bind(this));this.sandbox.on(TOGGLE_ITEM.call(this),this.toggleItem.bind(this));this.sandbox.on(ITEMS_DESELECT.call(this),function(){this.gridViews[this.viewId].deselectAllRecords();}.bind(this));this.sandbox.on(ITEMS_GET_SELECTED.call(this),function(callback,returnItems){if(!!returnItems){var ids=this.getSelectedItemIds(),items=[];this.sandbox.util.foreach(ids,function(id){items.push(this.getRecordById(id));}.bind(this));callback(ids,items);}else{callback(this.sandbox.util.deepCopy(this.getSelectedItemIds()));}}.bind(this));this.sandbox.on(CHANGE_PAGE.call(this),function(page,limit){if(!isNaN(page)){this.changePage(null,page,limit);}}.bind(this));this.startColumnOptionsListener();this.startSearchListener();},startSearchListener:function(){if(this.options.searchInstanceName!==null){var searchInstanceName='.'+this.options.searchInstanceName;this.sandbox.on('husky.search'+searchInstanceName,this.searchGrid.bind(this));this.sandbox.on('husky.search'+searchInstanceName+'.reset',this.searchGrid.bind(this,''));}},startColumnOptionsListener:function(){if(this.options.columnOptionsInstanceName!==null){var columnOptionsInstanceName=(this.options.columnOptionsInstanceName!=='')?'.'+this.options.columnOptionsInstanceName:'';this.sandbox.on('husky.column-options'+columnOptionsInstanceName+'.saved',this.filterGrid.bind(this));}},getUrlWithoutParams:function(){var url=this.data.links.self.href;if(url.indexOf('?')!==-1){return url.substring(0,url.indexOf('?'));}
return url;},getRecordIndexById:function(id){for(var i=-1,length=this.data.embedded.length;++i<length;){if(this.data.embedded[i].id===id){return i;}}
return null;},getRecordById:function(id){for(var i=-1,length=this.data.embedded.length;++i<length;){if(this.data.embedded[i].id===id){return this.data.embedded[i];}}
return null;},provideData:function(){this.sandbox.emit(DATA_PROVIDE.call(this),this.data);},windowResizeListener:function(){if(!!this.gridViews[this.viewId].onResize){this.gridViews[this.viewId].onResize();}},addRecordHandler:function(recordData){if(!!this.gridViews[this.viewId].addRecord){if(!!recordData[this.options.idKey]){this.pushRecords([recordData]);}
this.gridViews[this.viewId].addRecord(recordData,false);this.sandbox.emit(NUMBER_SELECTIONS.call(this),this.getSelectedItemIds().length);}},addRecordsHandler:function(records,callback){if(!!this.gridViews[this.viewId].addRecord){this.sandbox.util.foreach(records,function(record){if(!!record[this.options.idKey]){this.pushRecords([record]);this.gridViews[this.viewId].addRecord(record,false);}}.bind(this));if(typeof callback==='function'){callback();}
this.sandbox.emit(NUMBER_SELECTIONS.call(this),this.getSelectedItemIds().length);}},removeRecordHandler:function(recordId){if(!!this.gridViews[this.viewId].removeRecord&&!!recordId){this.gridViews[this.viewId].removeRecord(recordId);this.removeRecordFromSelected(recordId);this.sandbox.emit(NUMBER_SELECTIONS.call(this),this.getSelectedItemIds().length);}},removeRecordFromSelected:function(recordId){var index=this.selectedItems.indexOf(recordId);if(index>-1){this.selectedItems.splice(index,1);}},changeRecordsHandler:function(records){if(!this.sandbox.dom.isArray(records)){records=[records];}
this.sandbox.util.foreach(records,function(record){this.changeRecord(record);}.bind(this));this.rerenderView();this.rerenderPagination();},itemClicked:function(id){if(typeof this.options.clickCallback==='function'){this.options.clickCallback(id,this.data.embedded[this.getRecordIndexById(id)]);}
this.sandbox.emit(ITEM_CLICK.call(this),id,this.data.embedded[this.getRecordIndexById(id)]);},itemAction:function(id){if(typeof this.options.actionCallback==='function'){this.options.actionCallback(id,this.data.embedded[this.getRecordIndexById(id)]);}},getRemainingViewHeight:function(){var height=this.sandbox.dom.height(this.sandbox.dom.window)-this.sandbox.dom.offset(this.$element).top;if(!!this.paginations[this.paginationId]&&!!this.paginations[this.paginationId].getHeight){height-=this.paginations[this.paginationId].getHeight();}
height-=this.options.viewSpacingBottom;return height;},updateSelectedCounter:function(){if(this.options.selectedCounter===true){this.sandbox.dom.html(this.$find('.selected-elements .number'),this.getSelectedItemIds().length);if(this.getSelectedItemIds().length===0){this.sandbox.dom.addClass(this.$find('.selected-elements'),'invisible');}else{this.sandbox.dom.removeClass(this.$find('.selected-elements'),'invisible');}
if(!!this.gridViews[this.viewId]&&!!this.gridViews[this.viewId].showSelected&&this.getSelectedItemIds().length===0){this.show=false;}
if(!!this.show){this.sandbox.dom.text(this.$find('.show-selected'),this.sandbox.translate(this.options.selectedCounterShowAllText));}else{this.sandbox.dom.text(this.$find('.show-selected'),this.sandbox.translate(this.options.selectedCounterShowSelectedText));}
if(!!this.gridViews[this.viewId].showSelected){this.sandbox.dom.show(this.$find('.show-selected-container'));}else{this.sandbox.dom.hide(this.$find('.show-selected-container'));}}},deselectAllItems:function(){this.selectedItems=[];this.sandbox.emit(ALL_DESELECT.call(this));this.sandbox.emit(NUMBER_SELECTIONS.call(this),0);this.setSelectedItemsToData();},selectAllItems:function(){var i,length;for(i=-1,length=this.data.embedded.length;++i<length;){this.setItemSelected(this.data.embedded[i].id);}
this.sandbox.emit(ALL_SELECT.call(this),this.selectedItems);this.sandbox.emit(NUMBER_SELECTIONS.call(this),this.selectedItems.length);this.setSelectedItemsToData();},updateSelection:function(selection){var i,length;this.gridViews[this.viewId].deselectAllRecords();for(i=-1,length=selection.length;++i<length;){this.gridViews[this.viewId].selectRecord(selection[i]);}},selectItem:function(itemId){this.gridViews[this.viewId].selectRecord(itemId);},deselectItem:function(itemId){if(!!this.gridViews[this.viewId].deselectRecord){this.gridViews[this.viewId].deselectRecord(itemId);}},toggleItem:function(itemId){if(this.itemIsSelected(itemId)){this.deselectItem(itemId);}else{this.selectItem(itemId);}},getSelectedItemIds:function(){return this.selectedItems;},setSelectedItems:function(items){var count=0,i,length,position;for(i=-1,length=items.length;++i<length;){if(this.selectedItems.indexOf(items[i])===-1&&this.selectingAllowed(items[i])){this.selectedItems.push(items[i]);count++;}else if((position=this.selectedItems.indexOf(items[i]))!==-1){this.selectedItems.splice(position,1);}}
this.sandbox.emit(NUMBER_SELECTIONS.call(this),count);},itemIsSelected:function(id){return this.selectedItems.indexOf(id)!==-1;},setItemSelected:function(id){if(this.selectedItems.indexOf(id)===-1){this.selectedItems.push(id);this.sandbox.emit(ITEM_SELECT.call(this),id,this.getRecordById(id));this.sandbox.emit(NUMBER_SELECTIONS.call(this),this.getSelectedItemIds().length);this.setSelectedItemsToData();return true;}
return false;},setItemUnselected:function(id){var position;if((position=this.selectedItems.indexOf(id))!==-1){this.selectedItems.splice(position,1);this.sandbox.emit(ITEM_DESELECT.call(this),id);this.sandbox.emit(NUMBER_SELECTIONS.call(this),this.getSelectedItemIds().length);this.setSelectedItemsToData();return true;}
return false;},selectingAllowed:function(id){var itemIndex=this.getRecordIndexById(id);if(this.options.onlySelectLeaves===true&&this.data.embedded[itemIndex][this.options.childrenPropertyName]){return false;}
return true;},updateUrl:function(parameters){var url,key;url=this.currentUrl;for(key in parameters){url=setGetParameter.call(this,url,key,parameters[key]);}
this.destroy();this.loading();this.load({url:url,success:function(data){this.sandbox.emit(UPDATED.call(this),data);}.bind(this)});},updateRecord:function(record){for(var i=-1,length=this.data.embedded.length;++i<length;){if(record[this.options.idKey]===this.data.embedded[i].id){this.data.embedded[i]=record;return true;}}
return false;},changeRecord:function(record){if(!!record[this.options.idKey]){for(var i=-1,length=this.data.embedded.length;++i<length;){if(record[this.options.idKey]===this.data.embedded[i].id){this.data.embedded[i]=this.sandbox.util.extend(true,{},this.data.embedded[i],record);return true;}}}else{this.sandbox.logger.log('Error: Failed changing a record. Must contain id-property');return false;}},removeRecord:function(recordId){if(!!recordId){var i,length;for(i=-1,length=this.data.embedded.length;++i<length;){if(recordId===this.data.embedded[i].id){this.removeRecordFromSelected(recordId);this.data.embedded.splice(i,1);this.rerenderPagination();return true;}}}
return false;},pushRecords:function(records){for(var i=-1,length=records.length;++i<length;){this.data.embedded.push(records[i]);}
this.rerenderPagination();},unshiftRecords:function(records){for(var i=-1,length=records.length;++i<length;){this.data.embedded.unshift(records[i]);this.rerenderPagination();}},changePage:function(uri,page,limit){if(!!this.data.links.pagination||!!uri){var def=this.sandbox.data.deferred();this.show=false;this.updateSelectedCounter();var url,uriTemplate;if(!!uri){url=uri;}else{if(!page||page>this.data.pages||page<1){this.sandbox.logger.log("invalid page number or reached start/end!");return;}
if(!limit){limit=this.data.limit;}else if(this.data.limit!==limit){this.sandbox.emit(PAGE_SIZE_CHANGED.call(this),limit,this.paginationId);}
uriTemplate=this.sandbox.uritemplate.parse(this.data.links.pagination.href);url=this.sandbox.uritemplate.expand(uriTemplate,{page:page,limit:limit});}
this.sandbox.emit(PAGE_CHANGE.call(this),url);this.load({url:url,success:function(){def.resolve();this.sandbox.emit(UPDATED.call(this),'changed page');}.bind(this)});return def;}},updateGrid:function(){if(!!this.data.links.self){this.resetSortingOptions();this.load({url:this.data.links.self.href,success:function(){this.sandbox.emit(UPDATED.call(this));}.bind(this)});}},filterGrid:function(matchings){if(!!this.data.links.filter){var uriTemplate,url;this.filterMatchings(matchings);uriTemplate=this.sandbox.uritemplate.parse(this.data.links.filter.href);url=this.sandbox.uritemplate.expand(uriTemplate,{fieldsList:this.requestFields.join(',')});this.destroy();this.loading();this.load({url:url,success:function(){this.sandbox.emit(UPDATED.call(this));}.bind(this)});}},sortGrid:function(attribute,direction){if(this.options.sortable===true&&!!this.data.links.sortable){var template,url;if(!!attribute){this.sort.attribute=attribute;this.sort.direction=direction;template=this.sandbox.uritemplate.parse(this.data.links.sortable.href);url=this.sandbox.uritemplate.expand(template,{sortBy:attribute,sortOrder:direction});this.sandbox.emit(DATA_SORT.call(this),{attribute:attribute,direction:direction});this.load({url:url,success:function(data){this.sandbox.emit(UPDATED.call(this),data);}.bind(this)});}}},loadChildren:function(recordId){if(!!this.data.links.children){var template=this.sandbox.uritemplate.parse(this.data.links.children.href),url=this.sandbox.uritemplate.expand(template,{parentId:recordId});this.sandbox.util.load(this.getUrl({url:url})).then(function(response){this.addRecordsHandler(response._embedded[this.options.resultKey]);}.bind(this)).fail(function(status,error){this.sandbox.logger.error(status,error);}.bind(this));}},searchGrid:function(searchString,searchFields){if(!!this.data.links.find){var template,url;template=this.sandbox.uritemplate.parse(this.data.links.find.href);if(!!searchFields){url=this.sandbox.uritemplate.expand(template,{searchString:searchString,searchFields:searchFields});}else{url=this.sandbox.uritemplate.expand(template,{searchString:searchString,searchFields:this.options.searchFields.join(',')});}
this.destroy();this.loading();this.load({url:url,success:function(){this.sandbox.emit(UPDATED.call(this));}.bind(this)});}},saveGrid:function(data,url,success,fail,unshift){var method='POST',isNewRecord=true;if(!!data.id){method='PUT';isNewRecord=false;url=url+'/'+data.id;}
for(var key in this.options.saveParams){url=setGetParameter.call(this,url,key,this.options.saveParams[key]);}
this.sandbox.emit(DATA_CHANGED.call(this));this.sandbox.util.save(url,method,data).then(function(data,textStatus){this.sandbox.emit(DATA_SAVED.call(this),data,textStatus);if(typeof success==='function'){success(data,textStatus);}
if(isNewRecord===false){this.updateRecord(data);}else if(unshift===true){this.unshiftRecords([data]);}else{this.pushRecords([data]);}}.bind(this)).fail(function(jqXHR,textStatus,error){this.sandbox.emit(DATA_SAVE_FAILED.call(this),jqXHR,textStatus,error,data);if(typeof fail==='function'){fail(jqXHR,textStatus,error);}}.bind(this));}};});})();define('__component__$dropdown@husky',['underscore'],function(_){'use strict';var moduleName='Husky.Ui.DropDown',defaults={url:'',data:[],trigger:'',triggerOutside:false,shadow:true,toggleClassOn:null,valueName:'name',infoName:'info',clickedName:'clickedInfo',setParentDropDown:false,excludeItems:[],instanceName:'undefined',alignment:'left',verticalAlignment:'bottom',translateLabels:true,clickDelay:1000};return{initialize:function(){this.name=moduleName;this.options=this.sandbox.util.extend({},defaults,this.options);this.$element=this.sandbox.dom.createElement('<div/>',{'class':'husky-drop-down'});this.sandbox.dom.append(this.options.el,this.$element);this.render();this.sandbox.emit('husky.dropdown.'+this.options.instanceName+'.initialized');},render:function(){var dropdownClasses=['dropdown-menu'];if(this.options.shadow===true){dropdownClasses.push('dropdown-shadow');}
this.$dropDown=this.sandbox.dom.createElement('<div/>',{'class':dropdownClasses.join(' ')});this.$dropDownList=this.sandbox.dom.createElement('<ul/>');this.sandbox.dom.append(this.$element,this.$dropDown);this.sandbox.dom.append(this.$dropDown,this.$dropDownList);this.hideDropDown();if(this.options.setParentDropDown){this.sandbox.dom.addClass(this.sandbox.dom.parent(this.$element),'dropdown');}
if(this.options.alignment==='right'){this.sandbox.dom.addClass(this.$dropDown,'dropdown-align-right');}
if(this.options.verticalAlignment==='top'){this.sandbox.dom.addClass(this.$dropDown,'dropdown-align-top');}
this.bindDOMEvents();this.bindCustomEvents();this.prepareData();},bindDOMEvents:function(){this.sandbox.dom.off(this.$element);if(this.options.trigger!==''){if(this.options.triggerOutside){$(this.options.trigger).addClass('husky-dropdown-trigger');this.sandbox.dom.on(this.options.trigger,'click',this.triggerClick.bind(this));}else{$(this.options.el).addClass('husky-dropdown-trigger');this.sandbox.dom.on(this.options.el,'click',this.triggerClick.bind(this),this.options.trigger);}}else{$(this.options.el).addClass('husky-dropdown-trigger');this.sandbox.dom.on(this.options.el,'click',this.triggerClick.bind(this));}
this.sandbox.dom.on(this.$dropDownList,'click',function(event){if(!this.sandbox.dom.hasClass(event.currentTarget,'disabled')){this.clickItem(this.sandbox.dom.data(event.currentTarget,'id'));}}.bind(this),'li:not(".divider")');},bindCustomEvents:function(){this.sandbox.on(this.getEvent('toggle'),this.triggerClick.bind(this));this.sandbox.on(this.getEvent('show'),this.showDropDown.bind(this));this.sandbox.on(this.getEvent('hide'),this.hideDropDown.bind(this));this.sandbox.on(this.getEvent('item.enable'),this.itemEnable.bind(this));this.sandbox.on(this.getEvent('item.disable'),this.itemDisable.bind(this));this.sandbox.on(this.getEvent('item.toggle'),this.itemToggle.bind(this));},getEvent:function(append){return'husky.dropdown.'+this.options.instanceName+'.'+append;},itemToggle:function(id,enable){if(enable===true){this.itemEnable(id);}else{this.itemDisable(id);}},itemEnable:function(id){this.sandbox.dom.removeClass(this.$find('li[data-id="'+id+'"]'),'disabled');},itemDisable:function (id){this.sandbox.dom.addClass(this.$find('li[data-id="'+id+'"]'),'disabled');},clickItem:function(id){var item=this.getItemById(id),$item=this.$el.find('*[data-id="'+id+'"]'),$infos;if(!item){return;}
if(!!item.callback&&typeof item.callback==='function'){item.callback.call(this);}else if(!!this.options.clickCallback&&typeof this.options.clickCallback==='function'){this.options.clickCallback(item,this.$el);}else{this.sandbox.emit(this.getEvent('item.click'),item,this.$el);}
if(!item[this.options.clickedName]){return this.hideDropDown();}
$infos=$item.find('.info, .info-clicked');$item.addClass('highlight-animation');$infos.addClass('clicked');_.delay(function(){$item.removeClass('highlight-animation');$infos.removeClass('clicked');return this.hideDropDown();}.bind(this),this.options.clickDelay);},getItemById:function(id){for(var i=0,length=this.options.data.length,item;i<length;++i){item=this.options.data[i];if(typeof item.id!=='undefined'&&item.id.toString()===id.toString()){return item;}}},triggerClick:function(event){var $target=$(event.target);if($target.hasClass('husky-dropdown-item')||$target.parents().hasClass('husky-dropdown-item')){return;}
this.toggleDropDown();},prepareData:function(){if(this.options.data.length>0){this.generateDropDown(this.options.data);}else{this.loadData();}},loadData:function(){var url=this.getUrl();this.sandbox.logger.log(this.name,'load: '+url);this.sandbox.util.ajax({url:url,success:function(response){this.sandbox.logger.log(this.name,'load','success');if(response.total>0&&response.items.length===response.total){this.options.data=response.items;}else{this.options.data=[];}
this.generateDropDown(this.options.data);}.bind(this),error:function(){this.sandbox.logger.log(this.name,'load','error');this.options.data=[];this.generateDropDown(this.options.data);}.bind(this)});setTimeout(function(){this.sandbox.emit(this.getEvent('data.load'));}.bind(this),200);},generateDropDown:function(items){this.clearDropDown();if(items.length>0){items.forEach(function(item){if(item.divider!==true){if(this.isVisible(item)){var label=item[this.options.valueName],info=item[this.options.infoName],clicked=item[this.options.clickedName],template;if(this.options.translateLabels){label=this.sandbox.translate(label);info=this.sandbox.translate(info);clicked=this.sandbox.translate(clicked);}
label=this.sandbox.util.cropMiddle(label,35);template=['<li class="husky-dropdown-item" data-id="',item.id,'">','<span class="label">',label,'</span>',(info!==undefined?('<span class="info">'+info+'</span>'):''),(clicked!==undefined?('<span class="info-clicked">'+clicked+'</span>'):''),'</li>'].join('');this.sandbox.dom.append(this.$dropDownList,template);}}else{this.sandbox.dom.append(this.$dropDownList,'<li class="divider"/>');}}.bind(this));}else{this.sandbox.dom.append(this.$dropDownList,'<li>No data received</li>');}
this.sandbox.emit(this.getEvent('rendered'));},isVisible:function(item){var result=true;this.options.excludeItems.forEach(function(testItem){if(item.id===testItem.id){result=false;}}.bind(this));return result;},clearDropDown:function(){this.sandbox.dom.remove(this.sandbox.dom.children(this.sandbox.dom.children(this.$dropDown,'ul'),'li'));},toggleDropDown:function(){this.sandbox.logger.log(this.name,'toggle dropdown');if(this.sandbox.dom.is(this.$dropDown,':visible')){this.hideDropDown();}else{this.showDropDown();}},showDropDown:function(){this.sandbox.logger.log(this.name,'show dropdown');this.sandbox.dom.removeClass(this.$dropDown,'top');this.sandbox.dom.one(this.sandbox.dom.window,'click',this.hideDropDown.bind(this));this.sandbox.dom.show(this.$dropDown);this.sandbox.emit('husky.dropdown.'+this.options.instanceName+'.showing');if(!!this.options.toggleClassOn){this.sandbox.dom.addClass(this.options.toggleClassOn,'is-active');}
if((this.sandbox.dom.offset(this.$dropDown).top-this.sandbox.dom.scrollTop(this.sandbox.dom.window)+
this.sandbox.dom.outerHeight(this.$dropDown))>this.sandbox.dom.height(this.sandbox.dom.window)){this.sandbox.dom.addClass(this.$dropDown,'top');}},hideDropDown:function(event){if(!!event){var $target=$(event.target);if($target.is('.husky-dropdown-trigger:not(.husky-dropdown-item), .highlight-animation')||$target.parents().is('.husky-dropdown-trigger:not(.husky-dropdown-item), .highlight-animation')){this.sandbox.dom.one(this.sandbox.dom.window,'click',this.hideDropDown.bind(this));return;}}
this.sandbox.logger.log(this.name,'hide dropdown');this.sandbox.dom.off(this.sandbox.dom.window,'click',this.hideDropDown.bind(this));this.sandbox.dom.hide(this.$dropDown);if(!!this.options.toggleClassOn){this.sandbox.dom.removeClass(this.options.toggleClassOn,'is-active');}},getUrl:function(){return this.options.url;}};});define('__component__$matrix@husky',[],function(){'use strict';var activeClass='is-active';return{initialize:function(){this.$element=this.sandbox.dom.createElement('<div class="husky-matrix"/>');this.prepare();this.sandbox.dom.append(this.$el,this.$element);this.bindDOMEvents();this.bindCustomEvents();},bindDOMEvents:function(){this.sandbox.dom.on(this.$element,'click',this.toggleIcon.bind(this),'tbody > tr > td.value > span[class^="fa-"]');this.sandbox.dom.on(this.$element,'click',this.toggleRow.bind(this),'tbody > tr > td:last-child');},bindCustomEvents:function(){this.sandbox.on('husky.matrix.set-all',this.setAllActive.bind(this));this.sandbox.on('husky.matrix.unset-all',this.unsetAllActive.bind(this));},toggleIcon:function(event){var $target=event.currentTarget,$tr=this.sandbox.dom.parent($target),$allTargets=this.sandbox.dom.find('span[class^="fa-"]',$tr),$activeTargets,$link=this.sandbox.dom.find('td:last-child span',$tr);this.sandbox.dom.toggleClass($target,activeClass);$activeTargets=this.sandbox.dom.find('span[class^="fa-"].'+activeClass,$tr);if($activeTargets.length<$allTargets.length){this.sandbox.dom.html($link,this.options.captions.all);}else{this.sandbox.dom.html($link,this.options.captions.none);}
this.sandbox.emit('husky.matrix.changed',{section:this.sandbox.dom.data($target,'section'),value:this.sandbox.dom.data($target,'value'),activated:this.sandbox.dom.hasClass($target,activeClass)});},toggleRow:function(event){var $tr=this.sandbox.dom.parent(event.currentTarget),$targets=this.sandbox.dom.find('span[class^="fa-"]',$tr),$activeTargets=this.sandbox.dom.find('span[class^="fa-"].'+activeClass,$tr),$link=this.sandbox.dom.find('td:last-child span',$tr),activated;if($activeTargets.length<$targets.length){this.sandbox.dom.addClass($targets,activeClass);this.sandbox.dom.html($link,this.options.captions.none);activated=true;}else{this.sandbox.dom.removeClass($targets,activeClass);this.sandbox.dom.html($link,this.options.captions.all);activated=false;}
this.sandbox.emit('husky.matrix.changed',{section:this.sandbox.dom.data($targets,'section'),value:this.options.values.horizontal[$tr.data('row-count')],activated:activated});},setAllActive:function(){var $targets=this.sandbox.dom.find('span[class^="fa-"]',this.$element),$trs=this.sandbox.dom.find('tbody > tr',this.$element);this.sandbox.dom.addClass($targets,activeClass);this.sandbox.dom.each($trs,function(key,tr){this.sandbox.emit('husky.matrix.changed',{section:this.sandbox.dom.data(this.sandbox.dom.find('td.section',tr),'section'),value:this.options.values.horizontal[$(tr).data('row-count')],activated:true});}.bind(this));},unsetAllActive:function(){var $targets=this.sandbox.dom.find('span[class^="fa-"]',this.$element),$trs=this.sandbox.dom.find('tbody > tr',this.$element);this.sandbox.dom.removeClass($targets,activeClass);this.sandbox.dom.each($trs,function(key,tr){this.sandbox.emit('husky.matrix.changed',{section:this.sandbox.dom.data(this.sandbox.dom.find('td.section',tr),'section'),value:this.options.values.horizontal[$(tr).data('row-count')],activated:false});}.bind(this));},prepare:function(){this.$element.append(this.prepareTable());},prepareTable:function(){var $table;$table=this.sandbox.dom.createElement('<table class="table matrix"/>');this.sandbox.dom.append($table,this.prepareTableHead());if(!!this.options.captions.vertical){this.sandbox.dom.append($table,this.prepareTableBody());}
return $table;},prepareTableHead:function(){var $thead=this.sandbox.dom.createElement('<thead/>'),$tr=this.sandbox.dom.createElement('<tr/>'),$thSection=this.sandbox.dom.createElement('<th class="section"/>'),$thGeneral,$th;if(!!this.options.captions.general){$thGeneral=this.sandbox.dom.createElement('<th class="general"/>');this.sandbox.dom.html($thGeneral,this.options.captions.general);this.sandbox.dom.append($tr,$thGeneral);}
this.sandbox.dom.html($thSection,this.options.captions.type);this.sandbox.dom.append($tr,$thSection);if(typeof(this.options.captions.horizontal)==='string'){$th=this.sandbox.dom.createElement('<th/>');this.sandbox.dom.html($th,this.options.captions.horizontal);this.sandbox.dom.append($tr,$th);}else{this.options.captions.horizontal.forEach(function(caption){var $th=this.sandbox.dom.createElement('<th/>');this.sandbox.dom.html($th,caption);this.sandbox.dom.append($tr,$th);}.bind(this));}
this.sandbox.dom.append($tr,this.sandbox.dom.createElement('<th/>'));this.sandbox.dom.append($thead,$tr);return $thead;},prepareTableBody:function(){var $tbody=this.sandbox.dom.createElement('<tbody/>'),rowCount;for(rowCount=0;rowCount<this.options.captions.vertical.length;rowCount++){this.prepareTableRow($tbody,rowCount);}
return $tbody;},prepareTableRow:function($tbody,rowCount){var $tr=this.sandbox.dom.createElement('<tr/>'),$tdHead=this.sandbox.dom.createElement('<td class="section"/>'),$tdValue=this.sandbox.dom.createElement('<td class="value"/>'),$tdAll=this.sandbox.dom.createElement('<td class="all"/>'),allActive;$tr.data('row-count',rowCount);if(!!this.options.captions.general){this.sandbox.dom.append($tr,this.sandbox.dom.createElement('<td/>'));}
this.sandbox.dom.html($tdHead,this.options.captions.vertical[rowCount]);this.sandbox.dom.data($tdHead,'section',this.options.values.vertical[rowCount]);this.sandbox.dom.append($tr,$tdHead);allActive=this.prepareTableColumn($tdValue,this.options.values.horizontal[rowCount],this.options.values.vertical[rowCount],this.options.data[rowCount]);this.sandbox.dom.append($tr,$tdValue);this.sandbox.dom.html($tdAll,['<span class="pointer">',(!!allActive)?this.options.captions.none:this.options.captions.all,'</span>'].join(''));this.sandbox.dom.append($tr,$tdAll);this.sandbox.dom.append($tbody,$tr);},prepareTableColumn:function($tdValue,columnData,section,value){var allActive=true,title,$span,i;for(i=0;i<columnData.length;i++){if(columnData[i].title){title='title="'+columnData[i].title+'"';}else{title='';}
$span=this.sandbox.dom.createElement('<span '+title+' class="fa-'+columnData[i].icon+' matrix-icon pointer"/>');this.sandbox.dom.data($span,'value',columnData[i].value);this.sandbox.dom.data($span,'section',section);if(!!value&&!!value[i]){this.sandbox.dom.addClass($span,activeClass);}else{allActive=false;}
this.sandbox.dom.append($tdValue,$span);}
return allActive;}};});define('__component__$search@husky',[],function(){'use strict';var templates={skeleton:['<button class="fa-search fa-flip-horizontal search-icon" />','<button class="fa-times-circle remove-icon" />','<input id="search-input" type="text" class="form-element input-round search-input" placeholder="<%= placeholderText %>"/>'].join('')},defaults={instanceName:null,placeholderText:'public.search',appearance:'gray',slide:false},constants={slideClass:'slide',slideCollapsedClass:'slide-collapsed',slideExpandedClass:'slide-expanded'},SEARCH=function(){return this.getEventName();},RESET=function(){return this.getEventName('reset');},CLEAR=function(){return this.getEventName('clear');},INITIALIZED=function(){return this.getEventName('initialized');};return{initialize:function(){this.sandbox.logger.log('initialize',this);this.options=this.sandbox.util.extend({},defaults,this.options);this.render();this.bindDOMEvents();this.bindCustomEvents();this.sandbox.emit(INITIALIZED.call(this));},bindCustomEvents:function(){this.sandbox.on(CLEAR.call(this),function(){this.removeSearch(null,true);}.bind(this));},render:function(){this.sandbox.dom.addClass(this.$el,'search-container');this.sandbox.dom.addClass(this.$el,this.options.appearance);if(this.options.slide===true){this.sandbox.dom.addClass(this.$el,constants.slideClass);this.collapse();}
this.sandbox.dom.html(this.$el,this.sandbox.template.parse(templates.skeleton,{placeholderText:this.sandbox.translate(this.options.placeholderText)}));},bindDOMEvents:function(){this.sandbox.dom.on(this.$el,'click',this.selectInput.bind(this),'input');this.sandbox.dom.on(this.$el,'mousedown',this.submitSearch.bind(this),'.search-icon');this.sandbox.dom.on(this.$el,'mousedown',this.removeSearch.bind(this),'.remove-icon');this.sandbox.dom.on(this.$el,'keyup onchange',this.checkKeyPressed.bind(this),'#search-input');this.sandbox.dom.on(this.$find('input'),'focus',function(){this.sandbox.dom.addClass(this.$el,'focus');}.bind(this));this.sandbox.dom.on(this.$find('input'),'blur',function(){this.sandbox.dom.removeClass(this.$el,'focus');}.bind(this));if(this.options.slide===true){this.sandbox.dom.on(this.$find('input'),'focus',this.expand.bind(this));this.sandbox.dom.on(this.$find('input'),'blur',this.collapse.bind(this));}},collapse:function(){this.sandbox.dom.removeClass(this.$el,constants.slideExpandedClass);this.sandbox.dom.addClass(this.$el,constants.slideCollapsedClass);},expand:function(){this.sandbox.dom.removeClass(this.$el,constants.slideCollapsedClass);this.sandbox.dom.addClass(this.$el,constants.slideExpandedClass);},resetSearch:function(noEmit){if(!noEmit){this.sandbox.emit(RESET.call(this));}
this.searchSubmitted=false;},checkKeyPressed:function(event){var $removeIcon;$removeIcon=this.sandbox.dom.prev(event.currentTarget,'.remove-icon');if(this.sandbox.dom.val(event.currentTarget).length>0){this.sandbox.dom.show($removeIcon);}else{this.sandbox.dom.hide($removeIcon);}
if(event.keyCode===13){this.submitSearch();}else if(event.keyCode===27){this.removeSearch();}},submitSearch:function(){var searchString=this.sandbox.dom.val(this.sandbox.dom.find('#search-input',this.$el));if(searchString===''){if(this.searchSubmitted){this.resetSearch();}
return;}
this.searchSubmitted=true;this.sandbox.emit(SEARCH.call(this),searchString);},removeSearch:function(event,noEmit){if(!event){event={target:this.sandbox.dom.find('.remove-icon',this.$el),currentTarget:this.sandbox.dom.find('.remove-icon',this.$el)};}
var $input=this.sandbox.dom.next(event.currentTarget,'input');this.sandbox.dom.hide(event.target);this.sandbox.dom.val($input,'');if(this.searchSubmitted){this.resetSearch(noEmit);}},selectInput:function(event){this.sandbox.dom.trigger(event.currentTarget,'select');},getEventName:function(postfix){var event='husky.search';if(!!postfix){postfix='.'+postfix;}else{postfix='';}
if(this.options.instanceName){event+='.'+this.options.instanceName;}
return event+postfix;}};});define('__component__$tabs@husky',[],function(){'use strict';var defaults={url:null,data:[],instanceName:'',preselect:true,preselector:'url',forceReload:false,callback:null,forceSelect:true,values:{},preSelectEvent:{enabled:false,triggerSelectItem:true}},ACTIVATE=function(){return this.createEventName('activate');},DEACTIVATE=function(){return this.createEventName('deactivate');},ITEM_SHOW=function(){return this.createEventName('item.show');},ITEM_HIDE=function(){return this.createEventName('item.hide');},ITEM_SELECT=function(){return this.createEventName('item.select');},ITEM_PRE_SELECT=function(){return this.createEventName('item.preselect');},ITEM_CLICKED=function(){return this.createEventName('item.clicked');},GET_SELECTED=function(){return this.createEventName('getSelected');},UPDATE=function(){return this.createEventName('update');},UPDATED=function(){return this.createEventName('updated');},INITIALIZED=function(){return this.createEventName('initialized');},preSelectEvent=function(event){event.preventDefault();this.sandbox.emit(ITEM_PRE_SELECT.call(this),event);if(!!this.options.preSelectEvent.triggerSelectItem){selectItem.call(this,event);}},selectItem=function(event){event.preventDefault();if(this.active===true&&this.sandbox.dom.hasClass(event.currentTarget,'is-selected')!==true){var item=this.items[this.sandbox.dom.data(event.currentTarget,'id')];if(!!item){this.sandbox.dom.removeClass(this.sandbox.dom.find('.is-selected',this.$el),'is-selected');this.sandbox.dom.addClass(event.currentTarget,'is-selected');this.sandbox.dom.addClass(this.$marker,'animate');setMarker.call(this);if(item.hasOwnProperty('callback')&&typeof item.callback==='function'){item.callback.call(this,item);}else if(!!this.options.callback&&typeof this.options.callback==='function'){this.options.callback.call(this,item);}else{triggerSelectEvent.call(this,item);}}}else{return false;}},setMarker=function(){var $selected=this.$find('li.is-selected');if(!!$selected.length){this.sandbox.dom.width(this.$marker,this.sandbox.dom.outerWidth($selected));this.sandbox.dom.css(this.$marker,{'left':this.sandbox.dom.position($selected).left+'px'});}},triggerSelectEvent=function(item){item.forceReload=(item.forceReload&&typeof item.forceReload!=="undefined")?item.forceReload:this.options.forceReload;this.sandbox.emit(ITEM_SELECT.call(this),item);},showItem=function(item){this.sandbox.dom.show(this.domItems[item]);this.sandbox.dom.removeClass(this.$marker,'animate');setMarker.call(this);},hideItem=function(item){this.sandbox.dom.hide(this.domItems[item]);this.sandbox.dom.removeClass(this.$marker,'animate');setMarker.call(this);},update=function(values){var visibleTabs=0;this.sandbox.util.foreach(this.data,function(item){var $item=this.$find('li[data-id="'+item.id+'"]');if(!!item.displayConditions&&!this.evaluate(item.displayConditions,values)){this.sandbox.dom.hide($item);}else{this.sandbox.dom.show($item);++visibleTabs;}}.bind(this));if(visibleTabs>=2){this.$el.show();}else{this.$el.hide();}
this.sandbox.emit(UPDATED.call(this),visibleTabs);setMarker.call(this);},bindDOMEvents=function(){if(!!this.options.preSelectEvent.enabled){this.sandbox.dom.on(this.$el,'click',preSelectEvent.bind(this),'li');}else{this.sandbox.dom.on(this.$el,'click',selectItem.bind(this),'li');}},bindCustomEvents=function(){this.sandbox.on(GET_SELECTED.call(this),function(callback){var selection=this.sandbox.dom.find('.is-selected',this.options.el);callback.call(this.items[this.sandbox.dom.data(selection,'id')]);}.bind(this));this.sandbox.on(ACTIVATE.call(this),this.activate.bind(this));this.sandbox.on(DEACTIVATE.call(this),this.deactivate.bind(this));this.sandbox.on(ITEM_SHOW.call(this),showItem.bind(this));this.sandbox.on(ITEM_HIDE.call(this),hideItem.bind(this));this.sandbox.on(ITEM_CLICKED.call(this),selectItem.bind(this));this.sandbox.on(UPDATE.call(this),update.bind(this));};return{initialize:function(){this.options=this.sandbox.util.extend(true,{},defaults,this.options);this.active=true;this.$marker=null;this.items=[];this.domItems={};bindDOMEvents.call(this);bindCustomEvents.call(this);if(!!this.options.url){this.sandbox.util.load(this.options.url).then(function(data){this.render(data,this.options.values);}.bind(this)).fail(function(data){this.sandbox.logger.log('data could not be loaded:',data);}.bind(this));}else if(!!this.options.data){this.render(this.options.data,this.options.values);}else{this.sandbox.logger.log('no data provided for tabs!');}},createEventName:function(ending){var instanceName=this.options.instanceName?this.options.instanceName+'.':'';return'husky.tabs.'+instanceName+ending;},setMinWidth:function($item){this.sandbox.dom.addClass($item,'is-selected');this.sandbox.dom.css($item,{'min-width':this.sandbox.dom.outerWidth($item)+'px'});this.sandbox.dom.removeClass($item,'is-selected');},deactivate:function(){this.active=false;this.sandbox.dom.addClass(this.sandbox.dom.find('.tabs-container',this.$el),'deactivated');},activate:function(){this.active=true;this.sandbox.dom.removeClass(this.sandbox.dom.find('.tabs-container',this.$el),'deactivated');},generateIds:function(data){this.sandbox.util.foreach(data,function(item){if(!item.id){item.id=this.getRandId();}}.bind(this));return data;},getRandId:function(){return Math.floor((Math.random()*1677721500000000)).toString(16);},evaluate:function(displayConditions,values){for(var i=0,length=displayConditions.length;i<length;i++){var item=this.sandbox.util.extend(true,{},{property:null,operator:null,value:null},displayConditions[i]);if(!values.hasOwnProperty(item.property)){this.sandbox.logger.warn('property "'+item.property+'" does not exists in data');return false;}
switch(item.operator){case'eq':if(values[item.property]!==item.value){return false;}
break;case'neq':if(values[item.property]===item.value){return false;}
break;default:this.sandbox.logger.error('operator "'+item.operator+'" is not implemented.');return false;}}
return true;},render:function(data,values){this.data=this.generateIds(data);var $element=this.sandbox.dom.createElement('<div class="tabs-container"></div>'),$list=this.sandbox.dom.createElement('<ul/>'),selectedItem=null,$item=null;this.$marker=this.sandbox.dom.createElement('<div class="marker"></div>');this.sandbox.dom.append($element,this.$marker);this.sandbox.dom.append(this.$el,$element);this.sandbox.dom.append($element,$list);this.items=[];this.domItems={};var visibleTabs=0;this.sandbox.util.foreach(this.data,function(item,index){this.items[item.id]=item;$item=this.sandbox.dom.createElement('<li data-id="'+item.id+'"><a href="#">'+this.sandbox.translate(item.name)+'</a></li>');this.sandbox.dom.append($list,$item);if((!!item.disabled&&item.disabled.toString()==='true')||(!!item.displayConditions&&!this.evaluate(item.displayConditions,values))){this.sandbox.dom.hide($item);}else{++visibleTabs;}
this.setMinWidth($item);if(!!this.options.preselect){if((this.options.preselector==='url'&&!!this.options.fragment&&this.options.fragment===item.action)||(this.options.preselector==='position'&&(index+1).toString()===this.options.preselect.toString())||(this.options.preselector==='name'&&item.name===this.options.preselect)){this.sandbox.dom.addClass($item,'is-selected');selectedItem=item;}}
this.domItems[item.id]=$item;}.bind(this));if(!selectedItem&&this.options.forceSelect){selectedItem=this.options.data[0];this.sandbox.dom.addClass(this.sandbox.dom.find('li',$list).eq(0),'is-selected');}
setMarker.call(this);this.sandbox.emit(INITIALIZED.call(this),selectedItem,visibleTabs);if(visibleTabs<2){this.$el.hide();}}};});define('__component__$toolbar@husky',[],function(){'use strict';var defaults={url:null,buttons:[],instanceName:'',dropdownItemsKey:'_embedded',searchOptions:null,hasSearch:false,groups:[{id:1,align:'left'}],skin:'default',small:false,showTitleAsTooltip:false,showTitle:true,responsive:false},itemDefaults={dropdownOptions:{}},constants={collapsedWidth:50,dropdownToggleWidth:5,loaderWhiteColor:'white',loaderDarkColor:'#cccccc',markedClass:'marked'},selectors={dropdownMenu:'.toolbar-dropdown-menu'},templates={skeleton:['<div class="husky-toolbar">','</div>'].join('')},INITIALIZED=function(){return createEventName.call(this,'initialized');},DROPDOWN_OPENED=function(){return createEventName.call(this,'dropdown.opened');},DROPDOWN_CLOSED=function(){return createEventName.call(this,'dropdown.closed');},BUTTON_CHANGED=function(){return createEventName.call(this,'button.changed');},ITEM_SELECT=function(){return createEventName.call(this,'item.select');},ITEM_ENABLE=function(){return createEventName.call(this,'item.enable');},ITEM_DISABLE=function(){return createEventName.call(this,'item.disable');},ITEM_LOADING=function(){return createEventName.call(this,'item.loading');},ITEM_CHANGE=function(){return createEventName.call(this,'item.change');},ITEM_RESET=function(){return createEventName.call(this,'item.reset');},ITEM_HIDE=function(){return createEventName.call(this,'item.hide');},ITEM_SHOW=function(){return createEventName.call(this,'item.show');},ITEM_MARK=function(){return createEventName.call(this,'item.mark');},ITEM_UNMARK=function(){return createEventName.call(this,'item.unmark');},BUTTON_SET=function(){return createEventName.call(this,'button.set');},ITEMS_SET=function(){return createEventName.call(this,'items.set');},COLLAPSE=function(){return createEventName.call(this,'collapse');},EXPAND=function(){return createEventName.call(this,'expand');},bindDOMEvents=function(){this.sandbox.dom.on(this.$el,'click',function(event){this.sandbox.dom.stopPropagation(event);}.bind(this),'li .content');this.sandbox.dom.on(this.$el,'click',toggleItem.bind(this),'li');this.sandbox.dom.on(this.$el,'click',selectItem.bind(this),'li');if(this.options.responsive===true){$(window).on('resize.husky-toolbar-'+this.options.instanceName,updateOverflow.bind(this));}},bindCustomEvents=function(){this.sandbox.on(ITEM_DISABLE.call(this),function(id,highlight){if(!!this.items[id]){toggleEnabled.call(this,false,id,highlight);}}.bind(this));this.sandbox.on(ITEM_ENABLE.call(this),function(id,highlight){if(!!this.items[id]){toggleEnabled.call(this,true,id,highlight);}}.bind(this));this.sandbox.on(ITEM_LOADING.call(this),function(id){if(!!this.items[id]){itemLoading.call(this,id);}}.bind(this));this.sandbox.on(ITEM_HIDE.call(this),function(id){if(!!this.items[id]){hideItem.call(this,this.items[id].$el);}}.bind(this));this.sandbox.on(ITEM_SHOW.call(this),function(id){if(!!this.items[id]){showItem.call(this,this.items[id].$el);}}.bind(this));this.sandbox.on(COLLAPSE.call(this),function(call back){collapseAll.call(this);if(typeof callback==='function'){callback();}}.bind(this));this.sandbox.on(EXPAND.call(this),function(callback){expandAll.call(this);if(typeof callback==='function'){callback();}}.bind(this));this.sandbox.on(ITEM_MARK.call(this),uniqueMarkItem.bind(this));this.sandbox.on(ITEM_UNMARK.call(this),unmarkItem.bind(this));this.sandbox.on(ITEM_CHANGE.call(this),changeButton.bind(this));this.sandbox.on(ITEM_RESET.call(this),resetButton.bind(this));this.sandbox.on(BUTTON_SET.call(this),function(button,newData){changeMainListItem.call(this,this.items[button].$el,newData);}.bind(this));this.sandbox.on(ITEMS_SET.call(this),function(button,items,itemId){if(!!this.items[button]){if(items.length>0){deleteDropdown.call(this,this.items[button]);this.sandbox.dom.removeAttr(this.sandbox.dom.find('.dropdown-toggle',this.items[button].$el),'style');this.items[button].dropdownItems=items;createDropdownMenu.call(this,this.items[button].$el,this.items[button]);if(!!itemId){changeButton.call(this,this.items[button].id,itemId).then(function(item){if(!this.items[button].dropdownOptions||typeof this.items[button].dropdownOptions.preSelectedCallback!=='function'){return;}
this.items[button].dropdownOptions.preSelectedCallback(item);}.bind(this));}}else{deleteDropdown.call(this,this.items[button]);this.sandbox.dom.hide(this.sandbox.dom.find('.dropdown-toggle',this.items[button].$el));}}}.bind(this));},changeButton=function(buttonId,itemId,executeCallback){if(!this.items[buttonId]){return;}
var button=this.items[buttonId],deferred=$.Deferred();button.initialized.then(function(){var index=getItemIndexById.call(this,itemId,button);if(index===true){index=0;}
changeMainListItem.call(this,button.$el,button.dropdownItems[index]);this.sandbox.emit(ITEM_MARK.call(this),button.dropdownItems[index].id);if(executeCallback===true||!!button.dropdownItems[index].callback&&typeof button.dropdownItems[index].callback==='function'){button.dropdownItems[index].callback();}
deferred.resolve(button.dropdownItems[index]);}.bind(this));return deferred.promise();},resetButton=function(buttonId){if(!this.items[buttonId]){return;}
this.items[buttonId].initialized.then(function(){resetMainListItem.call(this,this.items[buttonId].$el);}.bind(this));},updateOverflow=function(){if(this.$el.width()<this.$el[0].scrollWidth){if(!this.collapsed){this.expandedWidth=this.$find('.husky-toolbar').outerWidth();collapseAll.call(this);updatedOverflowClass.call(this);}else{updatedOverflowClass.call(this);}}else{if(this.collapsed&&this.$el.width()>=this.expandedWidth){expandAll.call(this);this.expandedWidth=this.$find('.husky-toolbar').outerWidth();updatedOverflowClass.call(this);}else{updatedOverflowClass.call(this);}}},updatedOverflowClass=function(){if(this.$el.width()<this.$el[0].scrollWidth){this.$el.addClass('overflown');}else{this.$el.removeClass('overflown');}},lockToolbarScroll=function(){var scrollPos=this.$el.scrollLeft();this.$el.css({overflow:'visible'});this.$find('.husky-toolbar').css({'margin-left':((-1)*scrollPos)+'px'});},unlockToolbarScroll=function(){this.$el.removeAttr('style');this.$find('.husky-toolbar').removeAttr('style');},toggleEnabled=function(enabled,id,highlight){if(!this.items[id]){return;}
var item=this.items[id],$item=this.sandbox.dom.find('[data-id="'+id+'"]',this.$el);this.items[id].disabled=!enabled;if(item.loading){item.loading=false;this.sandbox.stop(this.sandbox.dom.find('.item-loader',$item));this.sandbox.dom.remove(this.sandbox.dom.find('.item-loader',$item));this.sandbox.dom.removeClass($item,'is-loading');this.sandbox.dom.width($item,'');}
if(highlight!==false){this.sandbox.dom.addClass($item,'highlight-animation');this.sandbox.dom.on($item,'animationend webkitAnimationEnd oanimationend MSAnimationEnd',function(ev){this.sandbox.dom.removeClass(ev.currentTarget,'highlight-animation');}.bind(this));}
if(!!enabled){this.sandbox.dom.removeClass($item,'disabled');}else{this.sandbox.dom.addClass($item,'disabled');}
if(this.options.responsive===true){updateOverflow.call(this);}},hideItem=function($button){this.sandbox.dom.addClass($button,'hidden');},showItem=function($button){this.sandbox.dom.removeClass($button,'hidden');},itemLoading=function(id){var item=this.items[id],$item=this.sandbox.dom.find('[data-id="'+id+'"]',this.$el),$loader,color=constants.loaderWhiteColor;if(item.loading){return;}
item.loading=true;this.sandbox.dom.width($item,this.sandbox.dom.width($item));this.sandbox.dom.addClass($item,'is-loading');$loader=this.sandbox.dom.createElement('<span class="item-loader"></span>');this.sandbox.dom.append($item,$loader);if(this.sandbox.dom.hasClass($item,'highlight-white')){color=constants.loaderDarkColor;}
this.sandbox.start([{name:'loader@husky',options:{el:$loader,size:this.options.small?'14px':'20px',color:color}}]);if(this.options.responsive===true){updateOverflow.call(this);}},toggleItem=function(event){event.preventDefault();event.stopPropagation();var $list=this.sandbox.dom.$(event.currentTarget),id=this.sandbox.dom.data($list,'id'),item=this.items[id],visible;if(!!this.sandbox.dom.find('.dropdown-toggle',$list).length){if(!item||item.disabled||(item.dropdownOptions.onlyOnClickOnArrow===true&&!this.sandbox.dom.hasClass(event.target,'dropdown-toggle'))){return false;}
if(this.sandbox.dom.hasClass($list,'is-expanded')){visible=true;}
hideDropdowns.call(this);if(!visible){this.sandbox.dom.addClass($list,'is-expanded');this.sandbox.dom.show(this.sandbox.dom.find(selectors.dropdownMenu,$list));this.sandbox.dom.one('body','click',hideDropdowns.bind(this));if(this.options.responsive===true){lockToolbarScroll.call(this);}
this.sandbox.emit(DROPDOWN_OPENED.call(this));}}},getItemIndexById=function(id,button){for(var i=-1,length=button.dropdownItems.length;++i<length;){if(button.dropdownItems[i].id===id){return i;}}
return id;},hideDropdowns=function(){this.sandbox.dom.removeClass(this.sandbox.dom.find('.is-expanded',this.$el),'is-expanded');this.sandbox.dom.hide(this.$find(selectors.dropdownMenu));if(this.options.responsive===true){unlockToolbarScroll.call(this);}
this.sandbox.emit(DROPDOWN_CLOSED.call(this));},selectItem=function(event){this.sandbox.dom.stopPropagation(event);this.sandbox.dom.preventDefault(event);var item=this.items[this.sandbox.dom.data(event.currentTarget,'id')],$parent=(!!this.items[item.parentId])?this.items[item.parentId].$el:null;if(item.loading||(!!item.dropdownItems&&item.dropdownOptions.onlyOnClickOnArrow!==true)||this.sandbox.dom.hasClass(event.target,'dropdown-toggle')){return false;}
hideDropdowns.call(this);if(!!item.parentId&&!!this.items[item.parentId].dropdownOptions&&this.items[item.parentId].dropdownOptions.markSelected===true){uniqueMarkItem.call(this,item.id);}
if(!item.disabled){triggerSelectEvent.call(this,item,$parent);}else{return false;}},triggerSelectEvent=function(item,$parent){var parentItem,original=item._original||item,$content=this.sandbox.dom.find('.content',this.items[item.id].$el);if(!!$content.length){this.sandbox.dom.click(this.sandbox.dom.children($content));}
if(item.parentId){parentItem=this.items[item.parentId];if(!!parentItem.dropdownOptions.changeButton){changeMainListItem.call(this,$parent,item);}
if(!!parentItem.dropdownOptions){if(typeof parentItem.dropdownOptions.callback==='function'){parentItem.dropdownOptions.callback(original);}}}
if(item.callback){item.callback();}else{this.sandbox.emit(ITEM_SELECT.call(this),item);}},resetMainListItem=function(listElement){var listItems=this.sandbox.dom.find('span',listElement),itemId=this.sandbox.dom.data(listElement).id,item=this.items[itemId];this.sandbox.dom.removeClass(listItems.eq(0),'');item.icon=item.defaultIcon;if(!!item.defaultIcon){this.sandbox.dom.addClass(listItems.eq(0),createIconSupportClass.call(this,item));}
item.title=this.sandbox.translate(item.defaultTitle);this.sandbox.dom.html(listItems.eq(1),item.title);this.items[itemId].title=item.title;if(!!item.dropdownItems){this.sandbox.dom.removeClass(selectors.dropdownMenu+' li','marked');}
if(this.options.responsive===true){updateOverflow.call(this);}
this.sandbox.emit(BUTTON_CHANGED.call(this));},changeMainListItem=function(listElement,item){var listItems=this.sandbox.dom.find('span',listElement),itemId=this.sandbox.dom.data(listElement).id;if(!!item.icon){this.sandbox.dom.removeClass(listItems.eq(0),'');this.sandbox.dom.addClass(listItems.eq(0),createIconSupportClass.call(this,item));this.items[itemId].icon=item.icon;}
if(!!item.title){item.title=this.sandbox.translate(item.title);this.sandbox.dom.html(listItems.eq(1),item.title);this.items[itemId].icon=item.title;}
if(this.options.responsive===true){updateOverflow.call(this);}
this.sandbox.emit(BUTTON_CHANGED.call(this));},createIconSupportClass=function(item){var classArray,classString='',icon=createIconClass.call(this,item);if(item.icon){classArray=[];classArray.push(icon);classArray.push('icon');classString=classArray.join(' ');}
return classString;},createIconClass=function(item){return'fa-'+item.icon;},createDropdownMenu=function(listItem,parent){var $list=this.sandbox.dom.createElement('<ul class="toolbar-dropdown-menu" />'),$item;this.sandbox.dom.append(listItem,$list);this.sandbox.util.foreach(parent.dropdownItems,function(dropdownItem){dropdownItem.title=this.sandbox.translate(dropdownItem.title);if(dropdownItem.divider){if(this.items[parent.id].dropdownItems.length<=2){return}
this.sandbox.dom.append($list,'<li class="divider"></li>');return;}
dropdownItem.parentId=parent.id;checkItemId.call(this,dropdownItem);$item=this.sandbox.dom.createElement('<li data-id="'+dropdownItem.id+'"><a href="#">'+dropdownItem.title+'</a></li>');dropdownItem.$el=$item;this.items[dropdownItem.id]=dropdownItem;if(dropdownItem.disabled===true){this.sandbox.dom.addClass($item,'disabled');}
if(dropdownItem.marked===true){uniqueMarkItem.call(this,dropdownItem.id);}
this.sandbox.dom.append($list,$item);}.bind(this));},uniqueMarkItem=function(itemId){if(!!this.items[itemId]&&!!this.items[itemId].parentId){this.sandbox.util.each(this.items,function(id,item){if(item.parentId===this.items[itemId].parentId){this.sandbox.dom.removeClass(item.$el,constants.markedClass);}}.bind(this));this.sandbox.dom.addClass(this.items[itemId].$el,constants.markedClass);}},unmarkItem=function(itemId){if(!!this.items[itemId]&&!!this.items[itemId].parentId){this.sandbox.dom.removeClass(this.items[itemId].$el,constants.markedClass);}},handleRequestedItems=function(requestedItems,buttonId){var id,title,icon,callback,divider,i,length;this.items[buttonId].dropdownItems=[];for(i=-1,length=requestedItems.length;++i<length;){if(!!this.items[buttonId].dropdownOptions.idAttribute){id=requestedItems[i][this.items[buttonId].dropdownOptions.idAttribute];}else if(!!requestedItems[i].id){id=requestedItems[i].id;}
if(!!this.items[buttonId].dropdownOptions.titleAttribute){title=requestedItems[i][this.items[buttonId].dropdownOptions.titleAttribute];}else if(!!requestedItems[i].title){title=requestedItems[i].title;}
if(!!this.items[buttonId].dropdownOptions.languageNamespace){title+=this.items[buttonId].dropdownOptions.languageNamespace+title;}
title=this.sandbox.translate(title);if(!!requestedItems[i].icon){icon=requestedItems[i].icon;}
if(!!requestedItems[i].callback){callback=requestedItems[i].callback;}
if(!!requestedItems[i].divider){divider=requestedItems[i].divider;}else{divider=false;}
this.items[buttonId].dropdownItems[i]={id:id,title:title,icon:icon,callback:callback,divider:divider,_original:requestedItems[i]};}
this.sandbox.emit(ITEMS_SET.call(this),buttonId,this.items[buttonId].dropdownItems,this.items[buttonId].dropdownOptions.preSelected);},collapseAll=function(){for(var key in this.items){if(this.items.hasOwnProperty(key)){toggleCollapseButton.call(this,this.items[key],true);}}
this.collapsed=true;},expandAll=function(){for(var key in this.items){if(this.items.hasOwnProperty(key)){toggleCollapseButton.call(this,this.items[key],false);}}
this.collapsed=false;},toggleCollapseButton=function(button,collapse){if(!button.parentId&&!!button.icon){if(collapse===true){this.sandbox.dom.hide(this.sandbox.dom.find('.title',button.$el));}else{this.sandbox.dom.removeAttr(this.sandbox.dom.find('.title',button.$el),'style');}}},sortData=function(data){for(var i=-1,length=data.length;++i<length;){if(typeof data[i].position!=='number'){data[i].position=9000;}}
data=data.sort(function(a,b){return a.position-b.position;});return data;},checkItemId=function(item){if(!item.id||!!this.items[item.id]){do{item.id=this.sandbox.util.uniqueId();}while(!!this.items[item.id]);}
if(!item.disabled){item.disabled=false;}},deleteDropdown=function(button){if(!!button.dropdownItems){this.sandbox.dom.remove(this.sandbox.dom.find(selectors.dropdownMenu,button.$el));this.sandbox.dom.hide(this.sandbox.dom.find('.dropdown-toggle',button.$el));for(var i=-1,length=button.dropdownItems.length;++i<length;){delete this.items[button.dropdownItems[i].id];}
button.dropdownItems=[];}},insertSearch=function($item){var searchOptions;this.sandbox.dom.removeClass($item);this.sandbox.dom.addClass($item,'toolbar-search');this.sandbox.dom.append($item,'<div id="'+this.options.instanceName+'-toolbar-search"/>');searchOptions={el:'#'+this.options.instanceName+'-toolbar-search',instanceName:this.options.instanceName,appearance:'white small',slide:true};searchOptions=this.sandbox.util.extend(true,{},searchOptions,this.options.searchOptions);this.sandbox.start([{name:'search@husky',options:searchOptions}]);},addSkinClass=function($element){if(this.options.skin!=='default'){this.sandbox.dom.addClass($element,this.options.skin);}},pushSearch=function(data){var searchGroup={id:'search',align:'right'};this.options.groups.unshift(searchGroup);data.push({id:'search',hasSearch:true,group:'search'});return data;},createEventName=function(postFix){return'husky.toolbar.'+(this.options.instanceName?this.options.instanceName+'.':'')+postFix;};return{initialize:function(){this.options=this.sandbox.util.extend(true,{},defaults,this.options);this.collapsed=false;this.itemGroups={};this.items={};this.expandedWidth=0;if(!!this.options.url){this.sandbox.util.load(this.options.url).then(this.render.bind(this)).fail(function(data){this.sandbox.logger.log('data could not be loaded:',data);}.bind(this));}else if(!!this.options.buttons){this.render((this.options.buttons));}else{this.sandbox.logger.log('no data provided for tabs!');}
bindDOMEvents.call(this);bindCustomEvents.call(this);if(this.options.responsive===true){updateOverflow.call(this);}
this.sandbox.emit(INITIALIZED.call(this));},destroy:function(){$(window).off('resize.husky-toolbar-'+this.options.instanceName);},render:function(data){var classArray,addTo,$listItem,title;if(this.options.hasSearch===true){data=pushSearch.call(this,data);}
this.renderSkeleton();data=sortData.call(this,data);this.sandbox.util.foreach(data,function(item){item=this.sandbox.util.extend(true,{},item,itemDefaults);item.title=this.sandbox.translate(item.title);checkItemId.call(this,item);var dfd=this.sandbox.data.deferred();item.defaultTitle=item.title;item.defaultIcon=item.icon;this.items[item.id]=item;this.items[item.id].initialized=dfd.promise();classArray=['toolbar-item'];if(!!item['class']){classArray.push(item['class']);}
if(item.hidden){classArray.push('hidden');}
if(item.disabled){classArray.push('disabled');}
if(!!item.group&&!!this.itemGroups[item.group]){addTo=this.itemGroups[item.group];}else{addTo=this.itemGroups[Object.keys(this.itemGroups)[0]];}
$listItem=this.sandbox.dom.createElement('<li class="'+classArray.join(' ')+'" data-id="'+item.id+'"/>');if(item.hasSearch===true){insertSearch.call(this,$listItem);}else{if(!!item.icon){this.sandbox.dom.append($listItem,'<span class="'+createIconSupportClass.call(this,item)+'" />');}
if(!!item.content){var $contentSpan=this.sandbox.dom.createElement('<span class="content"/>');this.sandbox.dom.append($contentSpan,item.content);this.sandbox.dom.append($listItem,$contentSpan);this.sandbox.start($contentSpan);}
title=(!!item.title&&this.options.showTitle===true)?item.title:'';this.sandbox.dom.append($listItem,'<span class="title">'+title+'</span>');this.sandbox.dom.append($listItem,this.sandbox.dom.createElement('<span class="dropdown-toggle" />'));this.sandbox.dom.hide(this.sandbox.dom.find('.dropdown-toggle',$listItem));if(this.options.showTitleAsTooltip===true){this.sandbox.dom.attr($listItem,{'title':title});}
if(item.hidden===true){hideItem.call(this,$listItem);}
if(!!item.dropdownOptions&&!!item.dropdownOptions.url){this.sandbox.util.load(item.dropdownOptions.url).then(function(result){var data=result[this.options.dropdownItemsKey];if(!!item.dropdownOptions.resultKey){data=data[item.dropdownOptions.resultKey];}
if(!!item.dropdownItems){data=data.concat(item.dropdownItems);}
handleRequestedItems.call(this,data,item.id);dfd.resolve();}.bind(this)).fail(function(result){this.sandbox.logger.log('dorpdown-items could not be loaded',result);}.bind(this));}else{if(!!item.dropdownItems){this.sandbox.dom.removeAttr(this.sandbox.dom.find('.dropdown-toggle',$listItem),'style');createDropdownMenu.call(this,$listItem,item);}
dfd.resolve();}}
this.sandbox.dom.append(addTo,$listItem);this.items[item.id].$el=$listItem;}.bind(this));},renderSkeleton:function(){var i,length,$group,$skeleton;$skeleton=this.sandbox.dom.createElement(templates.skeleton);if(this.options.small===true){this.sandbox.dom.addClass($skeleton,'small');}
addSkinClass.call(this,$skeleton);for(i=-1,length=this.options.groups.length;++i<length;){$group=this.sandbox.dom.createElement('<ul class="group"/>');if(!!this.options.groups[i].align){this.sandbox.dom.addClass($group,this.options.groups[i].align);}else{this.sandbox.dom.addClass($group,'left');}
this.sandbox.dom.append($skeleton,$group);this.itemGroups[this.options.groups[i].id]=$group;}
this.sandbox.dom.append(this.$el,$skeleton);this.sandbox.dom.addClass(this.sandbox.dom.last(this.sandbox.dom.find('.group.left',this.$el)),'last');if(this.options.responsive===true){this.$el.addClass('husky-toolbar-responsive');}}};});define('__component__$auto-complete@husky',[],function(){'use strict';var defaults={prefetchUrl:'',localData:[],remoteUrl:'',getParameter:'query',valueKey:'name',resultKey:'countries',value:null,instanceName:'undefined',noNewValues:false,suggestionClass:'suggestion',suggestionIcon:'',autoCompleteIcon:'search',stickToInput:false,hint:false,emptyOnBlur:false,excludes:[],selectCallback:null,fields:[],dropdownSizeClass:'',footerContent:'',limit:5},templates={main:['<div class="husky-auto-complete <%= dropdownSizeClass %>">','    <div class="front">','       <a class="fa-<%= autoCompleteIcon %>"></a>','    </div>','    <div class="input"></div>','    <div class="back">','       <div class="loader" style="display: none;"></div>','    </div>','</div>'].join('')},eventNamespace='husky.auto-complete.',INITIALIZED=function(){return createEventName.call(this,'initialized');},PREFETCH_LOAD=function(){return createEventName.call(this,'prefetch-data');},REMOTE_LOAD=function(){return createEventName.call(this,'remote-data-load');},REMOTE_RETRIEVE=function(){return createEventName.call(this,'remote-data');},REQUEST_MATCH=function(){return createEventName.call(this,'request-match');},SELECT=function(){return createEventName.call(this,'select');},SELECTION_REMOVED=function(){return createEventName.call(this,'selection-removed');},SET_EXCLUDES=function(){return createEventName.call(this,'set-excludes');},IS_MATCHED=function(){return createEventName.call(this,'is-matched');},FOOTER_CLICKED=function(){return createEventName.call(this,'footer.clicked');},createEventName=function(postFix){return eventNamespace+(this.options.instanceName?this.options.instanceName+'.':'')+postFix;};return{getValueID:function(){if(!!this.options.value){return this.options.value.id;}else{return null;}},getValueName:function(){if(!!this.options.value){return this.sandbox.util.escapeHtml(this.options.value[this.options.valueKey]);}else{return'';}},initialize:function(){this.sandbox.logger.log('initialize',this);this.sandbox.logger.log(arguments);this.options=this.sandbox.util.extend({},defaults,this.options);this.suggestionTpl=null;this.footerTpl=null;this.data=null;this.matched=true;this.matches=[];this.excludes=this.parseExcludes(this.options.excludes);this.localData={};this.localData._embedded={};this.localData._embedded[this.options.resultKey]=this.options.localData;this.setTemplates();this.render();this.bindDomEvents();this.setCustomEvents();this.sandbox.emit(INITIALIZED.call(this),this.$valueField);},setTemplates:function(){var iconHTML='';if(this.options.suggestionIcon!==''){iconHTML='<span class="fa-'+this.options.suggestionIcon+' icon"></span>';}
if(this.options.fields.length){this.suggestionTpl=this.sandbox.util.template(''+'<div class="'+this.options.suggestionClass+'" data-id="<%= context[\'id \']%>">'+'   <div class="border">'+'       <div class="text">'+'           <% _.each(fields, function(field, idx) { %>'+'           <div class="suggestion-column" style="width: <%= field.width %>;"><%= context[field.id] %></div>'+'           <% }) %>'+'       </div>'+'   </div>'+'</div>');}else{this.suggestionTpl=this.sandbox.util.template(''+'<div class="'+this.options.suggestionClass+'" data-id="<%= context[\'id \']%>">'+'   <div class="border">'+
iconHTML+'       <div class="text"><%= context[this.options.valueKey] %></div>'+'   </div>'+'</div>');}
if(!!this.options.footerContent){this.footerTpl=this.sandbox.util.template('<div class="auto-complete-footer">'+
this.options.footerContent+'</div>');}},buildSuggestionTemplate:function(context){var domObj;if(this.suggestionTpl!==null){domObj=this.sandbox.dom.createElement(this.suggestionTpl({context:context,fields:this.options.fields}));if(this.isExcluded(context)){this.sandbox.dom.addClass(domObj,'disabled');}
return this.sandbox.dom.html(this.sandbox.dom.append(this.sandbox.dom.$('<div/>'),domObj));}},renderMain:function(){this.sandbox.dom.html(this.$el,this.sandbox.template.parse(templates.main,{autoCompleteIcon:this.options.autoCompleteIcon,dropdownSizeClass:this.options.dropdownSizeClass}));},render:function(){this.renderMain();this.initValueField();this.appendValueField();this.sandbox.start([{name:'loader@husky',options:{el:this.$el.find('.loader'),color:'#ccc',size:'20px'}}]);this.bindTypeahead();},initValueField:function(){this.$valueField=this.sandbox.dom.createElement('<input id="'+this.options.instanceName+'" '+'class="husky-validate" '+'type="text" '+'autofill="false" '+'autocomplete="off"'+'data-id="'+this.getValueID()+'" '+'value="'+this.getValueName()+'"/>');},appendValueField:function(){if(!!this.$valueField.length){this.sandbox.dom.append(this.sandbox.dom.find('.input',this.$el),this.$valueField);}},bindTypeahead:function(){var delimiter=(this.options.remoteUrl.indexOf('?')===-1)?'?':'&',configs={name:this.options.instanceName,local:this.handleData(this.localData),limit:this.options.limit,displayKey:this.options.valueKey,templates:{suggestion:function(context){this.matches.push(context);this.matched=true;return this.buildSuggestionTemplate(context);}.bind(this),footer:function(){if(!!this.footerTpl){return this.footerTpl();}
return null;}.bind(this)}};if(!!this.options.prefetchUrl){configs.prefetch={url:this.options.prefetchUrl,ttl:1,filter:function(data){this.sandbox.emit(PREFETCH_LOAD.call(this),this.handleData(data));return this.data;}.bind(this)};}
if(!!this.options.remoteUrl){configs.remote={url:this.options.remoteUrl+delimiter+this.options.getParameter+'=%QUERY',ajax:{beforeSend:function(){this.sandbox.emit(REMOTE_LOAD.call(this));this.showLoader();}.bind(this)},filter:function(data){this.sandbox.emit(REMOTE_RETRIEVE.call(this),this.handleData(data));this.hideLoader();return this.data;}.bind(this)};}
this.sandbox.autocomplete.init(this.$valueField,configs);if(this.options.stickToInput===false){this.sandbox.dom.css(this.sandbox.dom.find('.twitter-typeahead',this.$el),'position','static');}
if(this.options.hint===false){this.sandbox.dom.remove(this.sandbox.dom.find('.tt-hint',this.$el));}},showLoader:function(){this.$el.find('.loader').show();},hideLoader:function(){this.$el.find('.loader').hide();},isExcluded:function(context){for(var i=-1,length=this.excludes.length;++i<length;){if(context.id!==null&&context.id===this.excludes[i].id){return true;}else if(context[this.options.valueKey]!==null&&context[this.options.valueKey]===this.excludes[i][this.options.valueKey]){return true;}}
return false;},setCustomEvents:function(){this.sandbox.on(SET_EXCLUDES.call(this),function(excludes){this.excludes=this.parseExcludes(excludes);}.bind(this));this.sandbox.on(IS_MATCHED.call(this),function(callback){if(this.isMatchedExactly()===true&&this.getClosestMatch()!==null){callback(true);}else{this.checkMatches(this.getValueFieldValue(),callback,true);}}.bind(this));this.sandbox.on('husky.auto-complete.'+this.options.instanceName+'.select',function(data){this.selectedElement=data;}.bind(this));},parseExcludes:function(excludes){var arrayReturn=[];if(!!excludes.length){this.sandbox.util.foreach(excludes,function(exclude){if(typeof exclude!=='object'){arrayReturn.push({id:null,name:exclude});}else{arrayReturn.push(exclude);}}.bind(this));}
return arrayReturn;},bindDomEvents:function(){this.sandbox.dom.on(this.$valueField,'typeahead:selected',function(event,datum){if(this.isExcluded(datum)){this.sandbox.dom.stopPropagation(event);this.clearValueFieldValue();}else{this.sandbox.emit(SELECT.call(this),datum);this.setValueFieldId(datum.id);if(typeof this.options.selectCallback==='function'){this.options.selectCallback.call(this,datum,event);}}}.bind(this));this.sandbox.dom.on(this.$valueField,'keypress',function(event){if(event.keyCode!==13){this.matched=false;this.matches=[];}}.bind(this));this.sandbox.dom.on(this.sandbox.dom.find('.tt-dropdown-menu',this.$el),'click',function(){return false;}.bind(this),'.disabled');this.sandbox.dom.on(this.$valueField,'blur',function(){if(this.options.emptyOnBlur===false){this.handleBlur();}else{this.clearValueFieldValue();}}.bind(this));this.sandbox.dom.on(this.$el,'click',function(){this.sandbox.dom.blur(this.$valueField);this.clearValueFieldValue();this.sandbox.emit(FOOTER_CLICKED.call(this));}.bind(this),'.auto-complete-footer');this.sandbox.dom.on(this.$valueField,'focusout',function(){if(this.sandbox.dom.val(this.$valueField)===''){var dataId=this.sandbox.dom.attr(this.$valueField,'data-id');if(dataId!=null&&dataId!=='null'){this.sandbox.dom.removeAttr(this.$valueField,'data-id');this.sandbox.dom.data(this.$valueField,'id','null');this.sandbox.emit(SELECTION_REMOVED.call(this));}}}.bind(this));},handleBlur:function(){if(!!this.selectedElement){this.selectedElement=null;}else if(this.options.noNewValues===true){if(this.isMatched()===true&&this.getClosestMatch()!==null){this.setValueFieldValue(this.getClosestMatch().name);this.setValueFieldId(this.getClosestMatch().id);}else{if(this.getValueFieldValue()!==''){this.checkMatches(this.getValueFieldValue(),function(isMatched){if(isMatched===true){this.setValueFieldValue(this.getClosestMatch().name);this.setValueFieldId(this.getClosestMatch().id);}else{this.clearValueFieldValue();}}.bind(this),false);}}}else{if(this.isMatchedExactly()===true&&this.getClosestMatch()!==null){this.setValueFieldValue(this.getClosestMatch().name);this.setValueFieldId(this.getClosestMatch().id);}}},checkMatches:function(string,callback,exactly){var delimiter=(this.options.remoteUrl.indexOf('?')===-1)?'?':'&';this.sandbox.emit(REQUEST_MATCH.call(this));this.sandbox.util.ajax({url:this.options.remoteUrl+delimiter+this.options.getParameter+'='+string,success:function(data){this.matches=this.handleData(data);if(exactly!==true){if(this.matches.length>0){callback(true);}else{callback(false);}}else{if(this.isMatchedExactly()===true){callback(true);}else{callback(false);}}}.bind(this),error:function(error){this.sandbox.logger.log('Error requesting auto-complete-matches',error);callback(false);}.bind(this)});},getClosestMatch:function(){if(!!this.matches.length&&this.getValueFieldValue()!==''){return this.matches[0];}
return null;},getValueFieldValue:function(){return this.sandbox.dom.val(this.$valueField);},setValueFieldValue:function(value){this.sandbox.autocomplete.setValue(this.$valueField,value);},clearValueFieldValue:function(){this.sandbox.autocomplete.setValue(this.$valueField,'');},setValueFieldId:function(id){this.sandbox.dom.attr(this.$valueField,{'data-id':id});this.sandbox.dom.data(this.$valueField,'id',id);},isMatched:function(){return this.matched;},isMatchedExactly:function(){if(this.getClosestMatch()!==null){if(this.getValueFieldValue().toLowerCase()===this.getClosestMatch().name.toLowerCase()){return true;}}
return false;},handleData:function(data){if(typeof data==='object'){this.data=[];this.sandbox.util.foreach(data._embedded[this.options.resultKey],function(key){if(this.isExcluded(key)===false){this.data.push(key);}}.bind(this));return this.data;}
return false;}};});define('__component__$auto-complete-list@husky',[],function(){'use strict';var defaults={instanceName:'undefined',items:[],itemsUrl:'',resultKey:'tags',suggestions:[],suggestionsHeadline:'',suggestionsUrl:'',suggestionsKey:'suggestions',label:'',inputSelector:'.husky-auto-complete-container',autocomplete:true,localData:[],prefetchUrl:'',remoteUrl:'',autocompleteOptions:{},getParameter:'query',maxListItems:0,CapitalizeFirstLetter:false,listItemClass:'auto-complete-list-selection',suggestionDeactivatedClass:'deactivated',AjaxPush:'',AjaxPushAllItems:false,AjaxPushParameters:null,togglerSelector:'.toggler',arrowDownClass:'fa-caret-down',arrowUpClass:'fa-caret-up',slideDuration:500,elementTagDataName:'tags',autoCompleteIcon:'search',suggestionIcon:'tag',delimiters:[9,188,13],noNewTags:false},templates={main:['<div class="auto-complete-list-container">','    <label>','        <%= label %>','        <div class="auto-complete-list">','           <div class="husky-auto-complete-container"></div>','           <div class="toggler"></div>','        </div>','    </label>','</div>'].join(''),suggestion:['<div class="auto-complete-list-suggestions">','    <h5><%= headline %></h5>','    <ul></ul>','</div>'].join('')},togglerPosUp='up',togglerPosDown='down',eventNamespace='husky.auto-complete-list.',INITIALIZED=function(){return createEventName.call(this,'initialized');},SET_TAGS=function(){return createEventName.call(this,'set-tags');},GET_TAGS=function(){return createEventName.call(this,'get-tags');},ITEM_REQUEST=function(){return createEventName.call(this,'item-request');},SUGGESTION_REQUEST=function(){return createEventName.call(this,'sug-request');},SUGGESTION_ADDED=function(){return createEventName.call(this,'sug-added');},ITEM_DELETED=function(){return createEventName.call(this,'item-deleted');},DATA_LOADED=function(){return createEventName.call(this,'data-loaded');},ITEM_ADDED=function(){return createEventName.call(this,'item-added');},ITEMS_ADDED=function(){return createEventName.call(this,'items-added');},SUGGESTIONS_CLOSED=function(){return createEventName.call(this,'sug-closed');},SUGGESTIONS_OPENED=function(){return createEventName.call(this,'sug-opened');},createEventName=function(postFix){return eventNamespace+(this.options.instanceName?this.options.instanceName+'.':'')+postFix;};return{initialize:function(){this.sandbox.logger.log('initialize',this);this.setVars();this.options=this.sandbox.util.extend({},defaults,this.options);this.renderMain();this.initInputCont();this.initSuggestions();this.initItems();if(this.options.autocomplete===true){this.sandbox.on('husky.auto-complete.'+this.options.instanceName+'.initialized',function(){this.sandbox.emit(INITIALIZED.call(this));}.bind(this));}else{this.sandbox.emit(INITIALIZED.call(this));}},setVars:function(){this.suggestions=[];this.$suggestions=null;this.$input=null;this.tagApi=null;this.toggler=null;this.$inputCont=null;},renderMain:function(){this.sandbox.dom.html(this.$el,_.template(templates.main)({label:this.options.label}));},initInputCont:function(){this.$inputCont=this.sandbox.dom.find(this.options.inputSelector,this.$el);if(!this.$inputCont.length){this.sandbox.logger.log('Initializing input-container failed.');return false;}
return true;},startPlugins:function(){if(this.options.autocomplete===true){this.bindStartTmEvent();this.startAutocomplete();}else{this.initInput();this.appendInput();this.startTagmanager();this.bindEvents();}},initInput:function(){this.$input=this.sandbox.dom.createElement('<input type="text" autocomplete="off"/>');},appendInput:function(){if(!!this.$input.length){this.sandbox.dom.append(this.$inputCont,this.$input);}},startAutocomplete:function(){this.sandbox.start([{name:'auto-complete@husky',options:this.sandbox.util.extend({el:this.$inputCont,emptyOnBlur:true,instanceName:this.options.instanceName,localData:this.options.localData,prefetchUrl:this.options.prefetchUrl,remoteUrl:this.options.remoteUrl,getParameter:this.options.getParameter,suggestionIcon:this.options.suggestionIcon,autoCompleteIcon:this.options.autoCompleteIcon,resultKey:this.options.resultKey,footerContent:this.options.footerContent},this.options.autocompleteOptions)}]);},startTagmanager:function(){this.tagApi=this.sandbox.autocompleteList.init(this.$input,{tagClass:this.options.listItemClass,prefilled:this.options.items,tagCloseIcon:'',maxTags:this.options.maxListItems,AjaxPush:this.options.AjaxPush,AjaxPushAllTags:this.options.AjaxPushAllItems,AjaxPushParameters:this.options.AjaxPushParameters,C apitalizeFirstLetter:this.options.CapitalizeFirstLetter,delimiters:[]});this.setElementDataTags();},bindStartTmEvent:function(){this.sandbox.once('husky.auto-complete.'+this.options.instanceName+'.initialized',function(data){this.$input=data;this.startTagmanager();this.bindEvents();}.bind(this));},bindEvents:function(){this.sandbox.on(GET_TAGS.call(this),function(callback){if(typeof callback==='function'){callback(this.getTags());}else{this.sandbox.logger.log('Error: Callback is not a function');}}.bind(this));this.sandbox.on(SET_TAGS.call(this),function(tags){this.pushTags(tags);}.bind(this));this.sandbox.on(ITEM_ADDED.call(this),function(){this.setElementDataTags();this.sandbox.emit('husky.auto-complete.'+this.options.instanceName+'.set-excludes',this.getTags());}.bind(this));this.sandbox.on(ITEM_DELETED.call(this),function(){this.sandbox.emit('husky.auto-complete.'+this.options.instanceName+'.set-excludes',this.getTags());}.bind(this));this.sandbox.on('husky.auto-complete.'+this.options.instanceName+'.select',function(d){this.pushTag(d.name);}.bind(this));this.sandbox.dom.on(this.$input,'keydown',function(event){if(event.keyCode===8&&this.sandbox.dom.val(this.$input).trim()===''){this.itemDeleteHandler();this.setElementDataTags();}
if(this.options.delimiters.indexOf(event.keyCode)!==-1){this.pushTagHandler(event,this.sandbox.dom.val(this.$input).trim());}}.bind(this));this.sandbox.dom.on(this.$el,'click',function(event){if(this.sandbox.dom.hasClass(event.target,'tm-tag-remove')===true){this.itemDeleteHandler();this.setElementDataTags();}}.bind(this));if(this.toggler!==null){this.sandbox.dom.on(this.toggler.$el,'click',function(event){this.sandbox.dom.preventDefault(event);this.changeToggler();this.toggleSuggestions();}.bind(this));}},pushTagHandler:function(event,tag){if(event.keyCode!==9){this.sandbox.dom.preventDefault(event);}
if(this.options.noNewTags!==true){this.pushTag(tag);}else{this.sandbox.emit('husky.auto-complete.'+this.options.instanceName+'.is-matched',function(isMatched){if(isMatched===true){this.pushTag(tag);}}.bind(this));}},setElementDataTags:function(){var tags=this.getTags();this.sandbox.dom.data(this.$el,this.options.elementTagDataName,tags);},initItems:function(){if(this.options.itemsUrl!==''){this.requestItems();}else{this.startPlugins();}},requestItems:function(){this.sandbox.util.ajax({url:this.options.itemsUrl,success:function(data){this.options.items=this.options.items.concat(data._embedded[this.options.resultKey]);this.startPlugins();DATA_LOADED.call(this);}.bind(this),error:function(error){this.sandbox.logger.log(error);}.bind(this)});this.sandbox.emit(ITEM_REQUEST.call(this));},initSuggestions:function(){if(this.options.suggestionsUrl!==''){this.requestSuggestions();}else{this.loadSuggestions();this.renderSuggestions();this.initToggler();}},requestSuggestions:function(){this.sandbox.util.ajax({url:this.options.suggestionsUrl,success:function(data){this.options.suggestions=this.options.suggestions.concat(data[this.options.suggestionsKey]);this.loadSuggestions();this.renderSuggestions();this.initToggler();}.bind(this),error :function(error){this.sandbox.logger.log(error);}.bind(this)});this.sandbox.emit(SUGGESTION_REQUEST.call(this));},loadSuggestions:function(){if(!!this.options.suggestions.length){for(var i=-1,length=this.options.suggestions.length;++i<length;){this.suggestions[i]={name:this.options.suggestions[i],$el:this.sandbox.dom.createElement('<li/>')};this.sandbox.dom.html(this.suggestions[i].$el,this.suggestions[i].name);}}},renderSuggestions:function(){if(!!this.options.suggestions.length){var box,list,i=-1,length=this.suggestions.length;box=this.sandbox.dom.parseHTML(_.template(templates.suggestion)({headline:this.options.suggestionsHeadline}));list=this.sandbox.dom.children(box,'ul');for(;++i<length;){this.sandbox.dom.append(list,this.suggestions[i].$el);this.bindSuggestionEvents(this.suggestions[i]);}
this.$suggestions=box;this.sandbox.dom.append(this.$el,this.$suggestions);}},initToggler:function(){if(!!this.options.suggestions.length){this.toggler={$el:this.sandbox.dom.find(this.options.togglerSelector,this.$el),pos:togglerPosUp};this.sandbox.dom.prependClass(this.toggler.$el,this.options.arrowUpClass);}},changeToggler:function(){if(this.toggler.pos===togglerPosDown){this.togglerUp();}else{this.togglerDown();}},toggleSuggestions:function(){if(this.toggler.pos===togglerPosDown){this.hideSuggestions();}else{this.showSuggestions();}},hideSuggestions:function(){this.sandbox.dom.slideUp(this.$suggestions,this.options.slideDuration);this.sandbox.emit(SUGGESTIONS_CLOSED.call(this));},showSuggestions:function(){this.sandbox.dom.slideDown(this.$suggestions,this.options.slideDuration);this.sandbox.emit(SUGGESTIONS_OPENED.call(this));},togglerDown:function(){this.sandbox.dom.removeClass(this.toggler.$el,this.options.arrowUpClass);this.sandbox.dom.prependClass(this.toggler.$el,this.optio ns.arrowDownClass);this.toggler.pos=togglerPosDown;},togglerUp:function(){this.sandbox.dom.removeClass(this.toggler.$el,this.options.arrowDownClass);this.sandbox.dom.prependClass(this.toggler.$el,this.options.arrowUpClass);this.toggler.pos=togglerPosUp;},bindSuggestionEvents:function(suggestion){this.sandbox.dom.on(suggestion.$el,'click',function(){if(!this.sandbox.dom.hasClass(suggestion,this.options.suggestionDeactivatedClass)){this.pushTag(suggestion.name);this.deactivateSuggestion(suggestion);this.sandbox.emit(SUGGESTION_ADDED.call(this),suggestion);}}.bind(this));},itemDeleteHandler:function(){this.refreshSuggestions();this.sandbox.emit(ITEM_DELETED.call(this));},deactivateSuggestion:function(suggestion){this.sandbox.dom.addClass(suggestion.$el,this.options.suggestionDeactivatedClass);},activateSuggestion:function(suggestion){this.sandbox.dom.removeClass(suggestion.$el,this.options.suggestionDeactivatedClass);},refreshSuggestions:function(){for(var i=-1,length=this.suggestions.length;++i<length;){if(this.sandbox.dom.hasClass(this.suggestions[i].$el,this.options.suggestionDeactivatedClass)===true){if(this.suggestionContainedInTags(this.suggestions[i])===false){this.activateSuggestion(this.suggestions[i]);}}}},suggestionContainedInTags:function(suggestion){var tags=this.getTags(),i,length;for(i=-1,length=tags.length;++i<length;){if(tags[i]===suggestion.name){return true;}}
return false;},pushTag:function(value){if(this.tagApi!==null){this.tagApi.tagsManager('pushTag',value);this.sandbox.emit(ITEM_ADDED.call(this),value);}else{return false;}},pushTags:function(tags){for(var i=-1,length=tags.length;++i<length;){this.pushTag(tags[i]);}
this.sandbox.emit(ITEMS_ADDED.call(this));},getTags:function(){if(this.tagApi!==null){return this.tagApi.tagsManager('tags');}else{return[];}}};});define('__component__$dependent-select@husky',[],function(){'use strict';var defaults={url:null,data:[],instanceName:'',preselect:null,defaultLabels:'Please choose',selectOptions:[],container:null,isNative:false,deselectField:false},constants={childContainerClass:'dependent-select-container',namespace:'husky.dependent-select.'},INITIALIZED=function(){return getEventName.call(this,'initialized');},ITEM_SELECTED=function(){return getEventName.call(this,'item.selected');},ITEM_DESELECTED=function(){return getEventName.call(this,'item.deselected');},ALL_ITEMS_DESELECTED=function(){return getEventName.call(this,'all.items.deselected');},ALL_ITEMS_SELECTED=function(){return getEventName.call(this,'all.items.selected');},getEventName=function(postFix){return constants.namespace+(this.options.instanceName?this.options.instanceName+'.':'')+postFix;},renderEmptySelect=function(depth){var i,len,$child;for(i=depth,len=this.options.container.length;++i<len;){$child=findStopAndCreateNewChild.call(this,this.options.container[i]);this.sandbox.start([{name:'select@husky',options:{el:$child,disabled:true,singleSelect:true,instanceName:i,data:[],isNative:this.options.isNative,deselectField:this.options.deselectField,defaultLabel:this.sandbox.dom.isArray(this.options.defaultLabels)?this.options.defaultLabels[depth]:this.options.defaultLabels}}]);}},getDataById=function(data,id){for(var i=-1,len=data.length;++i<len;){if(data[i].id.toString()===id.toString()){return data[i];}}
return null;},findStopAndCreateNewChild=function(containerId){var $container=this.$find(containerId),$child=this.sandbox.dom.find('.'+constants.childContainerClass,$container);if(!$container){throw'dependent-select: no container with id '+containerId+' could be found';}
if(!!$child){this.sandbox.stop($child);}
$child=this.sandbox.dom.createElement('<div class="'+constants.childContainerClass+'" />');this.sandbox.dom.append($container,$child);return $child;},checkAllSelected=function(){var $lastContainer=this.$find(this.options.container[this.options.container.length-1]),lastSelectElement=this.sandbox.dom.children($lastContainer)[0],selection=this.sandbox.dom.data(lastSelectElement,'selection');if(!!lastSelectElement&&typeof selection!=='undefined'){if(!this.allSelected){this.allSelected=true;this.sandbox.emit(ALL_ITEMS_SELECTED.call(this));}}else if(this.allSelected){this.allSelected=false;this.sandbox.emit(ALL_ITEMS_DESELECTED.call(this));}},renderSelect=function(data,depth,preselect){depth=typeof depth!=='undefined'?depth:0;if(!this.options.container||!this.options.container[depth]){throw'dependent-select: no container at depth '+depth+' specified';}
var selectionCallback=null,deselectionCallback=null,options,$child=findStopAndCreateNewChild.call(this,this.options.container[depth]);selectionCallback=function(id){if(this.options.container.length>depth&&!!data[0].items){var items=getDataById.call(this,data,id).items;renderSelect.call(this,items,depth+1);}
this.sandbox.emit(ITEM_SELECTED.call(this),id,depth);checkAllSelected.call(this);}.bind(this);deselectionCallback=function(id){if(this.options.container.length>depth&&!!data[0].items){if(id===null){renderEmptySelect.call(this,depth);}}
this.sandbox.emit(ITEM_DESELECTED.call(this),id,depth);checkAllSelected.call(this);}.bind(this);if(!!this.options.selectOptions[depth]){options=this.options.selectOptions[depth];}
options=this.sandbox.util.extend(true,{},{el:$child,singleSelect:true,instanceName:depth,data:data,selectCallback:selectionCallback,deselectCallback:deselectionCallback,isNative:this.options.isNative,preSelectedElements:!!preselect?[preselect]:[],deselectField:this.options.deselectField,defaultLabel:this.sandbox.dom.isArray(this.options.defaultLabels)?this.options.defaultLabels[depth]:this.options.defaultLabels},options);this.sandbox.start([{name:'select@husky',options:options}]);};return{initialize:function(){this.options=this.sandbox.util.extend(true,{},defaults,this.options);if(!!this.options.url){this.sandbox.util.load(this.options.url).then(this.render.bind(this)).fail(function(data){this.sandbox.logger.log('data could not be loaded:',data);}.bind(this));}else if(!!this.options.data){this.render(this.options.data);}else{this.sandbox.logger.log('no data provided for dependent select!');}},render:function(data){renderSelect.call(this,data,0,this.options.preselect);renderEmptySelect.call(this,!!this.options.preselect?this.options.preselect.length:0);this.sandbox.emit(INITIALIZED.call(this));}};});define('__component__$select@husky',[],function(){'use strict';var translations={addItem:'select.add-item',editEntries:'select.edit-entries'},defaults={data:[],valueName:'name',instanceName:'undefined',defaultLabel:'Please choose',checkedAllLabel:'All Languages',preSelectedElements:[],multipleSelect:false,deselectField:false,disabled:false,selectCallback:null,preselectCallback:null,deselectCallback:null,style:'normal',skin:'',emitValues:false,fixedLabel:false,icon:null,noItemsCallback:null,repeatSelect:false,editable:false,direction:'auto',resultKey:'',showToolTip:false,translations:translations,isNative:false,defaultValue:null,dropdownPadding:0,},constants={selectClass:'husky-select',labelClass:'husky-select-label',listClass:'husky-select-list',dropdownContainerClass:'husky-select-dropdown-container',deselectFieldKey:'deselectindex',deselectFieldDefaultValue:'',disabledClass:'disabled',dropdownTopClass:'top',templateRemoveSelector:'.remove-row',templateAddSelector:'#addRow',editableFieldKey:'editableindex',typeRowSelector:'.type-row',contentInnerSelector:'.content-inner',toggleClass:'.toggle-icon',formElementSelector:'.form-element',selectContainerSelector:'.husky-select-container'},templates={row:function(){return['<div class="grid-row type-row" data-id="">','   <div class="grid-col-10 pull-left"><input class="form-element" type="text" value=""/></div>','   <div class="grid-col-2 pull-right"><div class="remove-row btn gray-dark fit only-icon pull-right"><div class="fa-minus-circle"></div></div></div>','</div>'].join('');},addOverlayRow:function(valueField,item){return['<div class="grid-row type-row" data-id="',item.id,'">','    <div class="grid-col-10 pull-left"><input class="form-element" type="text" value="',item[valueField],'"/></div>','    <div class="grid-col-2 pull-right"><div class="remove-row btn gray-dark fit only-icon pull-right"><div class="fa-minus-circle"></div></div></div>','</div>'].join('');},addOverlaySkeleton:function(){return['<div class="content-inner">','   <% _.each(data, function(item) { %>','        <%= rowTemplate(valueName, item) %>','   <% }); %>','</div>','<div class="grid-row">','   <div id="addRow" class="addButton">','   <span>',this.sandbox.translate(defaults.translations.addItem),'</span>','   </div>','</div>'].join('');}},EVENT_INITIALIZED=function(){return getEventName.call(this,'initialize');},EVENT_DESELECTED_ITEM=function(){return getEventName.call(this,'deselected.item');},EVENT_SELECTED_ITEM=function(){return getEventName.call(this,'selected.item');},EVENT_PRESELECTED_ITEM=function(){return getEventName.call(this,'preselected.item');},EVENT_ENABLE=function(){return getEventName.call(this,'enable');},EVENT_DISABLE=function(){return getEventName.call(this,'disable');},EVENT_TOGGLE=function(){return getEventName.call(this,'toggle');},EVENT_SHOW=function(){return getEventName.call(this,'show');},EVENT_HIDE=function(){return getEventName.call(this,'hide');},EVENT_GET_CHECKED=function(){return getEventName.call(this,'get-checked');},EVENT_UPDATE=function(){return getEventName.call(this,'update');},EVENT_DATA_CHANGED=function(){return'data-changed';},EVENT_SAVE=function(){return getEventName.call(this,'save');},EVENT_DELETE=function(){return getEventName.call(this,'delete');},EVENT_REVERT=function(){return getEventName.call(this,'revert');},getEventName=function(suffix){return'husky.select.'+this.options.instanceName+'.'+suffix;},showCaret=function(){this.sandbox.dom.show(getCaret.call(this));},hideCaret=function(){this.sandbox.dom.hide(getCaret.call(this));},getCaret=function(){return this.$find(constants.toggleClass);},processStyles=function($button){var allowedStyles=['small','big','action'];if(!!this.options.style){var styles=this.options.style.split(' ');this.sandbox.util.foreach(styles,function(style){if(allowedStyles.indexOf(style)>-1){this.sandbox.dom.addClass($button,style);}}.bind(this));}};return{initialize:function(){var selectedIds;this.sandbox.logger.log('initialize',this);this.options=this.sandbox.util.extend(true,{},defaults,this.options);if(!!this.options.deselectField&&this.options.deselectField.toString()==='true'){this.options.deselectField=constants.deselectFieldDefaultValue;}
this.selection=[];this.selectedElements=[];this.selectedElementsValues=[];this.dropdownVisible=false;this.mergedData=null;if(!this.options.preSelectedElements||this.options.preSelectedElements.length===0){selectedIds=this.sandbox.dom.data(this.$el,'selection');if(typeof selectedIds==='string'){this.options.preSelectedElements=selectedIds.split(',');}else if(Array.isArray(selectedIds)){this.options.preSelectedElements=selectedIds.map(String);}else if(typeof selectedIds==='number'){this.options.preSelectedElements.push(selectedIds.toString());}else if(!!this.options.defaultValue){this.options.preSelectedElements=this.options.defaultValue;}}
if(this.options.url){this.loadEntries(this.options.url);}else if(!!this.options.data){this.mergedData=this.options.data.slice(0);this.render();this.sandbox.emit(EVENT_INITIALIZED.call(this));}else{this.sandbox.logger.warn('Neither data nor url defined!');}},loadEntries:function(url){this.sandbox.util.load(url).then(function(response){if(!!this.options.resultKey){this.options.data=response._embedded[this.options.resultKey];}else{this.options.data=response._embedded;}
this.mergedData=this.options.data.slice(0);this.render();this.sandbox.emit(EVENT_INITIALIZED.call(this));}.bind(this)).fail(function(request,message,error){this.sandbox.logger.warn(request,message,error);}.bind(this));},render:function(){this.options.preSelectedElements=_.filter(this.options.preSelectedElements,function(item){return _.contains(this.options.data,item)||_.filter(this.options.data,function(data){return data.id==item;}.bind(this)).length>0;}.bind(this));this.sandbox.dom.addClass(this.$el,constants.selectClass);var $originalElement=this.sandbox.dom.$(this.options.el),button=this.sandbox.dom.createElement(this.sandbox.util.template(this.template.basicStructure.call(this,this.options.defaultLabel,this.options.icon),{isNative:this.options.isNative}));this.sandbox.dom.append($originalElement,button);processStyles.call(this,button);this.sandbox.dom.addClass(button,this.options.skin);this.$list=this.$find('.'+constants.listClass);this.$dropdownContainer=this.$find('.'+constants.dropdownContainerClass);this.$label=this.$find('.'+constants.labelClass);this.prepareData();this.bindDOMEvents();this.bindCustomEvents();if(this.options.disabled===true){this.disable();}
this.addEditEntry();},enable:function(){this.sandbox.dom.removeClass(this.sandbox.dom.children(this.$el,'.husky-select-container'),constants.disabledClass);this.bindDOMEvents();},disable:function(){this.sandbox.dom.addClass(this.sandbox.dom.children(this.$el,'.husky-select-container'),constants.disabledClass);this.hideDropDown();this.sandbox.dom.off(this.$el);},addEditEntry:function(){if(this.options.editable===true){this.addDivider();this.addDropdownElement(constants.editableFieldKey,this.sandbox.translate(translations.editEntries),false,null,null,false);}},prepareData:function(){if(this.options.data.length>0){if(this.options.preSelectedElements.length>0){this.options.preSelectedElements.map(function(el,index,arr){if(!!arr[index]||arr[index]===0){arr[index]=el.toString();}});}
this.generateDropDown(this.options.data);}else{this.sandbox.logger.log('error: data not set');}},addDropdownElement:function(id,value,disabled,callback,updateLabel,checkboxVisible){checkboxVisible=checkboxVisible!==false;var $item,template=(this.options.isNative)?this.template.optionElement:this.template.menuElement,idString=(id!==null&&typeof id!=='undefined')?id.toString():this.sandbox.util.uniqueId();if(this.options.preSelectedElements.indexOf(idString)>=0||this.options.preSelectedElements.indexOf(value)>=0){this.setToolTip(value);$item=this.sandbox.dom.createElement(this.sandbox.util.template(template.call(this,idString,value,'checked',updateLabel,true),{checked:true}));this.selectedElements.push(idString);this.selectedElementsValues.push(value);if(this.options.emitValues===true){this.triggerPreSelect(idString);}else{this.triggerPreSelect(value);}}else{$item=this.sandbox.dom.createElement(this.sandbox.util.template(template.call(this,idString,value,'',updateLabel,checkboxVisible),{checked:false}));}
if(typeof callback==='function'){this.sandbox.dom.data($item,'selectCallback',callback);}
if(!!disabled&&disabled===true){this.sandbox.dom.addClass($item,'disabled');if(this.options.isNative){this.sandbox.dom.attr($item,'disabled','disabled');}}
this.sandbox.dom.append(this.$list,$item);},addDivider:function(){var $item=this.sandbox.dom.$('<hr class="divider"/>');this.sandbox.dom.append(this.$list,$item);},generateDropDown:function(items){if(typeof this.options.deselectField==='string'&&this.options.deselectField!=='false'){this.addDropdownElement(constants.deselectFieldKey,this.sandbox.translate(this.options.deselectField));}
if(items.length>0){if(typeof(items[0])==='string'){this.sandbox.util.each(items,function(index,value){this.addDropdownElement(index,this.sandbox.translate(value));}.bind(this));}else if(typeof(items[0])==='object'){this.sandbox.util.each(items,function(index,value){if(value.divider===true){this.addDivider();}else{this.addDropdownElement(value.id,this.sandbox.translate(value[this.options.valueName]),!!value.disabled,value.callback,this.sandbox.translate(value.updateLabel));}}.bind(this));}
this.changeLabel();this.updateSelectionAttribute();}},bindDOMEvents:function(){this.sandbox.dom.on(this.$el,'click',this.labelClickHandler.bind(this),'.dropdown-label');this.sandbox.dom.on(this.$el,'click',function(event){this.sandbox.dom.stopPropagation(event);if(this.sandbox.dom.hasClass(event.currentTarget,'disabled')===false){this.clickItem(event);return true;}else{this.sandbox.dom.preventDefault(event);return false;}}.bind(this),'.husky-select-dropdown-container li');this.sandbox.dom.on(this.$el,EVENT_DATA_CHANGED.call(this),this.dataChanged.bind(this));if(this.options.isNative){this.sandbox.dom.on(this.$list,'change',this.onSelectChange.bind(this));}},bindCustomEvents:function(){this.sandbox.on(EVENT_TOGGLE.call(this),this.toggleDropDown.bind(this));this.sandbox.on(EVENT_SHOW.call(this),this.showDropDown.bind(this));this.sandbox.on(EVENT_HIDE.call(this),this.hideDropDown.bind(this));this.sandbox.on(EVENT_DISABLE.call(this),this.disable.bind(this));this.sandbox.on(EVENT_ENABLE.call(this),this.enable.bind(this));this.sandbox.on(EVENT_GET_CHECKED.call(this),this.getChecked.bind(this));this.sandbox.on(EVENT_UPDATE.call(this),this.updateDropdown.bind(this));this.sandbox.on(EVENT_REVERT.call(this),this.revert.bind(this));},onSelectChange:function(event){var selectedId=this.sandbox.dom.val(event.currentTarget),$selectedOption=this.sandbox.dom.find('option[value="'+selectedId+'"]',this.$list),callback=this.sandbox.dom.data($selectedOption,'selectCallback'),selectedValue=this.sandbox.dom.text($selectedOption);this.selectedElements=[selectedId];this.selectedElementsValues=[selectedValue];if(selectedId===constants.deselectFieldKey){this.selectedElements=[];this.selectedElementsValues=[];}
this.updateSelectionAttribute();this.changeLabel();if(!this.selectedElements.length){this.triggerDeselect(selectedId);}else{this.triggerSelect(selectedId,selectedValue);}},dataChanged:function(){var selectedIds=this.sandbox.dom.data(this.$el,'selection'),selectedValues=this.sandbox.dom.data(this.$el,'selectionValues'),id,$checkbox;this.selectedElements=[];this.selectedElementsValues=[];if(typeof selectedIds==='string'){this.selectedElements=selectedIds.split(',');}else if(Array.isArray(selectedIds)){this.selectedElements=selectedIds.map(String);}else if(typeof selectedIds==='number'){this.selectedElements.push(selectedIds.toString());}
if(typeof selectedValues==='string'){this.selectedElementsValues=selectedValues.split(',');}else if(!!Array.isArray(selectedValues)){this.selectedElementsValues=selectedValues;}
this.sandbox.util.foreach(this.sandbox.dom.children(this.$list),function($el){id=this.sandbox.dom.data($el,'id')||'';$checkbox=this.sandbox.dom.find('input[type=checkbox]',$el);if(this.selectedElements.indexOf(id)>-1){this.sandbox.dom.addClass($checkbox,'is-selected');this.sandbox.dom.prop($checkbox,'checked',true);}else{this.sandbox.dom.removeClass($checkbox,'is-selected');this.sandbox.dom.prop($checkbox,'checked',false);}}.bind(this));this.changeLabel();this.updateSelectionAttribute();},revert:function(){this.updateDropdown(this.mergedData,this.selectedElements,false);},updateDropdown:function(data,preselected,merge){if(!!merge){data=this.mergeDomAndRequestData(data,this.parseDataFromDom(this.domData,true));this.mergedData=data.slice(0);}else{this.selectedElements=[];this.selectedElementsValues=[];this.updateSelectionAttribute();this.dataChanged();}
if(preselected!==null){this.options.preSelectedElements=preselected.map(String);}
this.selectedElements=[];this.selectedElementsValues=[];this.sandbox.dom.empty(this.$list);this.options.data=data;if(!!data&&data.length>0){showCaret.call(this);this.generateDropDown(data);}else{hideCaret.call(this);this.sandbox.logger.warn('error invalid data for update!');}
this.addEditEntry();},updateSelectionAttribute:function(){this.sandbox.dom.data(this.$el,'selection',this.selectedElements);this.sandbox.dom.data(this.$el,'selectionValues',this.selectedElementsValues);},uncheckAll:function(clickedElementKey){var elements=this.sandbox.dom.children(this.$list),i=-1,length=elements.length,key,index,$checkbox;for(;++i<length;){key=this.sandbox.dom.data(elements[i],'id');if(key===undefined){key='';}
$checkbox=this.sandbox.dom.find('input[type=checkbox]',elements[i])[0];index=this.selectedElements.indexOf(key.toString());if(index>=0){if(clickedElementKey!==key){this.sandbox.dom.removeClass($checkbox,'is-selected');this.sandbox.dom.prop($checkbox,'checked',false);this.selectedElements.splice(index,1);this.selectedElementsValues.splice(index,1);this.sandbox.emit(EVENT_DESELECTED_ITEM.call(this),key);}}}},openEditDialog:function(){this.elementsToRemove=[];this.$elementsToRemove=[];var $element=this.sandbox.dom.createElement('<div/>'),$content=this.renderOverlayContent();this.sandbox.dom.append('body',$element);this.bindOverlayContentEvents($content);this.sandbox.start([{name:'overlay@husky',options:{el:$element,openOnStart:true,removeOnClose:true,instanceName:'husky-select',title:this.sandbox.translate('public.edit-entries'),cancelCallback:function(){this.onCloseWithCancel();}.bind(this),okCallback:function(data){this.onCloseWithOk(data);}.bind(this),data:$content}}]);},onCloseWithOk:function(domData){this.domData=domData;this.removeDeletedItems();if(!!domData){this.saveNewEditedItemsAndClose(domData,'PATCH');}},saveNewEditedItemsAndClose:function(domData){var data=this.parseDataFromDom(domData),mergeData,changedData=this.getChangedData(data);if(changedData.length>0){mergeData=this.mergeDomAndRequestData(changedData,this.parseDataFromDom(domData,true));this.options.data=mergeData.slice(0);this.updateDropdown(mergeData,this.selectedElements);this.sandbox.emit(EVENT_SAVE.call(this),changedData);}},mergeDomAndRequestData:function(updatedData,parsedDomData){this.sandbox.util.foreach(parsedDomData,function(parsedEl){this.sandbox.util.foreach(updatedData,function(updatedEl){if(parsedEl.id===updatedEl.id&&parsedEl.id!==''){parsedEl[this.options.valueName]=updatedEl[this.options.valueName];}else if(parsedEl[this.options.valueName]===updatedEl[this.options.valueName]){parsedEl.id=updatedEl.id;}}.bind(this));}.bind(this));return parsedDomData;},bindOverlayContentEvents:function($element){this.sandbox.dom.on($element,'click',this.markElementForRemoval.bind(this),constants.templateRemoveSelector);this.sandbox.dom.on($element,'click',this.addElement.bind(this),constants.templateAddSelector);},updateRemoveList:function(id,$row){if(this.elementsToRemove.indexOf(id)===-1){if(id!==null){this.elementsToRemove.push(id);}
this.$elementsToRemove.push($row);}else{if(id!==null){this.elementsToRemove.splice(this.elementsToRemove.indexOf(id),1);}
this.$elementsToRemove.splice(this.elementsToRemove.indexOf($row),1);}},deleteItem:function(id){var origData=this.options.data.slice(0);this.sandbox.util.each(origData,function(index,$el){if(id===$el.id){var i=this.options.data.indexOf($el);this.options.data.splice(i,1);}}.bind(this));this.updateDropdown(this.options.data,this.selectedElements);},removeDeletedItems:function(){if(!!this.$elementsToRemove&&this.$elementsToRemove.length>0){this.sandbox.util.each(this.$elementsToRemove,function(index,$el){this.sandbox.dom.remove($el);}.bind(this));}
if(!!this.elementsToRemove&&this.elementsToRemove.length>0){this.sandbox.util.each(this.elementsToRemove,function(index,el){this.deleteItem(el);}.bind(this));this.sandbox.emit(EVENT_DELETE.call(this),this.elementsToRemove);this.elementsToRemove=[];this.$elementsToRemove=[];}},parseDataFromDom:function(domData,excludeDeleted){var $rows=this.sandbox.dom.find(constants.typeRowSelector,domData),data=[],id,value,deleted,obj;this.sandbox.dom.each($rows,function(index,$el){deleted=this.sandbox.dom.hasClass($el,'faded');if(!!excludeDeleted){if(!deleted){id=this.sandbox.dom.data($el,'id');value=this.sandbox.dom.val(this.sandbox.dom.find('input',$el));if(value!==''){obj={id:id};obj[this.options.valueName]=value;data.push(obj);}}}else{id=this.sandbox.dom.data($el,'id');value=this.sandbox.dom.val(this.sandbox.dom.find('input',$el));if(value!==''){obj={id:id};obj[this.options.valueName]=value;data.push(obj);}}}.bind(this));return data;},getChangedData:function(newData){var changedData=[];this.sandbox.util.each(newData,function(idx,el){if(el.id===''){changedData.push(el);}else{this.sandbox.util.each(this.options.data,function(idx,origEl){if(el.id===origEl.id&&el[this.options.valueName]!==origEl[this.options.valueName]&&el[this.options.valueName]!==''){changedData.push(el);}}.bind(this));}}.bind(this));return changedData;},setToolTip:function(value){if(this.options.showToolTip===true&&this.options.multipleSelect===false){var $container=this.$find(constants.selectContainerSelector);this.sandbox.dom.attr($container,'title',value);}},onCloseWithCancel:function(){this.elementsToRemove=[];this.$elementsToRemove=[];},renderOverlayContent:function(){return this.sandbox.dom.createElement(this.sandbox.util.template(templates.addOverlaySkeleton.call(this),{data:this.options.data,rowTemplate:templates.addOverlayRow,valueName:this.options.valueName}));},addElement:function(){var $row=this.sandbox.dom.createElement(templates.addOverlayRow.call(this,this.options.valueName,{}));this.sandbox.dom.append(this.sandbox.dom.find(constants.contentInnerSelector),$row);this.sandbox.dom.focus(this.sandbox.dom.find(constants.formElementSelector,$row));},markElementForRemoval:function(event){var $row=this.sandbox.dom.parent(this.sandbox.dom.parent(event.currentTarget)),id=this.sandbox.dom.data($row,'id');if(id!==null){this.updateRemoveList(id,$row);}
this.toggleStateOfRow($row);},toggleStateOfRow:function($row){this.sandbox.dom.toggleClass($row,'faded');},clickItem:function(event){var key,value,$checkbox,index,callback,updateLabel;key=this.sandbox.dom.data(event.currentTarget,'id').toString();callback=this.sandbox.dom.data(event.currentTarget,'selectCallback');index=this.selectedElements.indexOf(key);updateLabel=this.sandbox.dom.attr(event.currentTarget,'data-update-label');if(key===constants.editableFieldKey){this.hideDropDown();this.openEditDialog();return;}
if(updateLabel!=='false'){if(this.options.multipleSelect===false){if(key===constants.deselectFieldKey){index=0;this.uncheckAll(key);}else if(index===-1){this.uncheckAll(key);}else if(this.options.repeatSelect!==true){this.hideDropDown();return;}}}
value=this.sandbox.dom.text(this.sandbox.dom.find('.item-value',event.currentTarget));$checkbox=this.sandbox.dom.find('input[type=checkbox]',event.currentTarget)[0];if(!!updateLabel&&updateLabel!=='false'){if(index>=0){this.sandbox.dom.removeClass($checkbox,'is-selected');this.sandbox.dom.prop($checkbox,'checked',false);this.selectedElements.splice(index,1);this.selectedElementsValues.splice(index,1);}else{this.sandbox.dom.addClass($checkbox,'is-selected');this.sandbox.dom.prop($checkbox,'checked',true);this.selectedElements.push(key.toString());this.selectedElementsValues.push(value);}
this.updateSelectionAttribute();this.changeLabel();}
if(this.options.multipleSelect===false){this.hideDropDown();}
if(this.options.emitValues===true){key=value;}
if(typeof callback==='function'){callback();}
if(index>=0){this.triggerDeselect(key);}else{this.triggerSelect(key,value);}
this.sandbox.dom.trigger(this.$el,'change');},triggerSelect:function(key,selectedValue){this.setToolTip(selectedValue);if(!!this.options.selectCallback){this.options.selectCallback.call(this,key,selectedValue);}else{this.sandbox.emit(EVENT_SELECTED_ITEM.call(this),key,selectedValue);}},triggerPreSelect:function(key){if(!!this.options.preselectCallback){this.options.preselectCallback.call(this,key);}else if(!!this.options.selectCallback){this.options.selectCallback.call(this,key);}else{this.sandbox.emit(EVENT_PRESELECTED_ITEM.call(this),key);}},triggerDeselect:function(key){if(!!this.options.deselectCallback){this.options.deselectCallback.call(this,key!==constants.deselectFieldKey?key:null);}else{this.sandbox.emit(EVENT_DESELECTED_ITEM.call(this),key);}},changeLabel:function(){if(this.options.fixedLabel!==true){if(this.selectedElements.length===this.options.data.length&&this.options.multipleSelect===true){this.sandbox.dom.text(this.$label,this.options.checkedAllLabel);}else if(this.selectedElements.length===0){this.sandbox.dom.text(this.$label,this.options.defaultLabel);}else{var text="",labelWidth;this.sandbox.util.each(this.selectedElementsValues,function(index,value){text+=' '+value+',';});this.sandbox.dom.text(this.$label,text.substring(1,text.length-1));}}},labelClickHandler:function(){if(!this.sandbox.dom.is(this.$find('.'+constants.listClass),':empty')){this.toggleDropDown();}else{if(typeof this.options.noItemsCallback==='function'){this.options.noItemsCallback();}}},toggleDropDown:function(){this.sandbox.logger.log('toggle dropdown '+this.options.instanceName);if(this.dropdownVisible===true){this.hideDropDown();}else{this.showDropDown();}},showDropDown:function(){if(this.options.isNative){return;}
this.sandbox.dom.removeClass(this.$dropdownContainer,'hidden');this.sandbox.dom.on(this.sandbox.dom.window,'click.dropdown.'+this.options.instanceName,this.hideDropDown.bind(this));this.dropdownVisible=true;this.sandbox.dom.removeClass(this.$dropdownContainer,constants.dropdownTopClass);var dropdownHeight=this.sandbox.dom.height(this.$dropdownContainer),dropdownTop=this.sandbox.dom.offset(this.$dropdownContainer).top,windowHeight=this.sandbox.dom.height(this.sandbox.dom.window),scrollTop=this.sandbox.dom.scrollTop(this.sandbox.dom.window),dropdownMaxHeight=windowHeight-dropdownTop;if(this.options.direction==='top'){this.sandbox.dom.addClass(this.$dropdownContainer,constants.dropdownTopClass);}else if(this.options.direction!=='bottom'&&dropdownHeight+dropdownTop>windowHeight+scrollTop&&windowHeight / 2<dropdownTop-scrollTop){this.sandbox.dom.addClass(this.$dropdownContainer,constants.dropdownTopClass);dropdownMaxHeight=dropdownHeight+this.$dropdownContainer.offset().top;}
this.$dropdownContainer.css({maxHeight:dropdownMaxHeight-this.options.dropdownPadding+'px'});},hideDropDown:function(event){if(!!event){if(!!this.sandbox.dom.find(event.target,this.$el).length){return false;}else{this.sandbox.dom.off(this.sandbox.dom.window,'click.dropdown.'+this.options.instanceName);}}
this.sandbox.dom.addClass(this.$dropdownContainer,'hidden');this.dropdownVisible=false;return true;},getChecked:function(callback){if(typeof callback==='function'){callback(this.selectedElements);}else{throw'error: callback is not a function';}},template:{basicStructure:function(defaultLabel,icon){var iconSpan='',dropdownStyle='display:none';if(!!icon){iconSpan='<span class="fa-'+icon+' icon"></span>';}
if(!!this.options.data&&!!this.options.data.length||this.options.editable){dropdownStyle='';}
return['<div class="husky-select-container">','   <div class="dropdown-label pointer">','       <% if (isNative) { %>','           <select class="'+constants.listClass+'">',(this.options.preSelectedElements.length===0?'           <option selected="true" disabled="true">'+defaultLabel+'</option>':''),'           </select>','       <% } %>','       <div class="checkbox">',iconSpan,'           <span class="'+constants.labelClass+'">',defaultLabel,'</span>','       </div>','       <span class="fa-caret-down toggle-icon" style="'+dropdownStyle+'"></span>','   </div>','   <% if (!isNative) { %>','   <div class="grid-row dropdown-list dropdown-shadow hidden '+constants.dropdownContainerClass+'">','       <ul class="'+constants.listClass+'"></ul>','   </div>','   <% } %>','</div>'].join('');},menuElement:function(index,value,checked,updateLabel,checkboxVisible){var hiddenClass='',update='true';if(this.options.multipleSelect===false||!checkboxVisible){hiddenClass=' hidden';}
if(updateLabel!==undefined&&updateLabel===false){update='false';}
return['<li data-id="',index,'" data-update-label="',update,'">','    <div>','        <div class="check'+hiddenClass+'">','           <div class="custom-checkbox no-spacing">','               <input type="checkbox" class="form-element"',checked,'/>','               <span class="icon"></span>','           </div>','        </div>','        <div class="item-value">',value,'</div>','    </div>','</li>'].join('');},optionElement:function(index,value,checked,updateLabel,checkboxVisible){return['<option <% if (checked) { print("selected "); } %>value="'+index+'">',value,'</option>'].join('');}}};});define('__component__$password-fields@husky',[],function(){'use strict';var defaults={instanceName:'undefined',validation:false,labels:{inputPassword1:'Password',inputPassword2:'Repeat Password',generateLabel:'Generate password'},values:{inputPassword1:'',inputPassword2:''}};return{initialize:function(){this.sandbox.logger.log('initialize');this.sandbox.logger.log(arguments);this.options=this.sandbox.util.extend({},defaults,this.options);this.options.ids={inputPassword1:'husky-password-fields-'+this.options.instanceName+'-password1',inputPassword2:'husky-password-fields-'+this.options.instanceName+'-password2',generateLabel:'husky-password-fields-'+this.options.instanceName+'-generate'};this.render();},render:function(){this.$originalElement=this.sandbox.dom.$(this.options.el);this.$element=this.sandbox.dom.$(this.template());this.$originalElement.append(this.$element);if(!!this.options.validation){this.sandbox.form.addField(this.options.validation,this.$el.find('#'+this.options.ids.inputPassword1));this.sandbox.form.addField(this.options.validation,this.$el.find('#'+this.options.ids.inputPassword2));}
this.bindDomEvents();this.bindCustomEvents();},bindCustomEvents:function(){this.sandbox.on('husky.password.fields.'+this.options.instanceName+'.get.passwords',function(callback){if(typeof callback==='function'){var password1=this.sandbox.dom.val('#'+this.options.ids.inputPassword1),password2=this.sandbox.dom.val('#'+this.options.ids.inputPassword2);callback(password1,password2);}}.bind(this));},bindDomEvents:function(){this.$element.on('click','#'+this.options.ids.generateLabel,function(){this.generatePasswords();this.sandbox.emit('husky.passwords.fields.'+this.options.instanceName+'.generated.passwords');}.bind(this));},generatePasswords:function(){var generatedPassword='test';this.sandbox.dom.val('#'+this.options.ids.inputPassword1,generatedPassword);this.sandbox.dom.val('#'+this.options.ids.inputPassword2,generatedPassword);},template:function(){return['<div class="husky-password-fields grid">','    <div class="grid-row">','        <div class="grid-col-6 form-group">','                <label for="',this.options.ids.inputPassword1,'">',this.options.labels.inputPassword1,'</label>','                <div class="align-right hidden" id="',this.options.ids.generateLabel,'">','                    <span class="fa-key m-right-10"></span><span class="pointer">',this.options.labels.generateLabel,'</span>','                </div>','                <input class="form-element" value="',this.options.values.inputPassword1,'" type="text" id="',this.options.ids.inputPassword1,'"',(!!this.options.validation?'data-validation-equal="'+this.options.instanceName+'"':''),'/>','        </div>','        <div class="grid-col-6 form-group">','                <label for="',this.options.ids.inputPassword2,'">',this.options.labels.inputPassword2,'</label>','                <input class="form-element" value="',this.options.values.inputPassword2,'" type="text" id="',this.options.ids.inputPassword2,'"',(!!this.options.validation?'data-validation-equal="'+this.options.instanceName+'"':''),'/>','        </div>','    </div>','</div>'].join('');}};});define('__component__$column-navigation@husky',[],function(){'use strict';var defaults={url:null,prefilledData:null,selected:null,data:null,instanceName:'',hasSubName:'hasSub',actionIcon:'fa-pencil',addButton:true,idName:'id',pathName:'path',linkedName:'linked',publishedName:'publishedState',titleName:'title',typeName:'type',noPageDescription:'public.no-pages',skin:'',resultKey:'nodes',responsive:true,showOptions:true,showStatus:true,premarkedIds:[],disableIds:[],disabledChildren:false,markable:false,orderable:true,showActionIcon:true,orderConfirmTitle:'column-navigation.order-title',orderConfirmMessage:'column-navigation.order-message',tooltipTranslations:{ghost:'column-navigation.ghost',shadow:'co lumn-navigation.shadow',unpublished:'public.unpublished',internalLink:'public.internal-link',externalLink:'public.external-link'},actionCallback:null},constants={responsiveHeightRation:7 / 10,columnWidth:250,minVisibleRatio:1 / 2,markedClass:'marked',displayedcolumns:2,wrapperClass:'column-navigation-wrapper',disabledClass:'disabled',columnClass:'column',optionsClass:'options',componentClass:'husky-column-navigation',nodeLoaderClass:'husky-column-navigation-loader',bigLoaderClass:'column-navigation-loader',columnItemClass:'column-item',iconsLeftClass:'icons-left',iconsRightClass:'icons-right',itemTextClass:'item-text',orderInputClass:'orderer',orderErrorClass:'husky-validate-error',highlightClass:'highlight-animation',orderModeClass:'order-mode'},templates={wrapper:['<div class="',constants.wrapperClass,'"></div>'].join(''),container:['<div class="column-navigation"></div>'].join(''),column:['<div data-column="<%= columnNumber %>" class="',constants.columnClass,'" id="<%= id %>">','    <ul></ul>','</div>'].join(''),noPage:['<div class="no-page">','    <span class="fa-coffee icon"></span>','    <div class="text"><%= description %></div>','</div>'].join(''),optionsContainer:['<div class="',constants.optionsClass,' grid-row"></div>'].join(''),optionsAdd:['<div class="align-center add pointer">','    <span class="fa-plus-circle"></span>','</div>'].join(''),optionsSettings:['<div class="align-center settings pointer drop-down-trigger">','    <span class="fa-gear inline-block"></span><span class="dropdown-toggle inline-block"></span>','</div>'].join(''),optionsOk:['<div class="align-center ok pointer">','    <span class="fa-check"></span>','</div>'].join(''),item:['<li data-id="<%= id %>" class="'+constants.columnItemClass+'">','    <span class="'+constants.iconsLeftClass+'"></span>','    <span title="<%= title %>" class="'+constants.itemTextClass+'"><%= title %></span>','    <span class="'+constants.iconsRightClass+'"></span>','</li>'].join(''),orderInput:['<span class="'+constants.orderInputClass+'">','    <input type="text" class="form-element husky-validate" value="<%= value %>" />','</span>'].join('')},eventNamespace='husky.column-navigation.',INITIALIZED=function(){return createEventName.call(this,'initialized');},LOADED=function(){return createEventName.call(this,'loaded');},SELECTED=function(){return createEventName.call(this,'selected');},SETTINGS=function(){return createEventName.call(this,'settings');},ADD=function(){return createEventName.call(this,'add');},ACTION=function(){return createEventName.call(this,'action');},ORDERED=function(){return createEventName.call(this,'ordered');},ORDER=function(){return createEventName.call(this,'order');},ORDER_START=function(){return createEventName.call(this,'order-start');},ORDER_END=function(){return createEventName.call(this,'order-end');},UNMARK=function(){return createEventName.call(this,'unmark');},HIGHLIGHT=function(){return createEventName.call(this,'highlight');},BREADCRUMB=function(){return createEventName.call(this,'get-breadcrumb');},RESIZE=function(){return createEventName.call(this,'resize');},SET_OPTIONS=function(){return createEventName.call(this,'set-options');},createContext=function(column){if(column<=0){return this.columns[column];}
var context={numberItems:0,hasSelected:false,selectedItem:null,parent:null,children:[]};if(!!this.columns[column]){context.numberItems=Object.keys(this.columns[column]).length;context.hasSelected=!!this.selected[column];context.children=this.columns[column];if(!!this.selected[column]){context.selectedItem=this.selected[column];}}
if(column>0){context.parent=createContext.call(this,column-1);}
return context;},getActionIcon=function(data){var actionItem=this.options.actionIcon;if(typeof(this.options.actionIcon)==='function'){actionItem=this.options.actionIcon(data);}
return actionItem;},getAddButton=function(){if(typeof(this.options.addButton)==='function'){return this.options.addButton(createContext.call(this,this.lastHoveredColumn));}
return this.options.addButton;},setOptionButtonWidths=function(){var $optionButtons=this.$find('.'+constants.optionsClass+' > :visible'),width=100 / $optionButtons.length;$optionButtons.each(function(count,optionButton){$(optionButton).width(width+'%');});this.$find('.'+constants.optionsClass+' > :visible').removeClass('first');this.$find('.'+constants.optionsClass+' > :visible').removeClass('last');this.$find('.'+constants.optionsClass+' > :visible:first').addClass('first');this.$find('.'+constants.optionsClass+' > :visible:last').addClass('last');},createEventName=function(postFix){return eventNamespace+(this.options.instanceName?this.options.instanceName+'.':'')+postFix;};return{initialize:function(){this.options=this.sandbox.util.extend(true,{},defaults,this.options);this.setProperties();this.render();this.startBigLoader();this.initData();this.bindDOMEvents();this.bindCustomEvents();this.sandbox.emit(INITIALIZED.call(this));},initData:function(){if(!!this.options.prefilledData){this.handleResponse(this.options.prefilledData,0);}else{this.load(this.options.url,0);}},setProperties:function(){this.$selectedElement=null;this.filledColumns=0;this.columnLoadStarted=false;this.isOrdering=false;this.inOrderMode=false;this.optionsLocked=false;this.dom={$wrapper:null,$container:null,$add:null,$settings:null,$bigLoader:null,$loader:null,$ok:null,$lastClicked:null};this.columns=[];this.selected=[];this.marked=this.options.premarkedIds||[];},render:function(){this.renderWrapper();if(!!this.options.showOptions){this.renderOptions();}
if(!!this.options.data){this.initSettingsDropdown();}
if(this.options.responsive===true){this.setContainerHeight();}},getColumnForItem:function(item){for(var i=-1,length=this.columns.length;++i<length;){if(!!this.columns[i]&&!!this.columns[i][item]){return i;}}
return-1;},renderOptions:function(){this.$optionsContainer=this.sandbox.dom.createElement(templates.optionsContainer);this.dom.$add=this.sandbox.dom.createElement(templates.optionsAdd);this.dom.$settings=this.sandbox.dom.createElement(templates.optionsSettings);this.dom.$ok=this.sandbox.dom.createElement(templates.optionsOk);this.sandbox.dom.hide(this.dom.$ok);this.sandbox.dom.append(this.$optionsContainer,this.dom.$add);this.sandbox.dom.append(this.$optionsContainer,this.dom.$settings);this.sandbox.dom.append(this.$optionsContainer,this.dom.$ok);this.hideOptions();this.sandbox.dom.append(this.dom.$wrapper,this.$optionsContainer);},renderWrapper:function(){this.sandbox.dom.addClass(this.$el,constants.componentClass);if(!!this.options.skin){this.sandbox.dom.addClass(this.$el,this.options.skin);}
this.dom.$wrapper=this.sandbox.dom.createElement(templates.wrapper);this.sandbox.dom.append(this.$el,this.dom.$wrapper);this.dom.$container=this.sandbox.dom.createElement(templates.container);this.sandbox.dom.append(this.dom.$wrapper,this.dom.$container);},startBigLoader:function(){if(this.dom.$bigLoader===null){this.dom.$bigLoader=this.sandbox.dom.createElement('<div class="'+constants.bigLoaderClass+'"/>');this.sandbox.dom.hide(this.dom.$bigLoader);this.sandbox.dom.html(this.dom.$container,this.dom.$bigLoader);this.sandbox.start([{name:'loader@husky',options:{el:this.dom.$bigLoader,size:'100px',color:'#e4e4e4'}}]);}
this.sandbox.dom.show(this.dom.$bigLoader);},removeBigLoader:function(){this.sandbox.dom.hide(this.dom.$bigLoader);},setContainerHeight:function(){var height=this.sandbox.dom.height(this.sandbox.dom.$window),top=this.sandbox.dom.offset(this.$el).top;this.sandbox.dom.height(this.dom.$container,(height-top)*constants.responsiveHeightRation);},initSettingsDropdown:function(){this.sandbox.start([{name:'dropdown@husky',options:{el:this.dom.$settings,setParentDropDown:true,instanceName:this.options.instanceName+'.settings.dropdown',alignment:'left',data:this.options.data}}]);},load:function(url,columnNumber){if(!!url){this.columnLoadStarted=true;this.sandbox.util.load(url).then(function(response){this.handleResponse(response,columnNumber);}.bind(this)).fail(function(error){this.columnLoadStarted=false;this.sandbox.logger.error("An error occured while fetching data from: ",error);}.bind(this));}else{this.sandbox.logger.log("husky.column.navigation -  url not set, aborted loading of data");}},handleResponse:function(response,columnNumber){this.removeBigLoader();this.columnLoadStarted=false;this.parseData(response,columnNumber);this.scrollIfNeeded(this.filledColumns+1);this.setOverflowClass();this.showOptionsAtLast();this.sandbox.emit(LOADED.call(this));},removeColumns:function(newColumn){var length=this.filledColumns,i;for(i=length;i>=newColumn;i--){delete this.columns[i];this.sandbox.dom.remove('#column'+this.options.instanceName+'-'+i);this.filledColumns--;}},parseData:function(data,columnNumber){if(columnNumber===0){this.columns[0]=data;}
var newColNumber=columnNumber+1;this.renderColumn(newColNumber,data);this.removeLoadingIconForSelected();},renderColumn:function(number,data){var $column=this.sandbox.dom.createElement(this.sandbox.util.template(templates.column)({columnNumber:number,id:'column'+this.options.instanceName+'-'+number}));this.sandbox.dom.append(this.dom.$container,$column);this.filledColumns=number;this.renderItems($column,number,data);},renderItems:function($column,number,data){var $list=this.sandbox.dom.find('ul',$column),nodeWithSubNodes,lastSelected;this.sandbox.util.each(data._embedded[this.options.resultKey],function(index,itemData){itemData.order=(index+1);var $item=this.renderItem(itemData);itemData.$el=$item;this.storeDataItem(number,itemData);this.sandbox.dom.append($list,$item);this.setItemsTextWidth($item);if(!!itemData[this.options.hasSubName]&&!!itemData._embedded[this.options.resultKey]&&itemData._embedded[this.options.resultKey].length>0){nodeWithSubNodes=itemData;this.setElementSelected($item);this.selected[number]=itemData;}
if(!!this.options.selected&&(this.options.selected===itemData[this.options.idName]||this.options.selected===itemData[this.options.pathName])){this.setElementSelected($item);this.selected[number]=itemData;lastSelected=itemData;this.options.selected=null;}}.bind(this));if(!!nodeWithSubNodes){this.parseData(nodeWithSubNodes,number);}else if(!!lastSelected&&!lastSelected[this.options.hasSubName]){this.insertAddColumn(lastSelected,number);}},renderItem:function(data){var $item=this.sandbox.dom.createElement(this.sandbox.util.template(templates.item)({title:this.sandbox.translate(this.sandbox.util.escapeHtml(data[this.options.titleName])),id:data[this.options.idName]})),disabled=(this.options.disableIds.indexOf(data[this.options.idName])!==-1);if(this.marked.indexOf(data[this.options.idName])!==-1){this.sandbox.dom.addClass($item,constants.markedClass);}
if(disabled){this.sandbox.dom.addClass($item,constants.disabledClass);}
this.renderLeftInfo($item,data);this.renderItemText($item,data);this.renderRightInfo($item,data,disabled);return $item;},renderLeftInfo:function($item,data){var $container=this.sandbox.dom.find('.'+constants.iconsLeftClass,$item);this.sandbox.dom.append($container,'<span class="fa-check pull-left marked-icon"></span>');if(!!this.options.showStatus){if(!!data[this.options.linkedName]){if(data[this.options.linkedName]==='internal'){this.sandbox.dom.append($container,'<span class="fa-internal-link col-icon" title="'+this.sandbox.translate(this.options.tooltipTranslations.internalLink)+'"></span>');}else if(data[this.options.linkedName]==='external'){this.sandbox.dom.append($container,'<span class="fa-external-link col-icon"  title="'+this.sandbox.translate(this.options.tooltipTranslations.externalLink)+'"></span>');}}
if(!!data[this.options.typeName]){if(data[this.options.typeName].name==='ghost'){this.sandbox.dom.append($container,'<span class="ghost col-icon"  title="'+this.sandbox.translate(this.options.tooltipTranslations.ghost)+'">'+data[this.options.typeName].value+'</span>');}else if(data[this.options.typeName].name==='shadow'){this.sandbox.dom.append($container,'<span class="fa-shadow-node col-icon"  title="'+this.sandbox.translate(this.options.tooltipTranslations.shadow)+'"></span>');}}
if(!data[this.options.publishedName]){this.sandbox.dom.append($container,'<span class="not-published col-icon"  title="'+this.sandbox.translate(this.options.tooltipTranslations.unpublished)+'">&bull;</span>');}}
if(!!this.options.orderable){this.sandbox.dom.append($container,this.sandbox.util.template(templates.orderInput)({value:data.order}));}},renderItemText:function($item,data){var $container=this.sandbox.dom.find('.'+constants.itemTextClass,$item);if(!!data[this.options.typeName]&&data[this.options.typeName].name==='ghost'){this.sandbox.dom.addClass($container,'inactive');}},renderRightInfo:function($item,data,disabled){var $container=this.sandbox.dom.find('.'+constants.iconsRightClass,$item),actionIcon=getActionIcon.call(this,data);if(this.options.showActionIcon===true&&actionIcon&&!disabled){this.sandbox.dom.append($container,'<span class="'+actionIcon+' action col-icon"></span>');}
if(!!data[this.options.hasSubName]&&(!disabled||!this.options.disabledChildren)){this.sandbox.dom.append($container,'<span class="fa-chevron-right arrow inactive col-icon"></span>');}},setItemsTextWidth:function($item){var width,$itemText;$itemText=this.sandbox.dom.find('.item-text',$item);width=constants.columnWidth-this.sandbox.dom.outerWidth(this.sandbox.dom.find('.icons-left',$item));width-=parseInt(this.sandbox.dom.css($item,'padding-right').replace('px',''));width-=parseInt(this.sandbox.dom.css($item,'padding-left').replace('px',''));width-=this.sandbox.dom.outerWidth(this.sandbox.dom.find('.icons-right',$item));width-=17;this.sandbox.dom.width($itemText,width);this.cropItemsText($itemText);},setColumnTextWidth:function(column){this.sandbox.util.each(this.columns[column],function(id,item){this.setItemsTextWidth(item.$el);}.bind(this));},cropItemsText:function($itemText){var title=this.sandbox.dom.attr($itemText,'title'),croppedTitle,maxLength=title.length,overflow;this.sandbox.dom.html($itemText,title);this.sandbox.dom.css($itemText,'font-weight','bold');overflow=(this.sandbox.dom.get($itemText,0).scrollWidth>this.sandbox.dom.width($itemText));while(overflow===true){maxLength--;croppedTitle=this.sandbox.util.cropMiddle(title,maxLength);this.sandbox.dom.html($itemText,croppedTitle);overflow=(this.sandbox.dom.get($itemText,0).scrollWidth>this.sandbox.dom.width($itemText));}
this.sandbox.dom.css($itemText,'font-weight','');},setElementSelected:function($element){this.sandbox.dom.addClass($element,'selected');var $arrowElement=this.sandbox.dom.find('.arrow',$element);this.sandbox.dom.removeClass($arrowElement,'inactive');},addLoadingIcon:function($container){this.sandbox.dom.removeClass($container,'fa-chevron-right inactive');if(this.dom.$loader===null){this.dom.$loader=this.sandbox.dom.createElement('<div class="'+constants.nodeLoaderClass+'"/>');this.sandbox.dom.hide(this.dom.$loader);}
if(this.sandbox.dom.is(this.dom.$loader,':empty')){this.sandbox.start([{name:'loader@husky',options:{el:this.dom.$loader,size:'16px',color:'#666666'}}]);}
this.sandbox.dom.detach(this.dom.$loader);this.sandbox.dom.html($container,this.dom.$loader);this.sandbox.dom.show(this.dom.$loader);},removeLoadingIconForSelected:function(){if(!!this.$selectedElement){var $arrow=this.sandbox.dom.find('.arrow',this.$selectedElement);this.sandbox.dom.hide(this.dom.$loader);this.sandbox.dom.prependClass($arrow,'fa-chevron-right');}},storeDataItem:function(columnNumber,item){if(!this.columns[columnNumber]){this.columns[columnNumber]={};}
this.columns[columnNumber][item[this.options.idName]]=item;},bindDOMEvents:function(){var selector='li:not(.selected'+(this.options.disabledChildren?', .'+constants.disabledClass:'')+')';this.sandbox.dom.on(this.dom.$container,'click',this.itemSelected.bind(this),selector);this.sandbox.dom.on(this.$el,'mouseenter',this.itemMouseEnter.bind(this),'.column-navigation li');this.sandbox.dom.on(this.$el,'mouseleave',this.itemMouseLeave.bind(this),'.column-navigation li');this.sandbox.dom.on(this.$el,'mouseenter',this.showOptions.bind(this),'.column');this.sandbox.dom.on(this.dom.$add,'click',this.addNode.bind(this));this.sandbox.dom.on(this.$el,'click',this.actionClickHandler.bind(this),'.action');this.sandbox.dom.on(this.dom.$container,'dblclick',this.actionClickHandler.bind(this),'li');this.sandbox.dom.on(this.$el,'click',function(event){this.sandbox.dom.stopPropagation(event);}.bind(this),'input[type="checkbox"]');if(this.options.responsive===true){this.sandbox.dom.on(this.sandbox.dom.$window,'resize',function(){this.setContainerHeight();this.setOverflowClass();}.bind(this));}
if(this.options.orderable){this.sandbox.dom.on(this.$el,'click',function(event){this.sandbox.dom.stopPropagation(event);}.bind(this),'.'+constants.orderInputClass);this.sandbox.dom.on(this.$el,'focus',function(event){if(this.isOrdering===true){this.sandbox.dom.blur(event.currentTarget);return false;}
this.sandbox.dom.select(event.currentTarget);}.bind(this),'.'+constants.orderInputClass+' input');this.sandbox.dom.on(this.dom.$wrapper,'mousedown',function(event){this.lastClicked=this.sandbox.dom.$(event.target);}.bind(this));this.sandbox.dom.on(this.dom.$ok,'click',this.closeOrderMode.bind(this));this.sandbox.dom.on(this.$el,'keydown',this.orderKeyHandler.bind(this),'.'+constants.orderInputClass+' input');this.sandbox.dom.on(this.$el,'focusout',this.orderBlurHandler.bind(this),'.'+constants.orderInputClass);}},unbindDOMEvents:function(){this.$el.off();if(!!this.dom.$add){this.dom.$add.off();}
if(!!this.dom.$container){this.dom.$container.off();}
if(!!this.dom.$wrapper){this.dom.$wrapper.off();}
if(!!this.dom.$ok){this.dom.$ok.off();}},orderKeyHandler:function(event){if(event.keyCode===13){this.sandbox.dom.blur(event.currentTarget);}
if(event.keyCode===27){var column=this.sandbox.dom.attr(this.sandbox.dom.parents(event.currentTarget,'.'+constants.columnClass),'data-column'),item=this.sandbox.dom.attr(this.sandbox.dom.parents(event.currentTarget,'.'+constants.columnItemClass),'data-id');this.resetOrderInput(column,item);this.sandbox.dom.blur(event.currentTarget);}},orderBlurHandler:function(event){if(this.isOrdering===false){var column=this.sandbox.dom.attr(this.sandbox.dom.parents(event.currentTarget,'.'+constants.columnClass),'data-column'),item=this.sandbox.dom.attr(this.sandbox.dom.parents(event.currentTarget,'.'+constants.columnItemClass),'data-id'),$input=this.sandbox.dom.find('input',this.columns[column][item].$el);if(this.sandbox.dom.isNumeric(this.sandbox.dom.val($input))&&Math.floor(this.sandbox.dom.val($input))==this.sandbox.dom.val($input)){this.orderPrepare(column,item);}else{this.orderError(column,item);}}},orderPrepare:function(column,item){var $input=this.sandbox.dom.find('input',this.columns[column][item].$el),position=this.normalizeOrderPosition(column,parseInt(this.sandbox.dom.val($input),10));this.sandbox.dom.val($input,position);this.sandbox.dom.removeClass(this.columns[column][item].$el,constants.orderErrorClass);if(position!==this.columns[column][item].order){this.isOrdering=true;this.confirmOrder(function(){this.order(column,item,position);this.isOrdering=false;this.sandbox.dom.click(this.lastClicked);}.bind(this),function(){this.resetOrderInput(column,item);this.isOrdering=false;this.sandbox.dom.click(this.lastClicked);}.bind(this));}},order:function(column,item,newPosition){var oldPosition=this.columns[column][item].order;this.sandbox.util.each(this.columns[column],function(itemId){this.repositionItem(column,itemId,oldPosition,newPosition);this.resetOrderInput(column,itemId);}.bind(this));this.updateItemDomPosition(column,item);this.sandbox.util.delay(this.highlight.bind(this,item),550);this.sandbox.emit(ORDERED.call(this),item,newPosition);this.isOrdering=false;},repositionItem:function(column,item,oldPosition,newPosition){if(this.columns[column][item].order===oldPosition){this.columns[column][item].order=newPosition;}else{if(this.columns[column][item].order>oldPosition&&this.columns[column][item].order<=newPosition){this.columns[column][item].order--;}else if(this.columns[column][item].order<oldPosition&&this.columns[column][item].order>=newPosition){this.columns[column][item].order++;}}},updateItemDomPosition:function(column,item){var $list=this.sandbox.dom.parent(this.columns[column][item].$el);this.sandbox.dom.detach(this.columns[column][item].$el);this.sandbox.dom.insertAt(this.columns[column][item].order-1,'.'+constants.columnItemClass,$list,this.columns[column][item].$el);this.sandbox.dom.scrollAnimate(this.sandbox.dom.position(this.columns[column][item].$el).top,this.sandbox.dom.parents(this.columns[column][item].$el,'.'+constants.columnClass));},resetOrderInput:function(column,item){var $input=this.sandbox.dom.find('input',this.columns[column][item].$el);this.sandbox.dom.val($input,this.columns[column][item].order);},normalizeOrderPosition:function(column,position){position=(position<1)?1:position;return(position>(Object.keys(this.columns[column])).length)?Object.keys(this.columns[column]).length:position;},orderError:function(column,item){this.sandbox.dom.addClass(this.columns[column][item].$el,constants.orderErrorClass);},confirmOrder:function(okCallback,closeCallback){this.sandbox.confirm.alert(this,this.options.orderConfirmTitle,this.options.orderConfirmMessage,okCallback,closeCallback);},setOverflowClass:function(){var $navigation=this.sandbox.dom.find('.column-navigation',this.$el);if(this.sandbox.dom.width($navigation)<this.sandbox.dom.get($navigation,0).scrollWidth){this.sandbox.dom.addClass($navigation,'overflow');}else{this.sandbox.dom.removeClass($navigation,'overflow');}},bindCustomEvents:function(){if(!!this.customEvents){return;}
this.sandbox.on(BREADCRUMB.call(this),this.getBreadCrumb.bind(this));this.sandbox.on(UNMARK.call(this),this.unmark.bind(this));this.sandbox.on(HIGHLIGHT.call(this),this.highlight.bind(this));this.sandbox.on(ORDER.call(this),this.startOrderModeItem.bind(this));this.sandbox.on(SET_OPTIONS.call(this),function(options){this.unbindDOMEvents();this.$el.children().remove();this.options=this.sandbox.util.extend(true,{},this.options,options);this.initialize();}.bind(this));this.sandbox.on('husky.dropdown.'+this.options.instanceName+'.settings.dropdown.item.click',this.dropdownItemClicked.bind(this));if(this.options.responsive===true){this.sandbox.on(RESIZE.call(this),function(){this.setContainerHeight();this.setOverflowClass();}.bind(this));}
this.customEvents=true;},startOrderModeItem:function(itemId){var column=this.getColumnForItem(itemId);if(column>0){this.startOrderModeColumn(column);}},startOrderModeColumn:function(column){if(this.inOrderMode===false&&!!this.columns[column]&&Object.keys(this.columns[column]).length>1){this.inOrderMode=true;var $column=this.$find('.'+constants.columnClass+'[data-column="'+column+'"]');this.lockOptions(column);this.sandbox.dom.addClass($column,constants.orderModeClass);this.sandbox.dom.hide(this.dom.$settings);this.sandbox.dom.hide(this.dom.$add);this.sandbox.dom.show(this.dom.$ok);setOptionButtonWidths.call(this);this.setColumnTextWidth(column);this.sandbox.emit(ORDER_START.call(this));}},closeOrderMode:function(){if(this.inOrderMode===true){var $column=this.$find('.'+constants.columnClass+'.'+constants.orderModeClass),column=this.sandbox.dom.data($column,'column');this.unlockOptions();this.sandbox.dom.removeClass($column,constants.orderModeClass);this.sandbox.dom.hide(this.dom.$ok);this.sandbox.dom.show(this.dom.$settings);this.sandbox.dom.show(this.dom.$add);this.setColumnTextWidth(column);this.inOrderMode=false;this.sandbox.emit(ORDER_END.call(this));}},highlight:function(item){var column=this.getColumnForItem(item);if(column>0){this.sandbox.dom.addClass(this.columns[column][item].$el,constants.highlightClass);this.sandbox.dom.on(this.columns[column][item].$el,'animationend webkitAnimationEnd oanimationend MSAnimationEnd',function(){this.sandbox.dom.removeClass(this.columns[column][item].$el,constants.highlightClass);}.bind(this));}},dropdownItemClicked:function(dropdownItem){if(!!this.lastHoveredColumn&&!!dropdownItem.mode&&dropdownItem.mode==='order'){this.startOrderModeColumn(this.lastHoveredColumn);}
if(!!this.selected[this.lastHoveredColumn]){if(!!dropdownItem.callback){dropdownItem.callback(dropdownItem,this.selected[this.lastHoveredColumn],this.columns[this.lastHoveredColumn]);}else{this.sandbox.emit(SETTINGS.call(this),dropdownItem,this.selected[this.lastHoveredColumn],this.columns[this.lastHoveredColumn]);}}},unmark:function(id){var $element=this.$find('li[data-id="'+id+'"]');if(!!$element.length){this.sandbox.dom.removeClass($element,constants.markedClass);this.marked.splice(this.marked.indexOf(id),1);}},itemMouseEnter:function(event){this.setItemsTextWidth(event.currentTarget);},itemMouseLeave:function(event){this.setItemsTextWidth(event.currentTarget);},getBreadCrumb:function(callback){if(typeof callback==='function'){callback(this.selected);}else{this.sandbox.logger.log("callback is not a function");}},showOptionsAtLast:function(){var $lastColumn=this.sandbox.dom.last(this.sandbox.dom.find('.column',this.dom.$container));this.showOptions({currentTarget:$lastColumn});},showOptions:function(event){if(this.optionsLocked===false){var $currentTarget=this.sandbox.dom.$(event.currentTarget);this.displayOptions($currentTarget);this.sandbox.dom.off(this.dom.$container,'scroll.column-navigation.'+this.options.instanceName);this.sandbox.dom.on(this.dom.$container,'scroll.column-navigation.'+this.options.instanceName,this.displayOptions.bind(this,$currentTarget));}},lockOptions:function(column){var $column=this.$find('.'+constants.columnClass+'[data-column="'+column+'"]');if(!!$column.length){this.showOptions({currentTarget:$column});this.optionsLocked=true;}},unlockOptions:function(){this.optionsLocked=false;},displayOptions:function($activeColumn){if(!!this.inOrderMode){return;}
var visibleRatio;this.lastHoveredColumn=this.sandbox.dom.data($activeColumn,'column');if(this.sandbox.dom.position($activeColumn).left+this.sandbox.dom.width($activeColumn)>this.sandbox.dom.width(this.dom.$container)){visibleRatio=(this.sandbox.dom.width(this.dom.$container)-this.sandbox.dom.position($activeColumn).left)/ this.sandbox.dom.width($activeColumn);}else{visibleRatio=(this.sandbox.dom.width($activeColumn)+this.sandbox.dom.position($activeColumn).left)/ this.sandbox.dom.width($activeColumn);}
if(visibleRatio>=constants.minVisibleRatio){this.sandbox.dom.css(this.$optionsContainer,{'visibility':'visible'});this.moveOptions($activeColumn);this.toggleSettingDropdownItems(this.lastHoveredColumn);}else{this.hideOptions();}},toggleSettingDropdownItems:function(column){if(!!this.options.data&&this.options.data.length>0){var context=createContext.call(this,column);this.sandbox.util.each(this.options.data,function(index,item){if(!!item.enabler&&typeof item.enabler==='function'){this.sandbox.emit('husky.dropdown.'+this.options.instanceName+'.settings.dropdown.item.toggle',item.id,item.enabler(context));}}.bind(this));}},moveOptions:function($activeColumn){var marginLeft=this.sandbox.dom.position($activeColumn).left-1;$(this.$optionsContainer).css('margin-left',marginLeft+'px');if(getAddButton.call(this)){$(this.dom.$add).show();}else{$(this.dom.$add).hide();}
setOptionButtonWidths.call(this);},hideOptions:function(){this.sandbox.dom.css(this.$optionsContainer,{'visibility':'hidden'});},itemSelected:function(event){if(this.columnLoadStarted===false){this.closeOrderMode();this.$selectedElement=this.sandbox.dom.$(event.currentTarget);var id=this.sandbox.dom.data(this.$selectedElement,'id'),column=this.sandbox.dom.data(this.sandbox.dom.parent(this.sandbox.dom.parent(this.$selectedElement)),'column'),selectedItem=this.columns[column][id],length=this.selected.length-1,i,$arrowElement;if(this.sandbox.dom.hasClass(this.$selectedElement,'selected')){this.sandbox.emit(SELECTED.call(this),selectedItem);}else{this.removeCurrentSelected(column);this.sandbox.dom.addClass(this.$selectedElement,'selected');$arrowElement=this.sandbox.dom.find('.arrow',this.$selectedElement);this.addLoadingIcon($arrowElement);if(!!selectedItem){for(i=length;i>=column;i--){delete this.selected[i];}
this.selected[column]=selectedItem;this.sandbox.emit(SELECTED.call(this),selectedItem);if(!!selectedItem[this.options.hasSubName]){this.load(selectedItem._links.children.href,column);}
this.removeColumns(column+1);this.setOverflowClass();}}
if(!selectedItem[this.options.hasSubName]){this.insertAddColumn(selectedItem,column);this.scrollIfNeeded(column);this.setOverflowClass();this.toggleSettingDropdownItems(column);}}},insertAddColumn:function(selectedItem,column){var $addColumn=this.sandbox.dom.createElement(this.sandbox.util.template(templates.column)({columnNumber:column+1,id:'column'+this.options.instanceName+'-'+(column+1)}));this.sandbox.dom.append($addColumn,this.sandbox.dom.createElement(this.sandbox.util.template(templates.noPage)({description:this.sandbox.translate(this.options.noPageDescription)})));this.sandbox.dom.append(this.dom.$container,$addColumn);this.filledColumns++;},scrollIfNeeded:function(column){if(column>constants.displayedcolumns){this.sandbox.dom.scrollLeft(this.dom.$container,(column-constants.displayedcolumns)*constants.columnWidth);}},removeCurrentSelected:function(column){var $items=this.sandbox.dom.find('li','#column'+this.options.instanceName+'-'+column);this.sandbox.util.each($items,function(index,$el){this.sandbox.dom.removeClass($el,'selected');var $arrowElement=this.sandbox.dom.find('.arrow',$el);this.sandbox.dom.addClass($arrowElement,'inactive');}.bind(this));},addNode:function(){var parent=this.selected[this.lastHoveredColumn-1]||null;this.sandbox.emit(ADD.call(this),parent);},actionClickHandler:function(event){var $listItem,id,item,column;if(this.inOrderMode===true){return false;}
if(this.sandbox.dom.hasClass(event.currentTarget,'action')===true){$listItem=this.sandbox.dom.parent(this.sandbox.dom.parent(event.currentTarget));}else{$listItem=this.sandbox.dom.$(event.currentTarget);}
if($listItem.hasClass(constants.disabledClass)){return;}
column=this.sandbox.dom.index(this.sandbox.dom.parents(event.currentTarget,'.column'));id=this.sandbox.dom.attr($listItem,'data-id');item=this.columns[column][id];if(this.options.markable===true){this.sandbox.dom.addClass($listItem,constants.markedClass);this.marked.push(id);this.setItemsTextWidth($listItem);}
this.sandbox.dom.stopPropagation(event);if(!!this.options.actionCallback){this.options.actionCallback(item)}else{this.sandbox.emit(ACTION.call(this),item);}}};});define('__component__$loader@husky',[],function(){'use strict';var defaults={size:'40px',color:'#666',hidden:false},namespace='husky.loader.',SHOW=namespace+'show',HIDE=namespace+'hide',INITIALIZED=namespace+'initialized',templates={doubleBounce:['<div class="spinner">','<div class="double-bounce1"></div>','<div class="double-bounce2"></div>','</div>'].join('')},bindCustomEvents=function(){this.sandbox.on(SHOW,showLoader.bind(this));this.sandbox.on(HIDE,hideLoader.bind(this));},hideLoader=function(){this.sandbox.dom.hide(this.$spinner);},showLoader=function(){this.sandbox.dom.show(this.$spinner);};return{initialize:function(){this.options=this.sandbox.util.extend(true,{},defaults,this.options);this.render();bindCustomEvents.call(this);this.sandbox.emit(INITIALIZED);},render:function(){this.$spinner=this.sandbox.dom.createElement(templates.doubleBounce);var $elements,styles;this.sandbox.dom.html(this.$el,this.$spinner);styles={width:this.options.size,height:this.options.size};this.sandbox.dom.css(this.$spinner,styles);$elements=this.sandbox.dom.find('div',this.$spinner);this.sandbox.dom.css($elements,'background-color',this.options.color);if(this.options.hidden){this.sandbox.dom.hide(this.$spinner);}}};});define('__component__$ckeditor@husky',[],function(){'use strict';var defaults={initializedCallback:null,instanceName:null,table:true,link:true,pasteFromWord:true,height:65,autoStart:true},eventNamespace='husky.ckeditor.',INITIALIZED=function(){return eventNamespace+(this.options.instanceName!==null?this.options.instanceName+'.':'')+'initialized';},CHANGED=function(){return eventNamespace+(this.options.instanceName!==null?this.options.instanceName+'.':'')+'changed';},FOCUSOUT=function(){return eventNamespace+(this.options.instanceName!==null?this.options.instanceName+'.':'')+'focusout';},START=function(){return eventNamespace+(this.options.instanceName!==null?this.options.instanceName+'.':'')+'start';},DESTROY=function(){return eventNamespace+(this.options.instanceName!==null?this.options.instanceName+'.':'')+'destroy';},getConfig=function(){var config=this.sandbox.util.extend(false,{},this.options),toolbarBuilder=this.sandbox.ckeditor.getToolbarBuilder();if(!!config.toolbar){toolbarBuilder=this.sandbox.ckeditor.createToolbarBuilder(config.toolbar);}
if(!this.options.pasteFromWord===true){toolbarBuilder.remove('paste',['PasteFromWord']);}
config.linkShowTargetTab=false;if(!this.options.link){toolbarBuilder.remove('links',['Link','Unlink']);config.linkShowTargetTab=true;}
if(!this.options.table){toolbarBuilder.remove('insert',['Table']);}
if(!!this.options.height){config.autoGrow_minHeight=this.options.height;config.height=this.options.height;}
if(!!this.options.maxHeight){config.autoGrow_maxHeight=this.options.maxHeight;if(config.height>config.autoGrow_maxHeight){config.height=config.autoGrow_maxHeight;}}
if(!!this.options.enterMode){config.enterMode=CKEDITOR['ENTER_'+this.options.enterMode.toUpperCase()];}
if(!config.stylesSet||0===config.stylesSet.length){toolbarBuilder.remove('styles',['Styles']);}
config.toolbar=toolbarBuilder.get();delete config.initializedCallback;delete config.baseUrl;delete config.el;delete config.property;delete config.name;delete config.ref;delete config._ref;delete config.require;delete config.element;delete config.link;delete config.table;delete config.maxHeight;return config;};return{initialize:function(){this.options=this.sandbox.util.extend(true,{},defaults,this.options);this.editorContent=null;if(!!this.options.autoStart){this.startEditor();}else{this.renderStartTemplate();}
this.sandbox.on(START.call(this),this.startEditor.bind(this));this.sandbox.on(DESTROY.call(this),this.destroyEditor.bind(this));},renderStartTemplate:function(){var $content=$(this.$el.val()),text=$content.text(),$trigger=$('<textarea class="form-element ckeditor-preview">'+text+'</textarea>');this.$el.parent().append($trigger);$trigger.one('click',function(e){$(e.currentTarget).remove();this.startEditor();this.editor.once('instanceReady',function(){this.editor.focus();}.bind(this));}.bind(this));},bindEditorEvents:function(){this.editor.on('dialogShow',function(){this.sandbox.dom.addClass(this.sandbox.dom.parent('.cke_dialog_ui_button_ok'),'sulu_ok_button');this.sandbox.dom.addClass(this.sandbox.dom.parent('.cke_dialog_ui_button_cancel'),'sulu_cancel_button');}.bind(this));this.editor.on('change',function(){this.emitChangedEvent();}.bind(this));this.editor.on('mode',function(){if(this.data!==this.editor.getData()){this.emitChangedEvent();}}.bind(this));this.editor.on('instanceReady',function(){this.sandbox.dom.addClass(this.sandbox.dom.find('.cke',this.sandbox.dom.parent(this.$el)),'form-element');this.sandbox.emit(INITIALIZED.call(this));}.bind(this));this.editor.on('blur',function(){this.sandbox.emit(FOCUSOUT.call(this ),this.editor.getData(),this.$el);}.bind(this));},emitChangedEvent:function(){this.data=this.editor.getData();this.sandbox.emit(CHANGED.call(this),this.data,this.$el);},startEditor:function(){var config=getConfig.call(this);this.editor=this.sandbox.ckeditor.init(this.$el,this.options.initializedCallback,config);if(!!this.editorContent){this.editor.setData(this.editorContent);}
this.data=this.editor.getData();this.bindEditorEvents();},destroyEditor:function(){if(!!this.editor){this.editorContent=this.editor.getData();if(!!this.editor.window&&!!this.editor.window.getFrame()){this.editor.destroy();}else{delete CKEDITOR.instances[this.editor.name];}}},destroy:function(){this.destroyEditor();}};});define('__component__$overlay@husky',[],function(){'use strict';var defaults={trigger:'click',triggerEl:null,instanceName:'undefined',openOnStart:false,removeOnClose:true,backdropClose:true,skin:'',supportKeyInput:true,displayHeader:true,propagateEvents:true,type:'normal',cssClass:'',slides:[],top:null,left:null},slideDefaults={index:-1,title:'',subTitle:null,message:'',closeCallback:null,cancelCallback:null,okCallback:null,type:'normal',data:'',tabs:null,okInactive:false,buttonsDefaultAlign:'center',cancelDefaultText:'public.cancel',okDefaultText:'public.ok',languageChanger:null,cssClass:''},internalSlideDefaults={$el:null,$footer:null,$header:null,$content:null,$languageChanger:null,$tabs:null,tabs:null},constants={closeSelector:'.close-button',footerSelector:'.overlay-footer',contentSelector:'.overlay-content',headerSelector:'.overlay-header',slidesS elector:'.slides',overlayOkSelector:'.overlay-ok',overlayCancelSelector:'.overlay-cancel',overlayOtherButtonsSelector:'.overlay-button',tabsClass:'overlay-tabs',languageChangerClass:'language-changer'},types={normal:{buttons:[{type:'ok',inactive:false,align:'right'},{type:'cancel',inactive:false,align:'left'}]},alert:{cssClass:'alert',removeOnClose:true,openOnStart:true,instanceName:'alert',buttons:[{type:'ok',inactive:false,align:'right'},{type:'cancel',inactive:false,align:'left'}]}},buttonTypes={OK:'ok',CANCEL:'cancel'},templates={overlaySkeleton:['<div class="husky-overlay-container <%= overflowClass %> <%= skin %> <%= cssClass %>">','   <div class="slides"></div>','</div>'].join(''),slideSkeleton:['<div class="slide slide-<%= index %> <%= cssClass %>">','   <% if(displayHeader) { %>','      <div class="overlay-header<% if(subTitle) { %> with-sub-title<% } %>">','           <span class="title"><%= title %></span>','           <% if(subTitle) { %><div class="sub-title"><%= subTitle %></div><% } %>','       </div>','   <% } %>','   <div class="overlay-content"></div>','   <div class="overlay-footer">','   </div>','</div>'].join(''),okButton:['<div class="btn action overlay-ok<%= classes %>">','   <% if (!!icon) { %>','   <span class="fa-<%= icon %>"></span>','   <% } %>','   <span class="text"><%= text %></span>','</div>','<div class="loader" style="display: none;"></div>'].join(''),cancelButton:['<div class="btn gray black-text overlay-cancel<%= classes %>">','   <% if (!!icon) { %>','   <span class="fa-<%= icon %>"></span>','   <% } %>','   <span class="text"><%= text %></span>','</div>'].join(''),button:['<div class="btn overlay-button <%= classes %>" data-button-number="<%=buttonNumber%>">','   <% if (!!icon) { %>','   <span class="fa-<%= icon %>"></span>','   <% } %>','   <span class="text"><%= text %></span>','</div>'].join(''),wrapper:['<div class="husky-overlay-wrapper"></div>'].join(''),message:['<div class="message"><%= message %></div>'].join('')},eventNamespace='husky.overlay.',INITIALIZED=function(){return createEventName.call(this,'initialized');},OPENED=function(){return createEventName.call(this,'opened');},CLOSED=function(){return createEventName.call(this,'closed');},CLOSING=function(){return createEventName.call(this,'closing');},OKBUTTON_ACTIVATE=function(){return createEventName.call(this,'okbutton.activate');},OKBUTTON_DEACTIVATE=function(){return createEventName.call(this,'okbutton.deactivate');},REMOVE=function(){return createEventName.call(this,'remove');},OPEN=function(){return createEventName.call(this,'open');},CLOSE=function(){return createEventName.call(this,'close');},SHOW_LOADER=function(){return createEventName.call(this,'show-loader');},HIDE_LOADER=function(){return createEventName.call(this,'hide-loader');},LANGUAGE_CHANGED=function(){return createEventName.call(this,'language-changed');},SLIDE_LEFT=function(){return createEventName.call(this,'slide-left');},SLIDE_RIGHT=function(){return createEventName.call(this,'slide-right');},SLIDE_TO=function(){return createEventName.call(this,'slide-to');},createEventName=function(postFix){return eventNamespace+(this.options.instanceName?this.options.instanceName+'.':'')+postFix;};return{initialize:function(){this.sandbox.logger.log('initialize',this);var type=this.options.type||defaults.type;this.options=this.sandbox.util.extend(true,{},defaults,types[type],this.options);this.setVariables();this.initSlideOptions();this.bindEvents();if(this.options.openOnStart){this.openOverlay();}},initSlideOptions:function(){var key,type;if(this.options.slides.length===0){this.slides[0]=this.sandbox.util.extend({},slideDefaults);this.slides[0].index=0;for(key in slideDefaults){if(this.options.hasOwnProperty(key)){this.slides[0][key]=this.options[key];}}
type=types[this.slides[0].type];this.slides[0]=this.sandbox.util.extend({},type,this.slides[0]);}else{this.sandbox.util.foreach(this.options.slides,function(value,i){this.slides[i]=this.sandbox.util.extend({},slideDefaults,value);type=types[this.slides[i].type];this.slides[i]=this.sandbox.util.extend({},type,this.slides[i]);if(this.slides[i].index===-1){this.slides[i].index=i;}}.bind(this));}},bindEvents:function(){if(!!this.$trigger){this.sandbox.dom.on(this.$trigger,this.options.trigger+'.overlay.'+this.options.instanceName,function(event){this.sandbox.dom.preventDefault(event);this.triggerHandler();}.bind(this));}
this.sandbox.on(REMOVE.call(this),this.removeComponent.bind(this));this.sandbox.on(OKBUTTON_ACTIVATE.call(this),this.activateOkButtons.bind(this));this.sandbox.on(OKBUTTON_DEACTIVATE.call(this),this.deactivateOkButtons.bind(this));this.sandbox.on(OPEN.call(this),this.triggerHandler.bind(this));this.sandbox.on(CLOSE.call(this),this.closeHandler.bind(this));this.sandbox.on('husky.select.'+this.options.instanceName+'.selected.item',function(localeIndex){this.sandbox.emit(LANGUAGE_CHANGED.call(this),this.slides[this.activeSlide].languageChanger.locales[localeIndex],this.activeTab);}.bind(this));},activateOkButtons:function(){var $okButtons=this.sandbox.dom.find(constants.overlayOkSelector,this.overlay.$footer),i,length;for(i=-1,length=$okButtons.length;++i<length;){this.sandbox.dom.removeClass($okButtons[i],'inactive gray');}},deactivateOkButtons:function(){var $okButtons=this.sandbox.dom.find(constants.overlayOkSelector,this.overlay.$footer),i,length;for(i=-1,length=$okButtons.length;++i<length;){this.sandbox.dom.addClass($okButtons[i],'inactive gray');}},removeComponent:function(){this.sandbox.stop();},setVariables:function(){this.$trigger=null;if(!!this.options.triggerEl){this.$trigger=this.sandbox.dom.$(this.options.triggerEl);}
this.overlay={opened:false,collapsed:false,normalHeight:null,$el:null,$slides:null,slides:[]};this.$wrapper=null;this.activeTab=null;this.slides=[];this.activeSlide=0;},triggerHandler:function(){this.openOverlay();},openOverlay:function(){if(this.overlay.opened===false){this.overlay.opened=true;if(this.$wrapper==null){this.initWrapper();}
if(this.overlay.$el===null){this.initSkeleton();this.bindOverlayEvents();this.bindCustomEvents();if(this.options.okInactive===true){this.deactivateOkButtons();}
this.sandbox.emit(INITIALIZED.call(this));this.overlay.$content=this.sandbox.dom.find(constants.contentSelector,this.overlay.$el);this.insertOverlay(true);this.sandbox.start([{name:'loader@husky',options:{el:this.$el.find('.loader'),size:'30px'}}]);}else{this.insertOverlay(true);}}},bindCustomEvents:function(){this.sandbox.on(SLIDE_LEFT.call(this),this.slideLeft.bind(this));this.sandbox.on(SLIDE_RIGHT.call(this),this.slideRight.bind(this));this.sandbox.on(SLIDE_TO.call(this),this.slideEvent.bind(this));this.sandbox.on(SHOW_LOADER.call(this),this.showLoader.bind(this));this.sandbox.on(HIDE_LOADER.call(this),this.hideLoader.bind(this));},showLoader:function(){this.$el.find('.btn').hide();this.$el.find('.loader').show();},hideLoader:function(){this.$el.find('.btn').show();this.$el.find('.loader').hide();},slideLeft:function(){var slide=this.activeSlide-1;if(slide<0){slide=this.slides.length-1;}
this.slideTo(slide);},slideRight:function(){var slide=this.activeSlide+1;if(slide>=this.slides.length){slide=0;}
this.slideTo(slide);},slideEvent:function(slide){if(slide<0||slide>=this.slides.length){this.sandbox.logger.error('Slide index out bounds');return;}
this.slideTo(slide);},slideTo:function(slide){this.activeSlide=slide;var width=this.sandbox.dom.outerWidth(this.sandbox.dom.find('.slide',this.overlay.$slides));this.sandbox.dom.css(this.overlay.$slides,'left','-'+slide*width+'px');},initWrapper:function(){this.$wrapper=this.sandbox.dom.createElement(templates.wrapper);this.$wrapper.hide();},closeOverlay:function(){this.sandbox.emit(CLOSING.call(this));this.overlay.opened=false;this.sandbox.emit(CLOSED.call(this));this.sandbox.dom.off('body','keydown.'+this.options.instanceName);this.$wrapper.hide();if(!this.options.removeOnClose){this.sandbox.dom.detach(this.overlay.$el);}else{this.removeComponent();}},insertOverlay:function(emitEvent){this.sandbox.dom.append(this.$wrapper,this.overlay.$el);this.sandbox.dom.append(this.$el,this.$wrapper);this.$wrapper.show();if(!!emitEvent){this.sandbox.emit(OPENED.call(this));}
if(this.options.supportKeyInput===true){this.sandbox.dom.off('body','keydown.'+this.options.instanceName);this.sandbox.dom.on('body','keydown.'+this.options.instanceName,this.keyHandler.bind(this));}},initSkeleton:function(){this.overlay.$el=this.sandbox.dom.createElement(this.sandbox.util.template(templates.overlaySkeleton,{skin:this.options.skin,cssClass:this.options.cssClass||'',overflowClass:(this.slides.length>1)?'overflow-hidden':''}));this.overlay.$slides=this.sandbox.dom.find(constants.slidesSelector,this.overlay.$el);var slide,$el;for(slide in this.slides){if(this.slides.hasOwnProperty(slide)){$el=this.initSlideSkeleton(slide);this.initButtons(slide);this.setContent(slide);this.sandbox.dom.append(this.overlay.$slides,$el);}}},initSlideSkeleton:function(slide){this.overlay.slides[slide]=this.sandbox.util.extend({},internalSlideDefaults);this.overlay.slides[slide].$el=this.sandbox.dom.createElement(this.sandbox.util.template(templates.slideSkeleton,{title:this.sandbox.util.cropMiddle(this.slides[slide].title,58),subTitle:!!this.slides[slide].subTitle?this.slides[slide].subTitle:null,index:this.slides[slide].index,cssClass:this.slides[slide].cssClass,displayHeader:this.options.displayHeader}));this.overlay.slides[slide].$footer=this.sandbox.dom.find(constants.footerSelector,this.overlay.slides[slide].$el);this.overlay.slides[slide].$content=this.sandbox.dom.find(constants.contentSelector,this.overlay.slides[slide].$el);this.overlay.slides[slide].$header=this.sandbox.dom.find(constants.headerSelector,this.overlay.slides[slide]. $el);if(this.slides[slide].languageChanger!==null){this.renderLanguageChanger(slide);}
this.sandbox.dom.addClass(this.overlay.slides[slide].$footer,this.options.buttonsDefaultAlign);this.sandbox.dom.addClass(this.overlay.slides[slide].$el,this.options.cssClass);return this.overlay.slides[slide].$el;},renderLanguageChanger:function(slide){var $element=this.sandbox.dom.createElement('<div/>');this.sandbox.dom.addClass(this.overlay.$el,'has-language-chooser');this.overlay.slides[slide].$languageChanger=this.sandbox.dom.createElement('<div class="'+constants.languageChangerClass+'"/>');this.sandbox.dom.append(this.overlay.slides[slide].$content,this.overlay.slides[slide].$languageChanger);this.sandbox.dom.append(this.overlay.slides[slide].$languageChanger,$element);this.sandbox.start([{name:'select@husky',options:{el:$element,data:this.slides[slide].languageChanger.locales,preSelectedElements:[this.slides[slide].languageChanger.preSelected],instanceName:this.options.instanceName}}]);},initButtons:function(slide){var i,length,$button,button,template,classes,text,inactive;for(i=-1,length=this.slides[slide].buttons.length;++i<length;){button=this.slides[slide].buttons[i];if(button.type===buttonTypes.OK){template=templates.okButton;text=this.slides[slide].okDefaultText;inactive=this.slides[slide].okInactive;}else if(button.type===buttonTypes.CANCEL){template=templates.cancelButton;text=this.slides[slide].cancelDefaultText;}else{template=templates.button;}
classes=(!!button.classes)?' '+button.classes:'';if(!!button.text){text=button.text;}else if(!!button.icon){text='';}
if(inactive!==true){inactive=button.inactive;}
$button=this.sandbox.dom.createElement(this.sandbox.util.template(template,{icon:button.icon,text:this.sandbox.translate(text),buttonNumber:i,classes:(inactive===true)?classes+' inactive gray':classes}));if(!!button.align){this.sandbox.dom.addClass($button,button.align);}
this.sandbox.dom.append(this.overlay.slides[slide].$footer,$button);}},setContent:function(slide){if(!!this.slides[slide].data){this.sandbox.dom.append(this.overlay.slides[slide].$content,this.slides[slide].data);}else if(!!this.slides[slide].message){this.sandbox.dom.append(this.overlay.slides[slide].$content,this.sandbox.util.template(templates.message,{message:this.slides[slide].message}));}else if(this.slides[slide].tabs!==null){this.renderTabs(slide);}else{this.sandbox.logger.log('Error: either options.data, options.message or options.tabs has to be set',this);}},renderTabs:function(slide){this.overlay.slides[slide].tabs=[];this.overlay.slides[slide].$tabs=this.sandbox.dom.createElement('<div class="'+constants.tabsClass+'"/>');this.sandbox.dom.after(this.overlay.slides[slide].$header,this.overlay.slides[slide].$tabs);for(var i=-1,length=this.slides[slide].tabs.length;++i<length;){this.overlay.slides[slide].tabs.push({id:i,name:this.slides[slide].tabs[i].title,$el:this.sandbox.dom.createElement(this.slides[slide].tabs[i].data)});this.sandbox.dom.hide(this.overlay.slides[slide].tabs[i].$el);this.sandbox.dom.append(this.overlay.slides[slide].$content,this.overlay.slides[slide].tabs[i].$el);}
this.showTab(this.overlay.slides[slide].tabs[0],slide);this.startTabsComponent(slide);},startTabsComponent:function(slide){var $element=this.sandbox.dom.createElement('<div/>');this.sandbox.dom.html(this.overlay.slides[slide].$tabs,$element);this.sandbox.start([{name:'tabs@husky',options:{el:$element,data:this.overlay.slides[slide].tabs,instanceName:'overlay'+this.options.instanceName,skin:'overlay'}}]);},keyHandler:function(event){if(event.keyCode===27){this.closeHandler();}else if(event.keyCode===13){if(event.target.tagName==='TEXTAREA'){return;}
this.okHandler();}},bindOverlayEvents:function(){if(this.options.propagateEvents===false){this.sandbox.dom.on(this.overlay.$el,'click',function(event){this.sandbox.dom.stopPropagation(event);}.bind(this));this.sandbox.dom.on(this.$wrapper,'click',function(event){this.sandbox.dom.stopPropagation(event);}.bind(this));}
this.sandbox.dom.on(this.overlay.$el,'click',this.closeHandler.bind(this),constants.overlayCancelSelector);this.sandbox.dom.on(this.overlay.$el,'click',this.okHandler.bind(this),constants.overlayOkSelector);this.sandbox.dom.on(this.overlay.$el,'click',this.buttonHandler.bind(this),constants.overlayOtherButtonsSelector);if(this.options.backdropClose===true){this.sandbox.dom.on(this.$wrapper,'click',function(event){if(event.target===this.$wrapper.get(0)){this.closeHandler(event);}}.bind(this));}
this.bindOverlayCustomEvents();},bindOverlayCustomEvents:function(){if(this.overlay.tabs!==null){this.sandbox.on('husky.tabs.overlay'+this.options.instanceName+'.item.select',this.showTab.bind(this));}},showTab:function(tab,slide){slide=slide||this.activeSlide;this.activeTab=tab;this.hideAllTabsElements(slide);this.sandbox.dom.show(tab.$el);},hideAllTabsElements:function(slide){for(var i=-1,length=this.overlay.slides[slide].tabs.length;++i<length;){this.sandbox.dom.hide(this.overlay.slides[slide].tabs[i].$el);}},okHandler:function(event){if(!!event&&this.sandbox.dom.hasClass(event.currentTarget,'inactive')){return;}
if(!!event){this.sandbox.dom.preventDefault(event);this.sandbox.dom.stopPropagation(event);}
if(this.executeCallback(this.slides[this.activeSlide].okCallback,this.sandbox.dom.find(constants.contentSelector,this.overlay.$el))!==false){this.closeOverlay();}},closeHandler:function(event){var cancelCallback=this.slides[this.activeSlide].closeCallback||this.slides[this.activeSlide].cancelCallback;if(!!event){this.sandbox.dom.preventDefault(event);this.sandbox.dom.stopPropagation(event);}
if(this.executeCallback(cancelCallback,this.sandbox.dom.find(constants.contentSelector,this.overlay.$el))!==false){this.closeOverlay();}},buttonHandler:function(event){if(!event||this.sandbox.dom.hasClass(event.currentTarget,'inactive')){return;}
var buttonNumber=this.sandbox.dom.data(event.currentTarget,'buttonNumber'),button=this.slides[this.activeSlide].buttons[buttonNumber];this.sandbox.dom.preventDefault(event);this.sandbox.dom.stopPropagation(event);this.executeCallback(button.callback,this.sandbox.dom.find(constants.contentSelector,this.overlay.$el));},executeCallback:function(callback,data){if(typeof callback==='function'){return callback(data);}}};});define('__component__$label@husky',[],function(){'use strict';var defaults={instanceName:'undefined',type:'WARNING',html:null,title:null,counter:1,description:null,hasClose:true,effectType:'slide',autoVanish:true,vanishDelay:0,vanishDuration:250,showDuration:250,closeCallback:null,insertMethod:'append'},insertMethods={APPEND:'append',PREPEND:'prepend'},constants={textClass:'text',closeClass:'close',counterClass:'counter',closeIconClass:'fa-times-circle'},typesDefaults={ERROR:{title:'Error',labelClass:'husky-label-error',vanishDelay:10000},WARNING:{vanishDelay:5000,title:'Warning',labelClass:'husky-label-warning'},SUCCESS:{vanishDelay:5000,title:'Success',labelClass:'husky-label-success'},SUCCESS_ICON:{labelClass:'husky-label-success-icon',effectType:'fade',hasClose:false,vanishDelay:2000,showDuration:100}},templates={basic:['<div class="'+constants.textClass+'">','   <% if (!!title) { %><strong><%= title %></strong><% } %>','   <span><%= description %></span>','   <div class="'+constants.counterClass+'"><span><%= counter %></span></div>','</div>'].join(''),closeButton:['<div class="'+constants.closeClass+'">','<span class="'+constants.closeIconClass+'"></span>','</div>'].join('')},eventNamespace='husky.label.',INITIALIZED=function(){return createEventName.call(this,'initialized');},DESTROYED=function(){return createEventName.call(this,'destroyed');},REFRESH=function(){return createEventName.call(this,'refresh');},createEventName=function(postFix){return eventNamespace+(this.options.instanceName?this.options.instanceName+'.':'')+postFix;};return{initialize:function(){this.options=this.sandbox.util.extend(true,{},defaults,typesDefaults[this.options.type],this.options);this.vanishTimer=null;this.label={$el:null,$content:null,$close:null};this.bindCustomEvents();this.render();this.bindDomEvents();this.startEffects();this.sandbox.emit(INITIALIZED.call(this));},destroy:function(){this.sandbox.emit(DESTROYED.call(this));},bindDomEvents:function(){this.sandbox.dom.on(this.label.$close,'click',function(){this.vanish();if(typeof this.options.closeCallback==='function'){this.options.closeCallback();}}.bind(this));},bindCustomEvents:function(){this.sandbox.on(REFRESH.call(this),this.refresh.bind(this));},refresh:function(){this.options.counter+=1;this.abortEffects();this.label.$el.find('.'+constants.counterClass+' span').html(this.options.counter);this.updateCounterVisibility();this.startEffects();},startEffects:function(){if(this.options.autoVanish===true){this.vanishTimer=_.delay(function(){this.vanish();}.bind(this),this.options.vanishDelay);}},abortEffects:function(){this.label.$el.stop();this.label.$el.removeAttr('style');clearTimeout(this.vanishTimer);},vanish:function(){if(this.options.effectType==='slide'){this.label.$el.slideUp({duration:this.options.vanishDuration,done:this.close.bind(this)});}else if(this.options.effectType==='fade'){this.label.$el.fadeOut({duration:this.options.vanishDuration,done:this.close.bind(this)});}},show:function(){if(this.options.effectType==='slide'){this.label.$el.slideDown({duration:this.options.showDuration});}else if(this.options.effectType==='fade'){this.label.$el.fadeIn({duration:this.options.showDuration});}},render:function(){this.renderElement();this.renderContent();this.renderClose();this.updateCounterVisibility();this.insertLabel();this.show();},renderElement:function(){this.label.$el=this.sandbox.dom.createElement('<div class="'+this.options.labelClass+'"/>');this.label.$el.hide();},renderContent:function(){if(this.options.html!==null){this.label.$content=this.sandbox.dom.createElement(this.options.html);}else{this.label.$content=this.sandbox.dom.createElement(this.sandbox.util.template(templates.basic,{title:this.options.title,description:this.options.description,counter:this.options.counter}));}
this.sandbox.dom.append(this.label.$el,this.label.$content);},updateCounterVisibility:function(){if(this.options.counter>1){this.sandbox.dom.show(this.label.$el.find('.'+constants.counterClass));}else{this.sandbox.dom.hide(this.label.$el.find('.'+constants.counterClass));}},renderClose:function(){if(this.options.hasClose===true){this.label.$close=this.sandbox.dom.createElement(templates.closeButton);this.sandbox.dom.append(this.label.$el,this.label.$close);}},insertLabel:function(){if(this.options.insertMethod===insertMethods.APPEND){this.sandbox.dom.append(this.$el,this.label.$el);}else if(this.options.insertMethod===insertMethods.PREPEND){this.sandbox.dom.prepend(this.$el,this.label.$el);}else{this.sandbox.logger.log('No insert method found for',this.options.insertMethod);}},close:function(){this.sandbox.stop();}};});define('__component__$toggler@husky',[],function(){'use strict';var defaults={instanceName:'undefined',hiddenCheckbox:true,outline:false},constants={componentClass:'husky-toggler',switchClass:'switch',checkedClass:'checked',wrapperClass:'toggler-wrapper',outlineClass:'outline'},eventNamespace='husky.toggler.',INITIALIZED=function(){return createEventName.call(this,'initialized');},CHANGED=function(){return createEventName.call(this,'changed');},CHANGE=function(){return createEventName.call(this,'change');},createEventName=function(postFix){return eventNamespace+(this.options.instanceName?this.options.instanceName+'.':'')+postFix;};return{initialize:function(){this.options=this.sandbox.util.extend(true,{},defaults,this.options);this.hasId=false;this.$checkbox=null;this.$wrapper=null;this.render();this.bindDomEvents();this.bindCustomEvents();if(this.$el.data('checked')===undefined){this.setData(false);}
this.sandbox.emit(INITIALIZED.call(this));},render:function(){this.sandbox.dom.addClass(this.$el,constants.componentClass);if(this.sandbox.dom.attr(this.$el,'id')){this.options.instanceName=this.sandbox.dom.attr(this.$el,'id');this.hasId=true;}
if(this.options.outline===true){this.sandbox.dom.addClass(this.$el,constants.outlineClass);}
this.$wrapper=this.sandbox.dom.createElement('<div class="'+constants.wrapperClass+'"/>');this.sandbox.dom.html(this.$el,this.$wrapper);this.generateHiddenCheckbox();if(this.getData()===true){this.setChecked(false);}
this.sandbox.dom.append(this.$wrapper,this.sandbox.dom.createElement('<div class="'+constants.switchClass+'"/>'));},bindDomEvents:function(){this.sandbox.dom.on(this.$el,'click',function(){this.toggleButton();}.bind(this));if(this.hasId===true){this.sandbox.dom.on('label[for="'+this.options.instanceName+'"]','click',function(){this.toggleButton();}.bind(this));}},bindCustomEvents:function(){this.sandbox.on(CHANGE.call(this),function(checked){if(this.getData()!==checked){if(checked===true){this.setChecked(true);}else{this.unsetChecked(true);}}}.bind(this));},toggleButton:function(){if(this.getData()===true){this.unsetChecked(true);}else{this.setChecked(true);}},setChecked:function(emit){this.sandbox.dom.addClass(this.$el,constants.checkedClass);this.setData(true);this.updateCheckbox(this.getData());if(emit!==false){this.sandbox.emit(CHANGED.call(this),true);}},unsetChecked:function(emit){this.sandbox.dom.removeClass(this.$el,constants.checkedClass);this.setData(false);this.updateCheckbox(this.getData());if(emit!==false){this.sandbox.emit(CHANGED.call(t his),false);}},generateHiddenCheckbox:function(){if(this.options.hiddenCheckbox===true){this.$checkbox=this.sandbox.dom.createElement('<input type="checkbox" name="'+this.options.instanceName+'"/>');this.sandbox.dom.append(this.$wrapper,this.$checkbox);}},updateCheckbox:function(checked){if(this.$checkbox!==null){this.sandbox.dom.prop(this.$checkbox,'checked',checked);}},setData:function(isChecked){this.$el.data('checked',!!isChecked);},getData:function(){return this.$el.data('checked');}};});define('__component__$dropzone@husky',[],function(){'use strict';var defaults={instanceName:'undefined',titleKey:'sulu.upload.dropzone-title',descriptionKey:'sulu.upload.dropzone-desc',descriptionIcon:'cloud-upload',cancelLoadingIcon:'repeat',method:'POST',url:'/',paramName:'file',headers:{'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8'},uploadMultiple:false,successCallback:null,beforeSendingCallback:null,removeFileCallback:null,afterDropCallback:null,pluginOptions:{},maxFiles:null,fadeOutDuration:200,fadeOutDelay:1500,showOverlay:true,keepFilesAfterSuccess:false,skin:'',dropzoneEnabled:true,cancelUploadOnOverlayClick:false,maxFilesize:256,fileTooBigKey:'husky.upload.error.file-to-big'},constants={contianerClass:'husky-dropzone',descriptionClass:'description',uploadedItemContainerClass:'upload-items',uploadItemClass:'item',droppedClass:'dropped'},templates={basic:['<div class="dropzone-container">','   <div class="'+constants.descriptionClass+'">','<div class="fa-<%= icon %> icon"></div>','<span class="title"><%= title %></span>','<span class="addition"><%= description %></span>','   </div>','   <div class="'+constants.uploadedItemContainerClass+'"></div>','</div>'].join(''),uploadItem:['<div class="'+constants.uploadItemClass+'">'+'<div class="loading-content">','<div class="fa-<%= cancelIcon %> icon" data-dz-remove></div>','<div class="file-size" data-dz-size></div>','<div class="progress">','<div class="bar" data-dz-uploadprogress></div>','</div>','</div>','<div class="success-content">','<div class="image">','<img data-dz-thumbnail />','</div>','<div class="fa-check tick"></div>','</div>','</div>'].join('')},eventNamespace='husky.dropzone.',INITIALIZED=function(){return createEventName.call(this,'initialized');},UPLOADING=function(){return createEventName.call(this,'uploading');},SUCCESS=function(){return createEventName.call(this,'success');},ERROR_FILE_TO_BIG=function(){return createEventName.call(this,'error.file-to-big',true);},ERROR=function(){return createEventName.call(this,'error',true);},OPEN_DATA_SOURCE=function(){return createEventName.call(this,'open-data-source');},LOCK_POPUP=function(){return createEventName.call(this,'lock-popup');},UNLOCK_POPUP=function(){return createEventName.call(this,'unlock-popup');},SHOW_POPUP=function(){return createEventName.call(this,'show-popup');},FILES_ADDED=function(){return createEventName.call(this,'files-added');},CHANGE_URL=function(){return createEventName.call(this,'change-url');},UPLOAD_ENABLE=function(){return createEventName.call(this,'enable');},UPLOAD_DISABLE=function(){return createEventName.call(this,'disable');},createEventName=function(postFix,global){return[eventNamespace,((!global&&this.options.instanceName)?this.options.instanceName+'.':''),postFix].join('');},createJQueryEventName=function(event){return event+'.dropzone.'+(this.options.instanceName?this.options.instanceName:'');};return{initialize:function(){this.sandbox.logger.log('initialize',this);this.options=this.sandbox.util.extend(true,{},defaults,this.options);this.dropzone=null;this.dropzoneEnabled=this.options.dropzoneEnabled;this.$dropzone=null;this.lastUploadedFile=null;this.overlayOpened=false;this.lockPopUp=false;this.url=this.options.url;this.filesDropped=0;this.bindCustomEvents();this.render();this.bindDomEvents();this.sandbox.emit(INITIALIZED.call(this));},bindDomEvents:function(){this.sandbox.dom.on(this.sandbox.dom.find('*',this.$dropzone),'click',function(event){this.sandbox.dom.stopPropagation(event);this.sandbox.dom.trigger(this.$dropzone,'click');}.bind(this));if(this.options.showOverlay){this.sandbox.dom.on(this.sandbox.dom.$document,createJQueryEventName.call(this,'dragenter'),function(){this.openOverlay();}.bind(this));this.sandbox.dom.on(this.sandbox.dom.$document,createJQueryEventName.call(this,'drop'),fun ction(event){if(this.dropzoneEnabled){this.addFiles(event.originalEvent.dataTransfer.files);}}.bind(this));}
this.sandbox.dom.on(this.sandbox.dom.$document,createJQueryEventName.call(this,'dragover')+' '+createJQueryEventName.call(this,'drop'),function(event){this.sandbox.dom.preventDefault(event);}.bind(this));if(this.options.cancelUploadOnOverlayClick){this.$el.on('click','.husky-overlay-container.dropzone',function(){if(this.overlayOpened===true){this.sandbox.emit('husky.overlay.dropzone-'+this.options.instanceName+'.close');}
this.sandbox.dom.removeClass(this.$dropzone,constants.droppedClass);this.dropzone.removeAllFiles();}.bind(this));}},bindCustomEvents:function(){this.sandbox.on(OPEN_DATA_SOURCE.call(this),function(){this.sandbox.dom.trigger(this.$dropzone,'click');}.bind(this));this.sandbox.on(CHANGE_URL.call(this),function(url){this.url=url;}.bind(this));this.sandbox.on(UPLOAD_DISABLE.call(this),function(){this.dropzoneEnabled=false;this.dropzone.disable();}.bind(this));this.sandbox.on(UPLOAD_ENABLE.call(this),function(){this.dropzoneEnabled=true;this.dropzone.enable();}.bind(this));if(this.options.showOverlay){this.sandbox.on(LOCK_POPUP.call(this),function(){this.lockPopUp=true;}.bind(this));this.sandbox.on(UNLOCK_POPUP.call(this),function(){this.lockPopUp=false;}.bind(this));this.sandbox.on(SHOW_POPUP.call(this),function(){this.openOverlay();}.bind(this));}},openOverlay:function(){if(this.overlayOpened===false&&this.lockPopUp===false&&this.dropzoneEnabled){this.sandbox.dom.heigh t(this.$el,this.sandbox.dom.outerHeight(this.$el));var $container=this.sandbox.dom.createElement('<div/>');this.sandbox.dom.append(this.$el,$container);this.sandbox.start([{name:'overlay@husky',options:{el:$container,openOnStart:true,removeOnClose:true,draggable:false,data:this.$dropzone,instanceName:'dropzone-'+this.options.instanceName,skin:'dropzone',smallHeader:true,cancelCallback:function(){this.sandbox.dom.append(this.$el,this.$dropzone);this.sandbox.dom.height(this.$el,'');this.overlayOpened=false;}.bind(this)}}]);this.overlayOpened=true;}},render:function(){this.$dropzone=this.sandbox.dom.createElement('<div class="'+constants.contianerClass+'"/>');this.sandbox.dom.html(this.$dropzone,this.sandbox.util.template(templates.basic)({description:this.sandbox.translate(this.options.descriptionKey),title:this.sandbox.translate(this.options.titleKey),icon:this.options.descriptionIcon,instanceName:this.options.instanceName}));this.sandbox.dom.addClass(this.$dropzone,this.options.skin);this.sandbox.dom.append(this.$el,this.$dropzone);this.startDropzone();},startDropzone:function(){var that=this,options={url:this.options.url,method:this.options.method,paramName:this.options.paramName,uploadMultiple:this.options.uploadMultiple,maxFiles:this.options.maxFiles,maxFilesize:this.options.maxFilesize,dictFileTooBig:this.sandbox.translate(this.options.fileTooBigKey),headers:this.options.headers,autoProcessQueue:!this.options.afterDropCallback,previewTemplate:this.sandbox.util.template(templates.uploadItem)({cancelIcon:this.options.cancelLoadingIcon}),previewsContainer:this.sandbox.dom.find('.'+constants.uploadedItemContainerClass,this.$dropzone)[0],init:function(){that.dropzone=this;this.on('drop',function(event){this.sandbox.dom.stopPropagation(event);this.filesDropped=event.dataTransfer.files.length;}.bind(that));if(that.options.showOverlay===true){this.on('dragenter',function(){this.openOverlay();}.bind(that));}
this.on('addedfile',function(file){that.sandbox.dom.addClass(that.$dropzone,constants.droppedClass);if(typeof that.options.afterDropCallback==='function'){if(this.files.length===that.filesDropped||that.filesDropped===0){that.options.afterDropCallback(file).then(function(){that.sandbox.util.foreach(this.files,function(file){that.sandbox.util.delay(this.processFile.bind(this,file),0);}.bind(this));}.bind(this));}}
that.sandbox.dom.on(file.previewElement,'click',function(event){this.sandbox.dom.stopPropagation(event);}.bind(that));});this.on('sending',function(file){if(typeof this.options.beforeSendingCallback==='function'){this.options.beforeSendingCallback(file);}else{this.sandbox.emit(UPLOADING.call(this),file);}}.bind(that));this.on('success',function(file,response){if(this.lastUploadedFile!==file){file.response=response;this.lastUploadedFile=file;if(typeof this.options.successCallback==='function'){this.options.successCallback(file,response);}else{this.sandbox.emit(SUCCESS.call(this),file,response);}
this.removeAllFiles(this.options.keepFilesAfterSuccess);}}.bind(that));this.on('removedfile',function(file){if(typeof this.options.removeFileCallback==='function'){this.options.removeFileCallback(file);}}.bind(that));this.on('reset',function(){if(this.options.keepFilesAfterSuccess===false){this.sandbox.dom.removeClass(this.$dropzone,constants.droppedClass);}}.bind(that));this.on('processing',function(){this.options.url=that.url;});this.on('error',function(file,message){this.removeFile(file);if(file.size / 1024>that.options.maxFilesize||file.xhr.status===413){that.sandbox.emit(ERROR_FILE_TO_BIG.call(this),that.getMessage.call(that,that.options.fileTooBigKey,file),file);}else{that.sandbox.emit(ERROR.call(this),message,file);}});}};options=this.sandbox.util.extend(true,{},options,this.options.pluginOptions);this.sandbox.dropzone.initialize(this.$dropzone,options);},getMessage:function(message,file){return this.sandbox.translate(message).replace('{{filesize}}',Math.round((file.size / 1048576)*100)/ 100).replace('{{maxFilesize}}',this.options.maxFilesize).replace('{{filename}}',this.sandbox.util.cropMiddle(file.name,20));},addFiles:function(files){this.sandbox.util.each(files,function(index,file){this.dropzone.addFile(file);}.bind(this));},removeAllFiles:function(keepDom){if(this.dropzone.getUploadingFiles.call(this.dropzone).length===0){if(keepDom===true){this.afterFadeOut(true);}else{this.sandbox.util.delay(function(){this.sandbox.dom.fadeOut(this.sandbox.dom.find('.'+constants.uploadItemClass,this.$dropzone),this.options.fadeOutDuration,function(){if(this.sandbox.dom.find('.'+constants.uploadItemClass+':animated',this.$dropzone).length===0){this.afterFadeOut();}}.bind(this));}.bind(this),this.options.fadeOutDelay);}}},afterFadeOut:function(keepDom){if(this.overlayOpened===true){this.sandbox.emit('husky.overlay.dropzone-'+this.options.instanceName+'.close');}
this.sandbox.emit(FILES_ADDED.call(this),this.getResponseArray(this.dropzone.files));this.filesDropped=0;if(keepDom===true){this.dropzone.files=[];}else{this.sandbox.dom.removeClass(this.$dropzone,constants.droppedClass);this.dropzone.removeAllFiles();}},getResponseArray:function(files){var arrReturn=[],i,length;for(i=-1,length=files.length;++i<length;){arrReturn.push(files[i].response);}
return arrReturn;},remove:function(){this.dropzone.disable();this.dropzone.destroy();this.sandbox.dom.off(this.sandbox.dom.$document,createJQueryEventName.call(this,'dragenter'));this.sandbox.dom.off(this.sandbox.dom.$document,createJQueryEventName.call(this,'drop'));this.sandbox.dom.off(this.sandbox.dom.$document,createJQueryEventName.call(this,'dragover'));}};});define('__component__$input@husky',[],function(){'use strict';var defaults={instanceName:'undefined',inputId:'',inputName:'',value:'',placeholder:'',disabled:false,skin:null,datepickerOptions:{orientation:'auto',startDate:-Infinity,endDate:Infinity,todayHighlight:true},colorPickerOptions:{},lockOptions:{locked:false},frontIcon:null,frontText:null,frontHtml:null,backIcon:null,backText:null,backHtml:null,renderMethod:null,inputType:'text'},constants={componentClass:'husky-input',frontClass:'front',backClass:'back',textClass:'text',inputClass:'input',actionClass:'action',colorFieldClass:'color-field',colorpickerClass:'colorpicker',datepickerClass:'pickdate',linkClickableClass:'clickable',lockIconClass:'fa-lock',unlockIconClass:'fa-unlock'},templates={input:'<input type="<%= type %>" value="<%= value %>" placeholder="<%= placeholder %>" id="<%= id %>" name="<%= name %>" data-from="false" <%= disabled %>/>',colorPickerFront:'<div class="'+constants.colorFieldClass+'"/>'},renderMethods={colorpicker:function(){this.renderColorPicker();},datepicker:function(){this.renderDatePicker();},time:function(){this.renderTime();},url:function(){this.renderLink('http://');},email:function(){this.renderLink('mailto:');},lock:function(){this.renderLock();}},frontClickedCallbacks={lock:function(event){this.lockClickedCallback(event);}},skins={color:{frontHtml:templates.colorPickerFront,renderMethod:'colorpicker'},phone:{frontIcon:'phone'},password:{frontIcon:'key',inputType:'password'},url:{frontText:'http://',renderMethod:'url'},email:{frontIcon:'envelope',renderMethod:'email'},date:{frontIcon:'calendar',placeholder:'TT - MM - JJJJ',renderMethod:'datepicker'},time:{frontIcon:'clock-o',placeholder:'HH - MM',renderMethod:'time'},lock:{frontIcon:'lock',renderMethod:'lock'}},eventNamespace='husky.input.',INITIALIZED=function(){return createEventName.call(this,'initialized');},LOCKED=function(){return createEventName.call(this,'locked');},UNLOCKED=function(){return createEventName.call(this,'unlocked');},createEventName=function(postFix){return eventNamespace+(this.options.instanceName?this.options.instanceName+'.':'')+postFix;};return{initialize:function(){this.sandbox.logger.log('initialize',this);var instanceDefaults=this.sandbox.util.extend(true,{},defaults);if(!!this.options.skin&&!!skins[this.options.skin]){instanceDefaults=this.sandbox.util.extend(true,{},defaults,skins[this.options.skin]);}
this.options=this.sandbox.util.extend(true,{},instanceDefaults,this.options);this.input={$front:null,$input:null,$back:null};this.linkProtocol=null;this.render();this.bindDomEvents();this.sandbox.emit(INITIALIZED.call(this));},render:function(){this.sandbox.dom.addClass(this.$el,constants.componentClass);if(!!this.options.action){this.sandbox.dom.addClass(this.$el,constants.actionClass);}
this.renderFront();this.renderInput();this.renderBack();if(!!this.options.renderMethod&&!!renderMethods[this.options.renderMethod]){renderMethods[this.options.renderMethod].call(this);}},bindDomEvents:function(){this.sandbox.dom.on(this.$el,'change',function(event){event.stopPropagation();event.preventDefault();this.$el.trigger('change');}.bind(this),'input');this.sandbox.dom.on(this.$el.find('.'+constants.frontClass),'click',function(event){if(frontClickedCallbacks.hasOwnProperty(this.options.skin)){frontClickedCallbacks[this.options.skin].call(this,event);}}.bind(this));this.sandbox.dom.on(this.$el,'click',function(){this.sandbox.dom.focus(this.input.$input);}.bind(this));this.sandbox.dom.on(this.input.$input,'click',function(){this.sandbox.dom.focus(this.input.$input);}.bind(this));if(!!this.sandbox.dom.attr(this.$el,'id')){this.sandbox.dom.on('label[for="'+this.sandbox.dom.attr(this.$el,'id')+'"]','click',function(){this.sandbox.dom.focus(this.input.$input);}.bind(this));} 
this.sandbox.dom.on(this.$el,'data-changed',function(){this.updateValue();}.bind(this));},renderFront:function(){if(!!this.options.frontIcon||!!this.options.frontText||!!this.options.frontHtml){this.input.$front=this.sandbox.dom.createElement('<div class="'+constants.frontClass+'"/>');if(!!this.options.frontIcon){this.sandbox.dom.html(this.input.$front,'<a class="fa-'+this.options.frontIcon+'"></a>');}else if(!!this.options.frontText){this.sandbox.dom.html(this.input.$front,'<a class="'+constants.textClass+'">'+this.options.frontText+'</a>');}else{this.sandbox.dom.html(this.input.$front,this.options.frontHtml);}
this.sandbox.dom.append(this.$el,this.input.$front);}},renderInput:function(){var $container=this.sandbox.dom.createElement('<div class="'+constants.inputClass+'"/>');this.input.$input=this.sandbox.dom.createElement(this.sandbox.util.template(templates.input)({type:this.options.inputType,name:(!!this.options.inputName)?this.options.inputName:'husky-input-'+this.options.instanceName,id:(!!this.options.inputId)?this.options.inputId:'husky-input-'+this.options.instanceName,value:this.options.value,placeholder:this.options.placeholder,disabled:(this.options.disabled===true)?'disabled':''}));this.sandbox.dom.append($container,this.input.$input);this.sandbox.dom.append(this.$el,$container);},renderBack:function(){if(!!this.options.backIcon||!!this.options.backText||!!this.options.backHtml){this.input.$back=this.sandbox.dom.createElement('<div class="'+constants.backClass+'"/>');if(!!this.options.backIcon){this.sandbox.dom.html(this.input.$back,'<span class="fa-'+this.options.backIcon+'"></span>');}else if(!!this.options.backText){this.sandbox.dom.html(this.input.$back,'<span class="'+constants.textClass+'">'+this.options.backText+'</span>');}else{this.sandbox.dom.html(this.input.$back,this.options.backHtml);}
this.sandbox.dom.append(this.$el,this.input.$back);}},renderColorPicker:function(){this.sandbox.dom.addClass(this.$el,constants.colorpickerClass);this.changeColorPreview(this.sandbox.dom.val(this.input.$input));this.sandbox.colorpicker.init(this.input.$input,this.sandbox.util.extend(true,{},{change:this.changeColorPreview.bind(this)},this.options.colorPickerOptions));},renderDatePicker:function(){this.sandbox.dom.addClass(this.$el,constants.datepickerClass);this.sandbox.dom.attr(this.input.$input,'placeholder',this.sandbox.globalize.getDatePattern());if(!!this.options.datepickerOptions.startDate&&typeof(this.options.datepickerOptions.startDate)==='string'){this.options.datepickerOptions.startDate=new Date(this.options.datepickerOptions.startDate);}
if(!!this.options.datepickerOptions.endDate&&typeof(this.options.datepickerOptions.endDate)==='string'){this.options.datepickerOptions.endDate=new Date(this.options.datepickerOptions.endDate);}
this.sandbox.datepicker.init(this.input.$input,this.options.datepickerOptions).on('changeDate',function(event){this.setDatepickerValueAttr(event.date);}.bind(this));this.updateValue();this.bindDatepickerDomEvents();},renderLink:function(protocol){this.linkProtocol=protocol;this.sandbox.dom.on(this.input.$input,'keyup',this.changeFrontLink.bind(this));this.changeFrontLink();},renderLock:function(){var locked=this.options.lockOptions.locked;this.sandbox.dom.addClass(this.sandbox.dom.find('a',this.input.$front),constants.linkClickableClass);this.renderLockIcon();this.$el.data('locked',locked);},lockClickedCallback:function(event){if(this.options.disabled===true){return;}
var locked=!this.options.lockOptions.locked;this.options.lockOptions.locked=locked;this.sandbox.dom.prop(this.input.$input,'disabled',locked);this.renderLockIcon();this.$el.data('locked',locked);if(locked){this.sandbox.emit(LOCKED.call(this));event.stopPropagation();}else{this.sandbox.emit(UNLOCKED.call(this));}},renderLockIcon:function(){var removeIcon=constants.lockIconClass,addIcon=constants.unlockIconClass;if(this.options.lockOptions.locked){removeIcon=constants.unlockIconClass;addIcon=constants.lockIconClass;}
this.exchangeFrontIconClass(addIcon,removeIcon);},exchangeFrontIconClass:function(addClass,removeClass){var selector=this.sandbox.dom.find('a',this.input.$front);this.sandbox.dom.removeClass(selector,removeClass);this.sandbox.dom.addClass(selector,addClass);if(this.sandbox.dom.hasClass(selector,constants.linkClickableClass)){this.sandbox.dom.removeClass(selector,constants.linkClickableClass);this.sandbox.dom.addClass(selector,constants.linkClickableClass);}},changeFrontLink:function(){var value=this.sandbox.dom.val(this.input.$input);if(!!value){this.sandbox.dom.addClass(this.sandbox.dom.find('a',this.input.$front),constants.linkClickableClass);this.sandbox.dom.attr(this.sandbox.dom.find('a',this.input.$front),'href',this.linkProtocol+value);if(this.linkProtocol.indexOf('mailto')<0){this.sandbox.dom.attr(this.sandbox.dom.find('a',this.input.$front),'target','_blank');}}else{this.sandbox.dom.removeClass(this.sandbox.dom.find('a',this.input.$front),constants.linkClickableClass);this.sandbox.dom.removeAttr(this.sandbox.dom.find('a',this.input.$front),'href');}},bindDatepickerDomEvents:function(){this.sandbox.dom.on(this.input.$input,'focusout',function(){this.setDatepickerValueAttr(this.sandbox.datepicker.getDate(this.input.$input));}.bind(this));},renderTime:function(){this.sandbox.dom.attr(this.input.$input,'placeholder',this.sandbox.globalize.getTimePatter());},changeColorPreview:function(color){this.sandbox.dom.css(this.$find('.'+constants.colorFieldClass),{'ba ckground-color':color});},setValue:function(value){if(this.options.renderMethod==='colorpicker'){if(!!value){this.sandbox.colorpicker.value(this.input.$input,value);}else{this.sandbox.dom.val(this.input.$input,value);}}else if(this.options.renderMethod==='datepicker'){if(!!value){value=this.isoToDate(value);value=new Date(value);}
this.sandbox.datepicker.setDate(this.input.$input,value);this.setDatepickerValueAttr(this.sandbox.datepicker.getDate(this.input.$input));}else{this.sandbox.dom.val(this.input.$input,value);if(this.options.renderMethod==='email'||this.options.renderMethod==='url'){this.changeFrontLink();}}},isoToDate:function(datetime){if(datetime.indexOf('T')>0){return datetime.substr(0,datetime.indexOf('T'));}
return datetime;},setDatepickerValueAttr:function(date){if(!!date){if(this.sandbox.dom.isNumeric(date.valueOf())){date=date.getFullYear()+'-'+
('0'+(date.getMonth()+1)).slice(-2)+'-'+
('0'+date.getDate()).slice(-2);}else{date='';this.sandbox.dom.val(this.input.$input,'');}}
this.sandbox.dom.data(this.$el,'value',date);},updateValue:function(){this.setValue(this.sandbox.dom.data(this.$el,'value'));}};});define('husky_components/data-navigation/list-view',[],function(){var templates={list:function(){return['<ul class="data-navigation-items">','   <% if (!!data.children && !!data.children.length) { %>',templates.children(),'   <% } else if (!!data.children && data.children.length === 0) { %>','       <li class="not-selectable">','           <div class="data-navigation-info data-navigation-info-empty">','               <div class="fa-coffee icon"></div>','               <span><%=options.translates.noData%></span>','           </div>','       </li>','   <% } else { %>','       <li class="not-selectable">','           <div class="data-navigation-loader-container">','               <div class="spinner">','                   <div class="double-bounce1" style="background-color: rgb(204, 204, 204);"></div>','                   <div class="double-bounce2" style="background-color: rgb(204, 204, 204);"></div>','               </div>','           </div>','       </li>','   <% } %>','</ul>'].join('');},children:function(){return['       <% _.each(data.children, function(child) { %>','           <li data-id="<%= child.id %>" class="data-navigation-item">','               <% if (!!child.preview && !child.locked) { %>','                   <div class="data-navigation-item-thumb" style="background-image: url(\'<%=child.preview.url%>\')"></div>','               <% } else { %>','                   <div class="<% if(!child.locked) { %>fa-coffee<% } else { %>fa-lock<% } %> data-navigation-item-thumb" style="margin-top: 10px;padding-left: 10px;"></div>','               <% } %>','               <div class="data-navigation-item-name">','                   <%= child[options.nameKey] %>','                   <% if (!!child.hasSub) { %>','                       <span class="fa-chevron-right data-navigation-item-next"></span>','                   <% } %>','               </div>','           </li>','       <% }) %>'].join('');}};return function ListView(){return{init:function(){this.template=_.template(templates.list());this.children=_.template(templates.children());this.$el=$('<div/>',{'class':'data-navigation-list'});return this;},destroy:function(){this.$el.off();this.$el.remove();this.$el=null;return this;},render:function(data,options){data=data||{};var tpl=this.template({data:data,options:options});this.$el.html(tpl);return this;},append:function(data,options){var tpl=this.children({data:{children:data},options:options});this.$el.find('ul').append(tpl);},placeAt:function(container){$(container).append(this.$el);return this;}};}});define('__component__$data-navigation@husky',['husky_components/data-navigation/list-view'],function(View){'use strict';var defaultOptions={url:null,rootUrl:null,resultKey:'items',parentResultKey:'parent',nameKey:'name',childrenLinkKey:'children',pageKey:'page',limitKey:'limit',searchKey:'search',limit:20,showAddButton:true,globalEvents:true,translates:{noData:'No Data',title:'Data',addButton:'Add Data',search:'Search ...'}},templates={header:function(){return['<div class="header-item data-navigation-back" style="display: none;">','    <div class="icon-container"><span class="fa-chevron-left"/></div>','</div>','<div class="header-item data-navigation-search" style="display: none;">','    <div class="icon-container"><span class="fa-search fa-flip-horizontal"/></div>','    <div class="content-container">','        <div class="search-container"/>','    </div>','</div>','<% if (!!options.showAddButton) { %>','   <div class="header-item ',constants.addButtonClass,'">','       <div class="icon-container"><span class="fa-plus-circle"/></div>','       <div class="content-container">','           <span class="add-container"><%= options.translates.addButton %></span>','       </div>','   </div>','<% } %>','<div class="header-item header-filler"/>'].join('');},main:function(){return['<div class="data-navigation">','   <div class="data-navigation-header"></div>','   <div class="data-navigation-list-container iscroll">','       <div class="data-navigation-list-scroll iscroll-inner"></div>','       <div class="loader"></div>','   </div>','</div>'].join('');}},constants={ROOT_ID:'root',addButtonClass:'data-navigation-add'},eventNamespace='husky.data-navigation.',createEventName=function(postFix){return eventNamespace+(this.options.instanceName?this.options.instanceName+'.':'')+postFix;},INITIALIZED=function(){return createEventName.call(this,'initialized');},SELECT=function(){return createEventName.call(this,'select');},SELECTED=function(){return createEventName.call(this,'selected')},SELECTED_GLOBAL=function(){return eventNamespace+'selected';},ADD=function(){return createEventName.call(this,'add')},HIDE_ADD_BUTTON=function(){return createEventName.call(this,'add-button.hide');},SHOW_ADD_BUTTON=function(){return createEventName.call(this,'add-button.show');},NAVIGATE=function(){return createEventName.call(this,'navigate')},SET_URL=function(){return createEventName.call(this,'set-url')},RELOAD=function(){return createEventName.call(this,'reload')},CLEAR_CACHE=function(){return createEventName.call(this,'clear-cache')};return{page:1,loading:false,initialize:function(){this.currentView=null;this.cache=this.sandbox.cacheFactory.create();this.options=this.sandbox.util.extend(true,{},defaultOptions,this.options);this.mainTpl=this.sandbox.util.template(templates.main());this.headerTpl=this.sandbox.util.template(templates.header());this.render();this.bindCustomEvents();this.bindDOMEvents();this.sandbox.once('husky.loader.initialized',function(){this.showLoader();this.load().then(function(data){this.hideLoader();this.sandbox.emit(INITIALIZED.call(this));this.currentView=this.createView(data);this.updateHeader(data);this.storeData(data);this.appendView();}.bind(this));}.bind(this));},remove:function(){this.cache.destroy();this.sandbox.infiniteScroll.destroy('.iscroll');},render:function(){var mainTpl=this.mainTpl({options:this.options});this.$el.html(mainTpl);var headerTpl=this.headerTpl({options:this.options});this.$el.find('.data-navigation-header').html(headerTpl);this.sandbox.start([{name:'loader@husky',options:{el:this.sandbox.dom.find('.loader',this.$el),color:'#ccc'}}]);this.startInfiniteScroll();this.startSearch();},startSearch:function(){this.sandbox.start([{name:'search@husky',options:{el:this.sandbox.dom.find('.search-container',this.$el),appearance:'white',instanceName:'data-navigation',placeholderText:this.options.translates.search}}]);},updateHeader:function(data){if(data.current.id!=='root'){$('.data-navigation-back').show();var parent=(!!data.parent)?data.parent.id:'root';this.sandbox.dom.data($('.data-navigation-back'),'parent-id',parent);}else{$('.data-navigation-back').hide();}
if(data.children.length!==0||!!this.searchTerm){$('.data-navigation-search').show();}else{$('.data-navigation-search').hide();}},startInfiniteScroll:function(){this.sandbox.infiniteScroll.initialize('.iscroll',this.loadNextPage.bind(this));},loadNextPage:function(){var def=this.sandbox.data.deferred();if(!!this.data.hasNextPage&&!this.loading){this.showLoader();this.page++;this.sandbox.util.load(this.getUrl(this.getCurrentUrl())).then(function(data){var children=data._embedded[this.options.resultKey]||[];this.data.children=this.data.children.concat(children);this.data.hasNextPage=this.page<data.pages;this.currentView.append(children,this.options);this.hideLoader();def.resolve();}.bind(this));}else{def.resolve();}
return def;},bindDOMEvents:function(){this.$el.on('click','.data-navigation-item',this.selectChildrenDataHandler.bind(this));this.$el.on('click','.data-navigation-item-thumb',this.selectChildrenDataHandler.bind(this));this.$el.on('click','.data-navigation-back',this.selectParentDataHandler.bind(this));this.$el.on('click','.data-navigation-add',this.addHandler.bind(this));this.$el.on('click','.data-navigation-search > .icon-container',function(){if(!$('.data-navigation-header').hasClass('header-search')){$('.data-navigation-header').addClass('header-search');$('.data-navigation-search .icon-container span').attr('class','fa-times');$('.data-navigation-search input').select();}else{this.clearSearch();}}.bind(this));},bindCustomEvents:function(){this.sandbox.on(SET_URL.call(this),function(url){if(url!==this.getCurrentUrl){this.setUrl(url,true);}else{this.cache.deleteAll();}}.bind(this));this.sandbox.on(SELECT.call(this),function(id){this.showChildren(id);}.bind(this));this.sandbox.on(SHOW_ADD_BUTTON.call(this),this.showAddButton.bind(this));this.sandbox.on(HIDE_ADD_BUTTON.call(this),this.hideAddButton.bind(this));this.sandbox.on(RELOAD.call(this),function(callback){this.setUrl(this.getCurrentUrl(),true,callback);}.bind(this));this.sandbox.on(CLEAR_CACHE.call(this),function(){this.cache.deleteAll();}.bind(this));this.sandbox.on('husky.search.data-navigation',function(searchTerm){this.searchTerm=searchTerm;this.setUrl(this.getCurrentUrl(),true);}.bind(this));this.sandbox.on('husky.search.data-navigation.reset',function(){this.searchTerm=null;this.setUrl(this.getCurrentUrl(),true);}.bind(this));},getCurrentUrl:function(){var url=this.options.rootUrl;if(!!this.data.current.item){url=this.data.current.item._links[this.options.childrenLinkKey].href;}
return url;},setUrl:function(url,clearCache,callback){if(!!clearCache){this.cache.deleteAll();}
this.load(url).then(this.storeData.bind(this)).then(function(data){this.updateHeader(data);this.currentView.render(data,this.options);if(typeof callback==='function'){callback.call(this);}}.bind(this));},load:function(url){this.page=1;this.loading=true;return this.sandbox.util.load(this.getUrl(url)).then(this.parse.bind(this)).then(function(data){this.loading=false;return data;}.bind(this));},hideLoader:function(){this.sandbox.dom.hide(this.sandbox.dom.find('.loader',this.$el));},showLoader:function(){this.sandbox.dom.show(this.sandbox.dom.find('.loader',this.$el));},clearSearch:function(){$('.data-navigation-header').removeClass('header-search');$('.data-navigation-search .icon-container span').attr('class','fa-search fa-flip-horizontal');this.sandbox.emit('husky.search.data-navigation.clear');if(!!this.searchTerm){this.sandbox.emit('husky.search.data-navigation.reset');this.searchTerm=null;}},getUrl:function(url){url=url||this.options.url||this.options.rootUrl;var delimiter=(url.indexOf('?')===-1)?'?':'&';url=[url,delimiter,this.options.pageKey,'=',this.page,'&',this.options.limitKey,'=',this.options.limit].join('');if(!!this.searchTerm){url=[url,'&',this.options.searchKey,'=',this.searchTerm].join('');}
return url;},parse:function(response){var current={item:response},parent=response._embedded.parent;current.id=response.id||constants.ROOT_ID;current.name=response[this.options.nameKey];if(!!parent){parent.id=parent.id||constants.ROOT_ID;}else if(current.id===constants.ROOT_ID){current.item=null;}
this.data={children:response._embedded[this.options.resultKey]||null,parent:parent,current:current,hasNextPage:true};return this.data;},storeData:function(data){var current=data.current;if(!this.searchTerm){this.cache.put(current.id,data);}
return data;},getItems:function(id){var dfd=$.Deferred(),data=this.cache.get(id),item,url;if(!data){if(id===constants.ROOT_ID||id==null){if(!!this.data.parent){url=this.data.parent._links[this.options.childrenLinkKey].href;}else{url=this.options.rootUrl;}}else{item=_.where(this.data.children,{id:id})[0];if(!item&&!!this.data.parent&&this.data.parent.id===id){item=this.data.parent;}
url=item._links[this.options.childrenLinkKey].href;}
return this.load(url).then(this.storeData.bind(this));}else{this.data=data;dfd.resolve(data);}
return dfd.promise();},getItem:function(id){return _.where(this.data.children,{id:id})[0];},showChildren:function(id){var oldView=this.currentView;this.clearSearch();this.currentView=this.createView();this.appendView(oldView);return this.getItems(id).then(function(data){this.updateHeader(data);this.currentView.render(data,this.options);}.bind(this));},openChildrenHandler:function(event){return this.showChildren($(event.currentTarget).closest('li').data('id'));},openParentHandler:function(event){var $item=$(event.currentTarget).closest('.data-navigation-back'),id=this.sandbox.dom.data($item,'parent-id'),newView=this.createView();this.clearSearch();this.prependView(newView);return this.getItems(id).then(function(data){this.updateHeader(data);newView.render(data,this.options);}.bind(this));},selectParentDataHandler:function(event){event.stopPropagation();this.sandbox.emit(SELECTED.call(this),this.data.parent);if(this.options.globalEvents){this.sandbox.emit(SELECTED_GLOBAL.call(this),this.data.parent);}
this.openParentHandler(event);},navigateParentDataHandler:function(event){event.stopPropagation();this.openParentHandler(event);},selectChildrenDataHandler:function(event){event.stopPropagation();var $item=$(event.currentTarget).closest('li'),id=$item.data('id'),item=this.getItem(id);this.sandbox.emit(SELECTED.call(this),item);if(this.options.globalEvents){this.sandbox.emit(SELECTED_GLOBAL.call(this),item);}
this.openChildrenHandler(event);},navigateChildrenHandler:function(event){event.stopPropagation();var $item=$(event.currentTarget).closest('li'),id=$item.data('id'),item=this.getItem(id);this.sandbox.emit(NAVIGATE.call(this),item);this.openChildrenHandler(event);},addHandler:function(){this.sandbox.emit(ADD.call(this),this.data.current.item);},showAddButton:function(){$('.'+constants.addButtonClass).show();},hideAddButton:function(){$('.'+constants.addButtonClass).hide();},createView:function(data){var view=(new View(this.options)).init();return view.render(data,this.options);},appendView:function(view){if(!!view){this.currentView.$el.addClass('is-animated');this.playAppendAnimation(view);}
this.currentView.placeAt('.data-navigation-list-container .iscroll-inner');},playAppendAnimation:function(oldView){this.currentView.$el.css({left:'100%'}).animate({left:'0%'},{duration:250,done:function(){oldView.destroy();this.currentView.$el.removeClass('is-animated');}.bind(this)});},prependView:function(view){view.placeAt('.data-navigation-list-container .iscroll-inner');this.currentView.$el.addClass('is-animated');this.playPrependAnimation(view);},playPrependAnimation:function(view){var oldView=this.currentView;this.currentView=view;oldView.$el.stop().css({left:'0%'}).animate({left:'100%'},{duration:250,done:function(){oldView.destroy();}.bind(this)});}};});define('__component__$url-input@husky',['services/husky/url-validator'],function(urlValidator){var defaults={instanceName:'url-input',inputClass:'',scheme:'http://',specificPart:''},constants={triggerClass:'drop-down-trigger',toggleClass:'dropdown-toggle',schemeClass:'scheme',specificPartClass:'specific-part-input',linkClass:'link',dataKey:'url-data',dataChangedEvent:'data-changed'},templates={skeleton:['<div class="front">','    <a class="<%= constants.schemeClass %> <%= constants.linkClass %> text text-link"','       href="<%= url %>" target="_blank"><%= data.scheme %></a>','<% if (items.length > 1) { %>','    <span class="<%= constants.triggerClass %>">','        <span class="<%= constants.toggleClass %>" style="display: inline-block;"/>','    </span>','<% } %>','</div>','<div class="input">','    <input type="text"','           class="<%= constants.specificPartClass %> <%= options.inputClass %>" ','           value="<%= data.specificPart %>"/>','</div>'].join('')};return{initialize:function(){if(!this.options.schemes||this.options.schemes.length===0){this.options.schemes=urlValidator.getDefaultSchemes();}
this.options=this.sandbox.util.extend(true,{},defaults,this.options);if(this.getData()===undefined){this.setData({scheme:this.options.scheme,specificPart:this.options.specificPart});}
this.prepareItems(this.options.schemes);this.render();this.bindDomEvents();},prepareItems:function(schemes){this.items=this.sandbox.util.arrayMap(schemes,function(scheme){return{id:scheme,name:scheme}}.bind(this));},render:function(){this.$el.addClass('husky-input');var data=this.getData();this.html(this.sandbox.util.template(templates.skeleton,{constants:constants,options:this.options,url:this.getUrl(data),data:data,items:this.items}));this.sandbox.start([{name:'dropdown@husky',options:{el:this.$find('.front'),trigger:this.$find('.'+constants.triggerClass),instanceName:constants.instanceName,data:this.items,clickCallback:this.selectSchemeHandler.bind(this)}}]);},bindDomEvents:function(){this.sandbox.dom.on(this.$find('.'+constants.linkClass),'click',this.linkHandler.bind(this));this.sandbox.dom.on(this.$find('.'+constants.specificPartClass),'focusout',this.specificPartChangedHandler.bind(this));this.sandbox.dom.on(this.$el,constants.dataChangedEvent,this.dataChangedHandler.bind(this));},linkHandler:function(){var data=this.getData(),url=this.getUrl(data);if(!url){return false;}},specificPartChangedHandler:function(e){this.sandbox.dom.stopPropagation(e);var $element=this.$find('.'+constants.specificPartClass),specificPart=$element.val(),match=urlValidator.match(specificPart,this.options.schemes),data={specificPart:specificPart};if(!!match){data.scheme=match.scheme;data.specificPart=match.specificPart;}
this.setData(data);this.dataChangedHandler();},dataChangedHandler:function(){var data=this.getData();this.$find('.'+constants.specificPartClass).val(data.specificPart);this.$find('.'+constants.schemeClass).html(data.scheme);this.$find('.'+constants.schemeClass).attr('href',this.getUrl(data));},selectSchemeHandler:function(item){this.setData({scheme:item.id});this.dataChangedHandler();},setData:function(data){var newData=this.sandbox.util.extend(true,{},this.$el.data(constants.dataKey),data);this.$el.data(constants.dataKey,newData);this.$el.trigger('change');return newData;},getUrl:function(data){if(!!data&&!!data.scheme&&!!data.specificPart){return data.scheme+data.specificPart;}
return null;},getData:function(){return this.$el.data(constants.dataKey);}};});(function(){'use strict';if(window.Backbone){define('backbone',[],function(){return window.Backbone;});}else{require.config({paths:{backbone:'bower_components/backbone/backbone'},shim:{backbone:{exports:'Backbone',deps:['underscore','jquery']}}});}
define('husky_extensions/backbone',['backbone'],{name:'Backbone',initialize:function(app){var core=app.core,sandbox=app.sandbox,_=app.sandbox.util._,views={};core.mvc=require('backbone');sandbox.mvc={};sandbox.mvc.routes=[];sandbox.mvc.Router=function(options){return core.mvc.Router.extend(options);};sandbox.mvc.View=function(options){return core.mvc.View.extend(options);};sandbox.mvc.Model=function(options){return core.mvc.Model.extend(options);};sandbox.mvc.Collection=function(options){return core.mvc.Collection.extend(options);};sandbox.mvc.history=core.mvc.history;define('mvc/view',function(){return sandbox.mvc.View;});define('mvc/model',function(){return sandbox.mvc.Model;});define('mvc/collection',function(){return sandbox.mvc.Collection;});app.components.before('initialize',function(options){if(!this){throw new Error('Missing context!');}
if(!!this.view){var View=views[options.ref],ext;if(!View){ext=_.pick(this,'model','collection','id','attributes','className','tagName','events');views[options.ref]=View=sandbox.mvc.View(ext);}
this.view=new View({el:this.$el});this.view.sandbox=this.sandbox;this.view.parent=this;}});app.components.before('remove',function(){if(!this){throw new Error('Missing context!');}
this.view&&this.view.stopListening();});},afterAppStart:function(app){app.sandbox.util._.delay(function(){if(!app.core.mvc.History.started){app.core.mvc.history.start();}},250);}});})();(function(){'use strict';define('husky_extensions/cache-factory',[],{name:'cacheFactory',initialize:function(app){var caches={};function Cache(cacheId){var store={};return{get:function(key){return store[key]||null;},put:function(key,value){store[key]=value;return value;},delete:function(key){delete store[key];},deleteAll:function(){store={};},destroy:function(){delete caches[cacheId];}};};app.sandbox.cacheFactory={create:function(cacheId){cacheId=cacheId||app.core.util.uniqueId('cache');if(cacheId in caches){throw new Error('cacheId already exists.');}
return caches[cacheId]=new Cache(cacheId);},get:function(cacheId){return caches[cacheId];}};}});})();(function(){'use strict';require.config({paths:{ckeditor:'bower_components/ckeditor/ckeditor',jqueryAdapter:'bower_components/ckeditor/adapters/jquery'},shim:{jqueryAdapter:{deps:['jquery','ckeditor']}}});define('husky_extensions/ckeditor-extension',['underscore','services/husky/util','ckeditor','jqueryAdapter'],function(_,Util){var getConfig=function(){return{format_tags:'p;h1;h2;h3;h4;h5;h6',width:'100%',defaultLanguage:'en',removeButtons:'',removePlugins:'elementspath,magicline',removeDialogTabs:'image:advanced;link:advanced',allowedContent:true,resize_enabled:false,enterMode:'P',uiColor:'#ffffff',skin:'husky'};};function ToolbarBuilder(toolbar){this.toolbar=toolbar;}
ToolbarBuilder.prototype.add=function(name,items){if(!this.toolbar[name]){this.toolbar[name]=[];}
this.toolbar[name]=this.toolbar[name].concat(items);};ToolbarBuilder.prototype.remove=function(name,items){if(!this.toolbar[name]){this.toolbar[name]=[];}
this.toolbar[name]=_.difference(this.toolbar[name],items);};ToolbarBuilder.prototype.get=function(){return _.map(this.toolbar,function(items,name){return{name:name,items:items};});};ToolbarBuilder.getRaw=function(){return this.toolbar;};return{name:'ckeditor',initialize:function(app){var toolbar={semantics:['Format'],basicstyles:['Superscript','Subscript','Italic','Bold','Underline','Strike'],blockstyles:['JustifyLeft','JustifyCenter','JustifyRight','JustifyBlock'],list:['NumberedList','BulletedList'],paste:['PasteFromWord'],links:['Link','Unlink'],insert:['Table'],styles:['Styles'],code:['Source']},plugins=['justify','format','sourcearea','link','table','pastefromword','autogrow'],icons={Format:'font',Strike:'strikethrough',JustifyLeft:'align-left',JustifyCenter:'align-center',JustifyRight:'align-right',JustifyBlock:'align-justify',NumberedList:'list-ol',BulletedList:'list',PasteFromWord:'file-word-o',Styles:'header',Source:'code'};app.sandbox.ckeditor={addPlugin:function(name,plugin){plugins.push(name);CKEDITOR.plugins.add(name,plugin);},addToolbarButton:function(toolbarName,button,icon){if(!toolbar[toolbarName]){toolbar[toolbarName]=[];}
toolbar[toolbarName].push(button);if(!!icon){icons[button]=icon;}},getToolbar:function(){return Util.deepCopy(toolbar);},getIcon:function(button){if(icons.hasOwnProperty(button)){return icons[button];}
return button.toLowerCase();},getToolbarBuilder:function(){return new ToolbarBuilder(this.getToolbar());},createToolbarBuilder:function(toolbar){var toolbarSections={};for(var i=0,length=toolbar.length;i<length;++i){toolbarSections[toolbar[i].name]=toolbar[i].items;}
return new ToolbarBuilder(toolbarSections);},init:function(selector,callback,config){var configuration=app.sandbox.util.extend(true,{},getConfig.call(),config),$editor;configuration.extraPlugins=plugins.join(',');if(!!callback&&typeof callback==='function'){$editor=$(selector).ckeditor(callback,configuration);}else{$editor=$(selector).ckeditor(configuration);}
CKEDITOR.on('dialogDefinition',function(ev){var dialogName=ev.data.name,dialogDefinition=ev.data.definition;if(dialogName=='link'){var infoTab=dialogDefinition.getContents('info'),targetTab=dialogDefinition.getContents('target'),linkOptions=infoTab.get('linkType'),targetOptions=targetTab.get('linkTargetType'),includedLinkOptions=['url','email'],selectedLinkOption=[],includedTargetOptions=['notSet','_blank','_self'],selectedTargetOptions=[];for(var i=0;i<linkOptions.items.length;i++){if(includedLinkOptions.indexOf(linkOptions.items[i][1])!==-1){selectedLinkOption.push(linkOptions.items[i]);}}
for(var i=0;i<targetOptions.items.length;i++){if(includedTargetOptions.indexOf(targetOptions.items[i][1])!==-1){selectedTargetOptions.push(targetOptions.items[i]);}}
linkOptions.items=selectedLinkOption;targetOptions.items=selectedTargetOptions;}});return $editor.editor;},getInstance:function(id){var instance=CKEDITOR.instances[id];if(!!instance){return instance;}}};}};});})();define('husky_extensions/collection',[],function(){'use strict';var Collection={byId:{},objs:[],add:function(obj){this.byId[obj.id]=obj;this.objs.push(obj);},get:function(obj){return this.byId[obj.id||obj];}};return{name:'Collection',initialize:function(app){app.sandbox.data.Collection=Collection;}};});(function(factory){if(typeof define==='function'&&define.amd){define('jquery-minicolors',['jquery'],factory);}else if(typeof exports==='object'){module.exports=factory(require('jquery'));}else{factory(jQuery);}}(function($){$.minicolors={defaults:{animationSpeed:50,animationEasing:'swing',change:null,changeDelay:0,control:'hue',dataUris:true,defaultValue:'',hide:null,hideSpeed:100,inline:false,letterCase:'lowercase',opacity:false,position:'bottom left',show:null,showSpeed:100,theme:'default'}};$.extend($.fn,{minicolors:function(method,data){switch(method){case'destroy':$(this).each(function(){destroy($(this));});return $(this);case'hide':hide();return $(this);case'opacity':if(data===undefined){return $(this).attr('data-opacity');}else{$(this).each(function(){updateFromInput($(this).attr('data-opacity',data));});}
return $(this);case'rgbObject':return rgbObject($(this),method==='rgbaObject');case'rgbString':case'rgbaString':return rgbString($(this),method==='rgbaString');case'settings':if(data===undefined){return $(this).data('minicolors-settings');}else{$(this).each(function(){var settings=$(this).data('minicolors-settings')||{};destroy($(this));$(this).minicolors($.extend(true,settings,data));});}
return $(this);case'show':show($(this).eq(0));return $(this);case'value':if(data===undefined){return $(this).val();}else{$(this).each(function(){updateFromInput($(this).val(data));});}
return $(this);default:if(method!=='create')data=method;$(this).each(function(){init($(this),data);});return $(this);}}});function init(input,settings){var minicolors=$('<div class="minicolors" />'),defaults=$.minicolors.defaults;if(input.data('minicolors-initialized'))return;settings=$.extend(true,{},defaults,settings);minicolors.addClass('minicolors-theme-'+settings.theme).toggleClass('minicolors-with-opacity',settings.opacity).toggleClass('minicolors-no-data-uris',settings.dataUris!==true);if(settings.position!==undefined){$.each(settings.position.split(' '),function(){minicolors.addClass('minicolors-position-'+this);});}
input.addClass('minicolors-input').data('minicolors-initialized',false).data('minicolors-settings',settings).prop('size',7).wrap(minicolors).after('<div class="minicolors-panel minicolors-slider-'+settings.control+'">'+'<div class="minicolors-slider minicolors-sprite">'+'<div class="minicolors-picker"></div>'+'</div>'+'<div class="minicolors-opacity-slider minicolors-sprite">'+'<div class="minicolors-picker"></div>'+'</div>'+'<div class="minicolors-grid minicolors-sprite">'+'<div class="minicolors-grid-inner"></div>'+'<div class="minicolors-picker"><div></div></div>'+'</div>'+'</div>');if(!settings.inline){input.after('<span class="minicolors-swatch minicolors-sprite"><span class="minicolors-swatch-color"></span></span>');input.next('.minicolors-swatch').on('click',function(event){event.preventDefault();input.focus();});}
input.parent().find('.minicolors-panel').on('selectstart',function(){return false;}).end();if(settings.inline)input.parent().addClass('minicolors-inline');updateFromInput(input,false);input.data('minicolors-initialized',true);}
function destroy(input){var minicolors=input.parent();input.removeData('minicolors-initialized').removeData('minicolors-settings').removeProp('size').removeClass('minicolors-input');minicolors.before(input).remove();}
function show(input){var minicolors=input.parent(),panel=minicolors.find('.minicolors-panel'),settings=input.data('minicolors-settings');if(!input.data('minicolors-initialized')||input.prop('disabled')||minicolors.hasClass('minicolors-inline')||minicolors.hasClass('minicolors-focus'))return;hide();minicolors.addClass('minicolors-focus');panel.stop(true,true).fadeIn(settings.showSpeed,function(){if(settings.show)settings.show.call(input.get(0));});}
function hide(){$('.minicolors-focus').each(function(){var minicolors=$(this),input=minicolors.find('.minicolors-input'),panel=minicolors.find('.minicolors-panel'),settings=input.data('minicolors-settings');panel.fadeOut(settings.hideSpeed,function(){if(settings.hide)settings.hide.call(input.get(0));minicolors.removeClass('minicolors-focus');});});}
function move(target,event,animate){var input=target.parents('.minicolors').find('.minicolors-input'),settings=input.data('minicolors-settings'),picker=target.find('[class$=-picker]'),offsetX=target.offset().left,offsetY=target.offset().top,x=Math.round(event.pageX-offsetX),y=Math.round(event.pageY-offsetY),duration=animate?settings.animationSpeed:0,wx,wy,r,phi;if(event.originalEvent.changedTouches){x=event.originalEvent.changedTouches[0].pageX-offsetX;y=event.originalEvent.changedTouches[0].pageY-offsetY;}
if(x<0)x=0;if(y<0)y=0;if(x>target.width())x=target.width();if(y>target.height())y=target.height();if(target.parent().is('.minicolors-slider-wheel')&&picker.parent().is('.minicolors-grid')){wx=75-x;wy=75-y;r=Math.sqrt(wx*wx+wy*wy);phi=Math.atan2(wy,wx);if(phi<0)phi+=Math.PI*2;if(r>75){r=75;x=75-(75*Math.cos(phi));y=75-(75*Math.sin(phi));}
x=Math.round(x);y=Math.round(y);}
if(target.is('.minicolors-grid')){picker.stop(true).animate({top:y+'px',left:x+'px'},duration,settings.animationEasing,function(){updateFromControl(input,target);});}else{picker.stop(true).animate({top:y+'px'},duration,settings.animationEasing,function(){updateFromControl(input,target);});}}
function updateFromControl(input,target){function getCoords(picker,container){var left,top;if(!picker.length||!container)return null;left=picker.offset().left;top=picker.offset().top;return{x:left-container.offset().left+(picker.outerWidth()/ 2),y:top-container.offset().top+(picker.outerHeight()/ 2)};}
var hue,saturation,brightness,x,y,r,phi,hex=input.val(),opacity=input.attr('data-opacity'),minicolors=input.parent(),settings=input.data('minicolors-settings'),swatch=minicolors.find('.minicolors-swatch'),grid=minicolors.find('.minicolors-grid'),slider=minicolors.find('.minicolors-slider'),opacitySlider=minicolors.find('.minicolors-opacity-slider'),gridPicker=grid.find('[class$=-picker]'),sliderPicker=slider.find('[class$=-picker]'),opacityPicker=opacitySlider.find('[class$=-picker]'),gridPos=getCoords(gridPicker,grid),sliderPos=getCoords(sliderPicker,slider),opacityPos=getCoords(opacityPicker,opacitySlider);if(target.is('.minicolors-grid, .minicolors-slider')){switch(settings.control){case'wheel':x=(grid.width()/ 2)-gridPos.x;y=(grid.height()/ 2)-gridPos.y;r=Math.sqrt(x*x+y*y);phi=Math.atan2(y,x);if(phi<0)phi+=Math.PI*2;if(r>75){r=75;gridPos.x=69-(75*Math.cos(phi));gridPos.y=69-(75*Math.sin(phi));}
saturation=keepWithin(r / 0.75,0,100);hue=keepWithin(phi*180 / Math.PI,0,360);brightness=keepWithin(100-Math.floor(sliderPos.y*(100 / slider.height())),0,100);hex=hsb2hex({h:hue,s:saturation,b:brightness});slider.css('backgroundColor',hsb2hex({h:hue,s:saturation,b:100}));break;case'saturation':hue=keepWithin(parseInt(gridPos.x*(360 / grid.width()),10),0,360);saturation=keepWithin(100-Math.floor(sliderPos.y*(100 / slider.height())),0,100);brightness=keepWithin(100-Math.floor(gridPos.y*(100 / grid.height())),0,100);hex=hsb2hex({h:hue,s:saturation,b:brightness});slider.css('backgroundColor',hsb2hex({h:hue,s:100,b:brightness}));minicolors.find('.minicolors-grid-inner').css('opacity',saturation / 100);break;case'brightness':hue=keepWithin(parseInt(gridPos.x*(360 / grid.width()),10),0,360);saturation=keepWithin(100-Math.floor(gridPos.y*(100 / grid.height())),0,100);brightness=keepWithin(100-Math.floor(sliderPos.y*(100 / slider.height())),0,100);hex=hsb2hex({h:hue,s:saturation,b:brightness});slider.css('backgroundColor',hsb2hex({h:hue,s:saturation,b:100}));minicolors.find('.minicolors-grid-inner').css('opacity',1-(brightness / 100));break;default:hue=keepWithin(360-parseInt(sliderPos.y*(360 / slider.height()),10),0,360);saturation=keepWithin(Math.floor(gridPos.x*(100 / grid.width())),0,100);brightness=keepWithin(100-Math.floor(gridPos.y*(100 / grid.height())),0,100);hex=hsb2hex({h:hue,s:saturation,b:brightness});grid.css('backgroundColor',hsb2hex({h:hue,s:100,b:100}));break;}
input.val(convertCase(hex,settings.letterCase));}
if(target.is('.minicolors-opacity-slider')){if(settings.opacity){opacity=parseFloat(1-(opacityPos.y / opacitySlider.height())).toFixed(2);}else{opacity=1;}
if(settings.opacity)input.attr('data-opacity',opacity);}
swatch.find('SPAN').css({backgroundColor:hex,opacity:opacity});doChange(input,hex,opacity);}
function updateFromInput(input,preserveInputValue){var hex,hsb,opacity,x,y,r,phi,minicolors=input.parent(),settings=input.data('minicolors-settings'),swatch=minicolors.find('.minicolors-swatch'),grid=minicolors.find('.minicolors-grid'),slider=minicolors.find('.minicolors-slider'),opacitySlider=minicolors.find('.minicolors-opacity-slider'),gridPicker=grid.find('[class$=-picker]'),sliderPicker=slider.find('[class$=-picker]'),opacityPicker=opacitySlider.find('[class$=-picker]');hex=convertCase(parseHex(input.val(),true),settings.letterCase);if(!hex){hex=convertCase(parseHex(settings.defaultValue,true),settings.letterCase);}
hsb=hex2hsb(hex);if(!preserveInputValue)input.val(hex);if(settings.opacity){opacity=input.attr('data-opacity')===''?1:keepWithin(parseFloat(input.attr('data-opacity')).toFixed(2),0,1);if(isNaN(opacity))opacity=1;input.attr('data-opacity',opacity);swatch.find('SPAN').css('opacity',opacity);y=keepWithin(opacitySlider.height()-(opacitySlider.height()*opacity),0,opacitySlider.height());opacityPicker.css('top',y+'px');}
swatch.find('SPAN').css('backgroundColor',hex);switch(settings.control){case'wheel':r=keepWithin(Math.ceil(hsb.s*0.75),0,grid.height()/ 2);phi=hsb.h*Math.PI / 180;x=keepWithin(75-Math.cos(phi)*r,0,grid.width());y=keepWithin(75-Math.sin(phi)*r,0,grid.height());gridPicker.css({top:y+'px',left:x+'px'});y=150-(hsb.b /(100 / grid.height()));if(hex==='')y=0;sliderPicker.css('top',y+'px');slider.css('backgroundColor',hsb2hex({h:hsb.h,s:hsb.s,b:100}));break;case'saturation':x=keepWithin((5*hsb.h)/ 12,0,150);y=keepWithin(grid.height()-Math.ceil(hsb.b /(100 / grid.height())),0,grid.height());gridPicker.css({top:y+'px',left:x+'px'});y=keepWithin(slider.height()-(hsb.s*(slider.height()/ 100)),0,slider.height());sliderPicker.css('top',y+'px');slider.css('backgroundColor',hsb2hex({h:hsb.h,s:100,b:hsb.b}));minicolors.find('.minicolors-grid-inner').css('opacity',hsb.s / 100);break;case'brightness':x=keepWithin((5*hsb.h)/ 12,0,150);y=keepWithin(grid.height()-Math.ceil(hsb.s /(100 / grid.height())),0,grid.height());gridPicker.css({top:y+'px',left:x+'px'});y=keepWithin(slider.height()-(hsb.b*(slider.height()/ 100)),0,slider.height());sliderPicker.css('top',y+'px');slider.css('backgroundColor',hsb2hex({h:hsb.h,s:hsb.s,b:100}));minicolors.find('.minicolors-grid-inner').css('opacity',1-(hsb.b / 100));break;default:x=keepWithin(Math.ceil(hsb.s /(100 / grid.width())),0,grid.width());y=keepWithin(grid.height()-Math.ceil(hsb.b /(100 / grid.height())),0,grid.height());gridPicker.css({top:y+'px',left:x+'px'});y=keepWithin(slider.height()-(hsb.h /(360 / slider.height())),0,slider.height());sliderPicker.css('top',y+'px');grid.css('backgroundColor',hsb2hex({h:hsb.h,s:100,b:100}));break;}
if(input.data('minicolors-initialized')){doChange(input,hex,opacity);}}
function doChange(input,hex,opacity){var settings=input.data('minicolors-settings'),lastChange=input.data('minicolors-lastChange');if(!lastChange||lastChange.hex!==hex||lastChange.opacity!==opacity){input.data('minicolors-lastChange',{hex:hex,opacity:opacity});if(settings.change){if(settings.changeDelay){clearTimeout(input.data('minicolors-changeTimeout'));input.data('minicolors-changeTimeout',setTimeout(function(){settings.change.call(input.get(0),hex,opacity);},settings.changeDelay));}else{settings.change.call(input.get(0),hex,opacity);}}
input.trigger('change').trigger('input');}}
function rgbObject(input){var hex=parseHex($(input).val(),true),rgb=hex2rgb(hex),opacity=$(input).attr('data-opacity');if(!rgb)return null;if(opacity!==undefined)$.extend(rgb,{a:parseFloat(opacity)});return rgb;}
function rgbString(input,alpha){var hex=parseHex($(input).val(),true),rgb=hex2rgb(hex),opacity=$(input).attr('data-opacity');if(!rgb)return null;if(opacity===undefined)opacity=1;if(alpha){return'rgba('+rgb.r+', '+rgb.g+', '+rgb.b+', '+parseFloat(opacity)+')';}else{return'rgb('+rgb.r+', '+rgb.g+', '+rgb.b+')';}}
function convertCase(string,letterCase){return letterCase==='uppercase'?string.toUpperCase():string.toLowerCase();}
function parseHex(string,expand){string=string.replace(/[^A-F0-9]/ig,'');if(string.length!==3&&string.length!==6)return'';if(string.length===3&&expand){string=string[0]+string[0]+string[1]+string[1]+string[2]+string[2];}
return'#'+string;}
function keepWithin(value,min,max){if(value<min)value=min;if(value>max)value=max;return value;}
function hsb2rgb(hsb){var rgb={};var h=Math.round(hsb.h);var s=Math.round(hsb.s*255 / 100);var v=Math.round(hsb.b*255 / 100);if(s===0){rgb.r=rgb.g=rgb.b=v;}else{var t1=v;var t2=(255-s)*v / 255;var t3=(t1-t2)*(h%60)/ 60;if(h===360)h=0;if(h<60){rgb.r=t1;rgb.b=t2;rgb.g=t2+t3;}
else if(h<120){rgb.g=t1;rgb.b=t2;rgb.r=t1-t3;}
else if(h<180){rgb.g=t1;rgb.r=t2;rgb.b=t2+t3;}
else if(h<240){rgb.b=t1;rgb.r=t2;rgb.g=t1-t3;}
else if(h<300){rgb.b=t1;rgb.g=t2;rgb.r=t2+t3;}
else if(h<360){rgb.r=t1;rgb.g=t2;rgb.b=t1-t3;}
else{rgb.r=0;rgb.g=0;rgb.b=0;}}
return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)};}
function rgb2hex(rgb){var hex=[rgb.r.toString(16),rgb.g.toString(16),rgb.b.toString(16)];$.each(hex,function(nr,val){if(val.length===1)hex[nr]='0'+val;});return'#'+hex.join('');}
function hsb2hex(hsb){return rgb2hex(hsb2rgb(hsb));}
function hex2hsb(hex){var hsb=rgb2hsb(hex2rgb(hex));if(hsb.s===0)hsb.h=360;return hsb;}
function rgb2hsb(rgb){var hsb={h:0,s:0,b:0};var min=Math.min(rgb.r,rgb.g,rgb.b);var max=Math.max(rgb.r,rgb.g,rgb.b);var delta=max-min;hsb.b=max;hsb.s=max!==0?255*delta / max:0;if(hsb.s!==0){if(rgb.r===max){hsb.h=(rgb.g-rgb.b)/ delta;}else if(rgb.g===max){hsb.h=2+(rgb.b-rgb.r)/ delta;}else{hsb.h=4+(rgb.r-rgb.g)/ delta;}}else{hsb.h=-1;}
hsb.h*=60;if(hsb.h<0){hsb.h+=360;}
hsb.s*=100/255;hsb.b*=100/255;return hsb;}
function hex2rgb(hex){hex=parseInt(((hex.indexOf('#')>-1)?hex.substring(1):hex),16);return{r:hex>>16,g:(hex&0x00FF00)>>8,b:(hex&0x0000FF)};}
$(document).on('mousedown.minicolors touchstart.minicolors',function(event){if(!$(event.target).parents().add(event.target).hasClass('minicolors')){hide();}}).on('mousedown.minicolors touchstart.minicolors','.minicolors-grid, .minicolors-slider, .minicolors-opacity-slider',function(event){var target=$(this);event.preventDefault();$(document).data('minicolors-target',target);move(target,event,true);}).on('mousemove.minicolors touchmove.minicolors',function(event){var target=$(document).data('minicolors-target');if(target)move(target,event);}).on('mouseup.minicolors touchend.minicolors',function(){$(this).removeData('minicolors-target');}).on('mousedown.minicolors touchstart.minicolors','.minicolors-swatch',function(event){var input=$(this).parent().find('.minicolors-input');event.preventDefault();show(input);}).on('focus.minicolors','.minicolors-input',function(){var input=$(this);if(!input.data('minicolors-initialized'))return;show(input);}).on('blur.minicolors','.minicolors-input',function(){var input=$(this),settings=input.data('minicolors-settings');if(!input.data('minicolors-initialized'))return;input.val(parseHex(input.val(),true));if(input.val()==='')input.val(parseHex(settings.defaultValue,true));input.val(convertCase(input.val(),settings.letterCase));}).on('keydown.minicolors','.minicolors-input',function(event){var input=$(this);if(!input.data('minicolors-initialized'))return;switch(event.keyCode){case 9:hide();break;case 13:case 27:hide();input.blur();break;}}).on('keyup.minicolors','.minicolors-input',function(){var input=$(this);if(!input.data('minicolors-initialized'))return;updateFromInput(input,true);}).on('paste.minicolors','.minicolors-input',function(){var input=$(this);if(!input.data('minicolors-initialized'))return;setTimeout(function(){updateFromInput(input,true);},1);});}));(function(){'use strict';require.config({paths:{"jquery-minicolors":'bower_components/jquery-minicolors/jquery.minicolors'},shim:{backbone:{deps:['jquery']}}});define('husky_extensions/colorpicker',['jquery-minicolors'],{name:'minicolor',initialize:function(app){app.sandbox.colorpicker={init:function(selector,configs){return app.core.dom.$(selector).minicolors(configs);},value:function(selector,value){return app.core.dom.$(selector).minicolors('value',value);}};}});})();(function(){'use strict';define('husky_extensions/confirm',{name:'Confirm',initialize:function(app){app.sandbox.confirm={alert:function(that,title,message,okCallback,closeCallback,type){var $element=app.core.dom.createElement('<div/>'),type=type||'alert';app.core.dom.append(that.$el,$element);that.sandbox.start([{name:'overlay@husky',options:{el:$element,title:app.sandbox.translate(title),message:app.sandbox.translate(message),closeCallback:closeCallback,okCallback:okCallback,type:type}}]);}};}});})();(function($,undefined){var $window=$(window);function UTCDate(){return new Date(Date.UTC.apply(Date,arguments));}
function UTCToday(){var today=new Date();return UTCDate(today.getFullYear(),today.getMonth(),today.getDate());}
function alias(method){return function(){return this[method].apply(this,arguments);};}
var DateArray=(function(){var extras={get:function(i){return this.slice(i)[0];},contains:function(d){var val=d&&d.valueOf();for(var i=0,l=this.length;i<l;i++)
if(this[i].valueOf()===val)
return i;return-1;},remove:function(i){this.splice(i,1);},replace:function(new_array){if(!new_array)
return;if(!$.isArray(new_array))
new_array=[new_array];this.clear();this.push.apply(this,new_array);},clear:function(){this.length=0;},copy:function(){var a=new DateArray();a.replace(this);return a;}};return function(){var a=[];a.push.apply(a,arguments);$.extend(a,extras);return a;};})();var Datepicker=function(element,options){this.dates=new DateArray();this.viewDate=UTCToday();this.focusDate=null;this._process_options(options);this.element=$(element);this.isInline=false;this.isInput=this.element.is('input');this.component=this.element.is('.date')?this.element.find('.add-on, .input-group-addon, .btn'):false;this.hasInput=this.component&&this.element.find('input').length;if(this.component&&this.component.length===0)
this.component=false;this.picker=$(DPGlobal.template);this._buildEvents();this._attachEvents();if(this.isInline){this.picker.addClass('datepicker-inline').appendTo(this.element);}
else{this.picker.addClass('datepicker-dropdown dropdown-menu');}
if(this.o.rtl){this.picker.addClass('datepicker-rtl');}
this.viewMode=this.o.startView;if(this.o.calendarWeeks)
this.picker.find('tfoot th.today, tfoot th.clear').attr('colspan',function(i,val){return parseInt(val)+1;});this._allow_update=false;this.setStartDate(this._o.startDate);this.setEndDate(this._o.endDate);this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled);this.fillDow();this.fillMonths();this._allow_update=true;this.update();this.showMode();if(this.isInline){this.show();}};Datepicker.prototype={constructor:Datepicker,_process_options:function(opts){this._o=$.extend({},this._o,opts);var o=this.o=$.extend({},this._o);var lang=o.language;if(!dates[lang]){lang=lang.split('-')[0];if(!dates[lang])
lang=defaults.language;}
o.language=lang;switch(o.startView){case 2:case'decade':o.startView=2;break;case 1:case'year':o.startView=1;break;default:o.startView=0;}
switch(o.minViewMode){case 1:case'months':o.minViewMode=1;break;case 2:case'years':o.minViewMode=2;break;default:o.minViewMode=0;}
o.startView=Math.max(o.startView,o.minViewMode);if(o.multidate!==true){o.multidate=Number(o.multidate)||false;if(o.multidate!==false)
o.multidate=Math.max(0,o.multidate);else
o.multidate=1;}
o.multidateSeparator=String(o.multidateSeparator);o.weekStart%=7;o.weekEnd=((o.weekStart+6)%7);var format=DPGlobal.parseFormat(o.format);if(o.startDate!==-Infinity){if(!!o.startDate){if(o.startDate instanceof Date)
o.startDate=this._local_to_utc(this._zero_time(o.startDate));else
o.startDate=DPGlobal.parseDate(o.startDate,format,o.language);}
else{o.startDate=-Infinity;}}
if(o.endDate!==Infinity){if(!!o.endDate){if(o.endDate instanceof Date)
o.endDate=this._local_to_utc(this._zero_time(o.endDate));else
o.endDate=DPGlobal.parseDate(o.endDate,format,o.language);}
else{o.endDate=Infinity;}}
o.daysOfWeekDisabled=o.daysOfWeekDisabled||[];if(!$.isArray(o.daysOfWeekDisabled))
o.daysOfWeekDisabled=o.daysOfWeekDisabled.split(/[,\s]*/);o.daysOfWeekDisabled=$.map(o.daysOfWeekDisabled,function(d){return parseInt(d,10);});var plc=String(o.orientation).toLowerCase().split(/\s+/g),_plc=o.orientation.toLowerCase();plc=$.grep(plc,function(word){return(/^auto|left|right|top|bottom$/).test(word);});o.orientation={x:'auto',y:'auto'};if(!_plc||_plc==='auto');else if(plc.length===1){switch(plc[0]){case'top':case'bottom':o.orientation.y=plc[0];break;case'left':case'right':o.orientation.x=plc[0];break;}}
else{_plc=$.grep(plc,function(word){return(/^left|right$/).test(word);});o.orientation.x=_plc[0]||'auto';_plc=$.grep(plc,function(word){return(/^top|bottom$/).test(word);});o.orientation.y=_plc[0]||'auto';}},_events:[],_secondaryEvents:[],_applyEvents:function(evs){for(var i=0,el,ch,ev;i<evs.length;i++){el=evs[i][0];if(evs[i].length===2){ch=undefined;ev=evs[i][1];}
else if(evs[i].length===3){ch=evs[i][1];ev=evs[i][2];}
el.on(ev,ch);}},_unapplyEvents:function(evs){for(var i=0,el,ev,ch;i<evs.length;i++){el=evs[i][0];if(evs[i].length===2){ch=undefined;ev=evs[i][1];}
else if(evs[i].length===3){ch=evs[i][1];ev=evs[i][2];}
el.off(ev,ch);}},_buildEvents:function(){if(this.isInput){this._events=[[this.element,{focus:$.proxy(this.show,this),keyup:$.proxy(function(e){if($.inArray(e.keyCode,[27,37,39,38,40,32,13,9])===-1)
this.update();},this),keydown:$.proxy(this.keydown,this)}]];}
else if(this.component&&this.hasInput){this._events=[[this.element.find('input'),{focus:$.proxy(this.show,this),keyup:$.proxy(function(e){if($.inArray(e.keyCode,[27,37,39,38,40,32,13,9])===-1)
this.update();},this),keydown:$.proxy(this.keydown,this)}],[this.component,{click:$.proxy(this.show,this)}]];}
else if(this.element.is('div')){this.isInline=true;}
else{this._events=[[this.element,{click:$.proxy(this.show,this)}]];}
this._events.push([this.element,'*',{blur:$.proxy(function(e){this._focused_from=e.target;},this)}],[this.element,{blur:$.proxy(function(e){this._focused_from=e.target;},this)}]);this._secondaryEvents=[[this.picker,{click:$.proxy(this.click,this)}],[$(window),{resize:$.proxy(this.place,this)}],[$(document),{'mousedown touchstart':$.proxy(function(e){if(!(this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length)){this.hide();}},this)}]];},_attachEvents:function(){this._detachEvents();this._applyEvents(this._events);},_detachEvents:function(){this._unapplyEvents(this._events);},_attachSecondaryEvents:function(){this._detachSecondaryEvents();this._applyEvents(this._secondaryEvents);},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents);},_trigger:function(event,altdate){var date=altdate||this.dates.get(-1),local_date=this._utc_to_local(date);this.element.trigger({type:event,date:local_date,dates:$.map(this.dates,this._utc_to_local),format:$.proxy(function(ix,format){if(arguments.length===0){ix=this.dates.length-1;format=this.o.format;}
else if(typeof ix==='string'){format=ix;ix=this.dates.length-1;}
format=format||this.o.format;var date=this.dates.get(ix);return DPGlobal.formatDate(date,format,this.o.language);},this)});},show:function(){if(!this.isInline)
this.picker.appendTo('body');this.picker.show();this.place();this._attachSecondaryEvents();this._trigger('show');},hide:function(){if(this.isInline)
return;if(!this.picker.is(':visible'))
return;this.focusDate=null;this.picker.hide().detach();this._detachSecondaryEvents();this.viewMode=this.o.startView;this.showMode();if(this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find('input').val()))
this.setValue();this._trigger('hide');},remove:function(){this.hide();this._detachEvents();this._detachSecondaryEvents();this.picker.remove();delete this.element.data().datepicker;if(!this.isInput){delete this.element.data().date;}},_utc_to_local:function(utc){return utc&&new Date(utc.getTime()+(utc.getTimezoneOffset()*60000));},_local_to_utc:function(local){return local&&new Date(local.getTime()-(local.getTimezoneOffset()*60000));},_zero_time:function(local){return local&&new Date(local.getFullYear(),local.getMonth(),local.getDate());},_zero_utc_time:function(utc){return utc&&new Date(Date.UTC(utc.getUTCFullYear(),utc.getUTCMonth(),utc.getUTCDate()));},getDates:function(){return $.map(this.dates,this._utc_to_local);},getUTCDates:function(){return $.map(this.dates,function(d){return new Date(d);});},getDate:function(){return this._utc_to_local(this.getUTCDate());},getUTCDate:function(){return new Date(this.dates.get(-1));},setDates:function(){var args=$.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,args);this._trigger('changeDate');this.setValue();},setUTCDates:function(){var args=$.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,$.map(args,this._utc_to_local));this._trigger('changeDate');this.setValue();},setDate:alias('setDates'),setUTCDate:alias('setUTCDates'),setValue:function(){var formatted=this.getFormattedDate();if(!this.isInput){if(this.component){this.element.find('input').val(formatted).change();}}
else{this.element.val(formatted).change();}},getFormattedDate:function(format){if(format===undefined)
format=this.o.format;var lang=this.o.language;return $.map(this.dates,function(d){return DPGlobal.formatDate(d,format,lang);}).join(this.o.multidateSeparator);},setStartDate:function(startDate){this._process_options({startDate:startDate});this.update();this.updateNavArrows();},setEndDate:function(endDate){this._process_options({endDate:endDate});this.update();this.updateNavArrows();},setDaysOfWeekDisabled:function(daysOfWeekDisabled){this._process_options({daysOfWeekDisabled:daysOfWeekDisabled});this.update();this.updateNavArrows();},place:function(){if(this.isInline)
return;var calendarWidth=this.picker.outerWidth(),calendarHeight=this.picker.outerHeight(),visualPadding=10,windowWidth=$window.width(),windowHeight=$window.height(),scrollTop=$window.scrollTop();var parentsZindex=[];this.element.parents().each(function(){var itemZIndex=$(this).css('z-index');if(itemZIndex!=='auto'&&itemZIndex!==0)parentsZindex.push(parseInt(itemZIndex));});var zIndex=Math.max.apply(Math,parentsZindex)+10;var offset=this.component?this.component.parent().offset():this.element.offset();var height=this.component?this.component.outerHeight(true):this.element.outerHeight(false);var width=this.component?this.component.outerWidth(true):this.element.outerWidth(false);var left=offset.left,top=offset.top;this.picker.removeClass('datepicker-orient-top datepicker-orient-bottom '+'datepicker-orient-right datepicker-orient-left');if(this.o.orientation.x!=='auto'){this.picker.addClass('datepicker-orient-'+this.o.orientation.x);if(this.o.orientation.x==='right')
left-=calendarWidth-width;}
else{this.picker.addClass('datepicker-orient-left');if(offset.left<0)
left-=offset.left-visualPadding;else if(offset.left+calendarWidth>windowWidth)
left=windowWidth-calendarWidth-visualPadding;}
var yorient=this.o.orientation.y,top_overflow,bottom_overflow;if(yorient==='auto'){top_overflow=-scrollTop+offset.top-calendarHeight;bottom_overflow=scrollTop+windowHeight-(offset.top+height+calendarHeight);if(Math.max(top_overflow,bottom_overflow)===bottom_overflow)
yorient='top';else
yorient='bottom';}
this.picker.addClass('datepicker-orient-'+yorient);if(yorient==='top')
top+=height;else
top-=calendarHeight+parseInt(this.picker.css('padding-top'));this.picker.css({top:top,left:left,zIndex:zIndex});},_allow_update:true,update:function(){if(!this._allow_update)
return;var oldDates=this.dates.copy(),dates=[],fromArgs=false;if(arguments.length){$.each(arguments,$.proxy(function(i,date){if(date instanceof Date)
date=this._local_to_utc(date);dates.push(date);},this));fromArgs=true;}
else{dates=this.isInput?this.element.val():this.element.data('date')||this.element.find('input').val();if(dates&&this.o.multidate)
dates=dates.split(this.o.multidateSeparator);else
dates=[dates];delete this.element.data().date;}
dates=$.map(dates,$.proxy(function(date){return DPGlobal.parseDate(date,this.o.format,this.o.language);},this));dates=$.grep(dates,$.proxy(function(date){return(date<this.o.startDate||date>this.o.endDate||!date);},this),true);this.dates.replace(dates);if(this.dates.length)
this.viewDate=new Date(this.dates.get(-1));else if(this.viewDate<this.o.startDate)
this.viewDate=new Date(this.o.startDate);else if(this.viewDate>this.o.endDate)
this.viewDate=new Date(this.o.endDate);if(fromArgs){this.setValue();}
else if(dates.length){if(String(oldDates)!==String(this.dates))
this._trigger('changeDate');}
if(!this.dates.length&&oldDates.length)
this._trigger('clearDate');this.fill();},fillDow:function(){var dowCnt=this.o.weekStart,html='<tr>';if(this.o.calendarWeeks){var cell='<th class="cw">&nbsp;</th>';html+=cell;this.picker.find('.datepicker-days thead tr:first-child').prepend(cell);}
while(dowCnt<this.o.weekStart+7){html+='<th class="dow">'+dates[this.o.language].daysMin[(dowCnt++)%7]+'</th>';}
html+='</tr>';this.picker.find('.datepicker-days thead').append(html);},fillMonths:function(){var html='',i=0;while(i<12){html+='<span class="month">'+dates[this.o.language].monthsShort[i++]+'</span>';}
this.picker.find('.datepicker-months td').html(html);},setRange:function(range){if(!range||!range.length)
delete this.range;else
this.range=$.map(range,function(d){return d.valueOf();});this.fill();},getClassNames:function(date){var cls=[],year=this.viewDate.getUTCFullYear(),month=this.viewDate.getUTCMonth(),today=new Date();if(date.getUTCFullYear()<year||(date.getUTCFullYear()===year&&date.getUTCMonth()<month)){cls.push('old');}
else if(date.getUTCFullYear()>year||(date.getUTCFullYear()===year&&date.getUTCMonth()>month)){cls.push('new');}
if(this.focusDate&&date.valueOf()===this.focusDate.valueOf())
cls.push('focused');if(this.o.todayHighlight&&date.getUTCFullYear()===today.getFullYear()&&date.getUTCMonth()===today.getMonth()&&date.getUTCDate()===today.getDate()){cls.push('today');}
if(this.dates.contains(date)!==-1)
cls.push('active');if(date.valueOf()<this.o.startDate||date.valueOf()>this.o.endDate||$.inArray(date.getUTCDay(),this.o.daysOfWeekDisabled)!==-1){cls.push('disabled');}
if(this.range){if(date>this.range[0]&&date<this.range[this.range.length-1]){cls.push('range');}
if($.inArray(date.valueOf(),this.range)!==-1){cls.push('selected');}}
return cls;},fill:function(){var d=new Date(this.viewDate),year=d.getUTCFullYear(),month=d.getUTCMonth(),startYear=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,startMonth=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,endYear=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,endMonth=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,todaytxt=dates[this.o.language].today||dates['en'].today||'',cleartxt=dates[this.o.language].clear||dates['en'].clear||'',tooltip;if(isNaN(year)||isNaN(month))return;this.picker.find('.datepicker-days thead th.datepicker-switch').text(dates[this.o.language].months[month]+' '+year);this.picker.find('tfoot th.today').text(todaytxt).toggle(this.o.todayBtn!==false);this.picker.find('tfoot th.clear').text(cleartxt).toggle(this.o.clearBtn!==false);this.updateNavArrows();this.fillMonths();var prevMonth=UTCDate(year,month-1,28),day=DPGlobal.getDaysInMonth(prevMonth.getUTCFullYear(),prevMonth.getUTCMonth());prevMonth.setUTCDate(day);prevMonth.setUTCDate(day-(prevMonth.getUTCDay()-this.o.weekStart+7)%7);var nextMonth=new Date(prevMonth);nextMonth.setUTCDate(nextMonth.getUTCDate()+42);nextMonth=nextMonth.valueOf();var html=[];var clsName;while(prevMonth.valueOf()<nextMonth){if(prevMonth.getUTCDay()===this.o.weekStart){html.push('<tr>');if(this.o.calendarWeeks){var
ws=new Date(+prevMonth+(this.o.weekStart-prevMonth.getUTCDay()-7)%7*864e5),th=new Date(Number(ws)+(7+4-ws.getUTCDay())%7*864e5),yth=new Date(Number(yth=UTCDate(th.getUTCFullYear(),0,1))+(7+4-yth.getUTCDay())%7*864e5),calWeek=(th-yth)/ 864e5 / 7+1;html.push('<td class="cw">'+calWeek+'</td>');}}
clsName=this.getClassNames(prevMonth);clsName.push('day');if(this.o.beforeShowDay!==$.noop){var before=this.o.beforeShowDay(this._utc_to_local(prevMonth));if(before===undefined)
before={};else if(typeof(before)==='boolean')
before={enabled:before};else if(typeof(before)==='string')
before={classes:before};if(before.enabled===false)
clsName.push('disabled');if(before.classes)
clsName=clsName.concat(before.classes.split(/\s+/));if(before.tooltip)
tooltip=before.tooltip;}
clsName=$.unique(clsName);html.push('<td class="'+clsName.join(' ')+'"'+(tooltip?' title="'+tooltip+'"':'')+'>'+prevMonth.getUTCDate()+'</td>');tooltip=null;if(prevMonth.getUTCDay()===this.o.weekEnd){html.push('</tr>');}
prevMonth.setUTCDate(prevMonth.getUTCDate()+1);}
this.picker.find('.datepicker-days tbody').empty().append(html.join(''));var months=this.picker.find('.datepicker-months').find('th:eq(1)').text(year).end().find('span').removeClass('active');$.each(this.dates,function(i,d){if(d.getUTCFullYear()===year)
months.eq(d.getUTCMonth()).addClass('active');});if(year<startYear||year>endYear){months.addClass('disabled');}
if(year===startYear){months.slice(0,startMonth).addClass('disabled');}
if(year===endYear){months.slice(endMonth+1).addClass('disabled');}
html='';year=parseInt(year/10,10)*10;var yearCont=this.picker.find('.datepicker-years').find('th:eq(1)').text(year+'-'+(year+9)).end().find('td');year-=1;var years=$.map(this.dates,function(d){return d.getUTCFullYear();}),classes;for(var i=-1;i<11;i++){classes=['year'];if(i===-1)
classes.push('old');else if(i===10)
classes.push('new');if($.inArray(year,years)!==-1)
classes.push('active');if(year<startYear||year>endYear)
classes.push('disabled');html+='<span class="'+classes.join(' ')+'">'+year+'</span>';year+=1;}
yearCont.html(html);},updateNavArrows:function(){if(!this._allow_update)
return;var d=new Date(this.viewDate),year=d.getUTCFullYear(),month=d.getUTCMonth();switch(this.viewMode){case 0:if(this.o.startDate!==-Infinity&&year<=this.o.startDate.getUTCFullYear()&&month<=this.o.startDate.getUTCMonth()){this.picker.find('.prev').css({visibility:'hidden'});}
else{this.picker.find('.prev').css({visibility:'visible'});}
if(this.o.endDate!==Infinity&&year>=this.o.endDate.getUTCFullYear()&&month>=this.o.endDate.getUTCMonth()){this.picker.find('.next').css({visibility:'hidden'});}
else{this.picker.find('.next').css({visibility:'visible'});}
break;case 1:case 2:if(this.o.startDate!==-Infinity&&year<=this.o.startDate.getUTCFullYear()){this.picker.find('.prev').css({visibility:'hidden'});}
else{this.picker.find('.prev').css({visibility:'visible'});}
if(this.o.endDate!==Infinity&&year>=this.o.endDate.getUTCFullYear()){this.picker.find('.next').css({visibility:'hidden'});}
else{this.picker.find('.next').css({visibility:'visible'});}
break;}},click:function(e){e.preventDefault();var target=$(e.target).closest('span, td, th'),year,month,day;if(target.length===1){switch(target[0].nodeName.toLowerCase()){case'th':switch(target[0].className){case'datepicker-switch':this.showMode(1);break;case'prev':case'next':var dir=DPGlobal.modes[this.viewMode].navStep*(target[0].className==='prev'?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,dir);this._trigger('changeMonth',this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,dir);if(this.viewMode===1)
this._trigger('changeYear',this.viewDate);break;}
this.fill();break;case'today':var date=new Date();date=UTCDate(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0);this.showMode(-2);var which=this.o.todayBtn==='linked'?null:'view';this._setDate(date,which);break;case'clear':var element;if(this.isInput)
element=this.element;else if(this.component)
element=this.element.find('input');if(element)
element.val("").change();this.update();this._trigger('changeDate');if(this.o.autoclose)
this.hide();break;}
break;case'span':if(!target.is('.disabled')){this.viewDate.setUTCDate(1);if(target.is('.month')){day=1;month=target.parent().find('span').index(target);year=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(month);this._trigger('changeMonth',this.viewDate);if(this.o.minViewMode===1){this._setDate(UTCDate(year,month,day));}}
else{day=1;month=0;year=parseInt(target.text(),10)||0;this.viewDate.setUTCFullYear(year);this._trigger('changeYear',this.viewDate);if(this.o.minViewMode===2){this._setDate(UTCDate(year,month,day));}}
this.showMode(-1);this.fill();}
break;case'td':if(target.is('.day')&&!target.is('.disabled')){day=parseInt(target.text(),10)||1;year=this.viewDate.getUTCFullYear();month=this.viewDate.getUTCMonth();if(target.is('.old')){if(month===0){month=11;year-=1;}
else{month-=1;}}
else if(target.is('.new')){if(month===11){month=0;year+=1;}
else{month+=1;}}
this._setDate(UTCDate(year,month,day));}
break;}}
if(this.picker.is(':visible')&&this._focused_from){$(this._focused_from).focus();}
delete this._focused_from;},_toggle_multidate:function(date){var ix=this.dates.contains(date);if(!date){this.dates.clear();}
if(this.o.multidate===1&&ix===0){}
else if(ix!==-1){this.dates.remove(ix);}
else{this.dates.push(date);}
if(typeof this.o.multidate==='number')
while(this.dates.length>this.o.multidate)
this.dates.remove(0);},_setDate:function(date,which){if(!which||which==='date')
this._toggle_multidate(date&&new Date(date));if(!which||which==='view')
this.viewDate=date&&new Date(date);this.fill();this.setValue();this._trigger('changeDate');var element;if(this.isInput){element=this.element;}
else if(this.component){element=this.element.find('input');}
if(element){element.change();}
if(this.o.autoclose&&(!which||which==='date')){this.hide();}},moveMonth:function(date,dir){if(!date)
return undefined;if(!dir)
return date;var new_date=new Date(date.valueOf()),day=new_date.getUTCDate(),month=new_date.getUTCMonth(),mag=Math.abs(dir),new_month,test;dir=dir>0?1:-1;if(mag===1){test=dir===-1?function(){return new_date.getUTCMonth()===month;}:function(){return new_date.getUTCMonth()!==new_month;};new_month=month+dir;new_date.setUTCMonth(new_month);if(new_month<0||new_month>11)
new_month=(new_month+12)%12;}
else{for(var i=0;i<mag;i++)
new_date=this.moveMonth(new_date,dir);new_month=new_date.getUTCMonth();new_date.setUTCDate(day);test=function(){return new_month!==new_date.getUTCMonth();};}
while(test()){new_date.setUTCDate(--day);new_date.setUTCMonth(new_month);}
return new_date;},moveYear:function(date,dir){return this.moveMonth(date,dir*12);},dateWithinRange:function(date){return date>=this.o.startDate&&date<=this.o.endDate;},keydown:function(e){if(this.picker.is(':not(:visible)')){if(e.keyCode===27)
this.show();return;}
var dateChanged=false,dir,newDate,newViewDate,focusDate=this.focusDate||this.viewDate;switch(e.keyCode){case 27:if(this.focusDate){this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.fill();}
else
this.hide();e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)
break;dir=e.keyCode===37?-1:1;if(e.ctrlKey){newDate=this.moveYear(this.dates.get(-1)||UTCToday(),dir);newViewDate=this.moveYear(focusDate,dir);this._trigger('changeYear',this.viewDate);}
else if(e.shiftKey){newDate=this.moveMonth(this.dates.get(-1)||UTCToday(),dir);newViewDate=this.moveMonth(focusDate,dir);this._trigger('changeMonth',this.viewDate);}
else{newDate=new Date(this.dates.get(-1)||UTCToday());newDate.setUTCDate(newDate.getUTCDate()+dir);newViewDate=new Date(focusDate);newViewDate.setUTCDate(focusDate.getUTCDate()+dir);}
if(this.dateWithinRange(newDate)){this.focusDate=this.viewDate=newViewDate;this.setValue();this.fill();e.preventDefault();}
break;case 38:case 40:if(!this.o.keyboardNavigation)
break;dir=e.keyCode===38?-1:1;if(e.ctrlKey){newDate=this.moveYear(this.dates.get(-1)||UTCToday(),dir);newViewDate=this.moveYear(focusDate,dir);this._trigger('changeYear',this.viewDate);}
else if(e.shiftKey){newDate=this.moveMonth(this.dates.get(-1)||UTCToday(),dir);newViewDate=this.moveMonth(focusDate,dir);this._trigger('changeMonth',this.viewDate);}
else{newDate=new Date(this.dates.get(-1)||UTCToday());newDate.setUTCDate(newDate.getUTCDate()+dir*7);newViewDate=new Date(focusDate);newViewDate.setUTCDate(focusDate.getUTCDate()+dir*7);}
if(this.dateWithinRange(newDate)){this.focusDate=this.viewDate=newViewDate;this.setValue();this.fill();e.preventDefault();}
break;case 32:break;case 13:focusDate=this.focusDate||this.dates.get(-1)||this.viewDate;if(this.o.keyboardNavigation){this._toggle_multidate(focusDate);dateChanged=true;}
this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.setValue();this.fill();if(this.picker.is(':visible')){e.preventDefault();if(this.o.autoclose)
this.hide();}
break;case 9:this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.fill();this.hide();break;}
if(dateChanged){if(this.dates.length)
this._trigger('changeDate');else
this._trigger('clearDate');var element;if(this.isInput){element=this.element;}
else if(this.component){element=this.element.find('input');}
if(element){element.change();}}},showMode:function(dir){if(dir){this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+dir));}
this.picker.find('>div').hide().filter('.datepicker-'+DPGlobal.modes[this.viewMode].clsName).css('display','block');this.updateNavArrows();}};var DateRangePicker=function(element,options){this.element=$(element);this.inputs=$.map(options.inputs,function(i){return i.jquery?i[0]:i;});delete options.inputs;$(this.inputs).datepicker(options).bind('changeDate',$.proxy(this.dateUpdated,this));this.pickers=$.map(this.inputs,function(i){return $(i).data('datepicker');});this.updateDates();};DateRangePicker.prototype={updateDates:function(){this.dates=$.map(this.pickers,function(i){return i.getUTCDate();});this.updateRanges();},updateRanges:function(){var range=$.map(this.dates,function(d){return d.valueOf();});$.each(this.pickers,function(i,p){p.setRange(range);});},dateUpdated:function(e){if(this.updating)
return;this.updating=true;var dp=$(e.target).data('datepicker'),new_date=dp.getUTCDate(),i=$.inArray(e.target,this.inputs),l=this.inputs.length;if(i===-1)
return;$.each(this.pickers,function(i,p){if(!p.getUTCDate())
p.setUTCDate(new_date);});if(new_date<this.dates[i]){while(i>=0&&new_date<this.dates[i]){this.pickers[i--].setUTCDate(new_date);}}
else if(new_date>this.dates[i]){while(i<l&&new_date>this.dates[i]){this.pickers[i++].setUTCDate(new_date);}}
this.updateDates();delete this.updating;},remove:function(){$.map(this.pickers,function(p){p.remove();});delete this.element.data().datepicker;}};function opts_from_el(el,prefix){var data=$(el).data(),out={},inkey,replace=new RegExp('^'+prefix.toLowerCase()+'([A-Z])');prefix=new RegExp('^'+prefix.toLowerCase());function re_lower(_,a){return a.toLowerCase();}
for(var key in data)
if(prefix.test(key)){inkey=key.replace(replace,re_lower);out[inkey]=data[key];}
return out;}
function opts_from_locale(lang){var out={};if(!dates[lang]){lang=lang.split('-')[0];if(!dates[lang])
return;}
var d=dates[lang];$.each(locale_opts,function(i,k){if(k in d)
out[k]=d[k];});return out;}
var old=$.fn.datepicker;$.fn.datepicker=function(option){var args=Array.apply(null,arguments);args.shift();var internal_return;this.each(function(){var $this=$(this),data=$this.data('datepicker'),options=typeof option==='object'&&option;if(!data){var elopts=opts_from_el(this,'date'),xopts=$.extend({},defaults,elopts,options),locopts=opts_from_locale(xopts.language),opts=$.extend({},defaults,locopts,elopts,options);if($this.is('.input-daterange')||opts.inputs){var ropts={inputs:opts.inputs||$this.find('input').toArray()};$this.data('datepicker',(data=new DateRangePicker(this,$.extend(opts,ropts))));}
else{$this.data('datepicker',(data=new Datepicker(this,opts)));}}
if(typeof option==='string'&&typeof data[option]==='function'){internal_return=data[option].apply(data,args);if(internal_return!==undefined)
return false;}});if(internal_return!==undefined)
return internal_return;else
return this;};var defaults=$.fn.datepicker.defaults={autoclose:false,beforeShowDay:$.noop,calendarWeeks:false,clearBtn:false,daysOfWeekDisabled:[],endDate:Infinity,forceParse:true,format:'mm/dd/yyyy',keyboardNavigation:true,language:'en',minViewMode:0,multidate:false,multidateSeparator:',',orientation:"auto",rtl:false,startDate:-Infinity,startView:0,todayBtn:false,todayHighlight:false,weekStart:0};var locale_opts=$.fn.datepicker.locale_opts=['format','rtl','weekStart'];$.fn.datepicker.Constructor=Datepicker;var dates=$.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}};var DPGlobal={modes:[{clsName:'days',navFnc:'Month',navStep:1},{clsName:'months',navFnc:'FullYear',navStep:1},{clsName:'years',navFnc:'FullYear',navStep:10}],isLeapYear:function(year){return(((year%4===0)&&(year%100!==0))||(year%400===0));},getDaysInMonth:function(year,month){return[31,(DPGlobal.isLeapYear(year)?29:28),31,30,31,30,31,31,30,31,30,31][month];},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(format){var separators=format.replace(this.validParts,'\0').split('\0'),parts=format.match(this.validParts);if(!separators||!separators.length||!parts||parts.length===0){throw new Error("Invalid date format.");}
return{separators:separators,parts:parts};},parseDate:function(date,format,language){if(!date)
return undefined;if(date instanceof Date)
return date;if(typeof format==='string')
format=DPGlobal.parseFormat(format);var part_re=/([\-+]\d+)([dmwy])/,parts=date.match(/([\-+]\d+)([dmwy])/g),part,dir,i;if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(date)){date=new Date();for(i=0;i<parts.length;i++){part=part_re.exec(parts[i]);dir=parseInt(part[1]);switch(part[2]){case'd':date.setUTCDate(date.getUTCDate()+dir);break;case'm':date=Datepicker.prototype.moveMonth.call(Datepicker.prototype,date,dir);break;case'w':date.setUTCDate(date.getUTCDate()+dir*7);break;case'y':date=Datepicker.prototype.moveYear.call(Datepicker.prototype,date,dir);break;}}
return UTCDate(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate(),0,0,0);}
parts=date&&date.match(this.nonpunctuation)||[];date=new Date();var parsed={},setters_order=['yyyy','yy','M','MM','m','mm','d','dd'],setters_map={yyyy:function(d,v){return d.setUTCFullYear(v);},yy:function(d,v){return d.setUTCFullYear(2000+v);},m:function(d,v){if(isNaN(d))
return d;v-=1;while(v<0)v+=12;v%=12;d.setUTCMonth(v);while(d.getUTCMonth()!==v)
d.setUTCDate(d.getUTCDate()-1);return d;},d:function(d,v){return d.setUTCDate(v);}},val,filtered;setters_map['M']=setters_map['MM']=setters_map['mm']=setters_map['m'];setters_map['dd']=setters_map['d'];date=UTCDate(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0);var fparts=format.parts.slice();if(parts.length!==fparts.length){fparts=$(fparts).filter(function(i,p){return $.inArray(p,setters_order)!==-1;}).toArray();}
function match_part(){var m=this.slice(0,parts[i].length),p=parts[i].slice(0,m.length);return m===p;}
if(parts.length===fparts.length){var cnt;for(i=0,cnt=fparts.length;i<cnt;i++){val=parseInt(parts[i],10);part=fparts[i];if(isNaN(val)){switch(part){case'MM':filtered=$(dates[language].months).filter(match_part);val=$.inArray(filtered[0],dates[language].months)+1;break;case'M':filtered=$(dates[language].monthsShort).filter(match_part);val=$.inArray(filtered[0],dates[language].monthsShort)+1;break;}}
parsed[part]=val;}
var _date,s;for(i=0;i<setters_order.length;i++){s=setters_order[i];if(s in parsed&&!isNaN(parsed[s])){_date=new Date(date);setters_map[s](_date,parsed[s]);if(!isNaN(_date))
date=_date;}}}
return date;},formatDate:function(date,format,language){if(!date)
return'';if(typeof format==='string')
format=DPGlobal.parseFormat(format);var val={d:date.getUTCDate(),D:dates[language].daysShort[date.getUTCDay()],DD:dates[language].days[date.getUTCDay()],m:date.getUTCMonth()+1,M:dates[language].monthsShort[date.getUTCMonth()],MM:dates[language].months[date.getUTCMonth()],yy:date.getUTCFullYear().toString().substring(2),yyyy:date.getUTCFullYear()};val.dd=(val.d<10?'0':'')+val.d;val.mm=(val.m<10?'0':'')+val.m;date=[];var seps=$.extend([],format.separators);for(var i=0,cnt=format.parts.length;i<=cnt;i++){if(seps.length)
date.push(seps.shift());date.push(val[format.parts[i]]);}
return date.join('');},headTemplate:'<thead>'+'<tr>'+'<th class="prev">&laquo;</th>'+'<th colspan="5" class="datepicker-switch"></th>'+'<th class="next">&raquo;</th>'+'</tr>'+'</thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot>'+'<tr>'+'<th colspan="7" class="today"></th>'+'</tr>'+'<tr>'+'<th colspan="7" class="clear"></th>'+'</tr>'+'</tfoot>'};DPGlobal.template='<div class="datepicker">'+'<div class="datepicker-days">'+'<table class=" table-condensed">'+
DPGlobal.headTemplate+'<tbody></tbody>'+
DPGlobal.footTemplate+'</table>'+'</div>'+'<div class="datepicker-months">'+'<table class="table-condensed">'+
DPGlobal.headTemplate+
DPGlobal.contTemplate+
DPGlobal.footTemplate+'</table>'+'</div>'+'<div class="datepicker-years">'+'<table class="table-condensed">'+
DPGlobal.headTemplate+
DPGlobal.contTemplate+
DPGlobal.footTemplate+'</table>'+'</div>'+'</div>';$.fn.datepicker.DPGlobal=DPGlobal;$.fn.datepicker.noConflict=function(){$.fn.datepicker=old;return this;};$(document).on('focus.datepicker.data-api click.datepicker.data-api','[data-provide="datepicker"]',function(e){var $this=$(this);if($this.data('datepicker'))
return;e.preventDefault();$this.datepicker('show');});$(function(){$('[data-provide="datepicker-inline"]').datepicker();});}(window.jQuery));define("bootstrap-datepicker",function(){});;(function($){$.fn.datepicker.dates['az']={days:["Bazar","Bazar ertəsi","Çərşənbə axşamı","Çərşənbə","Cümə axşamı","Cümə","Şənbə","Bazar"],daysShort:["B.","B.e","Ç.a","Ç.","C.a","C.","Ş.","B."],daysMin:["B.","B.e","Ç.a","Ç.","C.a","C.","Ş.","B."],months:["Yanvar","Fevral","Mart","Aprel","May","İyun","İyul","Avqust","Sentyabr","Oktyabr","Noyabr","Dekabr"],monthsShort:["Yan","Fev","Mar","Apr","May","İyun","İyul","Avq","Sen","Okt","Noy","Dek"],today:"Bu gün",weekStart:1};}(jQuery));define("datepicker-ar",function(){});;(function($){$.fn.datepicker.dates['bg']={days:["Неделя","Понеделник","Вторник","Сряда","Четвъртък","Петък","Събота","Неделя"],daysShort:["Нед","Пон","Вто","Сря","Чет","Пет","Съб","Нед"],daysMin:["Н","П","В","С","Ч","П","С","Н"],months:["Януари","Февруари","Март","Април","Май","Юни","Юли","Август","Септември","Октомври","Ноември","Декември"],monthsShort:["Ян","Фев","Мар","Апр","Май","Юни","Юли","Авг","Сеп","Окт","Ное","Дек"],today:"днес"};}(jQuery));define("datepicker-az",function(){});;(function($){$.fn.datepicker.dates['ar']={days:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت","الأحد"],daysShort:["أحد","اثنين","ثلاثاء","أربعاء","خ� �يس","جمعة","سبت","أحد"],daysMin:["ح","ن","ث","ع","خ","ج","س","ح"],months:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],monthsShort:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],today:"هذا اليوم",rtl:true};}(jQuery));define("datepicker-bg",function(){});;(function($){$.fn.datepicker.dates['ca']={days:["Diumenge","Dilluns","Dimarts","Dimecres","Dijous","Divendres","Dissabte","Diumenge"],daysShort:["Diu","Dil","Dmt","Dmc","Dij","Div","Dis","Diu"],daysMin:["dg","dl","dt","dc","dj","dv","ds","dg"],months:["Gener","Febrer","Març","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],monthsShort:["Gen","Feb","Mar","Abr","Mai","Jun","Jul","Ago","Set","Oct","Nov","Des"],today:"Avui",clear:"Esborrar",weekStart:1,format:"dd/mm/yyyy"};}(jQuery));define("datepicker-ca",function(){});;(function($){$.fn.datepicker.dates['cs']={days:["Neděle","Pondělí","Úterý","Středa","Čtvrtek","Pátek","Sobota","Neděle"],daysShort:["Ned","Pon","Úte","Stř","Čtv","Pát","Sob","Ned"],daysMin:["Ne","Po","Út","St","Čt","Pá","So","Ne"],months:["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosi nec"],monthsShort:["Led","Úno","Bře","Dub","Kvě","Čer","Čnc","Srp","Zář","Říj","Lis","Pro"],today:"Dnes",clear:"Vymazat",weekStart:1,format:"d.m.yyyy"};}(jQuery));define("datepicker-cs",function(){});;(function($){$.fn.datepicker.dates['cy']={days:["Sul","Llun","Mawrth","Mercher","Iau","Gwener","Sadwrn","Sul"],daysShort:["Sul","Llu","Maw","Mer","Iau","Gwe","Sad","Sul"],daysMin:["Su","Ll","Ma","Me","Ia","Gwe","Sa","Su"],months:["Ionawr","Chewfror","Mawrth","Ebrill","Mai","Mehefin","Gorfennaf","Awst","Medi","Hydref","Tachwedd","Rhagfyr"],monthsShort:["Ion","Chw","Maw","Ebr","Mai","Meh","Gor","Aws","Med","Hyd","Tach","Rha"],today:"Heddiw"};}(jQuery));define("datepicker-cy",function(){});;(function($){$.fn.datepicker.dates['da']={days:["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag","Søndag"],daysShort:["Søn","Man","Tir","Ons","Tor","Fre","Lør","Søn"],daysMin:["Sø","Ma","Ti","On","To","Fr","Lø","Sø"],months:["Januar","Februar","Marts","April","Maj","Juni ","Juli","August","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"I Dag",clear:"Nulstil"};}(jQuery));define("datepicker-da",function(){});;(function($){$.fn.datepicker.dates['de']={days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],daysShort:["Son","Mon","Die","Mit","Don","Fre","Sam","Son"],daysMin:["So","Mo","Di","Mi","Do","Fr","Sa","So"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthsShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],today:"Heute",clear:"Löschen",weekStart:1,format:"dd.mm.yyyy"};}(jQuery));define("datepicker-de",function(){});;(function($){$.fn.datepicker.dates['el']={days:["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο","Κυριακή"],daysShort:["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ","Κυρ"],daysMin:["Κυ","Δε","Τρ","Τε","Πε","Πα","Σα","Κυ"],months:["Ιανουάριος", "Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],monthsShort:["Ιαν","Φεβ","Μαρ","Απρ","Μάι","Ιουν","Ιουλ","Αυγ","Σεπ","Οκτ","Νοε","Δεκ"],today:"Σήμερα",clear:"Καθαρισμός",weekStart:1,format:"d/m/yyyy"};}(jQuery));define("datepicker-el",function(){});;(function($){$.fn.datepicker.dates['es']={days:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"],daysShort:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb","Dom"],daysMin:["Do","Lu","Ma","Mi","Ju","Vi","Sa","Do"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthsShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],today:"Hoy",clear:"Borrar",weekStart:1,format:"dd/mm/yyyy"};}(jQuery));defi ne("datepicker-es",function(){});;(function($){$.fn.datepicker.dates['et']={days:["Pühapäev","Esmaspäev","Teisipäev","Kolmapäev","Neljapäev","Reede","Laupäev","Pühapäev"],daysShort:["Pühap","Esmasp","Teisip","Kolmap","Neljap","Reede","Laup","Pühap"],daysMin:["P","E","T","K","N","R","L","P"],months:["Jaanuar","Veebruar","Märts","Aprill","Mai","Juuni","Juuli","August","September","Oktoober","November","Detsember"],monthsShort:["Jaan","Veebr","Märts","Apr","Mai","Juuni","Juuli","Aug","Sept","Okt","Nov","Dets"],today:"Täna",clear:"Tühjenda",weekStart:1,format:"dd.mm.yyyy"};}(jQuery));define("datepicker-et",function(){});;(function($){$.fn.datepicker.dates['fa']={days:["یک‌شنبه","دوشنبه","سه‌شنبه","چهارشنبه","پنج‌شنبه","جمعه","شنبه","یک‌شنبه"],daysShort:["یک","دو","سه","چهار","پنج","جمعه","شنبه","یک"],daysMin:["ی","د","س","چ","پ","ج","ش","ی"],months:["ژانویه","فوریه","مارس"," آوریل","مه","ژوئن","ژوئیه","اوت","سپتامبر","اکتبر","نوامبر","دسامبر"],monthsShort:["ژان","فور","مار","آور","مه","ژون","ژوی","اوت","سپت","اکت","نوا","دسا"],today:"امروز",clear:"پاک کن",weekStart:1,format:"yyyy/mm/dd"};}(jQuery));define("datepicker-fa",function(){});;(function($){$.fn.datepicker.dates['fi']={days:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai","sunnuntai"],daysShort:["sun","maa","tii","kes","tor","per","lau","sun"],daysMin:["su","ma","ti","ke","to","pe","la","su"],months:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kesäkuu","heinäkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],monthsShort:["tam","hel","maa","huh","tou","kes","hei","elo","syy","lok","mar","jou"],today:"tänään",weekStart:1,format:"d.m.yyyy"};}(jQuery));define("datepicker-fi",function(){});;(function($){$.fn.datepicker.dates['fr']={days:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],daysShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],daysMin:["D","L","Ma","Me","J","V","S","D"],months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Nov embre","Décembre"],monthsShort:["Jan","Fév","Mar","Avr","Mai","Jui","Jul","Aou","Sep","Oct","Nov","Déc"],today:"Aujourd'hui",clear:"Effacer",weekStart:1,format:"dd/mm/yyyy"};}(jQuery));define("datepicker-fr",function(){});;(function($){$.fn.datepicker.dates['gl']={days:["Domingo","Luns","Martes","Mércores","Xoves","Venres","Sábado","Domingo"],daysShort:["Dom","Lun","Mar","Mér","Xov","Ven","Sáb","Dom"],daysMin:["Do","Lu","Ma","Me","Xo","Ve","Sa","Do"],months:["Xaneiro","Febreiro","Marzo","Abril","Maio","Xuño","Xullo","Agosto","Setembro","Outubro","Novembro","Decembro"],monthsShort:["Xan","Feb","Mar","Abr","Mai","Xun","Xul","Ago","Sep","Out","Nov","Dec"],today:"Hoxe",clear:"Limpar",weekStart:1,format:"dd/mm/yyyy"};}(jQuery));define("datepicker-gl",function(){});;(function($){$.fn.datepicker.dates['he']={days:["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת","ראשון"],daysShort:["א","ב","ג","ד","ה","ו","ש","א"],daysMin:["א","ב","ג"," ד","ה","ו","ש","א"],months:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],monthsShort:["ינו","פבר","מרץ","אפר","מאי","יונ","יול","אוג","ספט","אוק","נוב","דצמ"],today:"היום",rtl:true};}(jQuery));define("datepicker-he",function(){});;(function($){$.fn.datepicker.dates['hr']={days:["Nedjelja","Ponedjeljak","Utorak","Srijeda","Četvrtak","Petak","Subota","Nedjelja"],daysShort:["Ned","Pon","Uto","Sri","Čet","Pet","Sub","Ned"],daysMin:["Ne","Po","Ut","Sr","Če","Pe","Su","Ne"],months:["Siječanj","Veljača","Ožujak","Travanj","Svibanj","Lipanj","Srpanj","Kolovoz","Rujan","Listopad","Studeni","Prosinac"],monthsShort:["Sij","Velj","Ožu","Tra","Svi","Lip","Srp","Kol","Ruj","Lis","Stu","Pro"],today:"Danas"};}(jQuery));define("datepicker-hr",function(){});;(function($){$.fn.datepicker.dates['hu']={days:["Vasárnap","Hétfő","Kedd","Szerda ","Csütörtök","Péntek","Szombat","Vasárnap"],daysShort:["Vas","Hét","Ked","Sze","Csü","Pén","Szo","Vas"],daysMin:["Va","Hé","Ke","Sz","Cs","Pé","Sz","Va"],months:["Január","Február","Március","Április","Május","Június","Július","Augusztus","Szeptember","Október","November","December"],monthsShort:["Jan","Feb","Már","Ápr","Máj","Jún","Júl","Aug","Sze","Okt","Nov","Dec"],today:"Ma",weekStart:1,format:"yyyy.mm.dd"};}(jQuery));define("datepicker-hu",function(){});;(function($){$.fn.datepicker.dates['id']={days:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu","Minggu"],daysShort:["Mgu","Sen","Sel","Rab","Kam","Jum","Sab","Mgu"],daysMin:["Mg","Sn","Sl","Ra","Ka","Ju","Sa","Mg"],months:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ags","Sep","Okt","Nov","Des"],today:"Hari Ini",clear:"Kosongkan"};}(jQuery));define("datepicker-id",function(){});;(function($){$.fn.datepicker.dates['is']={days:["Sunnudagur","Mánudagur","Þriðjudagur","Miðvikudagur","Fimmtudagur","Föstudagur","Laugardagur","Sunnudagur"],daysShort:["Sun","Mán","Þri","Mið","Fim","Fös","Lau","Sun"],daysMin:["Su","Má","Þr","Mi","Fi","Fö","La","Su"],months:["Janúar","Febrúar","Mars","Apríl","Maí","Júní","Júlí","Ágúst","September","Október","Nóvember","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Maí","Jún","Júl","Ágú","Sep","Okt","Nóv","Des"],today:"Í Dag"};}(jQuery));define("datepicker-is",function(){});;(function($) {$.fn.datepicker.dates['it']={days: ["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato","Domenica"],daysShort: ["Dom","Lun","Mar","Mer","Gio","Ven","Sab","Dom"],daysMin: ["Do","Lu","Ma","Me","Gi","Ve","Sa","Do"],months: ["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthsShort: ["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],today:"Oggi",clear:"Cancella",weekStart:1,format:"dd/mm /yyyy"};}(jQuery));define("datepicker-it",function(){});; (function($){$.fn.datepicker.dates['ja']={days:["日曜","月曜","火曜","水 曜","木曜","金曜","土曜","日曜"],daysShort:["日","月","火","水","木","金","土"," 日"],daysMin:["日","月","火","水","木","金","土","日"],months:["1月","2月","3 月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthsShort:["1 月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12 月"],today:"今日",format:"yyyy/mm/dd",clear:"クリア"};} (jQuery));define("datepicker-ja",function(){});;(function($) {$.fn.datepicker.dates['ka']={days: ["კვირა","ორშაბათი","სამშაბათი","ოთხშაბათი","ხუთშაბათი","პარასკევი","შაბათი","კვირა"],daysShort: ["კვი","ორშ","სამ","ოთხ","ხუთ","პარ","შაბ","კვი"],daysMin: ["კვ","ორ","სა","ოთ","ხუ","პა","შა","კვ"],months: ["იანვარი","თებერვალი","მარტი","აპრილი","მაისი","ივნისი","ივლისი","აგვისტო","სექტემბერი","ოქტომები","ნოემბერი","დეკემბერი"],monthsShort: ["იან","თებ","მარ","აპრ","მაი","ივნ","ივლ","აგვ","სექ","ოქტ","ნოე","დეკ"],today:"დღეს",clear:"გასუფთავება",weekStart:1,format:"dd.mm.yyyy"};} (jQuery));define("datepicker-ka",function(){});;(function($) {$.fn.datepicker.dates['kk']={days: ["Жексенбі","Дүйсенбі","Сейсенбі","Сәрсенбі","Бейсенбі","Жұма","Сенбі","Жексенбі"],daysShort: ["Жек","Дүй","Сей","Сәр","Бей","Жұм","Сен","Жек"],daysMin: ["Жк","Дс","Сс","Ср","Бс","Жм","Сн","Жк"],months: ["Қаңтар","Ақпан","Наурыз","Сәуір","Мамыр","Маусым","Шілде","Тамыз","Қыркүйек","Қазан","Қараша","Желтоқсан"],monthsShort: ["Қаң","Ақп","Нау","Сәу","Мамыр","Мау","Шлд","Тмз","Қыр","Қзн","Қар","Жел"],today:"Бүгін",weekStart:1};} (jQuery));define("datepicker-kk",function(){});;(function($) {$.fn.datepicker.dates['kr']={days:["일요일","월요일","화요일","수요일","목요일","금 요일","토요일","일요일"],daysShort:["일","월","화","수","목","금","토"," 일"],daysMin:["일","월","화","수","목","금","토","일"],months:["1월","2월","3 월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],monthsShort:["1 월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"]};} (jQuery));define("datepicker-kr",function(){});;(function($){$.fn.datepicker.dates['lt']={days:["Sekmadienis","Pirmadienis","Antradienis","Trečiadienis","Ketvirtadienis","Penktadienis","Šeštadienis","Sekmadienis"],daysShort:["S","Pr","A","T","K","Pn","Š","S"],daysMin:["Sk","Pr","An","Tr","Ke","Pn","Št","Sk"],months:["Sausis","Vasaris","Kovas","Balandis","Gegužė","Birželis","Liepa","Rugpjūtis","Rugsėjis","Spalis","Lapkritis","Gruodis"],monthsShort:["Sau","Vas","Kov","Bal","Geg","Bir","Lie","Rugp","Rugs","Spa","Lap","Gru"],today:"Šiandien",weekStart:1};}(jQuery));define("datepicker-lt",function(){});;(function($){$.fn.datepicker.dates['lv']={days:["Svētdiena","Pirmdiena","Otrdiena","Trešdiena","Ceturtdiena","Piektdiena","Sestdiena","Svētdiena"],daysShort:["Sv","P","O","T","C","Pk","S","Sv"],daysMin:["Sv","Pr","Ot","Tr","Ce","Pk","Se","Sv"],months:["Janvāris","Februāris","Marts","Aprīlis","Maijs","Jūnijs","Jūlijs","Augusts","Septembris","Oktobris","Novembris","Dece mbris"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jūn","Jūl","Aug","Sep","Okt","Nov","Dec"],today:"Šodien",weekStart:1};}(jQuery));define("datepicker-lv",function(){});;(function($){$.fn.datepicker.dates['mk']={days:["Недела","Понеделник","Вторник","Среда","Четврток","Петок","Сабота","Недела"],daysShort:["Нед","Пон","Вто","Сре","Чет","Пет","Саб","Нед"],daysMin:["Не","По","Вт","Ср","Че","Пе","Са","Не"],months:["Јануари","Февруари","Март","Април","Мај","Јуни","Јули","Август","Септември","Октомври","Ноември","Декември"],monthsShort:["Јан","Фев","Мар","Апр","Мај","Јун","Јул","Авг","Сеп","Окт","Ное","Дек"],today:"Денес",format:"dd.mm.yyyy"};}(jQuery));define("datepicker-mk",function(){});;(function($){$.fn.datepicker.dates['ms']={days:["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaa t","Sabtu","Ahad"],daysShort:["Aha","Isn","Sel","Rab","Kha","Jum","Sab","Aha"],daysMin:["Ah","Is","Se","Ra","Kh","Ju","Sa","Ah"],months:["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],monthsShort:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],today:"Hari Ini"};}(jQuery));define("datepicker-ms",function(){});;(function($){$.fn.datepicker.dates['nb']={days:["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag","Søndag"],daysShort:["Søn","Man","Tir","Ons","Tor","Fre","Lør","Søn"],daysMin:["Sø","Ma","Ti","On","To","Fr","Lø","Sø"],months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],monthsShort:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],today:"I Dag"};}(jQuery));define("datepicker-nb",function(){});;(function($){$.fn.datepicker.dates['nl']={days:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag","Zondag"],daysShort:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],daysMin:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],months:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"Vandaag",clear:"Wissen",weekStart:1,format:"dd-mm-yyyy"};}(jQuery));define("datepicker-nl",function(){});;(function($){$.fn.datepicker.dates['nl-BE']={days:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag","Zondag"],daysShort:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],daysMin:["Zo","Ma","Di","Wo","Do","Vr","Za","Zo"],months:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mrt" ,"Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"Vandaag",clear:"Leegmaken",weekStart:1,format:"dd/mm/yyyy"};}(jQuery));define("datepicker-nl-BE",function(){});;(function($){$.fn.datepicker.dates['no']={days:['Søndag','Mandag','Tirsdag','Onsdag','Torsdag','Fredag','Lørdag'],daysShort:['Søn','Man','Tir','Ons','Tor','Fre','Lør'],daysMin:['Sø','Ma','Ti','On','To','Fr','Lø'],months:['Januar','Februar','Mars','April','Mai','Juni','Juli','August','September','Oktober','November','Desember'],monthsShort:['Jan','Feb','Mar','Apr','Mai','Jun','Jul','Aug','Sep','Okt','Nov','Des'],today:'I dag',clear:'Nullstill',weekStart:1,format:'dd.mm.yyyy'};}(jQuery));define("datepicker-no",function(){});;(function($){$.fn.datepicker.dates['pl']={days:["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota","Niedziela"],daysShort:["Nie","Pn","Wt","Śr","Czw","Pt","So","Nie"],daysMin:["N","Pn","Wt","Śr","Cz","Pt","So","N"],months:["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"],monthsShort:["Sty","Lu","Mar","Kw","Maj","Cze","Lip","Sie","Wrz","Pa","Lis","Gru"],today:"Dzisiaj",weekStart:1,clear:"Wyczyść"};}(jQuery));define("datepicker-pl",function(){});;(function($){$.fn.datepicker.dates['pt']={days:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro ","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Limpar"};}(jQuery));define("datepicker-pt",function(){});;(function($){$.fn.datepicker.dates['pt-BR']={days:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado","Domingo"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb","Dom"],daysMin:["Do","Se","Te","Qu","Qu","Se","Sa","Do"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Limpar"};}(jQuery));define("datepicker-pt-BR",function(){});;(function($){$.fn.datepicker.dates['ro']={days:["Duminică","Luni","Marţi","Miercuri","Joi","Vineri","Sâmbătă","Duminică"],daysShort:["Dum","Lun","Mar","Mie","Joi","Vin","Sâm","Dum"],daysMin:["Du","Lu","Ma","Mi","Jo","Vi","Sâ","Du"],months:["Ianuarie","Februarie","Martie","A prilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],monthsShort:["Ian","Feb","Mar","Apr","Mai","Iun","Iul","Aug","Sep","Oct","Nov","Dec"],today:"Astăzi",clear:"Șterge",weekStart:1};}(jQuery));define("datepicker-ro",function(){});;(function($){$.fn.datepicker.dates['rs']={days:["Недеља","Понедељак","Уторак","Среда","Четвртак","Петак","Субота","Недеља"],daysShort:["Нед","Пон","Уто","Сре","Чет","Пет","Суб","Нед"],daysMin:["Н","По","У","Ср","Ч","Пе","Су","Н"],months:["Јануар","Фебруар","Март","Април","Мај","Јун","Јул","Август","Септембар","Октобар","Новембар","Децембар"],monthsShort:["Јан","Феб","Мар","Апр","Мај","Јун","Јул","Авг","Сеп","Окт","Нов","Дец"],today:"Данас",weekStart:1,format:"dd.mm.yyyy"};}(jQuery));define("datepicker-rs",function(){});;(functi on($){$.fn.datepicker.dates['rs-latin']={days:["Nedelja","Ponedeljak","Utorak","Sreda","Četvrtak","Petak","Subota","Nedelja"],daysShort:["Ned","Pon","Uto","Sre","Čet","Pet","Sub","Ned"],daysMin:["N","Po","U","Sr","Č","Pe","Su","N"],months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],today:"Danas",weekStart:1,format:"dd.mm.yyyy"};}(jQuery));define("datepicker-rs-latin",function(){});;(function($){$.fn.datepicker.dates['ru']={days:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],daysShort:["Вск","Пнд","Втр","Срд","Чтв","Птн","Суб","Вск"],daysMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб","Вс"],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Авгу� �т","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],today:"Сегодня",clear:"Очистить",format:"dd.mm.yyyy",weekStart:1};}(jQuery));define("datepicker-ru",function(){});;(function($){$.fn.datepicker.dates["sk"]={days:["Nedeľa","Pondelok","Utorok","Streda","Štvrtok","Piatok","Sobota","Nedeľa"],daysShort:["Ned","Pon","Uto","Str","Štv","Pia","Sob","Ned"],daysMin:["Ne","Po","Ut","St","Št","Pia","So","Ne"],months:["Január","Február","Marec","Apríl","Máj","Jún","Júl","August","September","Október","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Máj","Jún","Júl","Aug","Sep","Okt","Nov","Dec"],today:"Dnes"};}(jQuery));define("datepicker-sk",function(){});;(function($){$.fn.datepicker.dates['sl']={days:["Nedelja","Ponedeljek","Torek","Sreda","Četrtek","Petek","Sobota","Nedelja"],daysShort:["Ned","Pon","Tor","Sre ","Čet","Pet","Sob","Ned"],daysMin:["Ne","Po","To","Sr","Če","Pe","So","Ne"],months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],monthsShort:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Avg","Sep","Okt","Nov","Dec"],today:"Danes"};}(jQuery));define("datepicker-sl",function(){});;(function($){$.fn.datepicker.dates['sq']={days:["E Diel","E Hënë","E Martē","E Mërkurë","E Enjte","E Premte","E Shtunë","E Diel"],daysShort: ["Die","Hën","Mar","Mër","Enj","Pre","Shtu","Die"],daysMin: ["Di","Hë","Ma","Më","En","Pr","Sht","Di"],months: ["Janar","Shkurt","Mars","Prill","Maj","Qershor","Korrik","Gusht","Shtator","Tetor","Nëntor","Dhjetor"],monthsShort: ["Jan","Shk","Mar","Pri","Maj","Qer","Korr","Gu","Sht","Tet","Nën","Dhjet"],today:"Sot"};} (jQuery));define("datepicker-sq",function(){});;(function($) {$.fn.datepicker.dates['sv']={days: ["Söndag","Måndag","Tisdag","Onsdag","Torsdag","Fredag","Lördag","Söndag"],daysShort: ["Sön","Mån","Tis","Ons","Tor","Fre","Lör","Sön"],daysMin: ["Sö","Må","Ti","On","To","Fr","Lö","Sö"],months: ["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],monthsShort: ["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],today:"Idag",format:"yyyy- mm-dd",weekStart:1,clear:"Rensa"};}(jQuery));define("datepicker- sv",function(){});;(function($){$.fn.datepicker.dates['sw']={days: ["Jumapili","Jumatatu","Jumanne","Jumatano","Alhamisi","Ijumaa","Jumamosi","Jumapili"],daysShort: ["J2","J3","J4","J5","Alh","Ij","J1","J2"],daysMin: ["2","3","4","5","A","I","1","2"],months: ["Januari","Februari","Machi","Aprili","Mei","Juni","Julai","Agosti","Septemba","Oktoba","Novemba","Desemba"],monthsShort: ["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ago","Sep","Okt","Nov","Des"],today:"Leo"};} (jQuery));define("datepicker-sw",function(){});;(function($) {$.fn.datepicker.dates['th']={days:["อาทิตย์","จันทร์","อังคาร"," พุธ","พฤหัส","ศุกร์","เสาร์","อาทิตย์"],daysShort:["อา","จ","อ"," พ","พฤ","ศ","ส","อา"],daysMin:["อา","จ","อ","พ","พฤ","ศ","ส"," อา"],months:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม"," มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน"," ธันวาคม"],monthsShort:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค."," มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],today:"วัน นี้"};}(jQuery));define("datepicker-th",function(){});;(function($) {$.fn.datepicker.dates['tr']={days:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi","Pazar"],daysShort:["Pz","Pzt","Sal","Çrş","Prş","Cu","Cts","Pz"],daysMin:["Pz","Pzt","Sa","Çr","Pr","Cu","Ct","Pz"],months:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],monthsShort:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],today:"Bugün",format:"dd.mm.yyyy"};}(jQuery));define("datepicker-tr",function(){});;(function($){$.fn.datepicker.dates['vi']={days:["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy","Chủ nhật"],daysShort:["CN","Thứ 2","Thứ 3","Thứ 4","Thứ 5","Thứ 6","Thứ 7","CN"],daysMin:["CN","T2","T3","T4","T5","T6","T7","CN"],months:["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],monthsShort:["Th1","Th2","Th3","Th4","Th5","Th6","Th7","Th8","Th9","Th10","Th11","Th12"],today:"Hôm nay",clear:"Xóa",format:"dd/mm/yyyy"};}(jQuery));define("datepicker- vi",function(){});;(function($){$.fn.datepicker.dates['zh-CN']= {days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六","星期日"],daysShort:[" 周日","周一","周二","周三","周四","周五","周六","周日"],daysMin:["日","一","二","三"," 四","五","六","日"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九 月","十月","十一月","十二月"],monthsShort:["一月","二月","三月","四月","五月","六月","七 月","八月","九月","十月","十一月","十二月"],today:"今日",format:"yyyy年mm月dd 日",weekStart:1,clear:"清空"};}(jQuery));define("datepicker-zh- CN",function(){});;(function($){$.fn.datepicker.dates['zh-TW']= {days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六","星期日"],daysShort:[" 週日","週一","週二","週三","週四","週五","週六","週日"],daysMin:["日","一","二","三"," 四","五","六","日"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九 月","十月","十一月","十二月"],monthsShort:["一月","二月","三月","四月","五月","六月","七 月","八月","九月","十月","十一月","十二月"],today:"今天",format:"yyyy年mm月dd 日",weekStart:1};}(jQuery));define("datepicker-zh-TW",function(){});(function(){'use strict';require.config({paths:{"bootstrap-datepicker":'bower_components/bootstrap-datepicker/bootstrap-datepicker',"datepicker-az":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.az',"datepicker-bg":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.bg',"datepicker-ar":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.ar',"datepicker-ca":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.ca',"datepicker-cs":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.cs',"datepicker-cy":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.cy',"datepicker-da":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.da',"datepicker-de":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.de',"datepicker-el":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.el',"datepicker-es":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.es', "datepicker-et":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.et',"datepicker-sq":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.sq',"datepicker-fa":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.fa',"datepicker-fi":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.fi',"datepicker-fr":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.fr',"datepicker-gl":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.gl',"datepicker-he":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.he',"datepicker-hr":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.hr',"datepicker-hu":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.hu',"datepicker-id":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.id',"datepicker-is":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.is',"datepicker-it":'bower_componen ts/bootstrap-datepicker/locales/bootstrap-datepicker.it',"datepicker-ja":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.ja',"datepicker-ka":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.ka',"datepicker-kk":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.kk',"datepicker-kr":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.kr',"datepicker-lt":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.lt',"datepicker-lv":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.lv',"datepicker-mk":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.mk',"datepicker-ms":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.ms',"datepicker-nb":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.nb',"datepicker-nl":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.nl',"datepicker-nl-BE":'bower_components/bootstrap-datepicker/loca les/bootstrap-datepicker.nl-BE',"datepicker-no":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.no',"datepicker-pl":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.pl',"datepicker-pt":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.pt',"datepicker-pt-BR":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.pt-BR',"datepicker-ro":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.ro',"datepicker-rs":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.rs',"datepicker-rs-latin":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.rs-latin',"datepicker-ru":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.ru',"datepicker-sk":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.sk',"datepicker-sl":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.sl',"datepicker-sv":'bower_components/bootstrap-datepicker/locales/bootst rap-datepicker.sv',"datepicker-sw":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.sw',"datepicker-th":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.th',"datepicker-tr":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.tr',"datepicker-vi":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.vi',"datepicker-zh-CN":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN',"datepicker-zh-TW":'bower_components/bootstrap-datepicker/locales/bootstrap-datepicker.zh-TW'},shim:{"datepicker-az":{deps:['bootstrap-datepicker']},"datepicker-bg":{deps:['bootstrap-datepicker']},"datepicker-ar":{deps:['bootstrap-datepicker']},"datepicker-ca":{deps:['bootstrap-datepicker']},"datepicker-cs":{deps:['bootstrap-datepicker']},"datepicker-cy":{deps:['bootstrap-datepicker']},"datepicker-da":{deps:['bootstrap-datepicker']},"datepicker-de":{deps:['bootstrap-datepicker']},"datepicker-el":{deps:['bootstrap-datepicker']}," datepicker-es":{deps:['bootstrap-datepicker']},"datepicker-et":{deps:['bootstrap-datepicker']},"datepicker-sq":{deps:['bootstrap-datepicker']},"datepicker-fa":{deps:['bootstrap-datepicker']},"datepicker-fi":{deps:['bootstrap-datepicker']},"datepicker-fr":{deps:['bootstrap-datepicker']},"datepicker-gl":{deps:['bootstrap-datepicker']},"datepicker-he":{deps:['bootstrap-datepicker']},"datepicker-hr":{deps:['bootstrap-datepicker']},"datepicker-hu":{deps:['bootstrap-datepicker']},"datepicker-id":{deps:['bootstrap-datepicker']},"datepicker-is":{deps:['bootstrap-datepicker']},"datepicker-it":{deps:['bootstrap-datepicker']},"datepicker-ja":{deps:['bootstrap-datepicker']},"datepicker-ka":{deps:['bootstrap-datepicker']},"datepicker-kk":{deps:['bootstrap-datepicker']},"datepicker-kr":{deps:['bootstrap-datepicker']},"datepicker-lt":{deps:['bootstrap-datepicker']},"datepicker-lv":{deps:['bootstrap-datepicker']},"datepicker-mk":{deps:['bootstrap-datepicker']},"datepicker-ms":{deps:['bootstrap-datepi cker']},"datepicker-nb":{deps:['bootstrap-datepicker']},"datepicker-nl":{deps:['bootstrap-datepicker']},"datepicker-nl-BE":{deps:['bootstrap-datepicker']},"datepicker-no":{deps:['bootstrap-datepicker']},"datepicker-pl":{deps:['bootstrap-datepicker']},"datepicker-pt":{deps:['bootstrap-datepicker']},"datepicker-pt-BR":{deps:['bootstrap-datepicker']},"datepicker-ro":{deps:['bootstrap-datepicker']},"datepicker-rs":{deps:['bootstrap-datepicker']},"datepicker-rs-latin":{deps:['bootstrap-datepicker']},"datepicker-ru":{deps:['bootstrap-datepicker']},"datepicker-sk":{deps:['bootstrap-datepicker']},"datepicker-sl":{deps:['bootstrap-datepicker']},"datepicker-sv":{deps:['bootstrap-datepicker']},"datepicker-sw":{deps:['bootstrap-datepicker']},"datepicker-th":{deps:['bootstrap-datepicker']},"datepicker-tr":{deps:['bootstrap-datepicker']},"datepicker-vi":{deps:['bootstrap-datepicker']},"datepicker-zh-CN":{deps:['bootstrap-datepicker']},"datepicker-zh-TW":{deps:['bootstrap-datepicker']}}});define('hu sky_extensions/datepicker',['bootstrap-datepicker','datepicker-ar','datepicker-az','datepicker-bg','datepicker-ca','datepicker-cs','datepicker-cy','datepicker-da','datepicker-de','datepicker-el','datepicker-es','datepicker-et','datepicker-fa','datepicker-fi','datepicker-fr','datepicker-gl','datepicker-he','datepicker-hr','datepicker-hu','datepicker-id','datepicker-is','datepicker-it','datepicker-ja','datepicker-ka','datepicker-kk','datepicker-kr','datepicker-lt','datepicker-lv','datepicker-mk','datepicker-ms','datepicker-nb','datepicker-nl','datepicker-nl-BE','datepicker-no','datepicker-pl','datepicker-pt','datepicker-pt-BR','datepicker-ro','datepicker-rs','datepicker-rs-latin','datepicker-ru','datepicker-sk','datepicker-sl','datepicker-sq','datepicker-sv','datepicker-sw','datepicker-th','datepicker-tr','datepicker-vi','datepicker-zh-CN','datepicker-zh-TW'],{name:'bootstrap-datepicker',initialize:function(app){app.sandbox.datepicker={init:function(selector,configs){var settings={format:app.sandbox.globalize.getDatePattern().toLowerCase(),language:app.sandbox.globalize.getLocale(),autoclose:true};settings=app.sandbox.util.extend(true,{},settings,configs);return app.core.dom.$(selector).datepicker(settings);},setValue:function(selector,value){return app.core.dom.$(selector).datepicker('update',value);},getUTCDate:function(selector){return app.core.dom.$(selector).datepicker('getUTCDate');},getDate:function(selector){return app.core.dom.$(selector).datepicker('getDate');},setUTCDate:function(selector,date){return app.core.dom.$(selector).datepicker('setUTCDate',date);},setDate:function(selector,date){return app.core.dom.$(selector).datepicker('setDate',date);}};}});})();(function(){'use strict';require.config({paths:{'dropzone':'bower_components/dropzone/dropzone'},shim:{dropzone:{exports:'Dropzone',deps:['jquery']}}});define('husky_extensions/dropzone',['dropzone'],function(Dropzone){return{name:'dropzone',initialize:function(app){Dropzone.confirm=function(question,accepted){accepted();};app.sandbox.dropzone={initialize:function(selector,configs){return app.core.dom.$(selector).dropzone(configs);}};}};});})();(function(){'use strict';require.config({paths:{'globalize_lib':'bower_components/globalize/lib/globalize','cultures':'bower_components/globalize/lib/cultures'}});define('husky_extensions/globalize',['globalize_lib'],function(){var normalizeCultureName=function(cultureName){cultureName=cultureName.replace('_','-');if(cultureName.indexOf('-')>-1){cultureName=cultureName.substring(0,cultureName.indexOf('-'))+
cultureName.substring(cultureName.indexOf('-'),cultureName.length).toUpperCase();}
return cultureName;};return{name:'husky-validation',initialize:function(app){app.sandbox.globalize={addCultureInfo:function(cultureName,messages){cultureName=normalizeCultureName(cultureName);Globalize.addCultureInfo(cultureName,{messages:messages});},getLocale:function(){return Globalize.culture().name;},getDatePattern:function(){return Globalize.culture().calendar.patterns.d;},getTimePatter:function(){return Globalize.culture().calendar.patterns.t;},setCurrency:function(symbol){Globalize.culture().numberFormat.currency.symbol=symbol;}};app.sandbox.translate=function(key){var translation;if(!app.config.culture||!Globalize.culture().name){return key;}
try{translation=Globalize.localize(key,Globalize.culture().name);}catch(e){app.logger.warn('Globalize threw an error when translating key "'+key+'", failling back to key. Error: '+e);return key;}
return(!!translation||translation==='')?translation:key;};app.sandbox.date={format:function(date,returnDateAndTime){var returnDate,returnTime;if(typeof date==='string'){date=this.parse(date);}
returnDate=Globalize.format(date,Globalize.culture().calendar.patterns.d);if(returnDateAndTime===true){returnTime=Globalize.format(date,Globalize.culture().calendar.patterns.t);}
return((!!returnDate)?returnDate:'')+
((!!returnDate&&!!returnTime)?' ':'')+
((!!returnTime)?returnTime:'');},parse:function(dateString){var timebitsRegex=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})([0-9]{2}))?/,timebits=timebitsRegex.exec(dateString),resultDate,utcdate,offsetMinutes;if(timebits){utcdate=Date.UTC(parseInt(timebits[1]),parseInt(timebits[2])-1,parseInt(timebits[3]),parseInt(timebits[4]),parseInt(timebits[5]),(timebits[6]&&parseInt(timebits[6])||0),(timebits[7]&&parseFloat(timebits[7])*1000)||0);if(timebits[9]&&timebits[10]){offsetMinutes=parseInt(timebits[9])*60+parseInt(timebits[10]);utcdate+=(timebits[8]==='+'?-1:+1)*offsetMinutes*60000;}
resultDate=new Date(utcdate);}else{resultDate=null;}
return resultDate;}};app.sandbox.translateArray=function(array){var translations=[];app.sandbox.util.foreach(array,function(key){translations.push(app.sandbox.translate(key));}.bind(this));return translations;};app.sandbox.numberFormat=function(number,types){return Globalize.format(number,types);};app.sandbox.parseFloat=function(value,radix,culture){return Globalize.parseFloat(value,radix,culture);};app.setLanguage=function(cultureName,messages,defaultMessages){cultureName=normalizeCultureName(cultureName);if(cultureName!=='en'){require(['cultures/globalize.culture.'+cultureName]);}
Globalize.culture(cultureName);app.sandbox.globalize.addCultureInfo(cultureName,messages);app.sandbox.globalize.addCultureInfo('default',defaultMessages);};},afterAppStart:function(app){if(!!app.config.culture&&!!app.config.culture){if(!app.config.culture.messages){app.config.culture.messages={};}
app.setLanguage(app.config.culture.name,app.config.culture.messages,app.config.culture.defaultMessages);}
app.sandbox.globalize.setCurrency('');}};});})();(function(){'use strict';require.config({paths:{'jquery':'bower_components/jquery/jquery','html.sortable':'bower_components/html.sortable/html.sortable'},shim:{jquery:{exports:'$'},html5sortable:{deps:['jquery'],exports:'jQuery.fn.sortable'}}});define('husky_extensions/html.sortable',['html.sortable'],function(){return{name:'html.sortable',initialize:function(app){app.core.dom.sortable=function(selector,options){return $(selector).sortable(options);};}};});})();(function(){'use strict';require.config({paths:{"form":'bower_components/husky-validation/dist/validation'}});define('husky_extensions/husky-validation',['form'],function(Form){return{name:'husky-validation',initialize:function(app){app.sandbox.form={create:function(selector,options){return new Form($(selector),options);},getObject:function(selector){return $(selector).data('form-object');},validate:function(selector,force){if($(selector).length===0){return false;}
if(!force){force=false;}
return app.sandbox.form.getObject(selector).validation.validate(force);},isValid:function(selector){return app.sandbox.form.getObject(selector).validation.isValid();},addField:function(selector,elementSelector){return app.sandbox.form.getObject(selector).addField(elementSelector);},removeField:function(selector,elementSelector){return app.sandbox.form.getObject(selector).removeField(elementSelector);},addConstraint:function(selector,elementSelector,constraintName,options){app.sandbox.form.getObject(selector).validation.addConstraint(elementSelector,constraintName,options);},updateConstraint:function(selector,elementSelector,constraintName,options){app.sandbox.form.getObject(selector).validation.updateConstraint(elementSelector,constraintName,options);},deleteConstraint:function(selector,elementSelector,constraintName){app.sandbox.form.getObject(selector).validation.deleteConstraint(elementSelector,constraintName);},setData:function(selector,data){return app.sandbox.form.getObject(selector).mapper.setData(data);},getData:function(selector,returnMapperId,$el){return app.sandbox.form.getObject(selector).mapper.getData($el,returnMapperId);},addToCollection:function(selector,propertyName,data,append){return app.sandbox.form.getObject(selector).mapper.addToCollection(propertyName,data,append);},editInCollection:function(selector,mapperId,data){return app.sandbox.form.getObject(selector).mapper.editInCollection(mapperId,data);},removeFromCollection:function(selector,mapperId){return app.sandbox.form.getObject(selector).mapper.removeFromCollection(mapperId);},addCollectionFilter:function(selector,arrayName,callback){app.sandbox.form.getObject(selector).mapper.addCollectionFilter(arrayName,callback);},removeCollectionFilter:function(selector,arrayName){app.sandbox.form.getObject(selector).mapper.removeCollectionFilter(arrayName);},element:{getObject:function(elementSelector){return $(elementSelector).data('element');},validate:function(elementSelector,force){return app.sandbox.form.element.getObject(elementSelector).validate(force);},addConstraint:function(elementSelector,constraintName,options){app.sandbox.form.element.getObject(elementSelector).addConstraint(constraintName,options);},updateConstraint:function(elementSelector,constraintName,options){app.sandbox.form.element.getObject(elementSelector).updateConstraint(constraintName,options);},deleteConstraint:function(elementSelector,constraintName){app.sandbox.form.element.getObject(elementSelector).deleteConstraint(constraintName);},hasConstraint:function(elementSelector,constraintName){return app.sandbox.form.element.getObject(elementSelector).hasConstraint(constraintName);},getConstraint:function(elementSelector,constraintName){return app.sandbox.form.element.getObject(elementSelector).getConstraint(constraintName);},setValue:function(elementSelector,value){app.sandbox.form.element.getObject(elementSelector).setValue(value);},getValue:function(elementSelector){return app.sandbox.form.element.getObject(elementSelector).getValue();}}};}};});})();(function(){'use strict';define('husky_extensions/infinite-scroll',[],function(){var scrollTimer=null,scrollListener=function(selector,offset,callback){if(!$(selector).data('blocked')){if(!!scrollTimer){clearTimeout(scrollTimer);}
scrollTimer=setTimeout(scrollHandler.bind(this,selector,offset,callback),50);}},scrollHandler=function(selector,offset,callback){var scrollContainer=$(selector),containerHeight=scrollContainer[0].clientHeight,contentHeight=scrollContainer[0].scrollHeight,scrollTop=scrollContainer.scrollTop(),padding=(isNaN(offset))?0:offset;if((containerHeight+scrollTop+padding-contentHeight)>=0){scrollContainer.data('blocked',true);var result=callback();if(!!result&&!!result.then){result.then(function(){$(selector).removeData('blocked');});}else{$(selector).removeData('blocked');}}};return{name:'infinite-scroll',initialize:function(app){app.sandbox.infiniteScroll={initialize:function(selector,callback,offset){app.sandbox.dom.on(selector,'scroll.infinite',function(){scrollListener(selector,offset,callback);});},destroy:function(selector){app.sandbox.dom.off(selector,'scroll.infinite');}}}};});})();define('husky_extensions/itembox',[],function(){'use strict';var defaults={instanceName:null,url:null,eventNamespace:'husky.itembox',idsParameter:'ids',resultKey:null,idKey:'id',dataAttribute:'',dataDefault:{},sortable:true,removable:true,hideAddButton:false,hidePositionElement:false,hideConfigButton:false,hideSelectedCounter:false,defaultDisplayOption:'top',actionIcon:'fa-plus-circle',displayOptions:{leftTop:true,top:true,rightTop:true,left:true,middle:true,right:true,leftBottom:true,bottom:true,rightBottom:true},translations:{noContentSelected:'listbox.nocontent-selected',viewAll:'public.view-all',viewLess:'public.view-less',of:'public.of',visible:'public.visible',elementsSelected:'public.elements-selected'}},constants={displayOptionSelectedClass:'selected',itemInvisibleClass:'invisible-item',noContentClass:'no-content',isLoadingClass:'is-loading'},createEventName=function(eventName){return[this.options.eventNamespace,'.',(this.options.instanceName?this.options.instanceName+'.':''),eventName].join('');},templates={skeleton:function(){return[' <div class="white-box form-element" id="',this.ids.container,'">','    <div class="header">','        <span class="',this.options.actionIcon,' icon left action',!!this.options.hideAddButton?' hidden':'','" id="',this.ids.addButton,'"></span>','        <span class="selected-counter',!!this.options.hideSelectedCounter?' hidden':'','">','            <span class="num">0</span><span> ',this.sandbox.translate(this.options.translations.elementsSelected),'</span>','        </span>','        <span class="fa-cog icon right border',!!this.options.hideConfigButton?' hidden':'','" id="',this.ids.configButton,'"></span>','        <span class="no-content-message">',this.sandbox.translate(this.options.translations.noContentSelected),'</span>','        <div class="position',!!this.options.hidePositionElement?' hidden':'','">','            <div class="husky-position" id="',this.ids.displayOption,'">','                <div class="top left ',(!this.options.displayOptions.leftTop?'inactive':''),'" data-position="leftTop"></div>','                <div class="top middle ',(!this.options.displayOptions.top?'inactive':''),'" data-position="top"></div>','                <div class="top right ',(!this.options.displayOptions.rightTop?'inactive':''),'" data-position="rightTop"></div>','                <div class="middle left ',(!this.options.displayOptions.left?'inactive':''),'" data-position="left"></div>','                <div class="middle middle ',(!this.options.displayOptions.middle?'inactive':''),'" data-position="middle"></div>','                <div class="middle right ',(!this.options.displayOptions.right?'inactive':''),'" data-position="right"></div>','                <div class="bottom left ',(!this.options.displayOptions.leftBottom?'inactive':''),'" data-position="leftBottom"></div>','                <div class="bottom middle ',(!this.options.displayOptions.bottom?'inactive':''),'" data-position="bottom"></div>','                <div class="bottom right ',(!this.options.displayOptions.rightBottom?'inactive':''),'" data-position="rightBottom"></div>','            </div>','        </div>','    </div>','    <div class="content" id="',this.ids.content,'"></div>','</div>'].join('');},item:function(id,content){return['<li data-id="',id,'">',!!this.options.sortable?'    <span class="fa-ellipsis-v icon move"></span>':'','    <span class="num"></span>',content,!!this.options.removable?'    <span class="fa-times remove"></span>':'','</li>'].join('');}},bindCustomEvents=function(){this.sandbox.on(this.DATA_CHANGED(),this.changeData.bind(this));this.sandbox.on(this.DATA_RETRIEVED(),this.renderContent.bind(this));},bindDomEvents=function(){this.sandbox.dom.on(this.getId('displayOption')+' > div:not(.inactive)','click',this.changeDisplayOption.bind(this));this.sandbox.dom.on(this.$addButton,'click',function(){this.sandbox.emit(this.ADD_BUTTON_CLICKED());}.bind(this));this.sandbox.dom.on(this.$configButton,'click',function(){this.sandbox.emit(this.CONFIG_BUTTON_CLICKED());}.bind(this));this.sandbox.dom.on(this.getId('content'),'click',this.removeItem.bind(this),'li .remove');},initSortable=function(){var $sortable=this.sandbox.dom.find('.sortable',this.$el),sortable;this.sandbox.dom.sortable($sortable,'destroy');sortable=this.sandbox.dom.sortable('.sortable',{handle:'.move',forcePlaceholderSize:true});this.sandbox.dom.unbind(sortable,'unbind');sortable.bind('sortupdate',function(){var ids=this.updateOrder();this.sortHandler(ids);}.bind(this));},createItemList=function(){return this.sandbox.dom.createElement('<ul class="items-list sortable"/>');},itembox={DATA_CHANGED:function(){return createEventName.call(this,'data-changed');},DATA_RETRIEVED:function(){return createEventName.call(this,'data-retrieved');},DISPLAY_OPTION_CHANGED:function(){return createEventName.call(this,'display-position-changed');},ADD_BUTTON_CLICKED:function(){return createEventName.call(this,'add-button-clicked');},CONFIG_BUTTON_CLICKED:function(){return createEventName.call(this,'config-button-clicked');},render:function(){this.options=this.sandbox.util.extend(true,{},defaults,this.options);var data=this.getData();this.viewAll=true;this.ids={container:'listbox-'+this.options.instanceName+'-container',addButton:'listbox-'+this.options.instanceName+'-add',configButton:'listbox-'+this.options.instanceName+'-config',displayOption:'listbox-'+this.options.instanceName+'-display-option',content:'listbox-'+this.options.instanceName+'-content'};this.sandbox.dom.html(this.$el,templates.skeleton.call(this));this.$container=this.sandbox.dom.find(this.getId('container'),this.$el);this.$addButton=this.sandbox.dom.find(this.getId('addButton'),this.$el);this.$configButton=this.sandbox.dom.find(this.getId('configButton'),this.$el);this.$content=this.sandbox.dom.find(this.getId('content'),this.$el);this.$list=null;this.addNoContentClass();if(!this.isDataEmpty(data)){this.loadContent(data);}else{this.sandbox.dom.data(this.$el,this.options.dataAttribute,this.options.dataDefault);}
this.setDisplayOption(this.options.defaultDisplayOption);this.startLoader();bindCustomEvents.call(this);bindDomEvents.call(this);},addNoContentClass:function(){this.$list=null;this.sandbox.dom.addClass(this.$container,constants.noContentClass);},removeNoContentClass:function(){this.sandbox.dom.removeClass(this.$container,constants.noContentClass);},getData:function(){return this.sandbox.util.deepCopy(this.sandbox.dom.data(this.$el,this.options.dataAttribute));},setData:function(data,reload){var oldData=this.sandbox.dom.data(this.$el,this.options.dataAttribute);reload=typeof(reload)==='undefined'?true:reload;if(!this.sandbox.util.isEqual(oldData,data)){this.sandbox.emit(this.DATA_CHANGED(),data,this.$el,reload);}},changeData:function(data,$el,reload){this.sandbox.dom.data(this.$el,this.options.dataAttribute,data);if(!!reload){this.loadContent(data);}},updateVisibility:function(){if(!this.$list||!this.$list.find('li').length){this.addNoContentClass();}else{this.removeNoContentClass();}},loadContent:function(data){this.$container.addClass(constants.isLoadingClass);this.viewAll=false;if(!!data&&(!data.length||data.length>0)){this.sandbox.util.load(this.getUrl(data)).then(function(data){this.$container.removeClass(constants.isLoadingClass);this.sandbox.emit(this.DATA_RETRIEVED(),data._embedded[this.options.resultKey]);}.bind(this)).fail(function(error){this.sandbox.logger.error(error);}.bind(this));}else{this.$container.removeClass(constants.isLoadingClass);this.sa ndbox.emit(this.DATA_RETRIEVED(),[]);}},renderContent:function(data){if(data.length>0){var length=data.length;this.$list=createItemList.call(this);for(var i=-1;++i<length;){this.addItem(data[i],false,false);}
this.sandbox.dom.html(this.$content,this.$list);initSortable.call(this);this.updateOrder();this.updateSelectedCounter();this.updateVisibility();}else{this.$list.children().remove();this.addNoContentClass();}},startLoader:function(){var $loader=this.sandbox.dom.createElement('<div class="loader"/>');this.sandbox.dom.append(this.$container.find('.header'),$loader);this.sandbox.start([{name:'loader@husky',options:{el:$loader,size:'20px',color:'#999999'}}]);},setDisplayOption:function(displayOption){var $element=this.sandbox.dom.find('[data-position="'+displayOption+'"]',this.$container);this.sandbox.dom.removeClass(this.sandbox.dom.find('.'+constants.displayOptionSelectedClass,this.getId('displayOption')),constants.displayOptionSelectedClass);this.sandbox.dom.addClass($element,constants.displayOptionSelectedClass);},changeDisplayOption:function(event){var position=this.sandbox.dom.data(event.currentTarget,'position');this.setDisplayOption(position);this.sandbox.emit(this.DISPLAY_OPTION_CHANGED(),position);},updateOrder:function(){var $elements=this.sandbox.dom.find('li',this.$content),ids=[];this.sandbox.util.foreach($elements,function($element,index){var $number=this.sandbox.dom.find('.num',$element);$number.html(index+1);ids.push(this.sandbox.dom.data($element,'id'));}.bind(this));return ids;},updateSelectedCounter:function(){var number=this.$content.find('li').length;this.$find('.selected-counter .num').html(number);},addItem:function(item,reinitialize,scroll){if(typeof(reinitialize)==='undefined'){reinitialize=true;}
if(typeof(scroll)==='undefined'){scroll=true;}
if(!this.$list){this.$list=createItemList.call(this);this.sandbox.dom.html(this.$content,this.$list);}
var $item=this.sandbox.dom.createElement(templates.item.call(this,item[this.options.idKey],this.getItemContent(item)));this.sandbox.dom.append(this.$list,$item);if(!!reinitialize){if(this.options.sortable){initSortable.call(this);}
this.updateOrder();this.updateVisibility();this.updateSelectedCounter();}
if(!!scroll){this.sandbox.dom.scrollAnimate(this.$content.get(0).scrollHeight,this.$content);}},removeItemById:function(itemId){var $removeItem=this.sandbox.dom.find('li[data-id='+itemId+']',this.$el);this.sandbox.dom.remove($removeItem);this.removeHandler(itemId);this.updateOrder();this.updateVisibility();this.updateSelectedCounter();},removeItem:function(event){var $removeItem=this.sandbox.dom.parents(event.currentTarget,'li'),itemId=this.sandbox.dom.data($removeItem,'id');this.sandbox.dom.remove($removeItem);this.removeHandler(itemId);this.updateOrder();this.updateVisibility();this.updateSelectedCounter();},isDataEmpty:function(data){return this.sandbox.util.isEmpty(data);},getId:function(type){return['#',this.ids[type]].join('');},getUrl:function(data){throw new Error('"getUrl" not implemented');},getItemContent:function(item){throw new Error('"getItemContent" not implemented');},sortHandler:function(ids){throw new Error('"sortHandler" not implemented');},removeHandler:function(id){throw new Error('"removeHandler" not implemented');}};return{name:'itembox',initialize:function(app){app.components.addType('itembox',itembox);}}});define('husky_extensions/itemgrid',[],function(){'use strict';var defaults={instanceName:null,url:null,eventNamespace:'husky.itemgrid',idsParameter:'ids',resultKey:null,idKey:'id',dataAttribute:'',dataDefault:{},sortable:false,removable:true,translations:{noContentSelected:'listbox.nocontent-selected',viewAll:'public.view-all',viewLess:'public.view-less',of:'public.of',visible:'public.visible',elementsSelected:'public.elements-selected'}},constants={noContentClass:'no-content',addIcon:'fa-plus-circle',deleteIcon:'fa-trash-o'},createEventName=function(eventName){return[this.options.eventNamespace,'.',(this.options.instanceName?this.options.instanceName+'.':''),eventName].join('');},templates={skeleton:function(){return['<div class="listgrid" id="',this.ids.container,'">','    <div class="header">','        <span class="',constants.addIcon,' icon left action add-button" id="',this.ids.addButton,'"></span>','        <span class="',constants.deleteIcon,' icon left action delete-button" id="',this.ids.deleteButton,'"></span>','    </div>','    <div class="content" id="',this.ids.content,'"></div>','</div>'].join('');}},bindCustomEvents=function(){this.sandbox.on(this.DATA_CHANGED(),this.changeData.bind(this));this.sandbox.on(this.DELETE_BUTTON_CLICKED(),function(){this.sandbox.emit('husky.datagrid.'+this.options.instanceName+'.items.get-selected',function(ids){deleteItems.call(this,ids);}.bind(this));}.bind(this));this.sandbox.on(this.ITEM_ADD(),function(item){addItem.call(this,item);}.bind(this));this.sandbox.on(this.ITEM_SAVE(),function(item){editItem.call(this,item);}.bind(this));},bindDomEvents=function(){this.sandbox.dom.on(this.$addButton,'click',function(){this.sandbox.emit(this.ADD_BUTTON_CLICKED());}.bind(this));this.sandbox.dom.on(this.$deleteButton,'click',function(){this.sandbox.emit(this.DELETE_BUTTON_CLICKED());}.bind(this));},addItem=function(newItem){var data=this.getData();if(this.sandbox.util.typeOf(data)!=='array'||this.sandbox.util.typeOf(data[0])!=='object'){data=[];}
data.push(newItem);this.setData(data);},editItem=function(editedItem){var newData=[],data=this.getData();data.forEach(function(item){if(item.id===editedItem.id){newData.push(editedItem);}else{newData.push(item);}}.bind(this));this.setData(newData);},deleteItems=function(ids){this.sandbox.sulu.showDeleteDialog(function(wasConfirmed){if(wasConfirmed){var newData=[],data=this.getData();data.forEach(function(item){if(ids.indexOf(item.id)>-1){this.sandbox.emit('husky.datagrid.'+this.options.instanceName+'.record.remove',item.id);this.sandbox.emit('sulu.header.toolbar.item.enable','save',false);}else{newData.push(item);}}.bind(this));this.setData(newData);}}.bind(this));},itemgrid={DATA_CHANGED:function(){return createEventName.call(this,'data-changed');},ADD_BUTTON_CLICKED:function(){return createEventName.call(this,'add-button-clicked');},DELETE_BUTTON_CLICKED:function(){return createEventName.call(this,'delete-button-clicked');},ITEM_ADD:function(){return createEventName.call(this,'add-item');},ITEM_SAVE:function(){return createEventName.call(this,'save-item');},render:function(){this.options=this.sandbox.util.extend(true,{},defaults,this.options);var data=this.getData();this.viewAll=true;this.ids={container:'listbox-'+this.options.instanceName+'-container',addButton:'listbox-'+this.options.instanceName+'-add',deleteButton:'listbox-'+this.options.instanceName+'-delete',content:'listbox-'+this.options.instanceName+'-content'};this.sandbox.dom.html(this.$el,templates.skeleton.call(this));this.$container=this.sandbox.dom.find(this.getId('container'),this.$el);this.$addButton=this.sandbox.dom.find(this.getId('addButton'),this.$el);this.$deleteButton=this.sandbox.dom.find(this.getId('deleteButton'),this.$el);this.$content=this.sandbox.dom.find(this.getId('content'),this.$el);bindCustomEvents.call(this);bindDomEvents.call(this);this.renderContent(data);},getData:function(){return this.sandbox.util.deepCopy(this.sandbox.dom.data(this.$el,this.options.dataAttribute));},setData:function(data,reload){this.sandbox.emit(this.DATA_CHANGED(),data,this.$el,reload);},changeData:function(data){this.updateOrder(data);this.sandbox.emit('husky.datagrid.'+this.options.instanceName+'.data.set',data);this.sandbox.dom.data(this.$el,this.options.dataAttribute,data);this.sandbox.emit('sulu.header.toolbar.item.enable','save',false);},updateOrder:function(data){throw new Error('"updateOrder" not implemented');},editItem:function(id,item){throw new Error('"editItem" not implemented');},getId:function(type){return['#',this.ids[type]].join('');},renderContent:function(data){var template=['<div id="',this.options.instanceName,'-list-toolbar-container"></div>','<div id="itemgrid-list-',this.options.instanceName,'"></div>'].join('');this.sandbox.dom.html(this.$content,template);this.sandbox.start([{name:'datagrid@husky',options:{el:'#itemgrid-list-'+this.options.instanceName,instanceName:this.options.instanceName,view:'table',data:data,matchings:this.options.fieldList,viewOptions:{table:{noItemsText:'public.empty-list'}},actionCallback:function(id,item){this.editItem.call(this,id,item);}.bind(this)}}]);}};return{name:'itemgrid',initialize:function(app){app.components.addType('itemgrid',itemgrid);}}});(function(){'use strict';if(window.jQuery){define('jquery',[],function(){return window.jQuery;});}else{require.config({paths:{backbone:'bower_components/jquery/jquery'},shim:{backbone:{exports:'$'}}});}
var initRemoveEvent=function(){var ev=new $.Event('remove'),orig=$.fn.remove;$.fn.remove=function(){$(this).trigger(ev);return orig.apply(this,arguments);};};define('husky_extensions/jquery',['jquery'],{name:'jQuery',initialize:function(app){initRemoveEvent();app.core.dom.window=window;app.core.dom.$window=$(window);app.core.dom.document=document;app.core.dom.$document=$(document);app.core.dom.$=$;app.core.dom.createElement=function(selector,props){props=props||{};return $(selector,props);};app.core.dom.html=function(selector,content){if(typeof content!=='undefined'){return $(selector).html(content);}
return $(selector).html();};app.core.dom.outerHTML=function(selector){return $(selector).wrapAll('<div></div>').parent().html();};app.core.dom.parseHTML=function(data){return $.parseHTML(data);};app.core.dom.each=function(selector,callback){$(selector).each(callback);};app.core.dom.append=function(selector,element){return $(selector).append(element);};app.core.dom.prepend=function(selector,element){return $(selector).prepend(element);};app.core.dom.before=function(selector,element){return $(selector).before(element);};app.core.dom.after=function(selector,element){return $(selector).after(element);};app.core.dom.css=function(selector,style,value){if(typeof value!=='undefined'){return $(selector).css(style,value);}else{return $(selector).css(style);}};app.core.dom.addClass=function(selector,classes){return $(selector).addClass(classes);};app.core.dom.removeClass=function(selector,classes){if(!classes){return $(selector).removeClass();}
return $(selector).removeClass(classes);};app.core.dom.toggleClass=function(selector,classes){return $(selector).toggleClass(classes);};app.core.dom.hasClass=function(selector,classes){return $(selector).hasClass(classes);};app.core.dom.prependClass=function(selector,classes){var $el=$(selector),oldClasses=$el.attr('class');classes=classes+' '+oldClasses;$el.attr('class',classes);};app.core.dom.parent=function(selector,filter){return $(selector).parent(filter);};app.core.dom.width=function(selector,value){if(typeof value!=='undefined'){return $(selector).width(value);}else{return $(selector).width();}};app.core.dom.outerWidth=function(selector){return $(selector).outerWidth();};app.core.dom.height=function(selector,value){if(typeof value==='undefined'){return $(selector).height();}
return $(selector).height(value);};app.core.dom.outerHeight=function(selector,includeMargin){if(typeof includeMargin==='undefined'){return $(selector).outerHeight();}else{return $(selector).outerHeight(includeMargin);}};app.core.dom.outerWidth=function(selector,includeMargin){if(typeof includeMargin==='undefined'){return $(selector).outerWidth();}else{return $(selector).outerWidth(includeMargin);}};app.core.dom.offset=function(selector,attributes){if(attributes){return $(selector).offset(attributes);}else{return $(selector).offset();}};app.core.dom.position=function(selector){return $(selector).position();};app.core.dom.remove=function(context,selector){return $(context).remove(selector);};app.core.dom.detach=function(context,selector){return $(context).detach(selector);};app.core.dom.attr=function(selector,attributeName,value){if(typeof value==='undefined'){attributeName=attributeName||{};return $(selector).attr(attributeName);}else{return $(selector).attr(attributeName,value);}};app.core.dom.removeAttr=function(selector,attributeName){return $(selector).removeAttr(attributeName);};app.core.dom.is=function(selector,type){return $(selector).is(type);};app.core.dom.filter=function(selector,filter){return $(selector).filter(filter);};app.core.dom.isArray=function(selector){return $.isArray(selector);};app.core.dom.isNumeric=function(number){return $.isNumeric(number);};app.core.dom.data=function(selector,key,value){if(!!value||value===''){return $(selector).data(key,value);}else{return $(selector).data(key);}};app.core.dom.onReady=function(callback){$(window).on('load',callback);};app.core.dom.val=function(selector,value){if(!!value||value===''){return $(selector).val(value);}else{return $(selector).val();}};app.core.dom.clearVal=function(selector){return $(selector).val('');};app.core.dom.blur=function(selector){return $(selector).blur();};app.core.dom.on=function(selector,event,callback,filter){if(!!filter){$(selector).on(event,filter,callback);}else{$(selector).on(event,callback);}};app.core.dom.one=function(selector,event,callback,filter){if(!!filter){$(selector).one(event,filter,callback);}else{$(selector).one(event,callback);}};app.core.dom.off=function(selector,event,handler,filter){if(!!filter){$(selector).off(event,filter,handler);}else{$(selector).off(event,handler);}};app.core.dom.trigger=function(selector,eventType,params){$(selector).trigger(eventType,params);};app.core.dom.select=function(selector,handler){if(!!handler){return $(selector).select(handler);}else{return $(selector).select();}};app.core.dom.toggleClass=function(selector,className){$(selector).toggleClass(className);};app.core.dom.parent=function(selector,filter){return $(selector).parent(filter);};app.core.dom.parents=function(selector,filter){return $(selector).parents(filter);};app.core.dom.children=function(selector,filter){return $(selector).children(filter);};app.core.dom.next=function(selector,filter){return $(selector).next(filter);};app.core.dom.prev=function(selector,filter){return $(selector).prev(filter);};app.core.dom.closest=function(selector,filter){return $(selector).closest(filter);};app.core.dom.clone=function(selector){return $(selector).clone();};app.core.dom.text=function(selector,value){if(!!value||value===''){return $(selector).text(value);}else{return $(selector).text();}};app.core.dom.prop=function(selector,propertyName,value){if(value!==undefined){return $(selector).prop(propertyName,value);}else{return $(selector).prop(propertyName);}};app.core.dom.mouseleave=function(selector,handler){$(selector).mouseleave(handler);};app.core.dom.stopPropagation=function(event){event.stopPropagation();};app.core.dom.stop=function(selector){$(selector).stop();};app.core.dom.preventDefault=function(event){event.preventDefault();};app.core.dom.hide=function(selector){return $(selector).hide();};app.core.dom.show=function(selector){return $(selector).show();};app.core.dom.trim=function(string){return $.trim(string);};app.core.dom.map=function(selector,callback){return $(selector).map(callback);};app.core.dom.get=function(selector,index){return $(selector).get(index);};app.core.dom.toggle=function(selector){return $(selector).toggle();};app.core.dom.index=function(selector,filter){if(!!filter){return $(selector).index(filter);}else{return $(selector).index();}};app.core.dom.keypress=function(selector,callback){$(selector).keypress(callback);};app.core.dom.insertAt=function(index,selector,$container,$item){if(index===0){app.core.dom.prepend($container,$item);}else{var $before=app.core.dom.find(selector+':nth-child('+index+')',$container);app.core.dom.after($before,$item);}};app.core.dom.scrollToTop=function(itemSelector){$(window).scrollTop($(itemSelector).offset().top);};app.core.dom.scrollTop=function(selector,position){if(typeof position!=='undefined'){return $(selector).scrollTop(position);}else{return $(selector).scrollTop();}};app.core.dom.scrollLeft=function(selector,value){if(typeof value!=='undefined'){return $(selector).scrollLeft(value);}else{return $(selector).scrollLeft();}};app.core.dom.scrollAnimate=function(position,selector){if(!!selector){$(selector).animate({scrollTop:position},500);}else{$('html, body').animate({scrollTop:position},500);}};app.core.dom.slideUp=function(selector,duration,complete){$(selector).slideUp(duration,complete);};app.core.dom.slideDown=function(selector,duration,complete){$(selector).slideDown(duration,complete);};app.core.dom.last=function(selector){return $(selector).last();};app.core.dom.fadeIn=function(selector,duration,complete){$(selector).fadeIn(duration,complete);};app.core.dom.fadeTo=function(selector,duration,opacity,complete){$(selector).fadeTo(duration,opacity,complete);};app.core.dom.fadeOut=function(selector,duration,complete){$(selector).fadeOut(duration,complete);};app.core.dom.when=function(deffereds){return $.when(deffereds);};app.core.dom.unbind=function(selector,eventType){$(selector).unbind(eventType);};app.core.dom.focus=function(selector){$(selector).focus();};app.core.dom.click=function(selector){$(selector).click();};app.core.dom.submit=function(selector){$(selector).submit();};app.core.dom.animate=function(selector,properties,options){$(selector).animate(properties,options);};app.core.dom.empty=function(selector){$(selector).empty();};app.core.dom.replaceWith=function(selector,newContent){$(selector).replaceWith(newContent);};app.core.dom.inArray=function(value,array){return $.inArray(value,array);};app.core.dom.wrapAll=function(selector,html){return $(selector).wrapAll(html);};app.core.dom.first=function(selector){return $(selector).first();};app.core.dom.visible=function(selector,partial,hidden,direction){if(this.length<1){return;}
direction=(direction)?direction:'both';hidden=(typeof hidden==='undefined')?true:hidden;var $element=$(selector),$t=$element.length>1?$element.eq(0):$element,t=$t.get(0),vpWidth=app.sandbox.dom.$window.width(),vpHeight=app.sandbox.dom.$window.height(),clientSize=hidden===true?t.offsetWidth*t.offsetHeight:true,rec,tViz,bViz,lViz,rViz,vVisible,hVisible,viewTop,viewBottom,viewLeft,viewRight,offset,_top,_bottom,_left,_right,compareTop,compareBottom,compareLeft,compareRight;if(typeof t.getBoundingClientRect==='function'){rec=t.getBoundingClientRect();tViz=rec.top>=0&&rec.top<vpHeight;bViz=rec.bottom>0&&rec.bottom<=vpHeight;lViz=rec.left>=0&&rec.left<vpWidth;rViz=rec.right>0&&rec.right<=vpWidth;vVisible=partial?tViz||bViz:tViz&&bViz;hVisible=partial?lViz||lViz:lViz&&rViz;if(direction==='both'){return clientSize&&vVisible&&hVisible;}
else if(direction==='vertical'){return clientSize&&vVisible;}
else if(direction==='horizontal'){return clientSize&&hVisible;}}else{viewTop=app.sandbox.dom.$window.scrollTop();viewBottom=viewTop+vpHeight;viewLeft=app.sandbox.dom.$window.scrollLeft();viewRight=viewLeft+vpWidth;offset=$t.offset();_top=offset.top;_bottom=_top+$t.height();_left=offset.left;_right=_left+$t.width();compareTop=partial===true?_bottom:_top;compareBottom=partial===true?_top:_bottom;compareLeft=partial===true?_right:_left;compareRight=partial===true?_left:_right;if(direction==='both'){return!!clientSize&&((compareBottom<=viewBottom)&&(compareTop>=viewTop))&&((compareRight<=viewRight)&&(compareLeft>=viewLeft));}
else if(direction==='vertical'){return!!clientSize&&((compareBottom<=viewBottom)&&(compareTop>=viewTop));}
else if(direction==='horizontal'){return!!clientSize&&((compareRight<=viewRight)&&(compareLeft>=viewLeft));}}};app.core.util.ajax=$.ajax;app.core.util.ajaxError=function(callback){$(document).ajaxError(callback);};app.core.util.when=function(deferreds){return $.when(deferreds);};}});})();define('husky_extensions/model',[],function(){'use strict';var Model={get:function(attr){return this[attr];},set:function(attr,value){!!value&&(this[attr]=value);return this;}};return{name:'Model',initialize:function(app){app.sandbox.data.Model=Model;}};});(function(){'use strict';if(window.TagsManager){define('tagsManager',[],function(){return window.TagsManager;});}else{require.config({paths:{"tagsManager":'bower_components/tagmanager/tagmanager'},shim:{backbone:{deps:['jquery']}}});}
define('husky_extensions/tagmanager',['tagsManager'],{name:'tagsManager',initialize:function(app){app.sandbox.autocompleteList={init:function(selector,configs){return app.core.dom.$(selector).tagsManager(configs);}};}});})();define('husky_extensions/template',['underscore','jquery'],function(_,$){'use strict';function TemplateManager(options){this.options=_.defaults(options||{},{type:'html',compiler:_.template,lookup:[],components:'aura_components'});this.cache={};this.options.lookup.push(this.cache);}
TemplateManager.prototype={load:function(names,widget){names=_.isString(names)?[names]:names;var resolved={},unresolved=[],deferred,files;_.each(names,function(name){var template=this.find(widget+'/'+name);if(template){resolved[name]=template;}else{unresolved.push(name);}},this);deferred=new $.Deferred();if(!unresolved.length){deferred.resolve(resolved);}else{files=_.map(unresolved,function(u){var path=u+'.'+this.options.type;if(u.indexOf('/')!==0){}
return'text!'+path;},this);require(files,_.bind(function(){_.each(Array.prototype.slice.call(arguments),function(template,i){resolved[unresolved[i]]=this.options.compiler(template);this.cache[widget+'/'+name]=this.options.compiler(template);},this);deferred.resolve(resolved);},this),function(error){deferred.reject(error);});}
return deferred.promise();},find:function(name,namespace){namespace=namespace||'aura';var template=$('script[data-'+namespace+'-template="'+name+'"]').html(),hash;if(template){return this.options.compiler(template);}else{hash=_.find(this.options.lookup,function(h){return!!h[name];})||{};return hash[name];}}};return function(app){var manager=new TemplateManager(app.config.template);app.core.Components.Base.prototype.renderTemplate=function(tplName,context){if(typeof this.loadedTemplates[tplName]==='function'){var tpl=this.loadedTemplates[tplName],defaults={translate:this.sandbox.translate};context=this.sandbox.util.extend({},defaults,context);return tpl(context);}else{return'Template '+tplName+' not found.';}};app.components.before('initialize',function(){this.loadedTemplates={};if(!this.templates||!this.templates.length){return;}
var loading=manager.load(this.templates,this.options.name);loading.done(_.bind(function(templates){this.loadedTemplates=templates;},this));return loading.promise();});};});(function(){'use strict';if(window.Typeahead){define('typeahead',[],function(){return window.Typeahead;});}else{require.config({paths:{"typeahead":'bower_components/typeahead.js/typeahead.bundle'},shim:{backbone:{deps:['jquery']}}});}
define('husky_extensions/typeahead',['typeahead'],{name:'typeahead',initialize:function(app){app.sandbox.autocomplete={init:function(selector,configs){var engine=this.createEngine(configs);engine.initialize();return app.core.dom.$(selector).typeahead({highlight:true},{templates:configs.templates,displayKey:configs.displayKey,source:engine.ttAdapter()});},createEngine:function(configs){configs=app.sandbox.util.extend(true,{datumTokenizer:function(d){return Bloodhound.tokenizers.whitespace(d[configs.displayKey]);},queryTokenizer:Bloodhound.tokenizers.whitespace},configs);return new Bloodhound(configs);},setValue:function(selector,value){return app.core.dom.$(selector).typeahead('val',value);}};}});})();(function(){'use strict';require.config({paths:{"uri-template":'bower_components/massiveart-uritemplate/uritemplate'}});define('husky_extensions/uri-template',['uri-template'],function(UriTemplate){return{name:'uri-template',initialize:function(app){app.sandbox.uritemplate={parse:function(param){return UriTemplate.parse(param);},expand:function(template,params){return template.expand(params);}};}};});})();define('husky_extensions/util',['services/husky/util'],function(util){'use strict';return{name:'Util',initialize:function(app){for(var key in util){app.core.util[key]=util[key];}}};});